/share/home/conradb/git/ifg-ssl/S1_C1
/home/conradb/.conda/envs/torch/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:134: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
/share/home/conradb/git/ifg-ssl/S1_C1/training/dino_S1_train.py:85: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  fp16_scaler = torch.cuda.amp.GradScaler()
Using cuda
Commencing training
Epoch 0/501
  0%|          | 0/30 [00:00<?, ?it/s]/share/home/conradb/git/ifg-ssl/S1_C1/training/dino_S1_train.py:136: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(fp16_scaler is not None):
  3%|▎         | 1/30 [01:03<30:38, 63.40s/it]  7%|▋         | 2/30 [01:05<12:39, 27.12s/it] 10%|█         | 3/30 [01:05<06:43, 14.94s/it] 13%|█▎        | 4/30 [01:06<04:00,  9.26s/it] 17%|█▋        | 5/30 [01:06<02:32,  6.08s/it] 20%|██        | 6/30 [01:07<01:41,  4.22s/it] 23%|██▎       | 7/30 [01:07<01:08,  2.98s/it] 27%|██▋       | 8/30 [01:08<00:47,  2.17s/it] 30%|███       | 9/30 [01:08<00:34,  1.63s/it] 33%|███▎      | 10/30 [01:08<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:09<00:19,  1.01s/it] 40%|████      | 12/30 [01:09<00:15,  1.19it/s] 43%|████▎     | 13/30 [01:10<00:12,  1.39it/s] 47%|████▋     | 14/30 [01:10<00:10,  1.58it/s] 50%|█████     | 15/30 [01:11<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:11<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:12<00:06,  1.97it/s] 60%|██████    | 18/30 [01:12<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:12<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:13<00:04,  2.16it/s] 70%|███████   | 21/30 [01:13<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:14<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:14<00:03,  2.23it/s] 80%|████████  | 24/30 [01:15<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:15<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:15<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:16<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:16<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:17<00:00,  2.27it/s]100%|██████████| 30/30 [01:17<00:00,  2.27it/s]100%|██████████| 30/30 [01:17<00:00,  2.60s/it]
/share/home/conradb/git/ifg-ssl/S1_C1/training/dino_S1_train.py:210: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(config.model.checkpoint_path, map_location="cpu")
Epoch loss is 8.237406126658122
saving checkpoint
Extracting features for train set...
/home/conradb/git/ifg-ssl/dino/knn_evaluation.py:39: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(labels).long()
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0627,  0.1351,  0.0563,  ...,  0.0151,  0.0798,  0.0636],
        [-0.0374,  0.0854,  0.0619,  ..., -0.0248,  0.0285,  0.0873],
        [-0.0337,  0.1151,  0.0369,  ...,  0.0943,  0.1412,  0.0641],
        ...,
        [-0.0156,  0.1151,  0.0448,  ...,  0.0435,  0.0927,  0.1110],
        [-0.0701,  0.1126,  0.0272,  ...,  0.0168,  0.0542,  0.1249],
        [-0.0521,  0.1232,  0.0632,  ...,  0.0250,  0.0241,  0.1085]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9811, 0.9784, 0.9715,  ..., 0.9611, 0.9609, 0.9606],
        [0.9914, 0.9867, 0.9863,  ..., 0.9807, 0.9803, 0.9791],
        [0.9947, 0.9940, 0.9928,  ..., 0.9874, 0.9867, 0.9856],
        ...,
        [0.9742, 0.9738, 0.9723,  ..., 0.9661, 0.9660, 0.9660],
        [0.9837, 0.9821, 0.9813,  ..., 0.9781, 0.9781, 0.9780],
        [0.9772, 0.9769, 0.9755,  ..., 0.9694, 0.9692, 0.9690]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[1222492.3750, 1175638.1250, 1064370.7500,  ...,  917668.4375,
          915834.1250,  911846.1250],
        [1416030.7500, 1323751.8750, 1315904.0000,  ..., 1213957.8750,
         1207381.3750, 1186725.7500],
        [1483258.8750, 1468197.2500, 1444203.1250,  ..., 1336118.0000,
         1324134.5000, 1301859.0000],
        ...,
        [1107102.0000, 1100749.5000, 1077010.7500,  ...,  986543.6250,
          985228.2500,  984807.4375],
        [1267383.8750, 1239901.3750, 1225097.2500,  ..., 1170833.6250,
         1170532.1250, 1169294.7500],
        [1155028.6250, 1151040.3750, 1127210.8750,  ..., 1033244.2500,
         1030459.3125, 1027314.5000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[1222492.3750,       0.0000],
         [1175638.1250,       0.0000],
         [1064370.7500,       0.0000],
         ...,
         [ 917668.4375,       0.0000],
         [ 915834.1250,       0.0000],
         [ 911846.1250,       0.0000]],

        [[1416030.7500,       0.0000],
         [1323751.8750,       0.0000],
         [      0.0000, 1315904.0000],
         ...,
         [1213957.8750,       0.0000],
         [1207381.3750,       0.0000],
         [1186725.7500,       0.0000]],

        [[1483258.8750,       0.0000],
         [1468197.2500,       0.0000],
         [1444203.1250,       0.0000],
         ...,
         [1336118.0000,       0.0000],
         [1324134.5000,       0.0000],
         [1301859.0000,       0.0000]],

        ...,

        [[1107102.0000,       0.0000],
         [1100749.5000,       0.0000],
         [1077010.7500,       0.0000],
         ...,
         [ 986543.6250,       0.0000],
         [ 985228.2500,       0.0000],
         [ 984807.4375,       0.0000]],

        [[1267383.8750,       0.0000],
         [1239901.3750,       0.0000],
         [1225097.2500,       0.0000],
         ...,
         [1170833.6250,       0.0000],
         [1170532.1250,       0.0000],
         [1169294.7500,       0.0000]],

        [[1155028.6250,       0.0000],
         [1151040.3750,       0.0000],
         [1127210.8750,       0.0000],
         ...,
         [1033244.2500,       0.0000],
         [1030459.3125,       0.0000],
         [1027314.5000,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[19980472.0000,        0.0000],
        [22459006.0000,  2567816.7500],
        [26233466.0000,  1383195.3750],
        [22141162.0000,  2532983.0000],
        [20334068.0000,  3735936.5000],
        [29262414.0000,        0.0000],
        [28613740.0000,  1488148.3750],
        [27926788.0000,  1501055.0000],
        [24822964.0000,  1260046.8750],
        [19652902.0000,        0.0000],
        [22823120.0000,  2517473.5000],
        [27924476.0000,        0.0000],
        [23824370.0000,  1171046.8750],
        [23197458.0000,  2519158.7500],
        [23431310.0000,        0.0000],
        [24285980.0000,  1238934.5000],
        [26214708.0000,        0.0000],
        [24113768.0000,  2541839.0000],
        [25867732.0000,  2839059.0000],
        [21281064.0000,  2239558.0000],
        [25073766.0000,        0.0000],
        [25073596.0000,  2784119.5000],
        [20567716.0000,        0.0000],
        [22799376.0000,  1173798.5000],
        [24096416.0000,  1259131.6250],
        [22360854.0000,        0.0000],
        [23467126.0000,        0.0000],
        [22060684.0000,        0.0000],
        [22642782.0000,        0.0000],
        [21127382.0000,  1156072.2500],
        [24168838.0000,        0.0000],
        [22096596.0000,        0.0000],
        [23292078.0000,  1142483.7500],
        [25077438.0000,  1306160.5000],
        [20232408.0000,  3658853.5000],
        [25267262.0000,  1420338.3750],
        [26059248.0000,  1302090.0000],
        [24874368.0000,        0.0000],
        [22728204.0000,  1182573.8750],
        [25045412.0000,  1216603.8750],
        [21655660.0000,  2412112.5000],
        [24276314.0000,        0.0000],
        [21951956.0000,  2496390.7500],
        [22046122.0000,        0.0000],
        [21218020.0000,        0.0000],
        [21443848.0000,  1130629.2500],
        [22041930.0000,        0.0000],
        [23229954.0000,  2674842.0000],
        [20958618.0000,  3701973.5000],
        [27722022.0000,  1461497.2500],
        [24148592.0000,  2754658.5000],
        [22531386.0000,  2405059.5000],
        [23031324.0000,        0.0000],
        [22334604.0000,  1139801.2500],
        [25233540.0000,        0.0000],
        [19365468.0000,  1051564.2500],
        [22706060.0000,        0.0000],
        [23305128.0000,        0.0000],
        [21060938.0000,  1070040.7500],
        [23180540.0000,  1221767.3750],
        [26242904.0000,        0.0000],
        [19383216.0000,  1007586.6875],
        [23934564.0000,        0.0000],
        [21524844.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 1/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:52, 59.75s/it]  7%|▋         | 2/30 [01:00<11:38, 24.95s/it] 10%|█         | 3/30 [01:00<06:11, 13.76s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.50s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 8.165397787094117
Epoch 2/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:38, 59.25s/it]  7%|▋         | 2/30 [01:00<11:48, 25.31s/it] 10%|█         | 3/30 [01:01<06:16, 13.96s/it] 13%|█▎        | 4/30 [01:01<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.67s/it] 20%|██        | 6/30 [01:02<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 7.467891550064087
Epoch 3/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:46, 59.55s/it]  7%|▋         | 2/30 [01:00<11:34, 24.79s/it] 10%|█         | 3/30 [01:00<06:11, 13.75s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.50s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:01<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 7.280941963195801
Epoch 4/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:43, 57.36s/it]  7%|▋         | 2/30 [00:57<11:08, 23.88s/it] 10%|█         | 3/30 [00:59<06:12, 13.80s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.52s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.61s/it] 20%|██        | 6/30 [01:00<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 7.370309972763062
Epoch 5/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:48, 61.69s/it]  7%|▋         | 2/30 [01:02<11:58, 25.66s/it] 10%|█         | 3/30 [01:02<06:21, 14.14s/it] 13%|█▎        | 4/30 [01:03<03:47,  8.73s/it] 17%|█▋        | 5/30 [01:03<02:23,  5.74s/it] 20%|██        | 6/30 [01:03<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.05s/it] 30%|███       | 9/30 [01:05<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:06<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  2.00it/s] 60%|██████    | 18/30 [01:09<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:10<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.49s/it]
Epoch loss is 7.324561850229899
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0346,  0.1343,  0.0611,  ...,  0.0407,  0.0687,  0.0824],
        [-0.0070,  0.0959,  0.0806,  ..., -0.0109,  0.0126,  0.0994],
        [-0.0140,  0.1207,  0.0213,  ...,  0.1004,  0.1455,  0.0771],
        ...,
        [-0.0054,  0.1184,  0.0419,  ...,  0.0651,  0.0801,  0.1181],
        [-0.0434,  0.1165,  0.0311,  ...,  0.0453,  0.0456,  0.1291],
        [-0.0286,  0.1244,  0.0667,  ...,  0.0438,  0.0217,  0.1202]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9876, 0.9867, 0.9779,  ..., 0.9721, 0.9720, 0.9717],
        [0.9943, 0.9927, 0.9913,  ..., 0.9867, 0.9866, 0.9862],
        [0.9965, 0.9961, 0.9953,  ..., 0.9913, 0.9912, 0.9910],
        ...,
        [0.9844, 0.9836, 0.9821,  ..., 0.9789, 0.9789, 0.9788],
        [0.9895, 0.9888, 0.9888,  ..., 0.9860, 0.9858, 0.9858],
        [0.9865, 0.9850, 0.9843,  ..., 0.9809, 0.9806, 0.9804]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[1339707.2500, 1323504.5000, 1167106.8750,  ..., 1074530.1250,
         1072591.0000, 1068839.3750],
        [1474147.5000, 1441955.7500, 1412444.5000,  ..., 1323446.5000,
         1321379.3750, 1314073.1250],
        [1523181.7500, 1513096.2500, 1495589.5000,  ..., 1414278.8750,
         1410921.8750, 1407512.2500],
        ...,
        [1279963.0000, 1266261.5000, 1240050.3750,  ..., 1184121.0000,
         1183247.3750, 1182264.8750],
        [1377714.7500, 1364583.7500, 1363279.0000,  ..., 1310215.1250,
         1306153.0000, 1305688.5000],
        [1319829.1250, 1291804.1250, 1277901.6250,  ..., 1218579.0000,
         1212807.6250, 1209300.1250]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[1339707.2500,       0.0000],
         [1323504.5000,       0.0000],
         [1167106.8750,       0.0000],
         ...,
         [1074530.1250,       0.0000],
         [1072591.0000,       0.0000],
         [1068839.3750,       0.0000]],

        [[1474147.5000,       0.0000],
         [      0.0000, 1441955.7500],
         [1412444.5000,       0.0000],
         ...,
         [1323446.5000,       0.0000],
         [1321379.3750,       0.0000],
         [1314073.1250,       0.0000]],

        [[1523181.7500,       0.0000],
         [1513096.2500,       0.0000],
         [1495589.5000,       0.0000],
         ...,
         [1414278.8750,       0.0000],
         [1410921.8750,       0.0000],
         [1407512.2500,       0.0000]],

        ...,

        [[1279963.0000,       0.0000],
         [1266261.5000,       0.0000],
         [1240050.3750,       0.0000],
         ...,
         [1184121.0000,       0.0000],
         [1183247.3750,       0.0000],
         [1182264.8750,       0.0000]],

        [[1377714.7500,       0.0000],
         [1364583.7500,       0.0000],
         [1363279.0000,       0.0000],
         ...,
         [1310215.1250,       0.0000],
         [1306153.0000,       0.0000],
         [1305688.5000,       0.0000]],

        [[1319829.1250,       0.0000],
         [1291804.1250,       0.0000],
         [1277901.6250,       0.0000],
         ...,
         [1218579.0000,       0.0000],
         [1212807.6250,       0.0000],
         [1209300.1250,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[22615086.0000,        0.0000],
        [24567180.0000,  2767841.7500],
        [27509200.0000,  1459548.6250],
        [23975872.0000,  2723139.0000],
        [23627590.0000,  2760226.0000],
        [30100648.0000,        0.0000],
        [29174620.0000,  1522670.3750],
        [28705188.0000,  1541360.0000],
        [26268978.0000,  1332978.1250],
        [22458962.0000,        0.0000],
        [22939076.0000,  3999968.5000],
        [28830238.0000,        0.0000],
        [24322250.0000,  2518684.2500],
        [27836116.0000,        0.0000],
        [25119422.0000,  1279479.6250],
        [24992756.0000,  2716874.0000],
        [27794592.0000,        0.0000],
        [25621388.0000,  2755977.0000],
        [26673890.0000,  2948852.0000],
        [24786996.0000,  1338035.8750],
        [25510608.0000,  1309814.1250],
        [26006976.0000,  2916863.0000],
        [24422988.0000,        0.0000],
        [25235836.0000,  1324553.8750],
        [25708812.0000,  1357763.3750],
        [25694442.0000,        0.0000],
        [24995188.0000,  1284527.8750],
        [25349192.0000,        0.0000],
        [25730532.0000,        0.0000],
        [22845064.0000,  2553970.5000],
        [26346856.0000,        0.0000],
        [25488448.0000,        0.0000],
        [25398288.0000,  1262506.7500],
        [26743204.0000,  1410348.7500],
        [22165146.0000,  4018860.7500],
        [26872286.0000,  1487630.5000],
        [28863914.0000,        0.0000],
        [26613026.0000,        0.0000],
        [24861598.0000,  1272584.6250],
        [27687604.0000,        0.0000],
        [23851154.0000,  2676761.0000],
        [26655694.0000,        0.0000],
        [24016824.0000,  2677726.5000],
        [25450860.0000,        0.0000],
        [24586254.0000,        0.0000],
        [24224466.0000,  1257997.2500],
        [25416962.0000,        0.0000],
        [24801434.0000,  2824686.0000],
        [22897414.0000,  4068514.2500],
        [28516964.0000,  1478123.0000],
        [25301836.0000,  2859711.5000],
        [24360128.0000,  2669439.2500],
        [25975476.0000,        0.0000],
        [25973476.0000,        0.0000],
        [27454056.0000,        0.0000],
        [22782504.0000,  1160190.8750],
        [24414288.0000,  1263096.7500],
        [26217056.0000,        0.0000],
        [24052338.0000,  1244506.1250],
        [26731872.0000,        0.0000],
        [28006144.0000,        0.0000],
        [22970792.0000,  1201707.7500],
        [26593714.0000,        0.0000],
        [24937610.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 6/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:27, 56.82s/it]  7%|▋         | 2/30 [01:00<11:48, 25.32s/it] 10%|█         | 3/30 [01:00<06:16, 13.96s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.63s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.68s/it] 20%|██        | 6/30 [01:01<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 7.483589045206705
Epoch 7/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:25, 56.76s/it]  7%|▋         | 2/30 [01:00<11:56, 25.58s/it] 10%|█         | 3/30 [01:00<06:20, 14.10s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.71s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.73s/it] 20%|██        | 6/30 [01:02<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 7.517889753977458
Epoch 8/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:14, 56.37s/it]  7%|▋         | 2/30 [00:58<11:29, 24.61s/it] 10%|█         | 3/30 [00:59<06:06, 13.58s/it] 13%|█▎        | 4/30 [00:59<03:38,  8.39s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.53s/it] 20%|██        | 6/30 [01:00<01:31,  3.80s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:01<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 7.731361055374146
Epoch 9/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:02<30:08, 62.37s/it]  7%|▋         | 2/30 [01:02<12:06, 25.94s/it] 10%|█         | 3/30 [01:03<06:26, 14.30s/it] 13%|█▎        | 4/30 [01:03<03:49,  8.83s/it] 17%|█▋        | 5/30 [01:04<02:25,  5.80s/it] 20%|██        | 6/30 [01:04<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:05<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:05<00:45,  2.06s/it] 30%|███       | 9/30 [01:05<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:06<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:06<00:18,  1.02it/s] 40%|████      | 12/30 [01:07<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:07<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:08<00:09,  1.61it/s] 50%|█████     | 15/30 [01:08<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:09<00:06,  1.99it/s] 60%|██████    | 18/30 [01:09<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:10<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:10<00:04,  2.17it/s] 70%|███████   | 21/30 [01:11<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:11<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:12<00:03,  2.23it/s] 80%|████████  | 24/30 [01:12<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:13<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:14<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:14<00:00,  2.26it/s]100%|██████████| 30/30 [01:15<00:00,  2.26it/s]100%|██████████| 30/30 [01:15<00:00,  2.51s/it]
Epoch loss is 7.697088400522868
Epoch 10/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:43, 57.34s/it]  7%|▋         | 2/30 [00:57<11:08, 23.87s/it] 10%|█         | 3/30 [01:00<06:20, 14.07s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.69s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.72s/it] 20%|██        | 6/30 [01:01<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 7.8823723793029785
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0246,  0.1233,  0.0558,  ...,  0.0579,  0.0660,  0.0844],
        [ 0.0098,  0.0923,  0.0862,  ..., -0.0015,  0.0021,  0.1090],
        [-0.0042,  0.1138,  0.0089,  ...,  0.0959,  0.1543,  0.0737],
        ...,
        [-0.0097,  0.1065,  0.0274,  ...,  0.0821,  0.0712,  0.1138],
        [-0.0330,  0.1070,  0.0239,  ...,  0.0677,  0.0413,  0.1250],
        [-0.0188,  0.1115,  0.0585,  ...,  0.0579,  0.0206,  0.1252]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9896, 0.9895, 0.9826,  ..., 0.9737, 0.9736, 0.9732],
        [0.9956, 0.9947, 0.9946,  ..., 0.9905, 0.9904, 0.9903],
        [0.9975, 0.9974, 0.9973,  ..., 0.9926, 0.9924, 0.9923],
        ...,
        [0.9904, 0.9892, 0.9892,  ..., 0.9877, 0.9876, 0.9875],
        [0.9936, 0.9925, 0.9924,  ..., 0.9912, 0.9912, 0.9912],
        [0.9906, 0.9903, 0.9902,  ..., 0.9871, 0.9868, 0.9866]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[1378758.3750, 1377079.0000, 1248650.3750,  ..., 1098576.6250,
         1096834.6250, 1091507.6250],
        [1503741.6250, 1483635.1250, 1481029.6250,  ..., 1397763.3750,
         1395026.7500, 1393394.0000],
        [1544348.3750, 1541739.2500, 1540686.8750,  ..., 1439328.7500,
         1436104.0000, 1433727.0000],
        ...,
        [1395541.7500, 1372176.0000, 1371461.7500,  ..., 1342448.0000,
         1341273.2500, 1338697.0000],
        [1461114.0000, 1436749.2500, 1435093.6250,  ..., 1412243.8750,
         1412001.3750, 1411038.8750],
        [1398715.5000, 1392695.1250, 1390894.0000,  ..., 1330585.3750,
         1325936.5000, 1322304.7500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[1378758.3750,       0.0000],
         [1377079.0000,       0.0000],
         [1248650.3750,       0.0000],
         ...,
         [1098576.6250,       0.0000],
         [1096834.6250,       0.0000],
         [1091507.6250,       0.0000]],

        [[      0.0000, 1503741.6250],
         [1483635.1250,       0.0000],
         [1481029.6250,       0.0000],
         ...,
         [1397763.3750,       0.0000],
         [1395026.7500,       0.0000],
         [1393394.0000,       0.0000]],

        [[1544348.3750,       0.0000],
         [1541739.2500,       0.0000],
         [1540686.8750,       0.0000],
         ...,
         [1439328.7500,       0.0000],
         [1436104.0000,       0.0000],
         [1433727.0000,       0.0000]],

        ...,

        [[1395541.7500,       0.0000],
         [1372176.0000,       0.0000],
         [1371461.7500,       0.0000],
         ...,
         [1342448.0000,       0.0000],
         [1341273.2500,       0.0000],
         [1338697.0000,       0.0000]],

        [[1461114.0000,       0.0000],
         [1436749.2500,       0.0000],
         [1435093.6250,       0.0000],
         ...,
         [1412243.8750,       0.0000],
         [1412001.3750,       0.0000],
         [1411038.8750,       0.0000]],

        [[1398715.5000,       0.0000],
         [1392695.1250,       0.0000],
         [1390894.0000,       0.0000],
         ...,
         [1330585.3750,       0.0000],
         [1325936.5000,       0.0000],
         [1322304.7500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[23083780.0000,        0.0000],
        [27233932.0000,  1503741.6250],
        [28186140.0000,  1505057.1250],
        [25202952.0000,  2820026.0000],
        [25155132.0000,  2867806.2500],
        [30726608.0000,        0.0000],
        [29573296.0000,  1548578.0000],
        [29278850.0000,  1568189.6250],
        [28311672.0000,        0.0000],
        [23160980.0000,        0.0000],
        [21969316.0000,  5538427.5000],
        [29452960.0000,        0.0000],
        [25206394.0000,  2692657.0000],
        [29096056.0000,        0.0000],
        [28139438.0000,        0.0000],
        [24771242.0000,  4346497.0000],
        [28343648.0000,        0.0000],
        [24966268.0000,  4284183.0000],
        [25700722.0000,  4524638.0000],
        [25919820.0000,  1444238.8750],
        [26255336.0000,  1372316.1250],
        [22250164.0000,  7391442.0000],
        [27247870.0000,        0.0000],
        [25477620.0000,  2797054.0000],
        [26222188.0000,  1360790.2500],
        [27881808.0000,        0.0000],
        [26781108.0000,  1395618.8750],
        [27631478.0000,        0.0000],
        [27589686.0000,        0.0000],
        [25991312.0000,  1400226.3750],
        [28037184.0000,        0.0000],
        [27703288.0000,        0.0000],
        [26720056.0000,  1405120.8750],
        [26197656.0000,  2860458.2500],
        [23264574.0000,  4244730.0000],
        [27734292.0000,  1528921.6250],
        [29665326.0000,        0.0000],
        [27172190.0000,        0.0000],
        [27344568.0000,        0.0000],
        [27095000.0000,  1352552.6250],
        [23839460.0000,  4196393.0000],
        [28049918.0000,        0.0000],
        [26824250.0000,  1395331.3750],
        [27659622.0000,        0.0000],
        [25615098.0000,  1345658.8750],
        [27214512.0000,        0.0000],
        [27946526.0000,        0.0000],
        [25150430.0000,  2875321.5000],
        [25299898.0000,  2897098.0000],
        [30590804.0000,        0.0000],
        [24275460.0000,  4291506.0000],
        [24124528.0000,  4269319.5000],
        [26680438.0000,  1388593.1250],
        [27887548.0000,        0.0000],
        [27219504.0000,  1444175.5000],
        [26524944.0000,        0.0000],
        [26568538.0000,  1398274.0000],
        [28397834.0000,        0.0000],
        [27631162.0000,        0.0000],
        [28442072.0000,        0.0000],
        [29464578.0000,        0.0000],
        [27073200.0000,        0.0000],
        [28446182.0000,        0.0000],
        [27233752.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 11/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:52, 59.73s/it]  7%|▋         | 2/30 [01:00<11:35, 24.85s/it] 10%|█         | 3/30 [01:01<06:17, 13.98s/it] 13%|█▎        | 4/30 [01:01<03:44,  8.63s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.68s/it] 20%|██        | 6/30 [01:02<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 8.000360918045043
Epoch 12/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:01, 55.93s/it]  7%|▋         | 2/30 [00:56<10:52, 23.29s/it] 10%|█         | 3/30 [00:59<06:18, 14.02s/it] 13%|█▎        | 4/30 [00:59<03:45,  8.66s/it] 17%|█▋        | 5/30 [01:00<02:25,  5.80s/it] 20%|██        | 6/30 [01:00<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.07s/it] 30%|███       | 9/30 [01:02<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 7.9998968283335365
Epoch 13/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:12, 56.28s/it]  7%|▋         | 2/30 [00:56<10:56, 23.43s/it] 10%|█         | 3/30 [00:57<05:49, 12.94s/it] 13%|█▎        | 4/30 [01:00<03:55,  9.05s/it] 17%|█▋        | 5/30 [01:01<02:33,  6.13s/it] 20%|██        | 6/30 [01:01<01:40,  4.20s/it] 23%|██▎       | 7/30 [01:02<01:08,  2.97s/it] 27%|██▋       | 8/30 [01:02<00:47,  2.16s/it] 30%|███       | 9/30 [01:02<00:34,  1.63s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.01s/it] 40%|████      | 12/30 [01:04<00:15,  1.20it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.58it/s] 50%|█████     | 15/30 [01:05<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.97it/s] 60%|██████    | 18/30 [01:06<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 8.123206345240275
Epoch 14/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:33, 57.02s/it]  7%|▋         | 2/30 [00:57<11:04, 23.74s/it] 10%|█         | 3/30 [00:58<05:57, 13.23s/it] 13%|█▎        | 4/30 [00:59<03:40,  8.48s/it] 17%|█▋        | 5/30 [00:59<02:19,  5.58s/it] 20%|██        | 6/30 [01:00<01:32,  3.83s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:01<00:43,  2.00s/it] 30%|███       | 9/30 [01:01<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 8.159585825602214
Epoch 15/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:01, 55.92s/it]  7%|▋         | 2/30 [00:59<11:51, 25.41s/it] 10%|█         | 3/30 [01:00<06:19, 14.05s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.71s/it] 20%|██        | 6/30 [01:01<01:33,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 8.122545178731283
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0253,  0.1121,  0.0469,  ...,  0.0648,  0.0739,  0.0786],
        [ 0.0207,  0.0824,  0.0871,  ..., -0.0038, -0.0052,  0.1130],
        [-0.0006,  0.1023, -0.0017,  ...,  0.0865,  0.1629,  0.0635],
        ...,
        [-0.0241,  0.0904,  0.0065,  ...,  0.0944,  0.0707,  0.0983],
        [-0.0355,  0.0939,  0.0095,  ...,  0.0826,  0.0431,  0.1131],
        [-0.0176,  0.0942,  0.0448,  ...,  0.0655,  0.0206,  0.1218]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9876, 0.9865, 0.9817,  ..., 0.9637, 0.9634, 0.9630],
        [0.9963, 0.9961, 0.9954,  ..., 0.9912, 0.9911, 0.9910],
        [0.9984, 0.9981, 0.9979,  ..., 0.9928, 0.9926, 0.9925],
        ...,
        [0.9935, 0.9926, 0.9925,  ..., 0.9919, 0.9918, 0.9918],
        [0.9954, 0.9943, 0.9943,  ..., 0.9936, 0.9936, 0.9936],
        [0.9935, 0.9931, 0.9929,  ..., 0.9903, 0.9903, 0.9899]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 1, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [0., 1.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[1340031.7500, 1319688.1250, 1232554.1250,  ...,  952503.9375,
          948971.4375,  942806.6875],
        [1518799.6250, 1513818.0000, 1499002.1250,  ..., 1410342.0000,
         1409430.3750, 1406500.5000],
        [1564255.2500, 1557226.8750, 1553251.8750,  ..., 1443953.8750,
         1438995.3750, 1438254.3750],
        ...,
        [1459441.5000, 1439327.5000, 1438253.1250,  ..., 1424849.3750,
         1423788.5000, 1423694.8750],
        [1499100.8750, 1475514.6250, 1474320.3750,  ..., 1461314.7500,
         1460402.1250, 1460136.1250],
        [1458277.0000, 1450367.2500, 1446022.3750,  ..., 1392910.3750,
         1392875.7500, 1386029.2500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[1340031.7500,       0.0000],
         [1319688.1250,       0.0000],
         [1232554.1250,       0.0000],
         ...,
         [ 952503.9375,       0.0000],
         [ 948971.4375,       0.0000],
         [ 942806.6875,       0.0000]],

        [[1518799.6250,       0.0000],
         [1513818.0000,       0.0000],
         [1499002.1250,       0.0000],
         ...,
         [1410342.0000,       0.0000],
         [1409430.3750,       0.0000],
         [1406500.5000,       0.0000]],

        [[1564255.2500,       0.0000],
         [1557226.8750,       0.0000],
         [1553251.8750,       0.0000],
         ...,
         [1443953.8750,       0.0000],
         [1438995.3750,       0.0000],
         [1438254.3750,       0.0000]],

        ...,

        [[1459441.5000,       0.0000],
         [1439327.5000,       0.0000],
         [1438253.1250,       0.0000],
         ...,
         [1424849.3750,       0.0000],
         [1423788.5000,       0.0000],
         [1423694.8750,       0.0000]],

        [[1499100.8750,       0.0000],
         [1475514.6250,       0.0000],
         [1474320.3750,       0.0000],
         ...,
         [1461314.7500,       0.0000],
         [1460402.1250,       0.0000],
         [1460136.1250,       0.0000]],

        [[1458277.0000,       0.0000],
         [1450367.2500,       0.0000],
         [1446022.3750,       0.0000],
         ...,
         [      0.0000, 1392910.3750],
         [1392875.7500,       0.0000],
         [1386029.2500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[21499584.0000,        0.0000],
        [27600540.0000,  1485914.8750],
        [28399796.0000,  1522396.0000],
        [27120736.0000,  1464314.0000],
        [25702144.0000,  2896692.0000],
        [30988360.0000,        0.0000],
        [29774474.0000,  1564347.7500],
        [29551294.0000,  1579579.0000],
        [27132552.0000,  1388116.5000],
        [22333848.0000,        0.0000],
        [21743200.0000,  5644534.0000],
        [29847852.0000,        0.0000],
        [26976402.0000,  1450533.2500],
        [27902748.0000,  1419283.5000],
        [28767712.0000,        0.0000],
        [25142232.0000,  4431795.0000],
        [26996188.0000,  1360473.6250],
        [25074468.0000,  4320367.0000],
        [25974534.0000,  4575478.0000],
        [25873832.0000,  1482391.8750],
        [25747802.0000,  1309474.3750],
        [20963768.0000,  9003251.0000],
        [27092040.0000,  1418247.1250],
        [27547176.0000,  1437360.3750],
        [27376124.0000,        0.0000],
        [27463042.0000,  1451964.3750],
        [29160388.0000,        0.0000],
        [28687034.0000,        0.0000],
        [28818100.0000,        0.0000],
        [26745984.0000,  1416429.1250],
        [28971682.0000,        0.0000],
        [28778636.0000,        0.0000],
        [27092268.0000,  1472308.3750],
        [24919346.0000,  4257901.5000],
        [24675618.0000,  2949259.0000],
        [26333588.0000,  2979837.5000],
        [29998040.0000,        0.0000],
        [26635800.0000,        0.0000],
        [27533168.0000,        0.0000],
        [27170796.0000,  1367183.6250],
        [27363264.0000,  1435831.5000],
        [27351004.0000,  1421506.3750],
        [27427772.0000,  1427185.7500],
        [28557782.0000,        0.0000],
        [26731514.0000,  1415882.2500],
        [27713782.0000,        0.0000],
        [29126278.0000,        0.0000],
        [22881928.0000,  4110893.5000],
        [24363250.0000,  4297056.0000],
        [30853608.0000,        0.0000],
        [24075698.0000,  4263297.0000],
        [26202704.0000,  2956062.2500],
        [27602698.0000,  1450794.7500],
        [28860782.0000,        0.0000],
        [26242024.0000,  2919556.0000],
        [27813400.0000,        0.0000],
        [27662802.0000,  1462617.0000],
        [29559888.0000,        0.0000],
        [28679896.0000,        0.0000],
        [26297876.0000,  2924647.0000],
        [30224380.0000,        0.0000],
        [28628832.0000,        0.0000],
        [27917768.0000,  1468466.1250],
        [26988972.0000,  1392910.3750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 16/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:09, 56.21s/it]  7%|▋         | 2/30 [00:59<11:43, 25.12s/it] 10%|█         | 3/30 [01:00<06:22, 14.17s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.75s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.75s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 8.072953271865845
Epoch 17/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:01, 55.90s/it]  7%|▋         | 2/30 [00:58<11:19, 24.28s/it] 10%|█         | 3/30 [01:00<06:25, 14.28s/it] 13%|█▎        | 4/30 [01:00<03:49,  8.82s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.80s/it] 20%|██        | 6/30 [01:01<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 7.964429903030395
Epoch 18/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:58, 55.81s/it]  7%|▋         | 2/30 [00:58<11:21, 24.35s/it] 10%|█         | 3/30 [00:58<06:02, 13.44s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.31s/it] 17%|█▋        | 5/30 [00:59<02:16,  5.47s/it] 20%|██        | 6/30 [00:59<01:30,  3.76s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.68s/it] 27%|██▋       | 8/30 [01:00<00:43,  1.96s/it] 30%|███       | 9/30 [01:01<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:03<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 7.957654078801473
Epoch 19/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:12, 58.35s/it]  7%|▋         | 2/30 [00:59<11:38, 24.94s/it] 10%|█         | 3/30 [01:00<06:11, 13.75s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.50s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:01<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 7.907173347473145
Epoch 20/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:33, 61.15s/it]  7%|▋         | 2/30 [01:02<11:59, 25.69s/it] 10%|█         | 3/30 [01:02<06:22, 14.16s/it] 13%|█▎        | 4/30 [01:02<03:47,  8.75s/it] 17%|█▋        | 5/30 [01:03<02:23,  5.75s/it] 20%|██        | 6/30 [01:03<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:04<00:45,  2.05s/it] 30%|███       | 9/30 [01:05<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:09<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.49s/it]
Epoch loss is 7.7492385069529215
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0287,  0.1026,  0.0426,  ...,  0.0618,  0.0869,  0.0747],
        [ 0.0308,  0.0722,  0.0909,  ..., -0.0159, -0.0104,  0.1170],
        [ 0.0019,  0.0880, -0.0073,  ...,  0.0750,  0.1662,  0.0570],
        ...,
        [-0.0426,  0.0730, -0.0104,  ...,  0.1009,  0.0742,  0.0811],
        [-0.0434,  0.0790, -0.0020,  ...,  0.0899,  0.0474,  0.1017],
        [-0.0184,  0.0758,  0.0356,  ...,  0.0658,  0.0198,  0.1181]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9801, 0.9791, 0.9781,  ..., 0.9461, 0.9457, 0.9457],
        [0.9966, 0.9966, 0.9956,  ..., 0.9906, 0.9905, 0.9902],
        [0.9988, 0.9986, 0.9979,  ..., 0.9916, 0.9915, 0.9905],
        ...,
        [0.9950, 0.9946, 0.9944,  ..., 0.9939, 0.9938, 0.9938],
        [0.9957, 0.9957, 0.9956,  ..., 0.9941, 0.9941, 0.9940],
        [0.9945, 0.9943, 0.9942,  ..., 0.9915, 0.9913, 0.9910]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        [0, 0, 0,  ..., 0, 1, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [0., 1.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[1203689.7500, 1187525.0000, 1170804.5000,  ...,  741438.0625,
          737090.2500,  736578.0000],
        [1525173.1250, 1523822.5000, 1503879.2500,  ..., 1400150.2500,
         1396965.2500, 1391310.5000],
        [1572589.6250, 1568600.8750, 1553534.8750,  ..., 1419888.6250,
         1416483.2500, 1397151.6250],
        ...,
        [1489162.1250, 1481394.1250, 1476297.2500,  ..., 1465814.6250,
         1465494.5000, 1465224.8750],
        [1505842.6250, 1505496.5000, 1502018.7500,  ..., 1470848.7500,
         1470670.6250, 1469701.8750],
        [1479205.8750, 1474716.8750, 1473411.0000,  ..., 1417730.6250,
         1413314.8750, 1407952.5000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[1203689.7500,       0.0000],
         [1187525.0000,       0.0000],
         [1170804.5000,       0.0000],
         ...,
         [ 741438.0625,       0.0000],
         [ 737090.2500,       0.0000],
         [ 736578.0000,       0.0000]],

        [[1525173.1250,       0.0000],
         [1523822.5000,       0.0000],
         [1503879.2500,       0.0000],
         ...,
         [1400150.2500,       0.0000],
         [1396965.2500,       0.0000],
         [      0.0000, 1391310.5000]],

        [[1572589.6250,       0.0000],
         [1568600.8750,       0.0000],
         [1553534.8750,       0.0000],
         ...,
         [1419888.6250,       0.0000],
         [      0.0000, 1416483.2500],
         [1397151.6250,       0.0000]],

        ...,

        [[1489162.1250,       0.0000],
         [1481394.1250,       0.0000],
         [1476297.2500,       0.0000],
         ...,
         [1465814.6250,       0.0000],
         [1465494.5000,       0.0000],
         [1465224.8750,       0.0000]],

        [[1505842.6250,       0.0000],
         [1505496.5000,       0.0000],
         [1502018.7500,       0.0000],
         ...,
         [1470848.7500,       0.0000],
         [1470670.6250,       0.0000],
         [1469701.8750,       0.0000]],

        [[1479205.8750,       0.0000],
         [1474716.8750,       0.0000],
         [1473411.0000,       0.0000],
         ...,
         [1417730.6250,       0.0000],
         [      0.0000, 1413314.8750],
         [1407952.5000,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[17899314.0000,        0.0000],
        [27503852.0000,  1391310.5000],
        [26904962.0000,  2937126.5000],
        [27187410.0000,  1448848.0000],
        [25748236.0000,  2870315.5000],
        [30971396.0000,        0.0000],
        [29832628.0000,  1573212.1250],
        [29695148.0000,  1583070.1250],
        [27110426.0000,  1418201.1250],
        [20075612.0000,        0.0000],
        [22613788.0000,  4317523.0000],
        [30036060.0000,        0.0000],
        [27057074.0000,  1458770.8750],
        [29064294.0000,        0.0000],
        [28723352.0000,        0.0000],
        [26557678.0000,  2938053.2500],
        [26588156.0000,  1359338.8750],
        [26339424.0000,  2848837.5000],
        [24549712.0000,  6086131.0000],
        [23896168.0000,  2736367.0000],
        [24213218.0000,  1155279.8750],
        [21045072.0000,  9050580.0000],
        [27575496.0000,  1449660.6250],
        [27533460.0000,  1409003.0000],
        [26884590.0000,        0.0000],
        [27905954.0000,  1487860.3750],
        [29560514.0000,        0.0000],
        [28901192.0000,        0.0000],
        [29452958.0000,        0.0000],
        [26826168.0000,  1381160.1250],
        [29274976.0000,        0.0000],
        [29062284.0000,        0.0000],
        [25559226.0000,  2842775.0000],
        [27434876.0000,  1423772.1250],
        [24146128.0000,  2930078.0000],
        [24694944.0000,  4408969.5000],
        [28550084.0000,  1453911.1250],
        [25345952.0000,        0.0000],
        [26003194.0000,  1235193.5000],
        [27054928.0000,  1372490.1250],
        [28863404.0000,        0.0000],
        [27422042.0000,  1471560.2500],
        [27524080.0000,  1416090.1250],
        [27239114.0000,  1394071.7500],
        [27194220.0000,  1437852.6250],
        [27383756.0000,        0.0000],
        [29558132.0000,        0.0000],
        [21145272.0000,  3892248.7500],
        [25609372.0000,  2927992.2500],
        [29360520.0000,  1525238.5000],
        [22185106.0000,  5513120.0000],
        [26465874.0000,  2977361.2500],
        [29416390.0000,        0.0000],
        [29172556.0000,        0.0000],
        [26013224.0000,  2934484.0000],
        [28064442.0000,        0.0000],
        [29603496.0000,        0.0000],
        [30068024.0000,        0.0000],
        [27328328.0000,  1448738.8750],
        [26415894.0000,  2986117.2500],
        [28994552.0000,  1512652.0000],
        [29418270.0000,        0.0000],
        [28192808.0000,  1499654.2500],
        [27487100.0000,  1413314.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 21/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:08, 56.14s/it]  7%|▋         | 2/30 [00:56<10:59, 23.54s/it] 10%|█         | 3/30 [00:59<06:23, 14.19s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.77s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.77s/it] 20%|██        | 6/30 [01:01<01:34,  3.96s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 7.738105805714925
Epoch 22/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:32, 56.97s/it]  7%|▋         | 2/30 [00:57<11:04, 23.72s/it] 10%|█         | 3/30 [01:00<06:30, 14.45s/it] 13%|█▎        | 4/30 [01:01<03:51,  8.92s/it] 17%|█▋        | 5/30 [01:01<02:26,  5.86s/it] 20%|██        | 6/30 [01:02<01:36,  4.02s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.08s/it] 30%|███       | 9/30 [01:03<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 7.596311044692993
Epoch 23/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:22, 56.65s/it]  7%|▋         | 2/30 [00:57<11:00, 23.59s/it] 10%|█         | 3/30 [00:58<06:06, 13.58s/it] 13%|█▎        | 4/30 [00:59<03:38,  8.39s/it] 17%|█▋        | 5/30 [00:59<02:18,  5.53s/it] 20%|██        | 6/30 [01:00<01:31,  3.80s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:00<00:43,  1.98s/it] 30%|███       | 9/30 [01:01<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.01it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 7.53544511795044
Epoch 24/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:04, 56.00s/it]  7%|▋         | 2/30 [00:58<11:24, 24.45s/it] 10%|█         | 3/30 [01:00<06:25, 14.29s/it] 13%|█▎        | 4/30 [01:01<03:49,  8.82s/it] 17%|█▋        | 5/30 [01:01<02:25,  5.80s/it] 20%|██        | 6/30 [01:01<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 7.489171775182088
Epoch 25/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:43, 57.37s/it]  7%|▋         | 2/30 [00:57<11:08, 23.89s/it] 10%|█         | 3/30 [00:58<05:55, 13.18s/it] 13%|█▎        | 4/30 [00:59<03:37,  8.35s/it] 17%|█▋        | 5/30 [00:59<02:19,  5.58s/it] 20%|██        | 6/30 [01:00<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:01<00:43,  2.00s/it] 30%|███       | 9/30 [01:01<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 7.377186330159505
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0312,  0.0904,  0.0437,  ...,  0.0548,  0.1016,  0.0756],
        [ 0.0411,  0.0613,  0.0960,  ..., -0.0298, -0.0150,  0.1221],
        [ 0.0065,  0.0719, -0.0079,  ...,  0.0615,  0.1639,  0.0564],
        ...,
        [-0.0614,  0.0571, -0.0223,  ...,  0.1049,  0.0778,  0.0659],
        [-0.0518,  0.0651, -0.0093,  ...,  0.0940,  0.0510,  0.0935],
        [-0.0175,  0.0587,  0.0314,  ...,  0.0630,  0.0167,  0.1163]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9700, 0.9665, 0.9643,  ..., 0.9214, 0.9212, 0.9189],
        [0.9961, 0.9956, 0.9950,  ..., 0.9883, 0.9879, 0.9879],
        [0.9989, 0.9987, 0.9976,  ..., 0.9900, 0.9899, 0.9898],
        ...,
        [0.9958, 0.9954, 0.9953,  ..., 0.9947, 0.9947, 0.9947],
        [0.9961, 0.9961, 0.9960,  ..., 0.9942, 0.9942, 0.9942],
        [0.9952, 0.9950, 0.9945,  ..., 0.9918, 0.9915, 0.9915]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 1, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[1043226.7500,  991739.4375,  960329.8125,  ...,  520804.8750,
          519041.1875,  502319.3125],
        [1513529.2500, 1501954.2500, 1490381.1250,  ..., 1353458.3750,
         1347234.3750, 1346434.2500],
        [1575186.3750, 1570478.0000, 1546910.1250,  ..., 1387686.3750,
         1385586.3750, 1383363.0000],
        ...,
        [1508160.7500, 1497483.2500, 1495586.6250,  ..., 1483284.2500,
         1483246.1250, 1482609.6250],
        [1512927.5000, 1512551.0000, 1512364.8750,  ..., 1473413.7500,
         1472722.6250, 1472075.2500],
        [1495255.7500, 1488943.3750, 1479515.0000,  ..., 1424428.1250,
         1418203.8750, 1417948.2500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[1043226.7500,       0.0000],
         [ 991739.4375,       0.0000],
         [ 960329.8125,       0.0000],
         ...,
         [ 520804.8750,       0.0000],
         [ 519041.1875,       0.0000],
         [ 502319.3125,       0.0000]],

        [[1513529.2500,       0.0000],
         [1501954.2500,       0.0000],
         [1490381.1250,       0.0000],
         ...,
         [1353458.3750,       0.0000],
         [1347234.3750,       0.0000],
         [1346434.2500,       0.0000]],

        [[1575186.3750,       0.0000],
         [1570478.0000,       0.0000],
         [1546910.1250,       0.0000],
         ...,
         [      0.0000, 1387686.3750],
         [1385586.3750,       0.0000],
         [1383363.0000,       0.0000]],

        ...,

        [[1508160.7500,       0.0000],
         [1497483.2500,       0.0000],
         [1495586.6250,       0.0000],
         ...,
         [1483284.2500,       0.0000],
         [1483246.1250,       0.0000],
         [1482609.6250,       0.0000]],

        [[1512927.5000,       0.0000],
         [1512551.0000,       0.0000],
         [1512364.8750,       0.0000],
         ...,
         [1473413.7500,       0.0000],
         [1472722.6250,       0.0000],
         [1472075.2500,       0.0000]],

        [[1495255.7500,       0.0000],
         [1488943.3750,       0.0000],
         [1479515.0000,       0.0000],
         ...,
         [1424428.1250,       0.0000],
         [1418203.8750,       0.0000],
         [1417948.2500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[13548328.0000,        0.0000],
        [28451696.0000,        0.0000],
        [26694424.0000,  2894469.7500],
        [26912976.0000,  1426004.7500],
        [25522668.0000,  2819570.0000],
        [30784446.0000,        0.0000],
        [29827576.0000,  1578458.5000],
        [29753104.0000,  1583067.1250],
        [26901266.0000,  1419194.2500],
        [17852256.0000,        0.0000],
        [22147898.0000,  4216098.5000],
        [30120116.0000,        0.0000],
        [26690844.0000,  1446423.7500],
        [28535480.0000,        0.0000],
        [28134600.0000,        0.0000],
        [24636932.0000,  4296144.0000],
        [24836614.0000,  2640496.2500],
        [27425402.0000,  1405779.0000],
        [24500062.0000,  6078037.5000],
        [22900432.0000,  2619809.5000],
        [23975320.0000,        0.0000],
        [21061180.0000,  9013010.0000],
        [27620808.0000,  1453320.6250],
        [28253636.0000,        0.0000],
        [26162020.0000,        0.0000],
        [26675828.0000,  2946472.5000],
        [28110386.0000,  1476547.8750],
        [28622400.0000,        0.0000],
        [29721436.0000,        0.0000],
        [26348920.0000,  1342044.8750],
        [29193312.0000,        0.0000],
        [29095572.0000,        0.0000],
        [25022742.0000,  2790640.5000],
        [26775396.0000,  1397083.7500],
        [23343182.0000,  2848497.0000],
        [24596776.0000,  4412023.0000],
        [28358782.0000,  1467759.1250],
        [24147712.0000,        0.0000],
        [25377062.0000,  1178209.5000],
        [26761762.0000,  1380575.5000],
        [28539332.0000,        0.0000],
        [27092264.0000,  1489960.3750],
        [26003704.0000,  2731618.0000],
        [26857750.0000,  1417154.7500],
        [28968014.0000,        0.0000],
        [26699784.0000,        0.0000],
        [28266900.0000,  1494578.6250],
        [19242772.0000,  3585344.0000],
        [25372186.0000,  2901819.7500],
        [27745064.0000,  3049082.0000],
        [21558406.0000,  5362831.0000],
        [26329052.0000,  2934316.0000],
        [27950314.0000,  1437907.3750],
        [28854522.0000,        0.0000],
        [25346126.0000,  2899283.5000],
        [27780498.0000,        0.0000],
        [29856896.0000,        0.0000],
        [30260092.0000,        0.0000],
        [26682014.0000,  1464660.5000],
        [26249252.0000,  2989090.0000],
        [28965456.0000,  1518912.6250],
        [29774482.0000,        0.0000],
        [28304720.0000,  1511590.6250],
        [29058042.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 26/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:48, 57.55s/it]  7%|▋         | 2/30 [00:57<11:10, 23.96s/it] 10%|█         | 3/30 [01:00<06:19, 14.06s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.71s/it] 20%|██        | 6/30 [01:01<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 7.332304048538208
Epoch 27/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:04, 56.03s/it]  7%|▋         | 2/30 [00:56<10:53, 23.33s/it] 10%|█         | 3/30 [00:59<06:15, 13.89s/it] 13%|█▎        | 4/30 [01:00<03:50,  8.86s/it] 17%|█▋        | 5/30 [01:00<02:25,  5.83s/it] 20%|██        | 6/30 [01:01<01:35,  3.99s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.83s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.07s/it] 30%|███       | 9/30 [01:02<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 7.241346422831217
Epoch 28/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:03, 55.99s/it]  7%|▋         | 2/30 [00:57<11:09, 23.92s/it] 10%|█         | 3/30 [00:57<05:56, 13.20s/it] 13%|█▎        | 4/30 [00:58<03:32,  8.16s/it] 17%|█▋        | 5/30 [00:58<02:14,  5.38s/it] 20%|██        | 6/30 [01:00<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:00<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.08s/it] 30%|███       | 9/30 [01:01<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:01<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.02it/s] 40%|████      | 12/30 [01:02<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:04<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 7.15203529993693
Epoch 29/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:48, 55.45s/it]  7%|▋         | 2/30 [00:56<10:52, 23.30s/it] 10%|█         | 3/30 [00:56<05:47, 12.86s/it] 13%|█▎        | 4/30 [00:57<03:26,  7.96s/it] 17%|█▋        | 5/30 [00:58<02:17,  5.49s/it] 20%|██        | 6/30 [00:58<01:30,  3.78s/it] 23%|██▎       | 7/30 [00:59<01:01,  2.69s/it] 27%|██▋       | 8/30 [00:59<00:43,  1.97s/it] 30%|███       | 9/30 [01:00<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:00<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:00<00:17,  1.06it/s] 40%|████      | 12/30 [01:01<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:01<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:02<00:09,  1.62it/s] 50%|█████     | 15/30 [01:02<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:03<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:03<00:06,  2.00it/s] 60%|██████    | 18/30 [01:04<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:04<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:04<00:04,  2.17it/s] 70%|███████   | 21/30 [01:05<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:05<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:06<00:03,  2.24it/s] 80%|████████  | 24/30 [01:06<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:07<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:07<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:08<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:08<00:00,  2.27it/s]100%|██████████| 30/30 [01:09<00:00,  2.27it/s]100%|██████████| 30/30 [01:09<00:00,  2.32s/it]
Epoch loss is 7.118505016962687
Epoch 30/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:24, 56.70s/it]  7%|▋         | 2/30 [00:57<11:01, 23.61s/it] 10%|█         | 3/30 [01:00<06:26, 14.31s/it] 13%|█▎        | 4/30 [01:00<03:49,  8.84s/it] 17%|█▋        | 5/30 [01:01<02:25,  5.81s/it] 20%|██        | 6/30 [01:01<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.07s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 7.016354386011759
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0356,  0.0697,  0.0480,  ...,  0.0500,  0.1163,  0.0799],
        [ 0.0484,  0.0487,  0.1011,  ..., -0.0381, -0.0183,  0.1310],
        [ 0.0101,  0.0549, -0.0075,  ...,  0.0503,  0.1585,  0.0583],
        ...,
        [-0.0798,  0.0412, -0.0283,  ...,  0.1067,  0.0845,  0.0558],
        [-0.0604,  0.0510, -0.0118,  ...,  0.0966,  0.0570,  0.0909],
        [-0.0153,  0.0420,  0.0325,  ...,  0.0595,  0.0151,  0.1193]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9607, 0.9510, 0.9496,  ..., 0.8938, 0.8936, 0.8927],
        [0.9948, 0.9941, 0.9940,  ..., 0.9876, 0.9866, 0.9865],
        [0.9990, 0.9982, 0.9972,  ..., 0.9889, 0.9887, 0.9885],
        ...,
        [0.9964, 0.9961, 0.9959,  ..., 0.9951, 0.9951, 0.9951],
        [0.9967, 0.9961, 0.9960,  ..., 0.9941, 0.9940, 0.9935],
        [0.9954, 0.9953, 0.9950,  ..., 0.9911, 0.9906, 0.9906]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 913421.4375,  794432.5625,  779076.5625,  ...,  351224.6250,
          350038.5312,  345294.0000],
        [1485478.5000, 1471386.1250, 1468473.1250,  ..., 1340201.7500,
         1320752.0000, 1318743.2500],
        [1577882.1250, 1559297.0000, 1536682.2500,  ..., 1365367.3750,
         1361779.5000, 1357344.0000],
        ...,
        [1520801.2500, 1513262.2500, 1508747.6250,  ..., 1492022.2500,
         1491599.7500, 1491483.1250],
        [1526209.1250, 1512939.0000, 1512311.6250,  ..., 1471027.0000,
         1468984.3750, 1459298.1250],
        [1498179.0000, 1496511.1250, 1489838.2500,  ..., 1409767.7500,
         1399222.3750, 1399171.7500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 913421.4375,       0.0000],
         [ 794432.5625,       0.0000],
         [ 779076.5625,       0.0000],
         ...,
         [ 351224.6250,       0.0000],
         [ 350038.5312,       0.0000],
         [ 345294.0000,       0.0000]],

        [[1485478.5000,       0.0000],
         [1471386.1250,       0.0000],
         [1468473.1250,       0.0000],
         ...,
         [1340201.7500,       0.0000],
         [1320752.0000,       0.0000],
         [1318743.2500,       0.0000]],

        [[1577882.1250,       0.0000],
         [1559297.0000,       0.0000],
         [1536682.2500,       0.0000],
         ...,
         [1365367.3750,       0.0000],
         [1361779.5000,       0.0000],
         [      0.0000, 1357344.0000]],

        ...,

        [[1520801.2500,       0.0000],
         [1513262.2500,       0.0000],
         [1508747.6250,       0.0000],
         ...,
         [1492022.2500,       0.0000],
         [1491599.7500,       0.0000],
         [1491483.1250,       0.0000]],

        [[1526209.1250,       0.0000],
         [1512939.0000,       0.0000],
         [1512311.6250,       0.0000],
         ...,
         [1471027.0000,       0.0000],
         [1468984.3750,       0.0000],
         [1459298.1250,       0.0000]],

        [[1498179.0000,       0.0000],
         [1496511.1250,       0.0000],
         [1489838.2500,       0.0000],
         ...,
         [1409767.7500,       0.0000],
         [1399222.3750,       0.0000],
         [1399171.7500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[10304358.0000,        0.0000],
        [28055824.0000,        0.0000],
        [26495590.0000,  2839753.0000],
        [26461600.0000,  1401928.6250],
        [25240190.0000,  2759950.5000],
        [30603368.0000,        0.0000],
        [29817008.0000,  1581641.0000],
        [29762406.0000,  1581229.2500],
        [26718828.0000,  1423806.1250],
        [17048190.0000,        0.0000],
        [21713464.0000,  4087266.2500],
        [30088970.0000,        0.0000],
        [26125868.0000,  1428369.0000],
        [28195116.0000,        0.0000],
        [27358112.0000,        0.0000],
        [24124962.0000,  4179376.7500],
        [24652688.0000,  2612814.7500],
        [27158536.0000,  1377477.0000],
        [24409212.0000,  6049234.0000],
        [21853984.0000,  2537025.2500],
        [23452512.0000,        0.0000],
        [22456106.0000,  7492797.0000],
        [27543684.0000,  1453432.8750],
        [27235620.0000,        0.0000],
        [25343886.0000,        0.0000],
        [26648484.0000,  2864929.0000],
        [28012480.0000,  1504062.8750],
        [28021646.0000,        0.0000],
        [29627502.0000,        0.0000],
        [25616170.0000,  1276490.0000],
        [29053840.0000,        0.0000],
        [28816042.0000,        0.0000],
        [24557842.0000,  2702024.0000],
        [26030208.0000,  1376333.2500],
        [22524284.0000,  2728265.0000],
        [24588764.0000,  4398750.5000],
        [28061200.0000,  1477495.8750],
        [23373324.0000,        0.0000],
        [24621072.0000,  1142163.5000],
        [26578040.0000,  1383422.3750],
        [28072098.0000,        0.0000],
        [26687968.0000,  1483974.7500],
        [26748968.0000,  1334425.7500],
        [26160270.0000,  1412140.1250],
        [29003856.0000,        0.0000],
        [25519356.0000,        0.0000],
        [26892834.0000,  2991614.2500],
        [16712942.0000,  4066880.2500],
        [25139534.0000,  2873133.7500],
        [27619682.0000,  3054015.5000],
        [20846440.0000,  5248482.5000],
        [24191488.0000,  4243659.5000],
        [27664536.0000,  1429324.2500],
        [28171198.0000,        0.0000],
        [24409402.0000,  2843815.7500],
        [27284014.0000,        0.0000],
        [29878080.0000,        0.0000],
        [30221078.0000,        0.0000],
        [25422390.0000,  1472483.8750],
        [25939816.0000,  2948299.5000],
        [28852872.0000,  1518019.1250],
        [29969216.0000,        0.0000],
        [28317196.0000,  1509667.3750],
        [28911544.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 31/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:10, 58.29s/it]  7%|▋         | 2/30 [00:58<11:19, 24.26s/it] 10%|█         | 3/30 [00:59<06:01, 13.39s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.28s/it] 17%|█▋        | 5/30 [01:00<02:16,  5.45s/it] 20%|██        | 6/30 [01:00<01:29,  3.75s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.67s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.96s/it] 30%|███       | 9/30 [01:01<00:31,  1.48s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.16s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.47it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.15it/s] 70%|███████   | 21/30 [01:07<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 6.906627003351847
Epoch 32/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:03, 55.97s/it]  7%|▋         | 2/30 [00:59<11:39, 24.99s/it] 10%|█         | 3/30 [00:59<06:12, 13.78s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.52s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 6.861448287963867
Epoch 33/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:49, 59.62s/it]  7%|▋         | 2/30 [01:00<11:34, 24.81s/it] 10%|█         | 3/30 [01:00<06:09, 13.68s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.46s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.56s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 6.720081853866577
Epoch 34/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:04, 56.03s/it]  7%|▋         | 2/30 [00:57<11:14, 24.09s/it] 10%|█         | 3/30 [01:00<06:26, 14.30s/it] 13%|█▎        | 4/30 [01:00<03:49,  8.83s/it] 17%|█▋        | 5/30 [01:01<02:25,  5.80s/it] 20%|██        | 6/30 [01:01<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.21it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 6.711581230163574
Epoch 35/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.07s/it]  7%|▋         | 2/30 [00:57<11:05, 23.76s/it] 10%|█         | 3/30 [00:59<06:15, 13.92s/it] 13%|█▎        | 4/30 [01:00<03:43,  8.60s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.77s/it] 20%|██        | 6/30 [01:01<01:34,  3.96s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 6.617911132176717
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0380,  0.0435,  0.0546,  ...,  0.0420,  0.1254,  0.0811],
        [ 0.0527,  0.0338,  0.1033,  ..., -0.0439, -0.0216,  0.1377],
        [ 0.0119,  0.0402, -0.0057,  ...,  0.0414,  0.1528,  0.0617],
        ...,
        [-0.0940,  0.0241, -0.0295,  ...,  0.1047,  0.0891,  0.0502],
        [-0.0659,  0.0357, -0.0106,  ...,  0.0961,  0.0613,  0.0922],
        [-0.0099,  0.0244,  0.0367,  ...,  0.0526,  0.0115,  0.1240]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9555, 0.9374, 0.9369,  ..., 0.8856, 0.8787, 0.8783],
        [0.9939, 0.9934, 0.9933,  ..., 0.9860, 0.9859, 0.9858],
        [0.9990, 0.9971, 0.9967,  ..., 0.9889, 0.9868, 0.9866],
        ...,
        [0.9963, 0.9958, 0.9958,  ..., 0.9949, 0.9949, 0.9949],
        [0.9968, 0.9957, 0.9957,  ..., 0.9937, 0.9932, 0.9927],
        [0.9950, 0.9950, 0.9948,  ..., 0.9891, 0.9889, 0.9887]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 847136.5625,  654572.6875,  650164.8125,  ...,  312329.3438,
          282865.5000,  281210.5000],
        [1466435.5000, 1456017.5000, 1454808.5000,  ..., 1310735.0000,
         1308082.7500, 1306080.7500],
        [1577095.2500, 1536247.1250, 1525915.1250,  ..., 1365217.5000,
         1324868.3750, 1322133.2500],
        ...,
        [1517409.7500, 1506501.8750, 1506204.5000,  ..., 1487485.8750,
         1487338.2500, 1487060.2500],
        [1528433.2500, 1505811.0000, 1504615.2500,  ..., 1462113.3750,
         1452172.1250, 1442278.8750],
        [1491049.2500, 1490986.6250, 1486528.5000,  ..., 1370417.1250,
         1365600.3750, 1361009.5000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 847136.5625,       0.0000],
         [ 654572.6875,       0.0000],
         [ 650164.8125,       0.0000],
         ...,
         [ 312329.3438,       0.0000],
         [ 282865.5000,       0.0000],
         [ 281210.5000,       0.0000]],

        [[1466435.5000,       0.0000],
         [1456017.5000,       0.0000],
         [1454808.5000,       0.0000],
         ...,
         [1310735.0000,       0.0000],
         [1308082.7500,       0.0000],
         [1306080.7500,       0.0000]],

        [[1577095.2500,       0.0000],
         [1536247.1250,       0.0000],
         [1525915.1250,       0.0000],
         ...,
         [1365217.5000,       0.0000],
         [1324868.3750,       0.0000],
         [      0.0000, 1322133.2500]],

        ...,

        [[1517409.7500,       0.0000],
         [1506501.8750,       0.0000],
         [1506204.5000,       0.0000],
         ...,
         [1487485.8750,       0.0000],
         [1487338.2500,       0.0000],
         [1487060.2500,       0.0000]],

        [[1528433.2500,       0.0000],
         [1505811.0000,       0.0000],
         [1504615.2500,       0.0000],
         ...,
         [1462113.3750,       0.0000],
         [1452172.1250,       0.0000],
         [1442278.8750,       0.0000]],

        [[1491049.2500,       0.0000],
         [1490986.6250,       0.0000],
         [1486528.5000,       0.0000],
         ...,
         [1370417.1250,       0.0000],
         [1365600.3750,       0.0000],
         [1361009.5000,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 8713492.0000,        0.0000],
        [27616520.0000,        0.0000],
        [26216206.0000,  2770151.0000],
        [25891932.0000,  1371732.5000],
        [26172120.0000,  1399178.5000],
        [30417388.0000,        0.0000],
        [29777522.0000,  1583396.2500],
        [29729508.0000,  1578378.7500],
        [26459920.0000,  1420448.0000],
        [17114180.0000,        0.0000],
        [21369496.0000,  4035386.7500],
        [29927902.0000,        0.0000],
        [25349972.0000,  1407018.3750],
        [26595636.0000,  1325748.1250],
        [26513154.0000,        0.0000],
        [23669694.0000,  4014541.0000],
        [25637148.0000,  1325880.8750],
        [26749062.0000,  1330504.1250],
        [24285138.0000,  6000499.5000],
        [20808350.0000,  2489697.5000],
        [21206578.0000,  2051046.2500],
        [22247446.0000,  7395853.0000],
        [25903712.0000,  2823318.5000],
        [26398634.0000,        0.0000],
        [23234578.0000,  1094789.5000],
        [29142492.0000,        0.0000],
        [27821636.0000,  1519250.1250],
        [27244088.0000,        0.0000],
        [29349776.0000,        0.0000],
        [24787228.0000,  1198483.7500],
        [28789350.0000,        0.0000],
        [28429552.0000,        0.0000],
        [25321548.0000,  1422687.7500],
        [25446648.0000,  1351077.7500],
        [21612824.0000,  2603812.2500],
        [24431614.0000,  4360728.5000],
        [26220126.0000,  2877146.5000],
        [22797544.0000,        0.0000],
        [23890244.0000,  1130582.8750],
        [26446264.0000,  1370717.7500],
        [27421976.0000,        0.0000],
        [26113518.0000,  1448510.8750],
        [24549964.0000,  2519212.0000],
        [23932766.0000,  2628844.5000],
        [28675652.0000,        0.0000],
        [24301258.0000,        0.0000],
        [29912498.0000,        0.0000],
        [13959908.0000,  5195867.5000],
        [24865018.0000,  2846108.0000],
        [25987370.0000,  4545389.0000],
        [20076448.0000,  5101354.5000],
        [20391956.0000,  6696735.0000],
        [27055246.0000,  1413267.7500],
        [27352968.0000,        0.0000],
        [23502180.0000,  2773789.0000],
        [26751932.0000,        0.0000],
        [29612244.0000,        0.0000],
        [29949638.0000,        0.0000],
        [22693260.0000,  2708685.0000],
        [23823188.0000,  4209158.0000],
        [27162744.0000,  2991153.0000],
        [29931812.0000,        0.0000],
        [28131956.0000,  1491012.2500],
        [28538180.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 36/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:18, 58.58s/it]  7%|▋         | 2/30 [01:00<11:40, 25.03s/it] 10%|█         | 3/30 [01:00<06:12, 13.80s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 6.6342148621877035
Epoch 37/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:15, 56.40s/it]  7%|▋         | 2/30 [00:56<10:57, 23.49s/it] 10%|█         | 3/30 [01:00<06:27, 14.35s/it] 13%|█▎        | 4/30 [01:00<03:50,  8.86s/it] 17%|█▋        | 5/30 [01:01<02:25,  5.82s/it] 20%|██        | 6/30 [01:01<01:35,  3.99s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.83s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.07s/it] 30%|███       | 9/30 [01:02<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 6.437292003631592
Epoch 38/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:16, 58.52s/it]  7%|▋         | 2/30 [00:58<11:21, 24.35s/it] 10%|█         | 3/30 [00:59<06:02, 13.44s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.31s/it] 17%|█▋        | 5/30 [01:00<02:16,  5.47s/it] 20%|██        | 6/30 [01:00<01:30,  3.76s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.68s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.97s/it] 30%|███       | 9/30 [01:02<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 6.420384120941162
Epoch 39/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:55, 55.72s/it]  7%|▋         | 2/30 [00:59<11:42, 25.09s/it] 10%|█         | 3/30 [01:00<06:24, 14.24s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.79s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.78s/it] 20%|██        | 6/30 [01:02<01:35,  3.96s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 6.294533967971802
Epoch 40/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:40, 55.20s/it]  7%|▋         | 2/30 [00:55<10:43, 22.99s/it] 10%|█         | 3/30 [00:59<06:24, 14.23s/it] 13%|█▎        | 4/30 [00:59<03:48,  8.79s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.78s/it] 20%|██        | 6/30 [01:00<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.06s/it] 30%|███       | 9/30 [01:02<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 6.2840294202168785
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0378,  0.0129,  0.0607,  ...,  0.0314,  0.1292,  0.0811],
        [ 0.0522,  0.0174,  0.1046,  ..., -0.0470, -0.0220,  0.1427],
        [ 0.0111,  0.0239, -0.0042,  ...,  0.0308,  0.1450,  0.0668],
        ...,
        [-0.1045,  0.0034, -0.0265,  ...,  0.0982,  0.0929,  0.0494],
        [-0.0694,  0.0179, -0.0063,  ...,  0.0925,  0.0655,  0.0972],
        [-0.0052,  0.0054,  0.0427,  ...,  0.0443,  0.0098,  0.1294]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9521, 0.9308, 0.9297,  ..., 0.8856, 0.8844, 0.8843],
        [0.9938, 0.9932, 0.9927,  ..., 0.9845, 0.9843, 0.9841],
        [0.9989, 0.9964, 0.9956,  ..., 0.9890, 0.9862, 0.9855],
        ...,
        [0.9956, 0.9956, 0.9955,  ..., 0.9945, 0.9945, 0.9945],
        [0.9957, 0.9954, 0.9952,  ..., 0.9920, 0.9910, 0.9900],
        [0.9944, 0.9943, 0.9942,  ..., 0.9874, 0.9869, 0.9868]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 1, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 807420.3125,  595190.3750,  585957.1875,  ...,  312262.9375,
          306825.0938,  306269.3750],
        [1464187.0000, 1453105.7500, 1442635.2500,  ..., 1282102.1250,
         1278513.6250, 1275034.8750],
        [1574714.6250, 1520566.3750, 1502619.1250,  ..., 1366887.7500,
         1314281.2500, 1301494.0000],
        ...,
        [1502736.6250, 1502004.3750, 1499780.1250,  ..., 1479725.2500,
         1479489.5000, 1479148.1250],
        [1504124.5000, 1498424.7500, 1494156.7500,  ..., 1426860.5000,
         1408007.6250, 1386788.0000],
        [1476857.6250, 1475395.0000, 1474012.5000,  ..., 1337035.7500,
         1327549.7500, 1326118.5000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 807420.3125,       0.0000],
         [ 595190.3750,       0.0000],
         [ 585957.1875,       0.0000],
         ...,
         [ 312262.9375,       0.0000],
         [ 306825.0938,       0.0000],
         [ 306269.3750,       0.0000]],

        [[1464187.0000,       0.0000],
         [1453105.7500,       0.0000],
         [1442635.2500,       0.0000],
         ...,
         [      0.0000, 1282102.1250],
         [1278513.6250,       0.0000],
         [1275034.8750,       0.0000]],

        [[1574714.6250,       0.0000],
         [1520566.3750,       0.0000],
         [1502619.1250,       0.0000],
         ...,
         [1366887.7500,       0.0000],
         [1314281.2500,       0.0000],
         [      0.0000, 1301494.0000]],

        ...,

        [[1502736.6250,       0.0000],
         [1502004.3750,       0.0000],
         [1499780.1250,       0.0000],
         ...,
         [1479725.2500,       0.0000],
         [1479489.5000,       0.0000],
         [1479148.1250,       0.0000]],

        [[1504124.5000,       0.0000],
         [1498424.7500,       0.0000],
         [1494156.7500,       0.0000],
         ...,
         [1426860.5000,       0.0000],
         [1408007.6250,       0.0000],
         [1386788.0000,       0.0000]],

        [[1476857.6250,       0.0000],
         [1475395.0000,       0.0000],
         [1474012.5000,       0.0000],
         ...,
         [1337035.7500,       0.0000],
         [1327549.7500,       0.0000],
         [1326118.5000,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 8489299.0000,        0.0000],
        [25871850.0000,  1282102.1250],
        [25962292.0000,  2713173.5000],
        [25321380.0000,  1327539.6250],
        [25732178.0000,  1363826.3750],
        [30192406.0000,        0.0000],
        [29718840.0000,  1584239.1250],
        [29685242.0000,  1574752.2500],
        [26416436.0000,  1421648.7500],
        [17521632.0000,        0.0000],
        [19835364.0000,  5108554.5000],
        [29732582.0000,        0.0000],
        [24726338.0000,  1387691.6250],
        [26445792.0000,  1354857.0000],
        [25836916.0000,        0.0000],
        [24471670.0000,  2637043.5000],
        [25648928.0000,  1319074.1250],
        [25097840.0000,  2560283.0000],
        [22701674.0000,  7401077.0000],
        [19811246.0000,  2445695.5000],
        [21089102.0000,  2163807.0000],
        [20591992.0000,  8675758.0000],
        [25647980.0000,  2780320.5000],
        [26046544.0000,        0.0000],
        [22703066.0000,  1141895.5000],
        [28746698.0000,        0.0000],
        [27446590.0000,  1526046.1250],
        [26491224.0000,        0.0000],
        [29094132.0000,        0.0000],
        [25443726.0000,        0.0000],
        [28494626.0000,        0.0000],
        [28060358.0000,        0.0000],
        [24794436.0000,  1385764.7500],
        [25080818.0000,  1321559.6250],
        [20691244.0000,  2484207.0000],
        [24264556.0000,  4323468.0000],
        [25811020.0000,  2870282.2500],
        [22551178.0000,        0.0000],
        [23216468.0000,  1119377.8750],
        [26415942.0000,  1363823.8750],
        [26706220.0000,        0.0000],
        [25461086.0000,  1390127.5000],
        [23619588.0000,  2369131.5000],
        [22886332.0000,  2505506.0000],
        [28364030.0000,        0.0000],
        [23313544.0000,        0.0000],
        [29941050.0000,        0.0000],
        [13611076.0000,  4135286.5000],
        [24446540.0000,  2817165.0000],
        [25862688.0000,  4527405.0000],
        [19251512.0000,  4930547.0000],
        [19460320.0000,  6382423.0000],
        [26360312.0000,  1396762.6250],
        [26584728.0000,        0.0000],
        [23088410.0000,  2715090.0000],
        [26307396.0000,        0.0000],
        [27815602.0000,  1444697.7500],
        [29467516.0000,        0.0000],
        [21460528.0000,  2677238.7500],
        [23071940.0000,  4132166.5000],
        [26892232.0000,  2970383.7500],
        [29752872.0000,        0.0000],
        [27652448.0000,  1455074.8750],
        [28067846.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 41/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:01, 60.04s/it]  7%|▋         | 2/30 [01:00<11:39, 24.98s/it] 10%|█         | 3/30 [01:00<06:11, 13.78s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.60s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 6.211013762156169
Epoch 42/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:59, 59.98s/it]  7%|▋         | 2/30 [01:00<11:39, 24.98s/it] 10%|█         | 3/30 [01:00<06:11, 13.77s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.60s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 6.080769268671672
Epoch 43/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:37, 59.22s/it]  7%|▋         | 2/30 [01:01<11:53, 25.49s/it] 10%|█         | 3/30 [01:01<06:19, 14.05s/it] 13%|█▎        | 4/30 [01:01<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.71s/it] 20%|██        | 6/30 [01:02<01:33,  3.92s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 6.083063189188639
Epoch 44/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:39, 57.22s/it]  7%|▋         | 2/30 [00:59<11:29, 24.62s/it] 10%|█         | 3/30 [00:59<06:06, 13.58s/it] 13%|█▎        | 4/30 [00:59<03:38,  8.39s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.52s/it] 20%|██        | 6/30 [01:00<01:31,  3.80s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 6.0637403647104895
Epoch 45/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:28, 56.86s/it]  7%|▋         | 2/30 [00:57<11:02, 23.67s/it] 10%|█         | 3/30 [00:59<06:20, 14.08s/it] 13%|█▎        | 4/30 [01:00<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.77s/it] 20%|██        | 6/30 [01:01<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 5.969199879964193
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-3.3727e-02, -1.4318e-02,  6.8237e-02,  ...,  1.9253e-02,
          1.2896e-01,  8.0517e-02],
        [ 4.8628e-02, -4.0414e-05,  1.0458e-01,  ..., -4.7844e-02,
         -1.8138e-02,  1.4376e-01],
        [ 1.0796e-02,  7.6295e-03, -1.9047e-03,  ...,  1.8515e-02,
          1.3634e-01,  7.2249e-02],
        ...,
        [-1.0815e-01, -2.0623e-02, -1.9866e-02,  ...,  8.7129e-02,
          9.3399e-02,  5.1577e-02],
        [-6.8692e-02, -4.3573e-03,  4.7220e-04,  ...,  8.5214e-02,
          6.8386e-02,  1.0201e-01],
        [-8.3360e-04, -1.7143e-02,  4.9339e-02,  ...,  3.5479e-02,
          1.1172e-02,  1.3184e-01]], device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9473, 0.9236, 0.9227,  ..., 0.8899, 0.8856, 0.8834],
        [0.9937, 0.9933, 0.9921,  ..., 0.9837, 0.9836, 0.9830],
        [0.9987, 0.9963, 0.9948,  ..., 0.9883, 0.9858, 0.9846],
        ...,
        [0.9952, 0.9950, 0.9948,  ..., 0.9936, 0.9936, 0.9935],
        [0.9962, 0.9946, 0.9946,  ..., 0.9887, 0.9883, 0.9882],
        [0.9942, 0.9940, 0.9938,  ..., 0.9860, 0.9860, 0.9859]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 753341.7500,  537047.5625,  530271.1250,  ...,  332146.7500,
          312272.4688,  302761.8750],
        [1461994.8750, 1453428.6250, 1430136.8750,  ..., 1268502.3750,
         1265794.3750, 1255102.0000],
        [1570919.7500, 1516864.3750, 1486011.1250,  ..., 1353902.5000,
         1306224.1250, 1284129.7500],
        ...,
        [1493656.6250, 1491049.2500, 1486151.5000,  ..., 1460864.6250,
         1459632.2500, 1459228.6250],
        [1515203.1250, 1482260.3750, 1481063.6250,  ..., 1362004.1250,
         1354116.8750, 1352346.1250],
        [1473285.8750, 1469116.1250, 1463998.5000,  ..., 1311102.6250,
         1310470.1250, 1309263.5000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 753341.7500,       0.0000],
         [ 537047.5625,       0.0000],
         [ 530271.1250,       0.0000],
         ...,
         [ 332146.7500,       0.0000],
         [ 312272.4688,       0.0000],
         [ 302761.8750,       0.0000]],

        [[1461994.8750,       0.0000],
         [1453428.6250,       0.0000],
         [1430136.8750,       0.0000],
         ...,
         [1268502.3750,       0.0000],
         [1265794.3750,       0.0000],
         [1255102.0000,       0.0000]],

        [[1570919.7500,       0.0000],
         [1516864.3750,       0.0000],
         [1486011.1250,       0.0000],
         ...,
         [1353902.5000,       0.0000],
         [1306224.1250,       0.0000],
         [      0.0000, 1284129.7500]],

        ...,

        [[1493656.6250,       0.0000],
         [1491049.2500,       0.0000],
         [1486151.5000,       0.0000],
         ...,
         [1460864.6250,       0.0000],
         [1459632.2500,       0.0000],
         [1459228.6250,       0.0000]],

        [[1515203.1250,       0.0000],
         [1482260.3750,       0.0000],
         [1481063.6250,       0.0000],
         ...,
         [1362004.1250,       0.0000],
         [1354116.8750,       0.0000],
         [1352346.1250,       0.0000]],

        [[1473285.8750,       0.0000],
         [1469116.1250,       0.0000],
         [1463998.5000,       0.0000],
         ...,
         [1311102.6250,       0.0000],
         [1310470.1250,       0.0000],
         [1309263.5000,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 8415751.0000,        0.0000],
        [25688956.0000,  1282015.2500],
        [25683236.0000,  2662447.7500],
        [24870720.0000,  1278786.7500],
        [25265556.0000,  1333390.1250],
        [29908264.0000,        0.0000],
        [29636578.0000,  1583923.3750],
        [29640056.0000,  1571152.0000],
        [26366642.0000,  1420789.5000],
        [17849320.0000,        0.0000],
        [19503030.0000,  5045841.0000],
        [29496786.0000,        0.0000],
        [24159980.0000,  1372144.6250],
        [26366528.0000,  1386230.1250],
        [24440512.0000,  1175178.5000],
        [24109964.0000,  2568387.0000],
        [25669246.0000,  1316658.5000],
        [25979622.0000,  1269395.5000],
        [22533240.0000,  7332714.0000],
        [18088768.0000,  3327858.0000],
        [20993426.0000,  2259791.2500],
        [20295462.0000,  8538638.0000],
        [25457740.0000,  2737480.0000],
        [26098276.0000,        0.0000],
        [22354988.0000,  1185386.5000],
        [28394866.0000,        0.0000],
        [27165992.0000,  1528392.3750],
        [25962720.0000,        0.0000],
        [28857226.0000,        0.0000],
        [25265514.0000,        0.0000],
        [28284558.0000,        0.0000],
        [27768954.0000,        0.0000],
        [24297292.0000,  1371781.0000],
        [24914462.0000,  1300081.0000],
        [19090074.0000,  3379922.0000],
        [24091452.0000,  4278292.0000],
        [25391912.0000,  2847156.0000],
        [22409338.0000,        0.0000],
        [22663010.0000,  1108348.5000],
        [26404384.0000,  1350170.8750],
        [26002628.0000,        0.0000],
        [25026212.0000,  1325209.6250],
        [22796034.0000,  2229569.0000],
        [22068846.0000,  2361880.5000],
        [28114010.0000,        0.0000],
        [22912744.0000,        0.0000],
        [29934024.0000,        0.0000],
        [12517039.0000,  3825030.7500],
        [24007666.0000,  2782858.0000],
        [25734584.0000,  4503583.5000],
        [18445798.0000,  4738988.0000],
        [17551290.0000,  7199461.0000],
        [25804012.0000,  1386673.0000],
        [26045072.0000,        0.0000],
        [22819100.0000,  2665964.5000],
        [26102604.0000,        0.0000],
        [26045788.0000,  2869634.5000],
        [29045760.0000,        0.0000],
        [20811476.0000,  2662613.5000],
        [22229246.0000,  4018848.5000],
        [26539386.0000,  2939884.5000],
        [29417064.0000,        0.0000],
        [26984160.0000,  1414523.0000],
        [27670796.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 46/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:37, 57.16s/it]  7%|▋         | 2/30 [00:58<11:21, 24.32s/it] 10%|█         | 3/30 [01:00<06:25, 14.26s/it] 13%|█▎        | 4/30 [01:01<03:49,  8.81s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.79s/it] 20%|██        | 6/30 [01:02<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 5.863731718063354
Epoch 47/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:03<30:51, 63.85s/it]  7%|▋         | 2/30 [01:05<12:50, 27.52s/it] 10%|█         | 3/30 [01:06<06:55, 15.39s/it] 13%|█▎        | 4/30 [01:07<04:06,  9.49s/it] 17%|█▋        | 5/30 [01:07<02:35,  6.23s/it] 20%|██        | 6/30 [01:08<01:42,  4.26s/it] 23%|██▎       | 7/30 [01:08<01:09,  3.01s/it] 27%|██▋       | 8/30 [01:09<00:48,  2.19s/it] 30%|███       | 9/30 [01:09<00:34,  1.64s/it] 33%|███▎      | 10/30 [01:09<00:25,  1.27s/it] 37%|███▋      | 11/30 [01:10<00:19,  1.02s/it] 40%|████      | 12/30 [01:10<00:15,  1.19it/s] 43%|████▎     | 13/30 [01:11<00:12,  1.39it/s] 47%|████▋     | 14/30 [01:11<00:10,  1.57it/s] 50%|█████     | 15/30 [01:12<00:08,  1.73it/s] 53%|█████▎    | 16/30 [01:12<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:13<00:06,  1.97it/s] 60%|██████    | 18/30 [01:13<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:13<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:14<00:04,  2.16it/s] 70%|███████   | 21/30 [01:14<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:15<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:15<00:03,  2.23it/s] 80%|████████  | 24/30 [01:16<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:16<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:17<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:17<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:17<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:18<00:00,  2.27it/s]100%|██████████| 30/30 [01:18<00:00,  2.27it/s]100%|██████████| 30/30 [01:18<00:00,  2.63s/it]
Epoch loss is 5.856798442204793
Epoch 48/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:51, 57.65s/it]  7%|▋         | 2/30 [00:59<11:27, 24.54s/it] 10%|█         | 3/30 [00:59<06:05, 13.54s/it] 13%|█▎        | 4/30 [00:59<03:37,  8.37s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.51s/it] 20%|██        | 6/30 [01:00<01:30,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.69s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 5.783167966206869
Epoch 49/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:28, 60.97s/it]  7%|▋         | 2/30 [01:01<11:55, 25.56s/it] 10%|█         | 3/30 [01:02<06:20, 14.09s/it] 13%|█▎        | 4/30 [01:02<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:03<02:23,  5.72s/it] 20%|██        | 6/30 [01:03<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 5.722027540206909
Epoch 50/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:16, 58.50s/it]  7%|▋         | 2/30 [00:59<11:25, 24.47s/it] 10%|█         | 3/30 [01:01<06:32, 14.56s/it] 13%|█▎        | 4/30 [01:02<03:53,  8.98s/it] 17%|█▋        | 5/30 [01:02<02:27,  5.90s/it] 20%|██        | 6/30 [01:03<01:37,  4.04s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.87s/it] 27%|██▋       | 8/30 [01:04<00:46,  2.09s/it] 30%|███       | 9/30 [01:04<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.01it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.60it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.47s/it]
Epoch loss is 5.750413990020752
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-2.7293e-02, -3.6255e-02,  7.4118e-02,  ...,  8.3463e-03,
          1.2758e-01,  8.1572e-02],
        [ 4.4288e-02, -1.7369e-02,  1.0496e-01,  ..., -4.7295e-02,
         -1.0369e-02,  1.4092e-01],
        [ 8.7798e-03, -8.9667e-03, -1.1208e-04,  ...,  6.8350e-03,
          1.2968e-01,  7.7670e-02],
        ...,
        [-1.0940e-01, -4.3434e-02, -1.0776e-02,  ...,  7.2737e-02,
          9.2367e-02,  5.6206e-02],
        [-6.8245e-02, -2.6678e-02,  9.1765e-03,  ...,  7.5254e-02,
          7.1475e-02,  1.0614e-01],
        [ 1.5271e-03, -3.8629e-02,  5.6875e-02,  ...,  2.5899e-02,
          1.5107e-02,  1.3126e-01]], device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9421, 0.9214, 0.9147,  ..., 0.8936, 0.8932, 0.8892],
        [0.9935, 0.9931, 0.9916,  ..., 0.9838, 0.9835, 0.9830],
        [0.9985, 0.9962, 0.9946,  ..., 0.9871, 0.9857, 0.9837],
        ...,
        [0.9947, 0.9938, 0.9933,  ..., 0.9917, 0.9917, 0.9916],
        [0.9960, 0.9949, 0.9942,  ..., 0.9865, 0.9864, 0.9859],
        [0.9947, 0.9938, 0.9931,  ..., 0.9850, 0.9849, 0.9848]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 699506.1875,  520986.1875,  473470.7188,  ...,  350063.9375,
          347976.5938,  328521.7500],
        [1457681.8750, 1449586.0000, 1419305.2500,  ..., 1269057.8750,
         1265153.5000, 1256148.7500],
        [1566019.5000, 1515933.0000, 1480582.0000,  ..., 1331338.0000,
         1304910.3750, 1267668.0000],
        ...,
        [1484021.3750, 1465480.6250, 1454331.3750,  ..., 1420945.3750,
         1420650.0000, 1419932.1250],
        [1512145.7500, 1487095.7500, 1472065.5000,  ..., 1318999.8750,
         1317179.7500, 1309116.1250],
        [1482652.0000, 1465001.2500, 1449692.5000,  ..., 1292060.5000,
         1289899.6250, 1288101.2500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 699506.1875,       0.0000],
         [ 520986.1875,       0.0000],
         [ 473470.7188,       0.0000],
         ...,
         [ 350063.9375,       0.0000],
         [ 347976.5938,       0.0000],
         [ 328521.7500,       0.0000]],

        [[1457681.8750,       0.0000],
         [1449586.0000,       0.0000],
         [1419305.2500,       0.0000],
         ...,
         [1269057.8750,       0.0000],
         [1265153.5000,       0.0000],
         [1256148.7500,       0.0000]],

        [[1566019.5000,       0.0000],
         [1515933.0000,       0.0000],
         [1480582.0000,       0.0000],
         ...,
         [1331338.0000,       0.0000],
         [1304910.3750,       0.0000],
         [      0.0000, 1267668.0000]],

        ...,

        [[1484021.3750,       0.0000],
         [1465480.6250,       0.0000],
         [1454331.3750,       0.0000],
         ...,
         [1420945.3750,       0.0000],
         [1420650.0000,       0.0000],
         [1419932.1250,       0.0000]],

        [[1512145.7500,       0.0000],
         [1487095.7500,       0.0000],
         [1472065.5000,       0.0000],
         ...,
         [1318999.8750,       0.0000],
         [1317179.7500,       0.0000],
         [1309116.1250,       0.0000]],

        [[1482652.0000,       0.0000],
         [1465001.2500,       0.0000],
         [1449692.5000,       0.0000],
         ...,
         [1292060.5000,       0.0000],
         [1289899.6250,       0.0000],
         [1288101.2500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 8335476.0000,        0.0000],
        [25656048.0000,  1291031.8750],
        [25407860.0000,  2621459.5000],
        [24490376.0000,  1229022.1250],
        [24872828.0000,  1311522.8750],
        [29586972.0000,        0.0000],
        [29526428.0000,  1582768.1250],
        [29580468.0000,  1567860.5000],
        [26302428.0000,  1419673.3750],
        [18027806.0000,        0.0000],
        [19262892.0000,  4999428.0000],
        [29224056.0000,        0.0000],
        [23676240.0000,  1358404.5000],
        [26312978.0000,  1412584.6250],
        [24623872.0000,  1180286.6250],
        [25158776.0000,  1342093.3750],
        [25708076.0000,  1311780.5000],
        [25693664.0000,  1268930.7500],
        [22361972.0000,  7251524.0000],
        [17603912.0000,  3311326.2500],
        [20951588.0000,  2329233.0000],
        [19944572.0000,  8395434.0000],
        [25327472.0000,  2700582.0000],
        [26262068.0000,        0.0000],
        [22212368.0000,  1224687.2500],
        [28117866.0000,        0.0000],
        [25581620.0000,  2892011.5000],
        [25623920.0000,        0.0000],
        [28685178.0000,        0.0000],
        [25350988.0000,        0.0000],
        [28142778.0000,        0.0000],
        [27524008.0000,        0.0000],
        [23924396.0000,  1375185.2500],
        [24906444.0000,  1282458.0000],
        [18971852.0000,  3291542.5000],
        [23935412.0000,  4228750.0000],
        [25016076.0000,  2819441.5000],
        [21476080.0000,   975748.6250],
        [22313300.0000,  1097811.0000],
        [26438820.0000,  1343530.2500],
        [25518214.0000,        0.0000],
        [24784196.0000,  1266615.5000],
        [22187502.0000,  2147169.5000],
        [21367148.0000,  2224478.5000],
        [27993576.0000,        0.0000],
        [23039036.0000,        0.0000],
        [29950242.0000,        0.0000],
        [11508706.0000,  3544652.0000],
        [23737548.0000,  2757188.0000],
        [25600368.0000,  4472635.5000],
        [17821210.0000,  4571904.5000],
        [16109114.0000,  8043371.0000],
        [25447888.0000,  1389535.0000],
        [25805568.0000,        0.0000],
        [22704928.0000,  2625030.5000],
        [26083764.0000,        0.0000],
        [25850004.0000,  2872495.0000],
        [28762734.0000,        0.0000],
        [20422354.0000,  2661653.0000],
        [21494834.0000,  3902520.0000],
        [26155004.0000,  2903104.2500],
        [28788888.0000,        0.0000],
        [26316620.0000,  1377155.1250],
        [27361514.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 51/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:55, 55.71s/it]  7%|▋         | 2/30 [01:00<12:06, 25.93s/it] 10%|█         | 3/30 [01:01<06:25, 14.29s/it] 13%|█▎        | 4/30 [01:01<03:49,  8.82s/it] 17%|█▋        | 5/30 [01:02<02:25,  5.80s/it] 20%|██        | 6/30 [01:02<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 5.658950312932332
Epoch 52/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:14, 58.45s/it]  7%|▋         | 2/30 [00:58<11:21, 24.33s/it] 10%|█         | 3/30 [00:59<06:04, 13.50s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.71s/it] 20%|██        | 6/30 [01:01<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 5.577717018127442
Epoch 53/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:24, 56.70s/it]  7%|▋         | 2/30 [01:00<11:59, 25.68s/it] 10%|█         | 3/30 [01:01<06:22, 14.16s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.74s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.75s/it] 20%|██        | 6/30 [01:02<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 5.62074909210205
Epoch 54/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:37, 59.22s/it]  7%|▋         | 2/30 [00:59<11:30, 24.64s/it] 10%|█         | 3/30 [01:00<06:06, 13.59s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.40s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.53s/it] 20%|██        | 6/30 [01:01<01:31,  3.80s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.01it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 5.572705046335856
Epoch 55/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:00, 55.87s/it]  7%|▋         | 2/30 [00:58<11:28, 24.60s/it] 10%|█         | 3/30 [00:59<06:06, 13.57s/it] 13%|█▎        | 4/30 [00:59<03:38,  8.39s/it] 17%|█▋        | 5/30 [00:59<02:18,  5.52s/it] 20%|██        | 6/30 [01:00<01:31,  3.79s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:01<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.01it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 5.554521735509237
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0206, -0.0495,  0.0789,  ..., -0.0011,  0.1258,  0.0817],
        [ 0.0406, -0.0305,  0.1058,  ..., -0.0472,  0.0007,  0.1353],
        [ 0.0068, -0.0222, -0.0008,  ..., -0.0046,  0.1232,  0.0813],
        ...,
        [-0.1100, -0.0631, -0.0019,  ...,  0.0568,  0.0925,  0.0588],
        [-0.0688, -0.0470,  0.0172,  ...,  0.0641,  0.0776,  0.1060],
        [ 0.0019, -0.0570,  0.0639,  ...,  0.0171,  0.0234,  0.1266]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9358, 0.9222, 0.9182,  ..., 0.8902, 0.8890, 0.8885],
        [0.9930, 0.9929, 0.9918,  ..., 0.9848, 0.9844, 0.9829],
        [0.9982, 0.9962, 0.9943,  ..., 0.9859, 0.9859, 0.9823],
        ...,
        [0.9936, 0.9918, 0.9917,  ..., 0.9895, 0.9895, 0.9894],
        [0.9955, 0.9948, 0.9934,  ..., 0.9849, 0.9848, 0.9846],
        [0.9950, 0.9934, 0.9922,  ..., 0.9848, 0.9846, 0.9836]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 639727.3125,  526819.3750,  497355.6562,  ...,  333454.3750,
          327975.7812,  325240.0938],
        [1447970.8750, 1445276.5000, 1423093.5000,  ..., 1288616.1250,
         1279748.1250, 1253115.5000],
        [1559993.1250, 1514953.1250, 1474604.3750,  ..., 1309277.1250,
         1307805.7500, 1242504.3750],
        ...,
        [1460118.1250, 1422978.1250, 1420866.6250,  ..., 1377073.7500,
         1376847.8750, 1374727.6250],
        [1501676.3750, 1486304.5000, 1456885.5000,  ..., 1289362.2500,
         1287493.3750, 1283804.0000],
        [1490162.1250, 1456617.5000, 1432322.1250,  ..., 1287230.6250,
         1283480.8750, 1265759.2500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 639727.3125,       0.0000],
         [ 526819.3750,       0.0000],
         [ 497355.6562,       0.0000],
         ...,
         [ 333454.3750,       0.0000],
         [ 327975.7812,       0.0000],
         [ 325240.0938,       0.0000]],

        [[1447970.8750,       0.0000],
         [1445276.5000,       0.0000],
         [1423093.5000,       0.0000],
         ...,
         [1288616.1250,       0.0000],
         [1279748.1250,       0.0000],
         [1253115.5000,       0.0000]],

        [[1559993.1250,       0.0000],
         [1514953.1250,       0.0000],
         [1474604.3750,       0.0000],
         ...,
         [1309277.1250,       0.0000],
         [1307805.7500,       0.0000],
         [      0.0000, 1242504.3750]],

        ...,

        [[1460118.1250,       0.0000],
         [1422978.1250,       0.0000],
         [1420866.6250,       0.0000],
         ...,
         [1377073.7500,       0.0000],
         [1376847.8750,       0.0000],
         [1374727.6250,       0.0000]],

        [[1501676.3750,       0.0000],
         [1486304.5000,       0.0000],
         [1456885.5000,       0.0000],
         ...,
         [1289362.2500,       0.0000],
         [1287493.3750,       0.0000],
         [1283804.0000,       0.0000]],

        [[1490162.1250,       0.0000],
         [1456617.5000,       0.0000],
         [1432322.1250,       0.0000],
         ...,
         [1287230.6250,       0.0000],
         [1283480.8750,       0.0000],
         [1265759.2500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 7980558.0000,        0.0000],
        [25694830.0000,  1297327.7500],
        [25128064.0000,  2577682.5000],
        [24256288.0000,  1189322.5000],
        [24630448.0000,  1307920.6250],
        [29200920.0000,        0.0000],
        [29395776.0000,  1580740.7500],
        [29491104.0000,  1564180.6250],
        [26228546.0000,  1418364.8750],
        [17859388.0000,        0.0000],
        [19022572.0000,  4972953.0000],
        [28955712.0000,        0.0000],
        [23180924.0000,  1341896.3750],
        [26229962.0000,  1431521.8750],
        [26022110.0000,        0.0000],
        [25123156.0000,  1313974.1250],
        [25680268.0000,  1318356.0000],
        [25500908.0000,  1267716.3750],
        [22171992.0000,  7162355.0000],
        [16489824.0000,  4178789.2500],
        [20955140.0000,  2353682.2500],
        [20873426.0000,  6961020.0000],
        [25230380.0000,  2664299.7500],
        [26392432.0000,        0.0000],
        [22172284.0000,  1252595.7500],
        [27953070.0000,        0.0000],
        [25439372.0000,  2888066.0000],
        [25414332.0000,        0.0000],
        [28497404.0000,        0.0000],
        [25484462.0000,        0.0000],
        [28033136.0000,        0.0000],
        [27321752.0000,        0.0000],
        [23550182.0000,  1390257.3750],
        [24975706.0000,  1274363.7500],
        [19072570.0000,  3228093.0000],
        [23761064.0000,  4159975.2500],
        [23517888.0000,  4023161.5000],
        [21524068.0000,  1019295.5625],
        [22162084.0000,  1080912.6250],
        [26439774.0000,  1341941.1250],
        [24038978.0000,  1116229.0000],
        [24714010.0000,  1237713.3750],
        [22758482.0000,  1049706.6250],
        [20735868.0000,  2116040.5000],
        [26669588.0000,  1367838.3750],
        [23262906.0000,        0.0000],
        [29905124.0000,        0.0000],
        [10672205.0000,  3323475.2500],
        [23561154.0000,  2730024.5000],
        [25472808.0000,  4438524.5000],
        [17323764.0000,  4442068.5000],
        [17006926.0000,  6905564.0000],
        [25303686.0000,  1392664.6250],
        [25663690.0000,        0.0000],
        [22576900.0000,  2593373.5000],
        [26082260.0000,        0.0000],
        [25707536.0000,  2887583.0000],
        [28466272.0000,        0.0000],
        [19152196.0000,  3731993.5000],
        [19823576.0000,  4847377.0000],
        [25783212.0000,  2861261.2500],
        [27908288.0000,        0.0000],
        [25861580.0000,  1354618.0000],
        [27151472.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 56/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:50, 59.68s/it]  7%|▋         | 2/30 [01:00<11:35, 24.83s/it] 10%|█         | 3/30 [01:00<06:09, 13.70s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.46s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 5.4723273913065595
Epoch 57/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:44, 57.41s/it]  7%|▋         | 2/30 [00:57<11:09, 23.90s/it] 10%|█         | 3/30 [00:58<06:02, 13.41s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.29s/it] 17%|█▋        | 5/30 [00:59<02:16,  5.46s/it] 20%|██        | 6/30 [01:00<01:30,  3.75s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.67s/it] 27%|██▋       | 8/30 [01:00<00:43,  1.96s/it] 30%|███       | 9/30 [01:01<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 5.459156703948975
Epoch 58/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:45, 59.50s/it]  7%|▋         | 2/30 [01:00<11:43, 25.12s/it] 10%|█         | 3/30 [01:01<06:16, 13.96s/it] 13%|█▎        | 4/30 [01:01<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.67s/it] 20%|██        | 6/30 [01:02<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 5.4226912498474125
Epoch 59/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:46, 55.40s/it]  7%|▋         | 2/30 [01:00<12:01, 25.75s/it] 10%|█         | 3/30 [01:00<06:23, 14.19s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.77s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.76s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.43s/it]
Epoch loss is 5.3901227156321205
Epoch 60/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:08, 56.15s/it]  7%|▋         | 2/30 [00:56<10:54, 23.38s/it] 10%|█         | 3/30 [00:57<05:48, 12.91s/it] 13%|█▎        | 4/30 [00:59<03:51,  8.90s/it] 17%|█▋        | 5/30 [01:00<02:26,  5.85s/it] 20%|██        | 6/30 [01:00<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.08s/it] 30%|███       | 9/30 [01:02<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.60it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 5.364983288447062
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0143, -0.0588,  0.0824,  ..., -0.0093,  0.1216,  0.0815],
        [ 0.0384, -0.0397,  0.1064,  ..., -0.0458,  0.0100,  0.1289],
        [ 0.0048, -0.0334, -0.0008,  ..., -0.0151,  0.1151,  0.0851],
        ...,
        [-0.1089, -0.0784,  0.0071,  ...,  0.0432,  0.0908,  0.0597],
        [-0.0681, -0.0640,  0.0253,  ...,  0.0537,  0.0813,  0.1035],
        [ 0.0026, -0.0712,  0.0719,  ...,  0.0110,  0.0303,  0.1204]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9306, 0.9287, 0.9139,  ..., 0.8884, 0.8865, 0.8864],
        [0.9926, 0.9920, 0.9920,  ..., 0.9855, 0.9846, 0.9832],
        [0.9979, 0.9961, 0.9939,  ..., 0.9858, 0.9848, 0.9809],
        ...,
        [0.9917, 0.9893, 0.9889,  ..., 0.9866, 0.9865, 0.9865],
        [0.9946, 0.9944, 0.9923,  ..., 0.9843, 0.9842, 0.9836],
        [0.9952, 0.9929, 0.9914,  ..., 0.9842, 0.9842, 0.9829]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 1, 0, 0],
        [0, 0, 0,  ..., 1, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 593680.1250,  577895.3125,  467484.4688,  ...,  325069.2188,
          316380.9688,  315719.6875],
        [1439286.3750, 1428035.2500, 1427434.7500,  ..., 1301252.0000,
         1283494.3750, 1259101.5000],
        [1554019.3750, 1512839.5000, 1466912.3750,  ..., 1306562.8750,
         1288680.0000, 1217382.6250],
        ...,
        [1422315.8750, 1372577.8750, 1366163.1250,  ..., 1320642.5000,
         1320373.0000, 1318883.0000],
        [1481464.7500, 1476526.7500, 1432712.8750,  ..., 1279207.5000,
         1276947.7500, 1265625.3750],
        [1494290.6250, 1446503.6250, 1415398.8750,  ..., 1277605.6250,
         1277086.6250, 1254055.2500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 593680.1250,       0.0000],
         [ 577895.3125,       0.0000],
         [ 467484.4688,       0.0000],
         ...,
         [ 325069.2188,       0.0000],
         [ 316380.9688,       0.0000],
         [ 315719.6875,       0.0000]],

        [[1439286.3750,       0.0000],
         [1428035.2500,       0.0000],
         [1427434.7500,       0.0000],
         ...,
         [      0.0000, 1301252.0000],
         [1283494.3750,       0.0000],
         [1259101.5000,       0.0000]],

        [[1554019.3750,       0.0000],
         [1512839.5000,       0.0000],
         [1466912.3750,       0.0000],
         ...,
         [      0.0000, 1306562.8750],
         [1288680.0000,       0.0000],
         [1217382.6250,       0.0000]],

        ...,

        [[1422315.8750,       0.0000],
         [1372577.8750,       0.0000],
         [1366163.1250,       0.0000],
         ...,
         [1320642.5000,       0.0000],
         [1320373.0000,       0.0000],
         [1318883.0000,       0.0000]],

        [[1481464.7500,       0.0000],
         [1476526.7500,       0.0000],
         [1432712.8750,       0.0000],
         ...,
         [1279207.5000,       0.0000],
         [1276947.7500,       0.0000],
         [1265625.3750,       0.0000]],

        [[1494290.6250,       0.0000],
         [1446503.6250,       0.0000],
         [1415398.8750,       0.0000],
         ...,
         [1277605.6250,       0.0000],
         [1277086.6250,       0.0000],
         [1254055.2500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 7695053.0000,        0.0000],
        [25687218.0000,  1301252.0000],
        [26067644.0000,  1306562.8750],
        [24053764.0000,  1158076.2500],
        [24439866.0000,  1311506.6250],
        [28758130.0000,        0.0000],
        [29234016.0000,  1577633.8750],
        [29334688.0000,  1558480.8750],
        [26140548.0000,  1410787.3750],
        [17528144.0000,        0.0000],
        [18820302.0000,  4966174.5000],
        [28568092.0000,        0.0000],
        [22629798.0000,  1327476.3750],
        [26194964.0000,  1442151.0000],
        [26210990.0000,        0.0000],
        [25098394.0000,  1273605.6250],
        [25633124.0000,  1324209.0000],
        [25308856.0000,  1266152.8750],
        [21919012.0000,  7044067.0000],
        [16424974.0000,  4193536.2500],
        [20993732.0000,  2346674.5000],
        [20442258.0000,  6830004.0000],
        [25163992.0000,  2644937.0000],
        [26418506.0000,        0.0000],
        [22052690.0000,  1268696.0000],
        [27796800.0000,        0.0000],
        [25285454.0000,  2883411.0000],
        [25204788.0000,        0.0000],
        [28311622.0000,        0.0000],
        [25682280.0000,        0.0000],
        [28003824.0000,        0.0000],
        [27249796.0000,        0.0000],
        [21944342.0000,  2490236.5000],
        [24986772.0000,  1262889.6250],
        [19258002.0000,  3171761.0000],
        [23623316.0000,  4072098.2500],
        [23259026.0000,  3966652.5000],
        [21581928.0000,  1054714.0000],
        [22035236.0000,  1055116.3750],
        [26391356.0000,  1341011.1250],
        [23767066.0000,  1142255.0000],
        [24666636.0000,  1238090.0000],
        [21305106.0000,  2040994.0000],
        [20272914.0000,  2050970.5000],
        [26573754.0000,  1383835.3750],
        [23405412.0000,        0.0000],
        [29811396.0000,        0.0000],
        [10078445.0000,  3169396.5000],
        [23354140.0000,  2699429.2500],
        [23866070.0000,  5835726.0000],
        [16943254.0000,  4346618.5000],
        [16951156.0000,  6864580.5000],
        [25212056.0000,  1393164.0000],
        [25521406.0000,        0.0000],
        [22402228.0000,  2571056.5000],
        [26094834.0000,        0.0000],
        [25507012.0000,  2900900.0000],
        [28075916.0000,        0.0000],
        [18966198.0000,  3750689.0000],
        [19290640.0000,  4703341.5000],
        [25387204.0000,  2805168.5000],
        [26822176.0000,        0.0000],
        [25436372.0000,  1339004.7500],
        [26945372.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 61/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:49, 57.58s/it]  7%|▋         | 2/30 [00:58<11:11, 23.97s/it] 10%|█         | 3/30 [00:58<05:57, 13.23s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.63s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.69s/it] 20%|██        | 6/30 [01:00<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 5.353297583262125
Epoch 62/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:32, 57.00s/it]  7%|▋         | 2/30 [00:57<11:11, 23.98s/it] 10%|█         | 3/30 [00:58<05:58, 13.28s/it] 13%|█▎        | 4/30 [00:59<03:44,  8.65s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.69s/it] 20%|██        | 6/30 [01:00<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 5.216198062896728
Epoch 63/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:43, 55.28s/it]  7%|▋         | 2/30 [00:55<10:44, 23.02s/it] 10%|█         | 3/30 [00:56<05:50, 12.97s/it] 13%|█▎        | 4/30 [01:00<03:57,  9.15s/it] 17%|█▋        | 5/30 [01:00<02:30,  6.01s/it] 20%|██        | 6/30 [01:00<01:38,  4.12s/it] 23%|██▎       | 7/30 [01:01<01:07,  2.91s/it] 27%|██▋       | 8/30 [01:01<00:46,  2.13s/it] 30%|███       | 9/30 [01:02<00:33,  1.60s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.24s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.00it/s] 40%|████      | 12/30 [01:03<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:03<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.59it/s] 50%|█████     | 15/30 [01:04<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 5.2413486321767175
Epoch 64/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:52, 55.60s/it]  7%|▋         | 2/30 [00:56<10:48, 23.16s/it] 10%|█         | 3/30 [00:56<05:45, 12.79s/it] 13%|█▎        | 4/30 [01:00<04:06,  9.48s/it] 17%|█▋        | 5/30 [01:01<02:35,  6.22s/it] 20%|██        | 6/30 [01:01<01:42,  4.26s/it] 23%|██▎       | 7/30 [01:02<01:09,  3.01s/it] 27%|██▋       | 8/30 [01:02<00:48,  2.19s/it] 30%|███       | 9/30 [01:03<00:34,  1.65s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.27s/it] 37%|███▋      | 11/30 [01:04<00:19,  1.02s/it] 40%|████      | 12/30 [01:04<00:15,  1.18it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.38it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.57it/s] 50%|█████     | 15/30 [01:05<00:08,  1.73it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.86it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.97it/s] 60%|██████    | 18/30 [01:07<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 5.206777350107829
Epoch 65/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:05, 60.17s/it]  7%|▋         | 2/30 [01:00<11:41, 25.07s/it] 10%|█         | 3/30 [01:01<06:13, 13.82s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.54s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.62s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 5.1876463731129965
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[-0.0055, -0.0641,  0.0860,  ..., -0.0175,  0.1182,  0.0826],
        [ 0.0392, -0.0451,  0.1076,  ..., -0.0441,  0.0189,  0.1236],
        [ 0.0050, -0.0418, -0.0014,  ..., -0.0248,  0.1082,  0.0876],
        ...,
        [-0.1068, -0.0877,  0.0156,  ...,  0.0324,  0.0904,  0.0592],
        [-0.0655, -0.0756,  0.0330,  ...,  0.0449,  0.0854,  0.0992],
        [ 0.0047, -0.0809,  0.0799,  ...,  0.0067,  0.0371,  0.1141]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9357, 0.9208, 0.9140,  ..., 0.8830, 0.8810, 0.8790],
        [0.9920, 0.9920, 0.9908,  ..., 0.9851, 0.9846, 0.9829],
        [0.9976, 0.9960, 0.9936,  ..., 0.9841, 0.9839, 0.9805],
        ...,
        [0.9894, 0.9864, 0.9861,  ..., 0.9831, 0.9831, 0.9830],
        [0.9937, 0.9932, 0.9914,  ..., 0.9825, 0.9824, 0.9818],
        [0.9952, 0.9919, 0.9910,  ..., 0.9831, 0.9825, 0.9823]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 1, 0, 0],
        [0, 0, 0,  ..., 1, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 638931.6250,  516100.3438,  468145.6875,  ...,  300776.6875,
          292450.8438,  284014.0312],
        [1426852.3750, 1426844.1250, 1403086.8750,  ..., 1292603.8750,
         1284534.0000, 1254192.7500],
        [1546703.6250, 1512116.8750, 1459941.2500,  ..., 1275330.3750,
         1272115.0000, 1210921.6250],
        ...,
        [1376303.1250, 1318139.7500, 1311775.5000,  ..., 1257192.5000,
         1256194.1250, 1256082.7500],
        [1462699.2500, 1451986.6250, 1415354.3750,  ..., 1246130.8750,
         1244299.6250, 1234210.2500],
        [1493321.8750, 1425635.0000, 1407226.2500,  ..., 1256417.0000,
         1245567.6250, 1243036.5000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 638931.6250,       0.0000],
         [ 516100.3438,       0.0000],
         [ 468145.6875,       0.0000],
         ...,
         [ 300776.6875,       0.0000],
         [ 292450.8438,       0.0000],
         [ 284014.0312,       0.0000]],

        [[1426852.3750,       0.0000],
         [1426844.1250,       0.0000],
         [1403086.8750,       0.0000],
         ...,
         [      0.0000, 1292603.8750],
         [1284534.0000,       0.0000],
         [1254192.7500,       0.0000]],

        [[1546703.6250,       0.0000],
         [1512116.8750,       0.0000],
         [1459941.2500,       0.0000],
         ...,
         [      0.0000, 1275330.3750],
         [1272115.0000,       0.0000],
         [1210921.6250,       0.0000]],

        ...,

        [[1376303.1250,       0.0000],
         [1318139.7500,       0.0000],
         [1311775.5000,       0.0000],
         ...,
         [1257192.5000,       0.0000],
         [1256194.1250,       0.0000],
         [1256082.7500,       0.0000]],

        [[1462699.2500,       0.0000],
         [1451986.6250,       0.0000],
         [1415354.3750,       0.0000],
         ...,
         [1246130.8750,       0.0000],
         [1244299.6250,       0.0000],
         [1234210.2500,       0.0000]],

        [[1493321.8750,       0.0000],
         [1425635.0000,       0.0000],
         [1407226.2500,       0.0000],
         ...,
         [1256417.0000,       0.0000],
         [1245567.6250,       0.0000],
         [1243036.5000,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 7078711.5000,   321598.4062],
        [25576920.0000,  1292603.8750],
        [25794316.0000,  1275330.3750],
        [23769508.0000,  1129949.0000],
        [23117876.0000,  2484541.0000],
        [28301044.0000,        0.0000],
        [29055508.0000,  1573941.5000],
        [29124390.0000,  1550267.0000],
        [26018734.0000,  1397295.6250],
        [17099900.0000,        0.0000],
        [18542244.0000,  4954703.0000],
        [26829348.0000,  1339401.8750],
        [22105350.0000,  1314170.8750],
        [26052824.0000,  1446487.2500],
        [26256082.0000,        0.0000],
        [24944156.0000,  1223963.3750],
        [25508342.0000,  1326661.2500],
        [25106702.0000,  1266195.1250],
        [20299610.0000,  8263445.5000],
        [16430672.0000,  4198887.0000],
        [20976506.0000,  2319246.5000],
        [20066212.0000,  6691839.0000],
        [25097736.0000,  2620825.7500],
        [26301528.0000,        0.0000],
        [22001876.0000,  1280942.3750],
        [27609716.0000,        0.0000],
        [25086856.0000,  2870653.0000],
        [24944736.0000,        0.0000],
        [28046900.0000,        0.0000],
        [25743732.0000,        0.0000],
        [27997734.0000,        0.0000],
        [27127160.0000,        0.0000],
        [21305596.0000,  2479235.5000],
        [24893042.0000,  1246595.5000],
        [19294000.0000,  3111068.7500],
        [24736270.0000,  2725388.0000],
        [22994018.0000,  3903692.5000],
        [21558252.0000,  1073702.3750],
        [21818128.0000,  1023618.8750],
        [26316076.0000,  1339953.8750],
        [23396156.0000,  1161399.7500],
        [24478052.0000,  1231622.2500],
        [21766678.0000,  1018117.1250],
        [19612292.0000,  1953129.7500],
        [26348448.0000,  1394508.0000],
        [23290116.0000,        0.0000],
        [29659184.0000,        0.0000],
        [10141164.0000,  2645278.5000],
        [23000240.0000,  2659035.0000],
        [23713368.0000,  5782366.0000],
        [16536262.0000,  4245992.0000],
        [16966864.0000,  6799787.0000],
        [24932958.0000,  1389614.6250],
        [25215194.0000,        0.0000],
        [22166476.0000,  2532644.0000],
        [25927178.0000,        0.0000],
        [25210772.0000,  2907339.5000],
        [27655408.0000,        0.0000],
        [18695708.0000,  3752110.0000],
        [19768382.0000,  3550173.2500],
        [25007148.0000,  2744584.5000],
        [25620382.0000,        0.0000],
        [24988072.0000,  1332786.2500],
        [26639656.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 66/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.08s/it]  7%|▋         | 2/30 [00:57<11:05, 23.77s/it] 10%|█         | 3/30 [01:00<06:22, 14.17s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.75s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.75s/it] 20%|██        | 6/30 [01:01<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 5.229086081186931
Epoch 67/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:13, 60.46s/it]  7%|▋         | 2/30 [01:00<11:44, 25.15s/it] 10%|█         | 3/30 [01:01<06:14, 13.87s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 5.218909629185995
Epoch 68/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:05, 60.19s/it]  7%|▋         | 2/30 [01:00<11:41, 25.05s/it] 10%|█         | 3/30 [01:01<06:12, 13.81s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 5.090091768900553
Epoch 69/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:56, 59.89s/it]  7%|▋         | 2/30 [01:00<11:37, 24.93s/it] 10%|█         | 3/30 [01:00<06:11, 13.75s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.71s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.73s/it] 20%|██        | 6/30 [01:02<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 5.155089124043783
Epoch 70/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:39, 55.17s/it]  7%|▋         | 2/30 [00:58<11:35, 24.83s/it] 10%|█         | 3/30 [01:00<06:25, 14.29s/it] 13%|█▎        | 4/30 [01:01<03:51,  8.91s/it] 17%|█▋        | 5/30 [01:01<02:26,  5.85s/it] 20%|██        | 6/30 [01:02<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.08s/it] 30%|███       | 9/30 [01:03<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 5.048930581410726
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0041, -0.0691,  0.0889,  ..., -0.0215,  0.1156,  0.0834],
        [ 0.0416, -0.0490,  0.1094,  ..., -0.0391,  0.0271,  0.1200],
        [ 0.0060, -0.0504, -0.0016,  ..., -0.0318,  0.1022,  0.0898],
        ...,
        [-0.1032, -0.0936,  0.0231,  ...,  0.0256,  0.0914,  0.0581],
        [-0.0611, -0.0840,  0.0398,  ...,  0.0386,  0.0900,  0.0944],
        [ 0.0080, -0.0880,  0.0877,  ...,  0.0056,  0.0443,  0.1081]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9377, 0.9129, 0.9127,  ..., 0.8801, 0.8767, 0.8751],
        [0.9919, 0.9912, 0.9905,  ..., 0.9845, 0.9844, 0.9828],
        [0.9972, 0.9960, 0.9931,  ..., 0.9829, 0.9823, 0.9799],
        ...,
        [0.9862, 0.9831, 0.9823,  ..., 0.9786, 0.9786, 0.9780],
        [0.9932, 0.9913, 0.9907,  ..., 0.9813, 0.9808, 0.9802],
        [0.9949, 0.9909, 0.9907,  ..., 0.9824, 0.9819, 0.9817]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 657266.2500,  461408.8750,  459724.8438,  ...,  288770.6562,
          274948.1562,  268735.0000],
        [1426271.3750, 1411997.2500, 1397800.7500,  ..., 1282372.3750,
         1280026.5000, 1251272.8750],
        [1538462.3750, 1511518.5000, 1449930.2500,  ..., 1253263.7500,
         1242343.1250, 1201322.7500],
        ...,
        [1313138.6250, 1257151.7500, 1242030.3750,  ..., 1178535.3750,
         1177989.3750, 1168783.1250],
        [1451463.2500, 1412367.6250, 1400736.5000,  ..., 1224325.2500,
         1216092.2500, 1206599.7500],
        [1488401.1250, 1405368.8750, 1400655.1250,  ..., 1244921.5000,
         1235245.2500, 1232693.8750]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 657266.2500,       0.0000],
         [ 461408.8750,       0.0000],
         [ 459724.8438,       0.0000],
         ...,
         [ 288770.6562,       0.0000],
         [ 274948.1562,       0.0000],
         [ 268735.0000,       0.0000]],

        [[1426271.3750,       0.0000],
         [1411997.2500,       0.0000],
         [1397800.7500,       0.0000],
         ...,
         [1282372.3750,       0.0000],
         [      0.0000, 1280026.5000],
         [1251272.8750,       0.0000]],

        [[1538462.3750,       0.0000],
         [1511518.5000,       0.0000],
         [1449930.2500,       0.0000],
         ...,
         [1253263.7500,       0.0000],
         [      0.0000, 1242343.1250],
         [1201322.7500,       0.0000]],

        ...,

        [[1313138.6250,       0.0000],
         [1257151.7500,       0.0000],
         [1242030.3750,       0.0000],
         ...,
         [1178535.3750,       0.0000],
         [1177989.3750,       0.0000],
         [1168783.1250,       0.0000]],

        [[1451463.2500,       0.0000],
         [1412367.6250,       0.0000],
         [1400736.5000,       0.0000],
         ...,
         [1224325.2500,       0.0000],
         [1216092.2500,       0.0000],
         [1206599.7500,       0.0000]],

        [[1488401.1250,       0.0000],
         [1405368.8750,       0.0000],
         [1400655.1250,       0.0000],
         ...,
         [1244921.5000,       0.0000],
         [1235245.2500,       0.0000],
         [1232693.8750,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 6527130.0000,   623703.1250],
        [25451620.0000,  1280026.5000],
        [25505436.0000,  1242343.1250],
        [24430606.0000,        0.0000],
        [22887848.0000,  2465640.5000],
        [27784718.0000,        0.0000],
        [28818280.0000,  1568246.3750],
        [28862834.0000,  1539495.7500],
        [25870196.0000,  1379800.2500],
        [16663795.0000,        0.0000],
        [18381282.0000,  4947909.0000],
        [26400964.0000,  1312065.8750],
        [21430536.0000,  1293547.3750],
        [25863628.0000,  1445539.7500],
        [26238520.0000,        0.0000],
        [24723404.0000,  1164486.2500],
        [25379810.0000,  1332002.2500],
        [24943094.0000,  1271151.0000],
        [20008902.0000,  8127739.5000],
        [16433464.0000,  4196013.0000],
        [20987610.0000,  2281839.5000],
        [20909070.0000,  5386842.0000],
        [25031574.0000,  2599760.0000],
        [26143042.0000,        0.0000],
        [21826478.0000,  1278697.7500],
        [27445422.0000,        0.0000],
        [24873488.0000,  2846441.5000],
        [24850156.0000,        0.0000],
        [27868276.0000,        0.0000],
        [25784976.0000,        0.0000],
        [28000404.0000,        0.0000],
        [26982744.0000,        0.0000],
        [20632896.0000,  2460410.0000],
        [24788204.0000,  1225239.8750],
        [20344390.0000,  2100444.2500],
        [24587748.0000,  2676865.0000],
        [22670680.0000,  3836030.5000],
        [20602792.0000,  2078636.0000],
        [20653638.0000,  1938996.0000],
        [26228660.0000,  1344128.7500],
        [22977064.0000,  1173984.3750],
        [24322096.0000,  1223451.0000],
        [21146264.0000,  1016910.0625],
        [19001536.0000,  1862717.0000],
        [25969848.0000,  1403829.7500],
        [23020126.0000,        0.0000],
        [29393128.0000,        0.0000],
        [ 9884986.0000,  2584593.7500],
        [22555176.0000,  2613257.5000],
        [26349486.0000,  2905663.0000],
        [16191786.0000,  4142971.2500],
        [16948148.0000,  6710872.5000],
        [24494712.0000,  1386125.6250],
        [24875350.0000,        0.0000],
        [21986246.0000,  2488076.0000],
        [25733036.0000,        0.0000],
        [24717752.0000,  2909011.5000],
        [27153334.0000,        0.0000],
        [18450464.0000,  3746768.0000],
        [19199392.0000,  3436026.0000],
        [24646894.0000,  2684107.5000],
        [24104688.0000,        0.0000],
        [24610664.0000,  1330287.2500],
        [26338284.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 71/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:04, 60.14s/it]  7%|▋         | 2/30 [01:00<11:40, 25.02s/it] 10%|█         | 3/30 [01:01<06:12, 13.80s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 5.034104379018148
Epoch 72/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:29, 56.88s/it]  7%|▋         | 2/30 [00:57<11:03, 23.68s/it] 10%|█         | 3/30 [00:59<06:13, 13.84s/it] 13%|█▎        | 4/30 [00:59<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.63s/it] 20%|██        | 6/30 [01:00<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 5.07301861445109
Epoch 73/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:26, 60.90s/it]  7%|▋         | 2/30 [01:01<11:49, 25.33s/it] 10%|█         | 3/30 [01:01<06:17, 13.97s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.63s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.67s/it] 20%|██        | 6/30 [01:03<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 4.990625111262004
Epoch 74/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:29, 58.93s/it]  7%|▋         | 2/30 [00:59<11:26, 24.53s/it] 10%|█         | 3/30 [01:01<06:29, 14.41s/it] 13%|█▎        | 4/30 [01:02<03:51,  8.89s/it] 17%|█▋        | 5/30 [01:02<02:26,  5.85s/it] 20%|██        | 6/30 [01:03<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.08s/it] 30%|███       | 9/30 [01:04<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 5.049549849828084
Epoch 75/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:30, 58.97s/it]  7%|▋         | 2/30 [00:59<11:31, 24.69s/it] 10%|█         | 3/30 [01:00<06:07, 13.62s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.42s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.54s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 5.025714763005575
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0124, -0.0721,  0.0913,  ..., -0.0257,  0.1143,  0.0847],
        [ 0.0449, -0.0511,  0.1107,  ..., -0.0362,  0.0338,  0.1187],
        [ 0.0068, -0.0577, -0.0022,  ..., -0.0385,  0.0977,  0.0927],
        ...,
        [-0.0992, -0.0978,  0.0277,  ...,  0.0195,  0.0917,  0.0549],
        [-0.0570, -0.0903,  0.0442,  ...,  0.0330,  0.0933,  0.0889],
        [ 0.0113, -0.0934,  0.0940,  ...,  0.0041,  0.0495,  0.1031]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9384, 0.9114, 0.9054,  ..., 0.8761, 0.8751, 0.8749],
        [0.9920, 0.9904, 0.9902,  ..., 0.9837, 0.9833, 0.9825],
        [0.9969, 0.9959, 0.9924,  ..., 0.9811, 0.9802, 0.9790],
        ...,
        [0.9822, 0.9794, 0.9792,  ..., 0.9732, 0.9729, 0.9726],
        [0.9926, 0.9903, 0.9898,  ..., 0.9794, 0.9787, 0.9786],
        [0.9944, 0.9902, 0.9896,  ..., 0.9801, 0.9800, 0.9799]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 664039.2500,  451497.2812,  414339.3750,  ...,  272767.6250,
          268858.3125,  267907.7188],
        [1426559.7500, 1395436.6250, 1390315.7500,  ..., 1268197.6250,
         1260254.7500, 1246275.8750],
        [1529973.2500, 1509452.7500, 1435567.1250,  ..., 1222488.7500,
         1205823.3750, 1186230.1250],
        ...,
        [1241514.1250, 1193040.7500, 1188190.0000,  ..., 1091773.1250,
         1086301.8750, 1081570.5000],
        [1440161.0000, 1393614.5000, 1384198.3750,  ..., 1192535.6250,
         1180578.2500, 1179130.1250],
        [1477803.1250, 1390505.3750, 1378696.6250,  ..., 1204547.6250,
         1203121.6250, 1200162.7500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 664039.2500,       0.0000],
         [ 451497.2812,       0.0000],
         [ 414339.3750,       0.0000],
         ...,
         [ 272767.6250,       0.0000],
         [ 268858.3125,       0.0000],
         [ 267907.7188,       0.0000]],

        [[1426559.7500,       0.0000],
         [1395436.6250,       0.0000],
         [1390315.7500,       0.0000],
         ...,
         [1268197.6250,       0.0000],
         [      0.0000, 1260254.7500],
         [1246275.8750,       0.0000]],

        [[1529973.2500,       0.0000],
         [1509452.7500,       0.0000],
         [1435567.1250,       0.0000],
         ...,
         [1222488.7500,       0.0000],
         [      0.0000, 1205823.3750],
         [1186230.1250,       0.0000]],

        ...,

        [[1241514.1250,       0.0000],
         [1193040.7500,       0.0000],
         [1188190.0000,       0.0000],
         ...,
         [1091773.1250,       0.0000],
         [1086301.8750,       0.0000],
         [1081570.5000,       0.0000]],

        [[1440161.0000,       0.0000],
         [1393614.5000,       0.0000],
         [1384198.3750,       0.0000],
         ...,
         [1192535.6250,       0.0000],
         [1180578.2500,       0.0000],
         [1179130.1250,       0.0000]],

        [[1477803.1250,       0.0000],
         [1390505.3750,       0.0000],
         [1378696.6250,       0.0000],
         ...,
         [1204547.6250,       0.0000],
         [1203121.6250,       0.0000],
         [1200162.7500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 6324964.0000,   647575.3750],
        [25272638.0000,  1260254.7500],
        [25223646.0000,  1205823.3750],
        [23831332.0000,        0.0000],
        [22499182.0000,  2433054.0000],
        [27335024.0000,        0.0000],
        [28550774.0000,  1560661.2500],
        [28540964.0000,  1525747.7500],
        [24470434.0000,  2599586.7500],
        [16324883.0000,        0.0000],
        [18177028.0000,  4936152.0000],
        [25898562.0000,  1276528.8750],
        [20757248.0000,  1272939.1250],
        [25587460.0000,  1437492.0000],
        [26057082.0000,        0.0000],
        [25584716.0000,        0.0000],
        [25263242.0000,  1337602.1250],
        [24803472.0000,  1275057.8750],
        [17095654.0000, 10574938.0000],
        [17178754.0000,  3334871.2500],
        [21958764.0000,  1302507.2500],
        [20553912.0000,  5300012.0000],
        [24877856.0000,  2552705.2500],
        [25891860.0000,        0.0000],
        [21545498.0000,  1270775.1250],
        [27205386.0000,        0.0000],
        [24609776.0000,  2809730.0000],
        [24812848.0000,        0.0000],
        [27670376.0000,        0.0000],
        [25644064.0000,        0.0000],
        [27957202.0000,        0.0000],
        [26771702.0000,        0.0000],
        [19936636.0000,  2428248.0000],
        [24595468.0000,  1196095.0000],
        [20380194.0000,  2078412.5000],
        [24437380.0000,  2625455.7500],
        [23441380.0000,  2636667.5000],
        [20622060.0000,  2121232.5000],
        [21303096.0000,   960483.6875],
        [26097558.0000,  1343144.7500],
        [22372580.0000,  1171881.3750],
        [24169508.0000,  1218121.2500],
        [20396036.0000,  1010102.5625],
        [18348510.0000,  1759174.5000],
        [24128604.0000,  2661405.0000],
        [22538590.0000,        0.0000],
        [29060210.0000,        0.0000],
        [ 9215726.0000,  2940487.0000],
        [21930028.0000,  2556912.5000],
        [26104652.0000,  2883374.5000],
        [15828590.0000,  4041965.5000],
        [17820176.0000,  5645281.5000],
        [23951952.0000,  1381423.7500],
        [24398340.0000,        0.0000],
        [20581006.0000,  3529697.0000],
        [25403080.0000,        0.0000],
        [22734280.0000,  4207007.5000],
        [26475594.0000,        0.0000],
        [18098018.0000,  3734649.0000],
        [17652608.0000,  4251169.5000],
        [24269244.0000,  2620319.5000],
        [21412682.0000,  1092365.7500],
        [23006024.0000,  2520739.5000],
        [25991924.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 76/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:05, 58.12s/it]  7%|▋         | 2/30 [00:58<11:24, 24.43s/it] 10%|█         | 3/30 [00:59<06:04, 13.50s/it] 13%|█▎        | 4/30 [00:59<03:36,  8.34s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.49s/it] 20%|██        | 6/30 [01:00<01:30,  3.78s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.68s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.97s/it] 30%|███       | 9/30 [01:02<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.01it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.22it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.24it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.24it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.25it/s]100%|██████████| 30/30 [01:11<00:00,  2.25it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 4.987111520767212
Epoch 77/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:58, 55.80s/it]  7%|▋         | 2/30 [00:59<11:47, 25.27s/it] 10%|█         | 3/30 [01:00<06:16, 13.93s/it] 13%|█▎        | 4/30 [01:00<03:43,  8.61s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.66s/it] 20%|██        | 6/30 [01:01<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 4.998873519897461
Epoch 78/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:24, 56.72s/it]  7%|▋         | 2/30 [01:00<11:52, 25.43s/it] 10%|█         | 3/30 [01:00<06:18, 14.02s/it] 13%|█▎        | 4/30 [01:01<03:45,  8.66s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.70s/it] 20%|██        | 6/30 [01:02<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 5.0248732725779215
Epoch 79/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:54, 55.68s/it]  7%|▋         | 2/30 [01:00<12:01, 25.78s/it] 10%|█         | 3/30 [01:00<06:23, 14.21s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.77s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.77s/it] 20%|██        | 6/30 [01:02<01:34,  3.96s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.9242586930592855
Epoch 80/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:54, 57.73s/it]  7%|▋         | 2/30 [01:00<11:47, 25.28s/it] 10%|█         | 3/30 [01:00<06:16, 13.94s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.61s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.66s/it] 20%|██        | 6/30 [01:02<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 4.877661069234212
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0218, -0.0742,  0.0927,  ..., -0.0280,  0.1129,  0.0856],
        [ 0.0490, -0.0524,  0.1108,  ..., -0.0323,  0.0413,  0.1186],
        [ 0.0103, -0.0651, -0.0030,  ..., -0.0453,  0.0916,  0.0964],
        ...,
        [-0.0960, -0.0980,  0.0318,  ...,  0.0175,  0.0920,  0.0524],
        [-0.0536, -0.0933,  0.0477,  ...,  0.0298,  0.0960,  0.0847],
        [ 0.0145, -0.0956,  0.0989,  ...,  0.0048,  0.0544,  0.0994]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9378, 0.9100, 0.9032,  ..., 0.8742, 0.8735, 0.8726],
        [0.9921, 0.9899, 0.9897,  ..., 0.9824, 0.9824, 0.9819],
        [0.9964, 0.9958, 0.9923,  ..., 0.9791, 0.9781, 0.9775],
        ...,
        [0.9774, 0.9762, 0.9760,  ..., 0.9673, 0.9672, 0.9672],
        [0.9919, 0.9907, 0.9889,  ..., 0.9770, 0.9770, 0.9769],
        [0.9937, 0.9895, 0.9882,  ..., 0.9791, 0.9788, 0.9782]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 657725.8750,  442682.6562,  401246.5625,  ...,  265393.4688,
          262782.2812,  259466.0312],
        [1428670.1250, 1386231.3750, 1380695.2500,  ..., 1245419.1250,
         1245127.0000, 1236566.5000],
        [1519895.0000, 1506053.6250, 1433307.3750,  ..., 1187732.3750,
         1169724.2500, 1159911.0000],
        ...,
        [1157958.0000, 1138924.3750, 1135190.7500,  ..., 1002975.2500,
         1002317.4375, 1000984.8125],
        [1426095.8750, 1401598.3750, 1364929.8750,  ..., 1152171.6250,
         1151380.7500, 1150000.2500],
        [1462883.3750, 1377718.6250, 1351543.0000,  ..., 1187689.2500,
         1182518.6250, 1171450.1250]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 657725.8750,       0.0000],
         [ 442682.6562,       0.0000],
         [ 401246.5625,       0.0000],
         ...,
         [ 265393.4688,       0.0000],
         [      0.0000,  262782.2812],
         [ 259466.0312,       0.0000]],

        [[1428670.1250,       0.0000],
         [1386231.3750,       0.0000],
         [1380695.2500,       0.0000],
         ...,
         [1245419.1250,       0.0000],
         [1245127.0000,       0.0000],
         [      0.0000, 1236566.5000]],

        [[1519895.0000,       0.0000],
         [1506053.6250,       0.0000],
         [1433307.3750,       0.0000],
         ...,
         [1187732.3750,       0.0000],
         [1169724.2500,       0.0000],
         [      0.0000, 1159911.0000]],

        ...,

        [[1157958.0000,       0.0000],
         [1138924.3750,       0.0000],
         [1135190.7500,       0.0000],
         ...,
         [1002975.2500,       0.0000],
         [      0.0000, 1002317.4375],
         [1000984.8125,       0.0000]],

        [[1426095.8750,       0.0000],
         [1401598.3750,       0.0000],
         [1364929.8750,       0.0000],
         ...,
         [1152171.6250,       0.0000],
         [1151380.7500,       0.0000],
         [1150000.2500,       0.0000]],

        [[1462883.3750,       0.0000],
         [1377718.6250,       0.0000],
         [1351543.0000,       0.0000],
         ...,
         [1187689.2500,       0.0000],
         [1182518.6250,       0.0000],
         [1171450.1250,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 5909265.0000,   936153.8750],
        [25119468.0000,  1236566.5000],
        [24885654.0000,  1159911.0000],
        [23109214.0000,        0.0000],
        [21969148.0000,  2383951.0000],
        [26997220.0000,        0.0000],
        [28230990.0000,  1550931.0000],
        [28165034.0000,  1509558.0000],
        [24323470.0000,  2580175.0000],
        [16057505.0000,        0.0000],
        [18133000.0000,  4921306.0000],
        [26622602.0000,        0.0000],
        [20062764.0000,  1253225.5000],
        [25251852.0000,  1424857.5000],
        [25812594.0000,        0.0000],
        [25271856.0000,        0.0000],
        [25111500.0000,  1330105.7500],
        [24588628.0000,  1278588.0000],
        [18028362.0000,  9148267.0000],
        [17069360.0000,  3301574.2500],
        [21974668.0000,  1297687.8750],
        [20173562.0000,  5193865.5000],
        [25908472.0000,  1284356.2500],
        [25619004.0000,        0.0000],
        [21204080.0000,  1254244.1250],
        [26925604.0000,        0.0000],
        [24350994.0000,  2761619.5000],
        [24790502.0000,        0.0000],
        [27494970.0000,        0.0000],
        [25432980.0000,        0.0000],
        [27887562.0000,        0.0000],
        [26583828.0000,        0.0000],
        [19220308.0000,  2367494.5000],
        [24357592.0000,  1158924.7500],
        [20374936.0000,  2064188.8750],
        [24272684.0000,  2570070.7500],
        [22957462.0000,  2600253.5000],
        [20564148.0000,  2148006.0000],
        [20999910.0000,   966103.1250],
        [25969472.0000,  1341472.8750],
        [21741148.0000,  1164908.3750],
        [23903062.0000,  1205763.6250],
        [19654712.0000,   993894.3750],
        [18570356.0000,   846475.1250],
        [23452100.0000,  2653643.5000],
        [21919910.0000,        0.0000],
        [28657734.0000,        0.0000],
        [ 9388007.0000,  2483449.0000],
        [21241910.0000,  2495694.5000],
        [25805772.0000,  2854818.7500],
        [15449894.0000,  3954174.2500],
        [17671328.0000,  5621228.5000],
        [23387220.0000,  1373384.3750],
        [23827186.0000,        0.0000],
        [20279500.0000,  3458493.0000],
        [25082240.0000,        0.0000],
        [21850038.0000,  4196820.0000],
        [24488206.0000,  1229294.1250],
        [17732880.0000,  3731231.2500],
        [17081270.0000,  4124699.0000],
        [23839972.0000,  2552737.5000],
        [18060150.0000,  3104006.7500],
        [22574396.0000,  2496947.0000],
        [25663986.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 81/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:14, 56.36s/it]  7%|▋         | 2/30 [00:57<11:07, 23.84s/it] 10%|█         | 3/30 [00:57<05:55, 13.16s/it] 13%|█▎        | 4/30 [00:58<03:31,  8.14s/it] 17%|█▋        | 5/30 [01:00<02:33,  6.15s/it] 20%|██        | 6/30 [01:01<01:41,  4.21s/it] 23%|██▎       | 7/30 [01:01<01:08,  2.98s/it] 27%|██▋       | 8/30 [01:02<00:47,  2.17s/it] 30%|███       | 9/30 [01:02<00:34,  1.63s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.01s/it] 40%|████      | 12/30 [01:04<00:15,  1.19it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.39it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.58it/s] 50%|█████     | 15/30 [01:05<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.97it/s] 60%|██████    | 18/30 [01:06<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 4.905285628636678
Epoch 82/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:09, 58.26s/it]  7%|▋         | 2/30 [00:58<11:18, 24.25s/it] 10%|█         | 3/30 [00:59<06:01, 13.38s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.27s/it] 17%|█▋        | 5/30 [01:00<02:16,  5.45s/it] 20%|██        | 6/30 [01:00<01:29,  3.75s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.67s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.96s/it] 30%|███       | 9/30 [01:01<00:31,  1.48s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.16s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.01it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 4.917118136088053
Epoch 83/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.08s/it]  7%|▋         | 2/30 [00:57<11:05, 23.76s/it] 10%|█         | 3/30 [00:57<05:54, 13.11s/it] 13%|█▎        | 4/30 [00:58<03:35,  8.29s/it] 17%|█▋        | 5/30 [00:59<02:19,  5.56s/it] 20%|██        | 6/30 [01:00<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:00<00:43,  1.99s/it] 30%|███       | 9/30 [01:01<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:03<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.01it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 4.863419866561889
Epoch 84/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:35, 61.21s/it]  7%|▋         | 2/30 [01:01<11:52, 25.46s/it] 10%|█         | 3/30 [01:02<06:18, 14.04s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.70s/it] 20%|██        | 6/30 [01:03<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 4.8735146204630535
Epoch 85/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:42, 57.31s/it]  7%|▋         | 2/30 [00:59<11:43, 25.11s/it] 10%|█         | 3/30 [01:00<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.56s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.63s/it] 20%|██        | 6/30 [01:01<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 4.805554421742757
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0297, -0.0743,  0.0947,  ..., -0.0304,  0.1118,  0.0856],
        [ 0.0514, -0.0518,  0.1113,  ..., -0.0282,  0.0471,  0.1185],
        [ 0.0139, -0.0694, -0.0028,  ..., -0.0504,  0.0851,  0.0989],
        ...,
        [-0.0951, -0.0973,  0.0351,  ...,  0.0160,  0.0928,  0.0492],
        [-0.0530, -0.0948,  0.0501,  ...,  0.0268,  0.0981,  0.0805],
        [ 0.0149, -0.0963,  0.1031,  ...,  0.0056,  0.0584,  0.0958]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9359, 0.9073, 0.9018,  ..., 0.8718, 0.8679, 0.8673],
        [0.9922, 0.9898, 0.9892,  ..., 0.9818, 0.9814, 0.9812],
        [0.9959, 0.9955, 0.9922,  ..., 0.9772, 0.9771, 0.9763],
        ...,
        [0.9763, 0.9738, 0.9736,  ..., 0.9621, 0.9613, 0.9612],
        [0.9913, 0.9904, 0.9877,  ..., 0.9756, 0.9747, 0.9745],
        [0.9926, 0.9887, 0.9866,  ..., 0.9783, 0.9780, 0.9771]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 640332.1875,  425378.8125,  393461.3438,  ...,  256257.3594,
          242388.0938,  240317.7031],
        [1432159.6250, 1382413.3750, 1372426.1250,  ..., 1233937.2500,
         1227561.5000, 1222648.6250],
        [1508503.1250, 1501610.5000, 1431270.7500,  ..., 1156169.3750,
         1153081.7500, 1140531.8750],
        ...,
        [1140508.0000, 1100830.3750, 1097703.1250,  ...,  930666.3750,
          920998.2500,  919866.7500],
        [1412305.7500, 1396191.3750, 1342503.1250,  ..., 1129265.0000,
         1114532.3750, 1111711.7500],
        [1440541.5000, 1361949.6250, 1322212.6250,  ..., 1174124.3750,
         1168911.2500, 1154277.6250]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 640332.1875,       0.0000],
         [ 425378.8125,       0.0000],
         [ 393461.3438,       0.0000],
         ...,
         [ 256257.3594,       0.0000],
         [ 242388.0938,       0.0000],
         [ 240317.7031,       0.0000]],

        [[1432159.6250,       0.0000],
         [1382413.3750,       0.0000],
         [1372426.1250,       0.0000],
         ...,
         [1233937.2500,       0.0000],
         [1227561.5000,       0.0000],
         [1222648.6250,       0.0000]],

        [[1508503.1250,       0.0000],
         [1501610.5000,       0.0000],
         [1431270.7500,       0.0000],
         ...,
         [1156169.3750,       0.0000],
         [1153081.7500,       0.0000],
         [1140531.8750,       0.0000]],

        ...,

        [[1140508.0000,       0.0000],
         [1100830.3750,       0.0000],
         [1097703.1250,       0.0000],
         ...,
         [ 930666.3750,       0.0000],
         [ 920998.2500,       0.0000],
         [ 919866.7500,       0.0000]],

        [[1412305.7500,       0.0000],
         [1396191.3750,       0.0000],
         [1342503.1250,       0.0000],
         ...,
         [1129265.0000,       0.0000],
         [1114532.3750,       0.0000],
         [      0.0000, 1111711.7500]],

        [[1440541.5000,       0.0000],
         [1361949.6250,       0.0000],
         [1322212.6250,       0.0000],
         ...,
         [1174124.3750,       0.0000],
         [1168911.2500,       0.0000],
         [1154277.6250,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 5701213.0000,   954757.5000],
        [26196030.0000,        0.0000],
        [25665922.0000,        0.0000],
        [22192824.0000,        0.0000],
        [21189092.0000,  2311477.0000],
        [26530960.0000,        0.0000],
        [27892892.0000,  1538927.6250],
        [27782714.0000,  1490911.3750],
        [24188218.0000,  2560021.5000],
        [15862648.0000,        0.0000],
        [17143710.0000,  5790056.0000],
        [26045744.0000,        0.0000],
        [19304506.0000,  1226951.7500],
        [24888546.0000,  1409263.7500],
        [25477140.0000,        0.0000],
        [24897508.0000,        0.0000],
        [24943258.0000,  1316663.5000],
        [24373804.0000,  1282153.5000],
        [17708046.0000,  9012700.0000],
        [16821610.0000,  3232040.0000],
        [21953378.0000,  1288544.7500],
        [19774646.0000,  5074857.0000],
        [25667324.0000,  1266222.8750],
        [25278408.0000,        0.0000],
        [20808248.0000,  1233227.7500],
        [26582532.0000,        0.0000],
        [24092872.0000,  2701187.5000],
        [24773760.0000,        0.0000],
        [27272480.0000,        0.0000],
        [25100528.0000,        0.0000],
        [27782726.0000,        0.0000],
        [26331806.0000,        0.0000],
        [18370612.0000,  2289846.2500],
        [25200942.0000,        0.0000],
        [20345152.0000,  2047915.5000],
        [24075780.0000,  2508478.5000],
        [22411092.0000,  2561142.0000],
        [20416992.0000,  2162228.7500],
        [19685976.0000,  1891679.0000],
        [25828198.0000,  1341859.2500],
        [20215434.0000,  2008438.2500],
        [23525378.0000,  1179712.7500],
        [18735300.0000,   954761.1875],
        [17875592.0000,   798805.5000],
        [21534820.0000,  3782282.7500],
        [21100458.0000,        0.0000],
        [28159032.0000,        0.0000],
        [ 9000406.0000,  2401990.5000],
        [19387976.0000,  3457651.5000],
        [25535626.0000,  2820045.0000],
        [14814136.0000,  3796905.5000],
        [17429642.0000,  5571175.5000],
        [22693506.0000,  1365919.5000],
        [23120836.0000,        0.0000],
        [19885286.0000,  3372908.2500],
        [24731708.0000,        0.0000],
        [20948902.0000,  4170695.0000],
        [23734886.0000,  1233397.1250],
        [17322928.0000,  3709167.5000],
        [17327400.0000,  3139002.7500],
        [23351180.0000,  2482891.5000],
        [16161326.0000,  3924133.0000],
        [21020540.0000,  3566783.2500],
        [25257328.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 86/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:53, 55.63s/it]  7%|▋         | 2/30 [00:56<10:55, 23.41s/it] 10%|█         | 3/30 [00:59<06:15, 13.90s/it] 13%|█▎        | 4/30 [01:00<03:51,  8.92s/it] 17%|█▋        | 5/30 [01:00<02:26,  5.86s/it] 20%|██        | 6/30 [01:01<01:36,  4.02s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.08s/it] 30%|███       | 9/30 [01:02<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 4.784535582860311
Epoch 87/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:53, 59.78s/it]  7%|▋         | 2/30 [01:00<11:36, 24.88s/it] 10%|█         | 3/30 [01:00<06:10, 13.72s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.48s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.58s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 4.809036779403686
Epoch 88/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:56, 55.76s/it]  7%|▋         | 2/30 [00:59<11:37, 24.90s/it] 10%|█         | 3/30 [00:59<06:10, 13.73s/it] 13%|█▎        | 4/30 [00:59<03:40,  8.49s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.58s/it] 20%|██        | 6/30 [01:00<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:01<00:43,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 4.7993801434834795
Epoch 89/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:46, 59.53s/it]  7%|▋         | 2/30 [00:59<11:33, 24.77s/it] 10%|█         | 3/30 [01:00<06:08, 13.66s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.44s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.56s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 4.716156911849976
Epoch 90/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:14, 56.37s/it]  7%|▋         | 2/30 [00:57<11:00, 23.60s/it] 10%|█         | 3/30 [00:57<05:51, 13.03s/it] 13%|█▎        | 4/30 [00:59<03:41,  8.51s/it] 17%|█▋        | 5/30 [00:59<02:20,  5.60s/it] 20%|██        | 6/30 [00:59<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:00<00:44,  2.00s/it] 30%|███       | 9/30 [01:01<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.62it/s] 50%|█████     | 15/30 [01:03<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 4.737706979115804
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0350, -0.0732,  0.0966,  ..., -0.0318,  0.1110,  0.0848],
        [ 0.0534, -0.0490,  0.1127,  ..., -0.0241,  0.0513,  0.1180],
        [ 0.0179, -0.0725, -0.0021,  ..., -0.0538,  0.0801,  0.1014],
        ...,
        [-0.0951, -0.0967,  0.0376,  ...,  0.0150,  0.0940,  0.0466],
        [-0.0531, -0.0968,  0.0522,  ...,  0.0234,  0.1003,  0.0772],
        [ 0.0156, -0.0968,  0.1078,  ...,  0.0057,  0.0613,  0.0933]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9342, 0.9052, 0.9032,  ..., 0.8708, 0.8672, 0.8667],
        [0.9924, 0.9894, 0.9893,  ..., 0.9816, 0.9815, 0.9808],
        [0.9953, 0.9952, 0.9921,  ..., 0.9757, 0.9754, 0.9754],
        ...,
        [0.9765, 0.9735, 0.9716,  ..., 0.9581, 0.9576, 0.9573],
        [0.9903, 0.9898, 0.9860,  ..., 0.9738, 0.9731, 0.9725],
        [0.9913, 0.9876, 0.9858,  ..., 0.9769, 0.9765, 0.9756]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 625097.0000,  413005.5312,  401241.1875,  ...,  252556.2344,
          240201.2969,  238430.2656],
        [1435253.7500, 1374852.1250, 1373819.3750,  ..., 1230295.7500,
         1227776.8750, 1216116.6250],
        [1496551.1250, 1494373.3750, 1429113.0000,  ..., 1130478.2500,
         1126631.6250, 1125343.1250],
        ...,
        [1144457.6250, 1096510.3750, 1066931.8750,  ...,  879521.1250,
          872680.7500,  869477.5000],
        [1393526.8750, 1383816.7500, 1310685.1250,  ..., 1100293.0000,
         1089154.5000, 1080210.8750],
        [1412964.5000, 1340503.5000, 1306367.2500,  ..., 1150958.0000,
         1143999.3750, 1129482.6250]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 625097.0000,       0.0000],
         [ 413005.5312,       0.0000],
         [ 401241.1875,       0.0000],
         ...,
         [ 252556.2344,       0.0000],
         [ 240201.2969,       0.0000],
         [ 238430.2656,       0.0000]],

        [[1435253.7500,       0.0000],
         [1374852.1250,       0.0000],
         [1373819.3750,       0.0000],
         ...,
         [1230295.7500,       0.0000],
         [1227776.8750,       0.0000],
         [1216116.6250,       0.0000]],

        [[1496551.1250,       0.0000],
         [1494373.3750,       0.0000],
         [1429113.0000,       0.0000],
         ...,
         [1130478.2500,       0.0000],
         [1126631.6250,       0.0000],
         [1125343.1250,       0.0000]],

        ...,

        [[1144457.6250,       0.0000],
         [1096510.3750,       0.0000],
         [1066931.8750,       0.0000],
         ...,
         [ 879521.1250,       0.0000],
         [ 872680.7500,       0.0000],
         [ 869477.5000,       0.0000]],

        [[1393526.8750,       0.0000],
         [1383816.7500,       0.0000],
         [1310685.1250,       0.0000],
         ...,
         [1100293.0000,       0.0000],
         [      0.0000, 1089154.5000],
         [1080210.8750,       0.0000]],

        [[1412964.5000,       0.0000],
         [1340503.5000,       0.0000],
         [1306367.2500,       0.0000],
         ...,
         [1150958.0000,       0.0000],
         [1143999.3750,       0.0000],
         [1129482.6250,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 5591803.0000,   971686.3750],
        [26109876.0000,        0.0000],
        [25260786.0000,        0.0000],
        [21245532.0000,        0.0000],
        [20261536.0000,  2226127.0000],
        [24898316.0000,  1126407.1250],
        [27552518.0000,  1524908.3750],
        [27346138.0000,  1468946.5000],
        [24035064.0000,  2531999.5000],
        [15789824.0000,        0.0000],
        [17039762.0000,  5731875.5000],
        [25341190.0000,        0.0000],
        [18566166.0000,  1195175.8750],
        [24532858.0000,  1389884.8750],
        [25045754.0000,        0.0000],
        [24408658.0000,        0.0000],
        [24687390.0000,  1289327.7500],
        [24155588.0000,  1283304.6250],
        [17356988.0000,  8846347.0000],
        [16539974.0000,  3146877.5000],
        [21851948.0000,  1279322.2500],
        [19308142.0000,  4938845.5000],
        [25417664.0000,  1236630.2500],
        [24860282.0000,        0.0000],
        [20379026.0000,  1204785.3750],
        [26163574.0000,        0.0000],
        [23745884.0000,  2634630.0000],
        [24609132.0000,        0.0000],
        [26982454.0000,        0.0000],
        [24688140.0000,        0.0000],
        [27602336.0000,        0.0000],
        [25998856.0000,        0.0000],
        [17389064.0000,  2200509.0000],
        [24848112.0000,        0.0000],
        [20248896.0000,  2029504.1250],
        [25046656.0000,  1279406.5000],
        [21811936.0000,  2523295.0000],
        [20197538.0000,  2158527.7500],
        [18362846.0000,  2804788.0000],
        [25678614.0000,  1341233.6250],
        [19461814.0000,  1948481.5000],
        [22969750.0000,  1144180.5000],
        [17771808.0000,   898121.1875],
        [17164146.0000,   743931.1875],
        [20681188.0000,  3738423.5000],
        [20190418.0000,        0.0000],
        [27559256.0000,        0.0000],
        [ 8206281.0000,  2672422.7500],
        [18547252.0000,  3350661.2500],
        [23915450.0000,  4104107.0000],
        [14169949.0000,  3639631.5000],
        [17098440.0000,  5486457.0000],
        [21794714.0000,  1352782.1250],
        [22234020.0000,        0.0000],
        [19389470.0000,  3268202.2500],
        [24257772.0000,        0.0000],
        [20085912.0000,  4124650.0000],
        [22880188.0000,  1233433.6250],
        [16838720.0000,  3673527.0000],
        [15984230.0000,  3865297.5000],
        [22784796.0000,  2424788.2500],
        [15511294.0000,  3775153.0000],
        [20523232.0000,  3486889.7500],
        [24720788.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 91/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:07, 56.10s/it]  7%|▋         | 2/30 [00:58<11:23, 24.40s/it] 10%|█         | 3/30 [00:59<06:09, 13.70s/it] 13%|█▎        | 4/30 [00:59<03:40,  8.47s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.58s/it] 20%|██        | 6/30 [01:00<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:01<00:43,  2.00s/it] 30%|███       | 9/30 [01:01<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 4.78516731262207
Epoch 92/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:48, 55.47s/it]  7%|▋         | 2/30 [00:59<11:40, 25.00s/it] 10%|█         | 3/30 [00:59<06:13, 13.82s/it] 13%|█▎        | 4/30 [01:00<03:50,  8.87s/it] 17%|█▋        | 5/30 [01:01<02:25,  5.83s/it] 20%|██        | 6/30 [01:01<01:35,  4.00s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.83s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.07s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 4.771760082244873
Epoch 93/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:05, 56.05s/it]  7%|▋         | 2/30 [00:56<10:53, 23.35s/it] 10%|█         | 3/30 [00:59<06:16, 13.93s/it] 13%|█▎        | 4/30 [00:59<03:43,  8.61s/it] 17%|█▋        | 5/30 [01:00<02:21,  5.66s/it] 20%|██        | 6/30 [01:00<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.02s/it] 30%|███       | 9/30 [01:01<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 4.8042503833770756
Epoch 94/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:17, 56.48s/it]  7%|▋         | 2/30 [00:58<11:32, 24.72s/it] 10%|█         | 3/30 [00:59<06:12, 13.80s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 4.7075527509053545
Epoch 95/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:03<30:28, 63.04s/it]  7%|▋         | 2/30 [01:08<13:43, 29.43s/it] 10%|█         | 3/30 [01:09<07:17, 16.19s/it] 13%|█▎        | 4/30 [01:10<04:21, 10.08s/it] 17%|█▋        | 5/30 [01:10<02:45,  6.60s/it] 20%|██        | 6/30 [01:10<01:48,  4.51s/it] 23%|██▎       | 7/30 [01:11<01:13,  3.18s/it] 27%|██▋       | 8/30 [01:11<00:50,  2.31s/it] 30%|███       | 9/30 [01:12<00:36,  1.72s/it] 33%|███▎      | 10/30 [01:12<00:26,  1.33s/it] 37%|███▋      | 11/30 [01:13<00:20,  1.06s/it] 40%|████      | 12/30 [01:13<00:15,  1.15it/s] 43%|████▎     | 13/30 [01:14<00:12,  1.35it/s] 47%|████▋     | 14/30 [01:14<00:10,  1.54it/s] 50%|█████     | 15/30 [01:14<00:08,  1.70it/s] 53%|█████▎    | 16/30 [01:15<00:07,  1.84it/s] 57%|█████▋    | 17/30 [01:15<00:06,  1.95it/s] 60%|██████    | 18/30 [01:16<00:05,  2.04it/s] 63%|██████▎   | 19/30 [01:16<00:05,  2.10it/s] 67%|██████▋   | 20/30 [01:17<00:04,  2.15it/s] 70%|███████   | 21/30 [01:17<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:18<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:18<00:03,  2.22it/s] 80%|████████  | 24/30 [01:18<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:19<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:19<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:20<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:20<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:21<00:00,  2.26it/s]100%|██████████| 30/30 [01:21<00:00,  2.26it/s]100%|██████████| 30/30 [01:21<00:00,  2.72s/it]
Epoch loss is 4.611331621805827
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0375, -0.0733,  0.0973,  ..., -0.0330,  0.1102,  0.0851],
        [ 0.0535, -0.0477,  0.1131,  ..., -0.0205,  0.0552,  0.1176],
        [ 0.0202, -0.0760, -0.0020,  ..., -0.0578,  0.0758,  0.1028],
        ...,
        [-0.0934, -0.0965,  0.0399,  ...,  0.0155,  0.0947,  0.0446],
        [-0.0525, -0.0986,  0.0538,  ...,  0.0215,  0.1016,  0.0745],
        [ 0.0165, -0.0972,  0.1114,  ...,  0.0059,  0.0628,  0.0908]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9321, 0.9050, 0.9029,  ..., 0.8671, 0.8661, 0.8655],
        [0.9925, 0.9895, 0.9893,  ..., 0.9819, 0.9806, 0.9805],
        [0.9950, 0.9946, 0.9919,  ..., 0.9744, 0.9739, 0.9737],
        ...,
        [0.9764, 0.9732, 0.9701,  ..., 0.9535, 0.9531, 0.9530],
        [0.9892, 0.9891, 0.9844,  ..., 0.9715, 0.9714, 0.9708],
        [0.9897, 0.9865, 0.9846,  ..., 0.9749, 0.9743, 0.9739]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 1, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 606235.2500,  411983.0938,  399936.1562,  ...,  239811.5156,
          236290.2344,  234126.2969],
        [1437501.6250, 1377040.8750, 1372718.0000,  ..., 1234903.7500,
         1213579.3750, 1211446.0000],
        [1489460.3750, 1481392.6250, 1426260.5000,  ..., 1110448.7500,
         1102013.1250, 1099643.6250],
        ...,
        [1143018.8750, 1091585.7500, 1043573.0000,  ...,  823493.6875,
          819274.6250,  817510.0625],
        [1371609.6250, 1370344.0000, 1279958.0000,  ..., 1065802.0000,
         1062846.2500, 1055173.7500],
        [1380871.7500, 1319714.5000, 1284507.0000,  ..., 1117404.8750,
         1109096.1250, 1102552.3750]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 606235.2500,       0.0000],
         [ 411983.0938,       0.0000],
         [ 399936.1562,       0.0000],
         ...,
         [ 239811.5156,       0.0000],
         [ 236290.2344,       0.0000],
         [ 234126.2969,       0.0000]],

        [[1437501.6250,       0.0000],
         [1377040.8750,       0.0000],
         [1372718.0000,       0.0000],
         ...,
         [1234903.7500,       0.0000],
         [1213579.3750,       0.0000],
         [1211446.0000,       0.0000]],

        [[1489460.3750,       0.0000],
         [1481392.6250,       0.0000],
         [1426260.5000,       0.0000],
         ...,
         [1110448.7500,       0.0000],
         [1102013.1250,       0.0000],
         [1099643.6250,       0.0000]],

        ...,

        [[1143018.8750,       0.0000],
         [1091585.7500,       0.0000],
         [      0.0000, 1043573.0000],
         ...,
         [ 823493.6875,       0.0000],
         [ 819274.6250,       0.0000],
         [ 817510.0625,       0.0000]],

        [[1371609.6250,       0.0000],
         [1370344.0000,       0.0000],
         [1279958.0000,       0.0000],
         ...,
         [      0.0000, 1065802.0000],
         [      0.0000, 1062846.2500],
         [1055173.7500,       0.0000]],

        [[1380871.7500,       0.0000],
         [1319714.5000,       0.0000],
         [1284507.0000,       0.0000],
         ...,
         [1117404.8750,       0.0000],
         [1109096.1250,       0.0000],
         [1102552.3750,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 5477227.0000,   982591.8125],
        [26027556.0000,        0.0000],
        [24862842.0000,        0.0000],
        [20356780.0000,        0.0000],
        [19294244.0000,  2146225.0000],
        [25506256.0000,        0.0000],
        [27180554.0000,  1510410.5000],
        [26944046.0000,  1444758.3750],
        [23869044.0000,  2494556.7500],
        [15246908.0000,   466261.8438],
        [16933540.0000,  5674936.0000],
        [24532400.0000,        0.0000],
        [17780564.0000,  1161577.0000],
        [24237228.0000,  1368241.5000],
        [24644382.0000,        0.0000],
        [23884830.0000,        0.0000],
        [24377646.0000,  1261471.6250],
        [23978460.0000,  1285388.0000],
        [16998082.0000,  8679009.0000],
        [16253491.0000,  3047118.2500],
        [21733706.0000,  1262837.8750],
        [18849528.0000,  4796180.5000],
        [26388672.0000,        0.0000],
        [24466296.0000,        0.0000],
        [19932010.0000,  1172430.2500],
        [25728184.0000,        0.0000],
        [24523564.0000,  1453315.0000],
        [24467448.0000,        0.0000],
        [26711736.0000,        0.0000],
        [24315084.0000,        0.0000],
        [27449672.0000,        0.0000],
        [25639128.0000,        0.0000],
        [16372766.0000,  2107018.5000],
        [24486884.0000,        0.0000],
        [21127668.0000,  1052341.8750],
        [24778896.0000,  1270903.6250],
        [21170520.0000,  2481813.5000],
        [18948518.0000,  3109411.5000],
        [18010576.0000,  2814971.0000],
        [24227432.0000,  2603163.2500],
        [18676174.0000,  1893458.7500],
        [22342114.0000,  1103759.1250],
        [16865780.0000,   832632.0625],
        [17224628.0000,        0.0000],
        [19824554.0000,  3690297.7500],
        [19142852.0000,        0.0000],
        [26882636.0000,        0.0000],
        [ 7829108.5000,  2563068.2500],
        [16681456.0000,  4203003.5000],
        [23611856.0000,  4046059.5000],
        [13593936.0000,  3492988.0000],
        [16808496.0000,  5417072.0000],
        [19915758.0000,  2293864.2500],
        [21284496.0000,        0.0000],
        [18950988.0000,  3172614.5000],
        [23784338.0000,        0.0000],
        [18261422.0000,  5140508.0000],
        [22015348.0000,  1230807.5000],
        [16391788.0000,  3641549.5000],
        [15553030.0000,  3791735.0000],
        [22109516.0000,  2369400.0000],
        [15697569.0000,  2785769.5000],
        [20062398.0000,  3407315.5000],
        [24135760.0000,        0.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 96/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:50, 61.73s/it]  7%|▋         | 2/30 [01:02<11:58, 25.68s/it] 10%|█         | 3/30 [01:02<06:22, 14.15s/it] 13%|█▎        | 4/30 [01:03<03:47,  8.74s/it] 17%|█▋        | 5/30 [01:03<02:23,  5.75s/it] 20%|██        | 6/30 [01:03<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:04<00:45,  2.05s/it] 30%|███       | 9/30 [01:05<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:06<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:07<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.98it/s] 60%|██████    | 18/30 [01:09<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:10<00:04,  2.15it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:11<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:14<00:00,  2.25it/s]100%|██████████| 30/30 [01:14<00:00,  2.25it/s]100%|██████████| 30/30 [01:14<00:00,  2.49s/it]
Epoch loss is 4.690817832946777
Epoch 97/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:13, 56.34s/it]  7%|▋         | 2/30 [01:00<12:04, 25.86s/it] 10%|█         | 3/30 [01:01<06:24, 14.25s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.80s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.79s/it] 20%|██        | 6/30 [01:02<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 4.638460397720337
Epoch 98/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:04, 56.01s/it]  7%|▋         | 2/30 [01:00<11:59, 25.70s/it] 10%|█         | 3/30 [01:00<06:22, 14.17s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.75s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.75s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.667093324661255
Epoch 99/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:05, 58.11s/it]  7%|▋         | 2/30 [00:59<11:35, 24.86s/it] 10%|█         | 3/30 [01:00<06:10, 13.71s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.47s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 4.636738125483195
Epoch 100/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:49, 57.58s/it]  7%|▋         | 2/30 [00:58<11:11, 23.97s/it] 10%|█         | 3/30 [00:58<05:57, 13.22s/it] 13%|█▎        | 4/30 [00:58<03:32,  8.18s/it] 17%|█▋        | 5/30 [00:59<02:14,  5.39s/it] 20%|██        | 6/30 [01:00<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.00s/it] 30%|███       | 9/30 [01:01<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.37s/it]
Epoch loss is 4.640547370910644
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0409, -0.0726,  0.0983,  ..., -0.0358,  0.1096,  0.0836],
        [ 0.0541, -0.0464,  0.1129,  ..., -0.0188,  0.0584,  0.1164],
        [ 0.0230, -0.0794, -0.0021,  ..., -0.0630,  0.0721,  0.1043],
        ...,
        [-0.0910, -0.0950,  0.0428,  ...,  0.0162,  0.0948,  0.0422],
        [-0.0516, -0.0997,  0.0558,  ...,  0.0184,  0.1022,  0.0719],
        [ 0.0175, -0.0962,  0.1142,  ...,  0.0046,  0.0635,  0.0885]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9309, 0.9055, 0.9030,  ..., 0.8667, 0.8663, 0.8657],
        [0.9925, 0.9894, 0.9892,  ..., 0.9808, 0.9807, 0.9806],
        [0.9945, 0.9940, 0.9915,  ..., 0.9732, 0.9721, 0.9720],
        ...,
        [0.9764, 0.9729, 0.9688,  ..., 0.9501, 0.9498, 0.9495],
        [0.9881, 0.9878, 0.9837,  ..., 0.9692, 0.9691, 0.9686],
        [0.9878, 0.9854, 0.9831,  ..., 0.9730, 0.9728, 0.9723]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 1, 0, 1],
        [0, 0, 0,  ..., 0, 1, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [0., 1.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 596046.9375,  414914.2812,  400289.8750,  ...,  238423.4375,
          236894.7031,  235064.3906],
        [1437959.6250, 1375211.5000, 1372491.5000,  ..., 1216464.6250,
         1214538.0000, 1213570.1250],
        [1478403.5000, 1469584.1250, 1418003.7500,  ..., 1090552.5000,
         1073845.7500, 1072183.8750],
        ...,
        [1142527.3750, 1086007.6250, 1024260.4375,  ...,  784413.7500,
          780794.7500,  777879.7500],
        [1350213.5000, 1345139.2500, 1267682.5000,  ..., 1030231.3750,
         1028641.9375, 1021926.5000],
        [1343578.8750, 1298856.6250, 1257137.3750,  ..., 1087824.7500,
         1084375.6250, 1076891.6250]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 596046.9375,       0.0000],
         [ 414914.2812,       0.0000],
         [ 400289.8750,       0.0000],
         ...,
         [ 238423.4375,       0.0000],
         [ 236894.7031,       0.0000],
         [ 235064.3906,       0.0000]],

        [[1437959.6250,       0.0000],
         [1375211.5000,       0.0000],
         [1372491.5000,       0.0000],
         ...,
         [1216464.6250,       0.0000],
         [1214538.0000,       0.0000],
         [1213570.1250,       0.0000]],

        [[1478403.5000,       0.0000],
         [1469584.1250,       0.0000],
         [1418003.7500,       0.0000],
         ...,
         [1090552.5000,       0.0000],
         [1073845.7500,       0.0000],
         [1072183.8750,       0.0000]],

        ...,

        [[1142527.3750,       0.0000],
         [1086007.6250,       0.0000],
         [      0.0000, 1024260.4375],
         ...,
         [ 784413.7500,       0.0000],
         [ 780794.7500,       0.0000],
         [ 777879.7500,       0.0000]],

        [[1350213.5000,       0.0000],
         [1345139.2500,       0.0000],
         [      0.0000, 1267682.5000],
         ...,
         [      0.0000, 1030231.3750],
         [1028641.9375,       0.0000],
         [      0.0000, 1021926.5000]],

        [[1343578.8750,       0.0000],
         [1298856.6250,       0.0000],
         [1257137.3750,       0.0000],
         ...,
         [1087824.7500,       0.0000],
         [      0.0000, 1084375.6250],
         [1076891.6250,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 5340515.0000,   977961.8125],
        [25905824.0000,        0.0000],
        [24400396.0000,        0.0000],
        [19336800.0000,        0.0000],
        [18263832.0000,  2054409.1250],
        [24897848.0000,        0.0000],
        [26792496.0000,  1494386.1250],
        [26526944.0000,  1417053.3750],
        [23649564.0000,  2447143.7500],
        [15070689.0000,   483549.1250],
        [17636490.0000,  4753672.0000],
        [23615918.0000,        0.0000],
        [16972992.0000,  1122162.2500],
        [23887290.0000,  1342737.5000],
        [24202458.0000,        0.0000],
        [23288996.0000,        0.0000],
        [24017646.0000,  1225348.5000],
        [23743436.0000,  1283691.3750],
        [17715212.0000,  7375347.0000],
        [15878426.0000,  2925254.7500],
        [21486294.0000,  1241157.7500],
        [19360628.0000,  3672597.2500],
        [26180542.0000,        0.0000],
        [24056822.0000,        0.0000],
        [19381806.0000,  1130884.7500],
        [25323122.0000,        0.0000],
        [24278700.0000,  1426871.3750],
        [24351110.0000,        0.0000],
        [26420192.0000,        0.0000],
        [23970574.0000,        0.0000],
        [27274128.0000,        0.0000],
        [25264684.0000,        0.0000],
        [15237166.0000,  1988049.5000],
        [24010788.0000,        0.0000],
        [19953386.0000,  2012237.0000],
        [24476614.0000,  1258155.6250],
        [20443556.0000,  2433721.0000],
        [19573704.0000,  2161640.0000],
        [17577548.0000,  2804470.7500],
        [24060794.0000,  2583708.0000],
        [17834880.0000,  1824301.2500],
        [22742000.0000,        0.0000],
        [15451048.0000,  1377794.0000],
        [16504654.0000,        0.0000],
        [18977376.0000,  3616747.7500],
        [17025146.0000,   869052.2500],
        [26202102.0000,        0.0000],
        [ 7373426.5000,  2437223.5000],
        [15774502.0000,  4023946.5000],
        [22008914.0000,  5241644.0000],
        [13030768.0000,  3327260.7500],
        [16449548.0000,  5328467.0000],
        [19068682.0000,  2274813.5000],
        [20210092.0000,        0.0000],
        [18488136.0000,  3068633.7500],
        [23240262.0000,        0.0000],
        [17595420.0000,  5069277.0000],
        [19111788.0000,  3325792.0000],
        [15902924.0000,  3604046.0000],
        [15067768.0000,  3704089.5000],
        [22445356.0000,  1168603.6250],
        [15189390.0000,  2686573.5000],
        [19611712.0000,  3319840.5000],
        [22456674.0000,  1084375.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 101/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:12, 56.29s/it]  7%|▋         | 2/30 [00:56<10:56, 23.44s/it] 10%|█         | 3/30 [00:57<05:49, 12.94s/it] 13%|█▎        | 4/30 [00:57<03:28,  8.01s/it] 17%|█▋        | 5/30 [00:58<02:11,  5.28s/it] 20%|██        | 6/30 [00:59<01:36,  4.00s/it] 23%|██▎       | 7/30 [01:00<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:00<00:45,  2.07s/it] 30%|███       | 9/30 [01:00<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:01<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:01<00:18,  1.02it/s] 40%|████      | 12/30 [01:02<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.61it/s] 50%|█████     | 15/30 [01:03<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:03<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:04<00:06,  1.99it/s] 60%|██████    | 18/30 [01:04<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:07<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:08<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch loss is 4.593628040949503
Epoch 102/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:47, 57.49s/it]  7%|▋         | 2/30 [00:58<11:19, 24.25s/it] 10%|█         | 3/30 [00:59<06:10, 13.74s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.49s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.59s/it] 20%|██        | 6/30 [01:01<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 4.605031728744507
Epoch 103/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:17, 56.45s/it]  7%|▋         | 2/30 [01:00<12:04, 25.88s/it] 10%|█         | 3/30 [01:01<06:25, 14.26s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.81s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.79s/it] 20%|██        | 6/30 [01:02<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:04<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 4.5623609066009525
Epoch 104/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:49, 55.51s/it]  7%|▋         | 2/30 [00:58<11:34, 24.79s/it] 10%|█         | 3/30 [00:59<06:09, 13.67s/it] 13%|█▎        | 4/30 [01:00<03:46,  8.73s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.74s/it] 20%|██        | 6/30 [01:01<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 4.54913117090861
Epoch 105/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:13, 56.32s/it]  7%|▋         | 2/30 [00:56<10:56, 23.45s/it] 10%|█         | 3/30 [00:57<05:49, 12.95s/it] 13%|█▎        | 4/30 [00:57<03:28,  8.01s/it] 17%|█▋        | 5/30 [00:58<02:12,  5.28s/it] 20%|██        | 6/30 [00:58<01:27,  3.64s/it] 23%|██▎       | 7/30 [00:59<01:02,  2.71s/it] 27%|██▋       | 8/30 [00:59<00:43,  1.99s/it] 30%|███       | 9/30 [01:00<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:00<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:01<00:18,  1.05it/s] 40%|████      | 12/30 [01:01<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:02<00:09,  1.63it/s] 50%|█████     | 15/30 [01:02<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:03<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:03<00:06,  2.00it/s] 60%|██████    | 18/30 [01:04<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:04<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:05<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:05<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:06<00:03,  2.23it/s] 80%|████████  | 24/30 [01:06<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:07<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:08<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:08<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:09<00:00,  2.32s/it]
Epoch loss is 4.525173012415568
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0431, -0.0708,  0.0986,  ..., -0.0381,  0.1095,  0.0813],
        [ 0.0542, -0.0445,  0.1132,  ..., -0.0179,  0.0615,  0.1151],
        [ 0.0252, -0.0812, -0.0026,  ..., -0.0667,  0.0696,  0.1052],
        ...,
        [-0.0886, -0.0944,  0.0461,  ...,  0.0175,  0.0954,  0.0399],
        [-0.0516, -0.1015,  0.0577,  ...,  0.0157,  0.1031,  0.0691],
        [ 0.0179, -0.0953,  0.1169,  ...,  0.0028,  0.0645,  0.0864]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9298, 0.9068, 0.9044,  ..., 0.8659, 0.8653, 0.8653],
        [0.9925, 0.9892, 0.9892,  ..., 0.9806, 0.9803, 0.9798],
        [0.9938, 0.9935, 0.9909,  ..., 0.9716, 0.9701, 0.9698],
        ...,
        [0.9761, 0.9716, 0.9674,  ..., 0.9480, 0.9465, 0.9460],
        [0.9871, 0.9863, 0.9831,  ..., 0.9673, 0.9668, 0.9661],
        [0.9856, 0.9840, 0.9812,  ..., 0.9723, 0.9709, 0.9708]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 1, 0],
        [0, 0, 1,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 587263.5000,  422557.0000,  408321.5938,  ...,  235752.0469,
          233555.1719,  233550.0625],
        [1437160.2500, 1371119.1250, 1371043.2500,  ..., 1213231.1250,
         1208487.2500, 1200019.6250],
        [1464460.6250, 1457454.0000, 1405371.6250,  ..., 1066862.6250,
         1044140.4375, 1039791.0000],
        ...,
        [1137874.5000, 1067288.0000, 1004488.7500,  ...,  761522.1875,
          745547.7500,  740097.9375],
        [1330269.5000, 1316613.2500, 1256532.1250,  ..., 1003336.0000,
          996494.8750,  986001.0000],
        [1302903.3750, 1272591.8750, 1223596.8750,  ..., 1077631.2500,
         1055598.5000, 1054179.0000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 587263.5000,       0.0000],
         [ 422557.0000,       0.0000],
         [ 408321.5938,       0.0000],
         ...,
         [ 235752.0469,       0.0000],
         [ 233555.1719,       0.0000],
         [ 233550.0625,       0.0000]],

        [[1437160.2500,       0.0000],
         [1371119.1250,       0.0000],
         [1371043.2500,       0.0000],
         ...,
         [1213231.1250,       0.0000],
         [1208487.2500,       0.0000],
         [1200019.6250,       0.0000]],

        [[1464460.6250,       0.0000],
         [1457454.0000,       0.0000],
         [1405371.6250,       0.0000],
         ...,
         [1066862.6250,       0.0000],
         [1044140.4375,       0.0000],
         [1039791.0000,       0.0000]],

        ...,

        [[1137874.5000,       0.0000],
         [1067288.0000,       0.0000],
         [      0.0000, 1004488.7500],
         ...,
         [ 761522.1875,       0.0000],
         [      0.0000,  745547.7500],
         [ 740097.9375,       0.0000]],

        [[1330269.5000,       0.0000],
         [1316613.2500,       0.0000],
         [      0.0000, 1256532.1250],
         ...,
         [1003336.0000,       0.0000],
         [      0.0000,  996494.8750],
         [ 986001.0000,       0.0000]],

        [[1302903.3750,       0.0000],
         [1272591.8750,       0.0000],
         [1223596.8750,       0.0000],
         ...,
         [1077631.2500,       0.0000],
         [1055598.5000,       0.0000],
         [1054179.0000,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 5268247.0000,   970901.8750],
        [25745940.0000,        0.0000],
        [23922122.0000,        0.0000],
        [18307458.0000,        0.0000],
        [17203234.0000,  1956790.0000],
        [24219986.0000,        0.0000],
        [26396572.0000,  1478557.1250],
        [26132058.0000,  1388936.1250],
        [23402674.0000,  2396494.5000],
        [14882650.0000,   499471.3125],
        [17434604.0000,  4709622.5000],
        [22701908.0000,        0.0000],
        [16228463.0000,  1075104.1250],
        [23498820.0000,  1314124.5000],
        [23803958.0000,        0.0000],
        [22714390.0000,        0.0000],
        [23660060.0000,  1193653.0000],
        [23514024.0000,  1280003.2500],
        [18360384.0000,  6125545.0000],
        [15563273.0000,  2803150.0000],
        [21194290.0000,  1215608.8750],
        [18822788.0000,  3582623.5000],
        [25997226.0000,        0.0000],
        [23614680.0000,        0.0000],
        [18797156.0000,  1082574.6250],
        [24958616.0000,        0.0000],
        [24044204.0000,  1399936.5000],
        [24171802.0000,        0.0000],
        [26160536.0000,        0.0000],
        [23612428.0000,        0.0000],
        [27097976.0000,        0.0000],
        [24895282.0000,        0.0000],
        [14214655.0000,  1863075.7500],
        [23492168.0000,        0.0000],
        [19751378.0000,  2014448.5000],
        [22977846.0000,  2405286.2500],
        [19741796.0000,  2381635.0000],
        [19217400.0000,  2168973.2500],
        [17152340.0000,  2789523.5000],
        [23871316.0000,  2560568.7500],
        [16978278.0000,  1751539.5000],
        [21944412.0000,        0.0000],
        [14823995.0000,  1290586.6250],
        [15753975.0000,        0.0000],
        [18219140.0000,  3520608.2500],
        [15531910.0000,   879261.9375],
        [25558784.0000,        0.0000],
        [ 6958770.0000,  2307234.5000],
        [14822865.0000,  3834883.5000],
        [21674474.0000,  5145802.0000],
        [12490398.0000,  3160587.0000],
        [16087259.0000,  5238290.0000],
        [18260050.0000,  2247553.0000],
        [18280510.0000,   790111.4375],
        [18952030.0000,  2044014.1250],
        [22705540.0000,        0.0000],
        [16959360.0000,  4969584.0000],
        [18307730.0000,  3276207.2500],
        [15361264.0000,  3566996.5000],
        [14502788.0000,  3604857.0000],
        [20425932.0000,  2221379.0000],
        [14756713.0000,  2584621.0000],
        [20203520.0000,  2253027.0000],
        [21839814.0000,  1079738.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 106/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:01, 60.05s/it]  7%|▋         | 2/30 [01:00<11:39, 24.99s/it] 10%|█         | 3/30 [01:00<06:12, 13.78s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.60s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.517809740702311
Epoch 107/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:33, 57.02s/it]  7%|▋         | 2/30 [00:58<11:22, 24.37s/it] 10%|█         | 3/30 [00:58<06:03, 13.45s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.71s/it] 20%|██        | 6/30 [01:01<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 4.537040821711222
Epoch 108/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.10s/it]  7%|▋         | 2/30 [00:57<11:10, 23.94s/it] 10%|█         | 3/30 [00:58<05:56, 13.21s/it] 13%|█▎        | 4/30 [00:59<03:38,  8.42s/it] 17%|█▋        | 5/30 [00:59<02:18,  5.54s/it] 20%|██        | 6/30 [01:00<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.99s/it] 30%|███       | 9/30 [01:01<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 4.508710686365763
Epoch 109/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:23, 56.66s/it]  7%|▋         | 2/30 [00:59<11:40, 25.03s/it] 10%|█         | 3/30 [00:59<06:12, 13.80s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 4.495906114578247
Epoch 110/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:39, 57.23s/it]  7%|▋         | 2/30 [00:58<11:19, 24.27s/it] 10%|█         | 3/30 [00:58<06:01, 13.39s/it] 13%|█▎        | 4/30 [01:00<03:49,  8.81s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.79s/it] 20%|██        | 6/30 [01:01<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:02<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 4.487881231307983
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0450, -0.0698,  0.0991,  ..., -0.0391,  0.1091,  0.0786],
        [ 0.0534, -0.0432,  0.1139,  ..., -0.0166,  0.0645,  0.1134],
        [ 0.0268, -0.0825, -0.0021,  ..., -0.0688,  0.0678,  0.1051],
        ...,
        [-0.0864, -0.0932,  0.0498,  ...,  0.0194,  0.0941,  0.0380],
        [-0.0523, -0.1033,  0.0597,  ...,  0.0139,  0.1027,  0.0664],
        [ 0.0177, -0.0944,  0.1199,  ...,  0.0009,  0.0642,  0.0841]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9292, 0.9063, 0.9037,  ..., 0.8632, 0.8631, 0.8629],
        [0.9924, 0.9889, 0.9887,  ..., 0.9802, 0.9796, 0.9792],
        [0.9929, 0.9928, 0.9901,  ..., 0.9702, 0.9678, 0.9678],
        ...,
        [0.9753, 0.9697, 0.9657,  ..., 0.9451, 0.9425, 0.9423],
        [0.9857, 0.9845, 0.9828,  ..., 0.9658, 0.9651, 0.9639],
        [0.9833, 0.9824, 0.9790,  ..., 0.9695, 0.9690, 0.9685]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 582409.5000,  419727.9062,  404304.0938,  ...,  226768.9688,
          226316.3438,  225669.7812],
        [1434689.8750, 1365593.8750, 1362221.0000,  ..., 1205276.1250,
         1195790.5000, 1188738.5000],
        [1445574.2500, 1443337.1250, 1389812.0000,  ..., 1044800.8750,
         1009717.3750, 1009540.1875],
        ...,
        [1124009.8750, 1037969.0000,  980622.9375,  ...,  730078.1875,
          704245.2500,  701930.5625],
        [1305515.5000, 1283072.1250, 1251047.3750,  ...,  981289.9375,
          971597.0625,  955171.9375],
        [1260402.6250, 1244299.6250, 1184934.3750,  ..., 1034702.6250,
         1027790.7500, 1020606.7500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 582409.5000,       0.0000],
         [ 419727.9062,       0.0000],
         [ 404304.0938,       0.0000],
         ...,
         [ 226768.9688,       0.0000],
         [ 226316.3438,       0.0000],
         [ 225669.7812,       0.0000]],

        [[1434689.8750,       0.0000],
         [1365593.8750,       0.0000],
         [1362221.0000,       0.0000],
         ...,
         [1205276.1250,       0.0000],
         [1195790.5000,       0.0000],
         [1188738.5000,       0.0000]],

        [[1445574.2500,       0.0000],
         [1443337.1250,       0.0000],
         [1389812.0000,       0.0000],
         ...,
         [1044800.8750,       0.0000],
         [1009717.3750,       0.0000],
         [1009540.1875,       0.0000]],

        ...,

        [[1124009.8750,       0.0000],
         [1037969.0000,       0.0000],
         [      0.0000,  980622.9375],
         ...,
         [ 730078.1875,       0.0000],
         [ 704245.2500,       0.0000],
         [ 701930.5625,       0.0000]],

        [[1305515.5000,       0.0000],
         [1283072.1250,       0.0000],
         [1251047.3750,       0.0000],
         ...,
         [ 981289.9375,       0.0000],
         [ 971597.0625,       0.0000],
         [      0.0000,  955171.9375]],

        [[1260402.6250,       0.0000],
         [1244299.6250,       0.0000],
         [1184934.3750,       0.0000],
         ...,
         [1034702.6250,       0.0000],
         [1027790.7500,       0.0000],
         [1020606.7500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 5140656.0000,   947023.6250],
        [25536456.0000,        0.0000],
        [23408562.0000,        0.0000],
        [17236818.0000,        0.0000],
        [15350032.0000,  2625255.7500],
        [23443028.0000,        0.0000],
        [25965648.0000,  1458552.3750],
        [25620692.0000,  1354122.0000],
        [23107684.0000,  2332578.5000],
        [14565800.0000,   514561.0938],
        [18013760.0000,  3801156.0000],
        [21664732.0000,        0.0000],
        [15490496.0000,  1019298.5000],
        [23075830.0000,  1285013.1250],
        [23418560.0000,        0.0000],
        [22161232.0000,        0.0000],
        [23306542.0000,  1162106.6250],
        [23205424.0000,  1274825.7500],
        [17812516.0000,  5984388.5000],
        [15284570.0000,  2671286.0000],
        [20876912.0000,  1186316.1250],
        [18226654.0000,  3476347.5000],
        [25822074.0000,        0.0000],
        [23163608.0000,        0.0000],
        [18101296.0000,  1026822.8125],
        [24596894.0000,        0.0000],
        [23787272.0000,  1372562.1250],
        [23976454.0000,        0.0000],
        [25899324.0000,        0.0000],
        [23259788.0000,        0.0000],
        [26900458.0000,        0.0000],
        [24476732.0000,        0.0000],
        [13232655.0000,  1732766.1250],
        [22925210.0000,        0.0000],
        [19465228.0000,  2005732.0000],
        [22547116.0000,  2378327.5000],
        [18996000.0000,  2322528.0000],
        [18781922.0000,  2165644.7500],
        [16629674.0000,  2755590.7500],
        [23656544.0000,  2522229.0000],
        [16107098.0000,  1673824.0000],
        [21019062.0000,        0.0000],
        [14253559.0000,  1192281.5000],
        [14949564.0000,        0.0000],
        [17480772.0000,  3399213.2500],
        [13852309.0000,   881955.2500],
        [24914612.0000,        0.0000],
        [ 6506376.5000,  2160543.5000],
        [12937202.0000,  4386644.5000],
        [21259772.0000,  5029329.0000],
        [11333886.0000,  3570861.5000],
        [15738013.0000,  5140184.5000],
        [16649486.0000,  3016504.5000],
        [17147282.0000,   767135.5625],
        [18424928.0000,  1963795.5000],
        [22160880.0000,        0.0000],
        [16326344.0000,  4856427.5000],
        [17475564.0000,  3204058.7500],
        [14796194.0000,  3522600.2500],
        [13879070.0000,  3488763.2500],
        [19355580.0000,  2128990.5000],
        [14973344.0000,  1779033.2500],
        [19781784.0000,  2203721.0000],
        [21178244.0000,  1076138.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 111/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:11, 56.27s/it]  7%|▋         | 2/30 [01:00<12:06, 25.95s/it] 10%|█         | 3/30 [01:01<06:26, 14.30s/it] 13%|█▎        | 4/30 [01:01<03:49,  8.83s/it] 17%|█▋        | 5/30 [01:02<02:25,  5.80s/it] 20%|██        | 6/30 [01:02<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.07s/it] 30%|███       | 9/30 [01:04<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 4.481751298904419
Epoch 112/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:05, 60.21s/it]  7%|▋         | 2/30 [01:00<11:41, 25.05s/it] 10%|█         | 3/30 [01:01<06:12, 13.81s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.62s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.4527172883351644
Epoch 113/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.07s/it]  7%|▋         | 2/30 [00:59<11:31, 24.69s/it] 10%|█         | 3/30 [00:59<06:07, 13.62s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.50s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.60s/it] 20%|██        | 6/30 [01:01<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 4.4401073773701984
Epoch 114/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:48, 55.47s/it]  7%|▋         | 2/30 [00:55<10:46, 23.10s/it] 10%|█         | 3/30 [01:01<06:45, 15.02s/it] 13%|█▎        | 4/30 [01:01<04:00,  9.26s/it] 17%|█▋        | 5/30 [01:02<02:32,  6.08s/it] 20%|██        | 6/30 [01:02<01:39,  4.16s/it] 23%|██▎       | 7/30 [01:03<01:07,  2.95s/it] 27%|██▋       | 8/30 [01:03<00:47,  2.15s/it] 30%|███       | 9/30 [01:03<00:33,  1.62s/it] 33%|███▎      | 10/30 [01:04<00:25,  1.25s/it] 37%|███▋      | 11/30 [01:04<00:19,  1.00s/it] 40%|████      | 12/30 [01:05<00:15,  1.20it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:06<00:10,  1.58it/s] 50%|█████     | 15/30 [01:06<00:08,  1.73it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.86it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.97it/s] 60%|██████    | 18/30 [01:07<00:05,  2.04it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.10it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 4.4300105730692545
Epoch 115/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:34, 61.17s/it]  7%|▋         | 2/30 [01:01<11:52, 25.45s/it] 10%|█         | 3/30 [01:02<06:18, 14.03s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.70s/it] 20%|██        | 6/30 [01:03<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 4.38196972211202
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0453, -0.0674,  0.1005,  ..., -0.0391,  0.1083,  0.0763],
        [ 0.0509, -0.0406,  0.1157,  ..., -0.0150,  0.0663,  0.1125],
        [ 0.0263, -0.0815, -0.0002,  ..., -0.0705,  0.0655,  0.1053],
        ...,
        [-0.0842, -0.0909,  0.0529,  ...,  0.0220,  0.0928,  0.0369],
        [-0.0536, -0.1046,  0.0616,  ...,  0.0125,  0.1021,  0.0645],
        [ 0.0175, -0.0928,  0.1224,  ..., -0.0009,  0.0633,  0.0828]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9288, 0.9060, 0.9032,  ..., 0.8612, 0.8611, 0.8610],
        [0.9921, 0.9885, 0.9882,  ..., 0.9794, 0.9784, 0.9783],
        [0.9920, 0.9918, 0.9891,  ..., 0.9674, 0.9660, 0.9651],
        ...,
        [0.9743, 0.9674, 0.9635,  ..., 0.9413, 0.9392, 0.9392],
        [0.9843, 0.9828, 0.9827,  ..., 0.9650, 0.9640, 0.9635],
        [0.9806, 0.9805, 0.9764,  ..., 0.9665, 0.9663, 0.9658]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 578399.8125,  417824.9062,  401184.5625,  ...,  220236.0000,
          220033.8125,  219727.2656],
        [1429742.7500, 1357187.2500, 1351771.0000,  ..., 1192119.5000,
         1175585.3750, 1173979.8750],
        [1427353.1250, 1422435.3750, 1369537.7500,  ..., 1005037.7500,
          983979.4375,  972207.8750],
        ...,
        [1108500.7500, 1005190.1250,  950437.7500,  ...,  691674.5625,
          671331.2500,  670938.2500],
        [1278734.2500, 1252281.6250, 1249301.8750,  ...,  970140.6250,
          957101.4375,  949686.6875],
        [1213766.8750, 1211644.7500, 1142881.5000,  ...,  991472.7500,
          988593.0000,  982268.3125]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 578399.8125,       0.0000],
         [ 417824.9062,       0.0000],
         [ 401184.5625,       0.0000],
         ...,
         [ 220236.0000,       0.0000],
         [ 220033.8125,       0.0000],
         [ 219727.2656,       0.0000]],

        [[1429742.7500,       0.0000],
         [1357187.2500,       0.0000],
         [1351771.0000,       0.0000],
         ...,
         [1192119.5000,       0.0000],
         [1175585.3750,       0.0000],
         [1173979.8750,       0.0000]],

        [[1427353.1250,       0.0000],
         [1422435.3750,       0.0000],
         [1369537.7500,       0.0000],
         ...,
         [1005037.7500,       0.0000],
         [ 983979.4375,       0.0000],
         [ 972207.8750,       0.0000]],

        ...,

        [[1108500.7500,       0.0000],
         [1005190.1250,       0.0000],
         [      0.0000,  950437.7500],
         ...,
         [ 691674.5625,       0.0000],
         [ 671331.2500,       0.0000],
         [ 670938.2500,       0.0000]],

        [[1278734.2500,       0.0000],
         [1252281.6250,       0.0000],
         [1249301.8750,       0.0000],
         ...,
         [ 970140.6250,       0.0000],
         [ 957101.4375,       0.0000],
         [      0.0000,  949686.6875]],

        [[1213766.8750,       0.0000],
         [1211644.7500,       0.0000],
         [1142881.5000,       0.0000],
         ...,
         [ 991472.7500,       0.0000],
         [ 988593.0000,       0.0000],
         [ 982268.3125,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 5006589.5000,   922408.0625],
        [25301706.0000,        0.0000],
        [22828630.0000,        0.0000],
        [16231112.0000,        0.0000],
        [15024824.0000,  1759712.2500],
        [22679680.0000,        0.0000],
        [25544078.0000,  1438342.2500],
        [25076428.0000,  1315747.2500],
        [23868268.0000,  1155011.1250],
        [14175212.0000,   521461.9062],
        [17723514.0000,  3744398.7500],
        [20544888.0000,        0.0000],
        [14728605.0000,   954995.2500],
        [22636286.0000,  1250855.3750],
        [23074612.0000,        0.0000],
        [21602736.0000,        0.0000],
        [22935494.0000,  1130181.8750],
        [22814438.0000,  1261930.0000],
        [17216398.0000,  5809924.0000],
        [15009622.0000,  2536810.5000],
        [20503182.0000,  1153394.1250],
        [17625916.0000,  3360669.7500],
        [25646446.0000,        0.0000],
        [22714362.0000,        0.0000],
        [17375776.0000,   966681.9375],
        [24194648.0000,        0.0000],
        [23497168.0000,  1344162.1250],
        [23734042.0000,        0.0000],
        [25653766.0000,        0.0000],
        [22892668.0000,        0.0000],
        [26676550.0000,        0.0000],
        [24092178.0000,        0.0000],
        [12294364.0000,  1593579.2500],
        [22243006.0000,        0.0000],
        [19093334.0000,  1992630.2500],
        [22013192.0000,  2344669.0000],
        [18229304.0000,  2256887.5000],
        [18223104.0000,  2145957.7500],
        [16087901.0000,  2716617.7500],
        [23414418.0000,  2476348.7500],
        [15248279.0000,  1591646.7500],
        [20024454.0000,        0.0000],
        [13719588.0000,  1094725.2500],
        [14253984.0000,        0.0000],
        [16768830.0000,  3266917.2500],
        [11978196.0000,   871494.8125],
        [24228224.0000,        0.0000],
        [ 6073317.0000,  2021167.3750],
        [11766252.0000,  4072047.5000],
        [20815052.0000,  4907244.0000],
        [10769467.0000,  3373064.5000],
        [15389383.0000,  5040457.5000],
        [15164963.0000,  3731614.5000],
        [15337692.0000,  1412563.5000],
        [17880628.0000,  1885026.0000],
        [21602242.0000,        0.0000],
        [15796494.0000,  4730657.5000],
        [16718499.0000,  3124808.0000],
        [14171606.0000,  3472603.5000],
        [13179810.0000,  3364503.5000],
        [18288084.0000,  2059570.6250],
        [14403018.0000,  1704424.2500],
        [19363494.0000,  2189284.2500],
        [20478192.0000,  1071200.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 116/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:28, 56.84s/it]  7%|▋         | 2/30 [00:57<11:02, 23.66s/it] 10%|█         | 3/30 [00:59<06:12, 13.81s/it] 13%|█▎        | 4/30 [00:59<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.62s/it] 20%|██        | 6/30 [01:00<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 4.388707971572876
Epoch 117/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:54, 57.75s/it]  7%|▋         | 2/30 [00:58<11:13, 24.04s/it] 10%|█         | 3/30 [01:01<06:27, 14.37s/it] 13%|█▎        | 4/30 [01:01<03:50,  8.87s/it] 17%|█▋        | 5/30 [01:01<02:25,  5.83s/it] 20%|██        | 6/30 [01:02<01:35,  4.00s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.83s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.07s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.3717874924341835
Epoch 118/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:44, 59.47s/it]  7%|▋         | 2/30 [01:00<11:35, 24.83s/it] 10%|█         | 3/30 [01:00<06:09, 13.69s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.46s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 4.346774117151896
Epoch 119/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:32, 56.99s/it]  7%|▋         | 2/30 [00:59<11:39, 24.98s/it] 10%|█         | 3/30 [01:00<06:11, 13.77s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.62s/it] 20%|██        | 6/30 [01:01<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 4.435268926620483
Epoch 120/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:54, 55.66s/it]  7%|▋         | 2/30 [01:00<11:55, 25.54s/it] 10%|█         | 3/30 [01:00<06:20, 14.08s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.72s/it] 20%|██        | 6/30 [01:01<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 4.294174838066101
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0459, -0.0641,  0.1017,  ..., -0.0405,  0.1083,  0.0736],
        [ 0.0488, -0.0378,  0.1169,  ..., -0.0152,  0.0681,  0.1120],
        [ 0.0260, -0.0793,  0.0012,  ..., -0.0731,  0.0634,  0.1059],
        ...,
        [-0.0822, -0.0881,  0.0551,  ...,  0.0243,  0.0914,  0.0364],
        [-0.0543, -0.1055,  0.0626,  ...,  0.0105,  0.1007,  0.0631],
        [ 0.0173, -0.0913,  0.1235,  ..., -0.0037,  0.0624,  0.0824]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9284, 0.9052, 0.9018,  ..., 0.8600, 0.8599, 0.8589],
        [0.9918, 0.9879, 0.9875,  ..., 0.9791, 0.9779, 0.9772],
        [0.9911, 0.9904, 0.9877,  ..., 0.9638, 0.9637, 0.9619],
        ...,
        [0.9731, 0.9648, 0.9609,  ..., 0.9371, 0.9363, 0.9355],
        [0.9826, 0.9826, 0.9817,  ..., 0.9634, 0.9632, 0.9632],
        [0.9781, 0.9776, 0.9743,  ..., 0.9645, 0.9638, 0.9638]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 1, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 575237.3125,  413302.6250,  393701.5625,  ...,  216649.7969,
          216170.9844,  213264.7031],
        [1423476.1250, 1345513.8750, 1338333.2500,  ..., 1187782.1250,
         1167353.8750, 1155246.8750],
        [1408692.6250, 1395089.3750, 1342325.1250,  ...,  954234.1875,
          952188.7500,  929234.9375],
        ...,
        [1089835.1250,  967356.9375,  915399.3125,  ...,  651885.2500,
          643958.8125,  636981.1250],
        [1248665.8750, 1248319.3750, 1231901.8750,  ...,  948321.9375,
          946357.7500,  945944.5000],
        [1169704.1250, 1161857.2500, 1109158.5000,  ...,  964362.3750,
          954822.2500,  954639.1875]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 575237.3125,       0.0000],
         [ 413302.6250,       0.0000],
         [ 393701.5625,       0.0000],
         ...,
         [ 216649.7969,       0.0000],
         [ 216170.9844,       0.0000],
         [ 213264.7031,       0.0000]],

        [[1423476.1250,       0.0000],
         [1345513.8750,       0.0000],
         [1338333.2500,       0.0000],
         ...,
         [1187782.1250,       0.0000],
         [1167353.8750,       0.0000],
         [1155246.8750,       0.0000]],

        [[1408692.6250,       0.0000],
         [1395089.3750,       0.0000],
         [1342325.1250,       0.0000],
         ...,
         [ 954234.1875,       0.0000],
         [ 952188.7500,       0.0000],
         [ 929234.9375,       0.0000]],

        ...,

        [[1089835.1250,       0.0000],
         [ 967356.9375,       0.0000],
         [      0.0000,  915399.3125],
         ...,
         [ 651885.2500,       0.0000],
         [ 643958.8125,       0.0000],
         [ 636981.1250,       0.0000]],

        [[1248665.8750,       0.0000],
         [1248319.3750,       0.0000],
         [      0.0000, 1231901.8750],
         ...,
         [ 948321.9375,       0.0000],
         [      0.0000,  946357.7500],
         [ 945944.5000,       0.0000]],

        [[1169704.1250,       0.0000],
         [1161857.2500,       0.0000],
         [1109158.5000,       0.0000],
         ...,
         [ 964362.3750,       0.0000],
         [ 954822.2500,       0.0000],
         [ 954639.1875,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4869282.0000,   888904.5625],
        [25066220.0000,        0.0000],
        [22165942.0000,        0.0000],
        [15139702.0000,        0.0000],
        [13959656.0000,  1654186.3750],
        [21752064.0000,        0.0000],
        [25079916.0000,  1413021.1250],
        [24494704.0000,  1273042.2500],
        [23400332.0000,  1127937.8750],
        [13693106.0000,   527116.3750],
        [17388864.0000,  3670438.2500],
        [19269072.0000,        0.0000],
        [13926292.0000,   880819.6875],
        [22188838.0000,  1217192.2500],
        [22734280.0000,        0.0000],
        [21038868.0000,        0.0000],
        [22506026.0000,  1100207.0000],
        [21370778.0000,  2242152.5000],
        [16561410.0000,  5611525.0000],
        [15487926.0000,  1689816.5000],
        [20069636.0000,  1113147.2500],
        [16967836.0000,  3223023.0000],
        [25435708.0000,        0.0000],
        [22261526.0000,        0.0000],
        [16610074.0000,   903988.5625],
        [23744036.0000,        0.0000],
        [23202236.0000,  1317555.3750],
        [23456612.0000,        0.0000],
        [25358718.0000,        0.0000],
        [22521840.0000,        0.0000],
        [26403196.0000,        0.0000],
        [23698568.0000,        0.0000],
        [11354783.0000,  1443545.5000],
        [21416866.0000,        0.0000],
        [18616572.0000,  1973567.0000],
        [21354260.0000,  2306086.0000],
        [17439806.0000,  2188145.0000],
        [17555346.0000,  2117464.5000],
        [15456678.0000,  2665414.0000],
        [24338928.0000,  1238360.3750],
        [14389840.0000,  1504562.7500],
        [19025432.0000,        0.0000],
        [13140430.0000,   991822.3750],
        [13492616.0000,        0.0000],
        [13723427.0000,  5536694.0000],
        [10017452.0000,   857632.5625],
        [23547924.0000,        0.0000],
        [ 5676752.5000,  1895951.6250],
        [10482272.0000,  3731967.5000],
        [20349372.0000,  4771778.0000],
        [10179388.0000,  3158132.2500],
        [15003098.0000,  4937008.0000],
        [13812547.0000,  4415445.5000],
        [14321219.0000,  1388092.0000],
        [17341446.0000,  1803682.0000],
        [21011568.0000,        0.0000],
        [14470264.0000,  5476369.0000],
        [15147096.0000,  3929524.0000],
        [13473494.0000,  3412754.2500],
        [12432563.0000,  3234033.7500],
        [17201590.0000,  1984932.1250],
        [13763891.0000,  1623722.2500],
        [18945146.0000,  2178259.5000],
        [19724556.0000,  1065094.7500]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 121/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:13, 60.46s/it]  7%|▋         | 2/30 [01:00<11:44, 25.15s/it] 10%|█         | 3/30 [01:01<06:14, 13.87s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 4.395834064483642
Epoch 122/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:32, 59.07s/it]  7%|▋         | 2/30 [00:59<11:28, 24.58s/it] 10%|█         | 3/30 [00:59<06:06, 13.56s/it] 13%|█▎        | 4/30 [01:00<03:37,  8.38s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.52s/it] 20%|██        | 6/30 [01:01<01:31,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.01it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 4.323495721817016
Epoch 123/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:10, 60.37s/it]  7%|▋         | 2/30 [01:00<11:43, 25.12s/it] 10%|█         | 3/30 [01:01<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.63s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.280724120140076
Epoch 124/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:57, 55.78s/it]  7%|▋         | 2/30 [00:58<11:33, 24.77s/it] 10%|█         | 3/30 [00:59<06:08, 13.66s/it] 13%|█▎        | 4/30 [00:59<03:39,  8.44s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.73s/it] 20%|██        | 6/30 [01:01<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 4.345442525545756
Epoch 125/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:19, 60.68s/it]  7%|▋         | 2/30 [01:01<11:46, 25.24s/it] 10%|█         | 3/30 [01:01<06:15, 13.92s/it] 13%|█▎        | 4/30 [01:02<03:43,  8.60s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.66s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 4.284292968114217
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0471, -0.0608,  0.1027,  ..., -0.0411,  0.1087,  0.0698],
        [ 0.0470, -0.0362,  0.1176,  ..., -0.0148,  0.0700,  0.1103],
        [ 0.0256, -0.0772,  0.0026,  ..., -0.0752,  0.0624,  0.1059],
        ...,
        [-0.0796, -0.0848,  0.0570,  ...,  0.0264,  0.0887,  0.0359],
        [-0.0546, -0.1061,  0.0637,  ...,  0.0091,  0.0986,  0.0613],
        [ 0.0175, -0.0900,  0.1239,  ..., -0.0062,  0.0607,  0.0820]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9288, 0.9041, 0.8998,  ..., 0.8574, 0.8565, 0.8562],
        [0.9913, 0.9871, 0.9867,  ..., 0.9781, 0.9773, 0.9763],
        [0.9901, 0.9889, 0.9862,  ..., 0.9613, 0.9604, 0.9603],
        ...,
        [0.9716, 0.9618, 0.9583,  ..., 0.9326, 0.9323, 0.9320],
        [0.9822, 0.9812, 0.9807,  ..., 0.9612, 0.9606, 0.9600],
        [0.9752, 0.9740, 0.9721,  ..., 0.9618, 0.9616, 0.9613]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 1, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 578452.1875,  406688.1562,  382510.0938,  ...,  208804.9688,
          206100.9062,  205108.1562],
        [1414080.7500, 1331373.5000, 1323762.0000,  ..., 1169978.6250,
         1157297.8750, 1139932.7500],
        [1389240.8750, 1365234.5000, 1313719.7500,  ...,  920107.1875,
          908310.2500,  907625.3750],
        ...,
        [1067172.0000,  927492.6250,  881984.6875,  ...,  611402.1250,
          608592.3750,  605681.6250],
        [1241607.6250, 1223487.2500, 1215557.7500,  ...,  919602.7500,
          912045.3125,  903287.0625],
        [1123483.7500, 1104502.5000, 1073528.3750,  ...,  927721.6875,
          925173.5625,  921000.0625]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 578452.1875,       0.0000],
         [ 406688.1562,       0.0000],
         [ 382510.0938,       0.0000],
         ...,
         [      0.0000,  208804.9688],
         [ 206100.9062,       0.0000],
         [ 205108.1562,       0.0000]],

        [[1414080.7500,       0.0000],
         [1331373.5000,       0.0000],
         [1323762.0000,       0.0000],
         ...,
         [1169978.6250,       0.0000],
         [1157297.8750,       0.0000],
         [1139932.7500,       0.0000]],

        [[1389240.8750,       0.0000],
         [1365234.5000,       0.0000],
         [1313719.7500,       0.0000],
         ...,
         [ 920107.1875,       0.0000],
         [ 908310.2500,       0.0000],
         [ 907625.3750,       0.0000]],

        ...,

        [[1067172.0000,       0.0000],
         [ 927492.6250,       0.0000],
         [      0.0000,  881984.6875],
         ...,
         [ 611402.1250,       0.0000],
         [ 608592.3750,       0.0000],
         [ 605681.6250,       0.0000]],

        [[1241607.6250,       0.0000],
         [      0.0000, 1223487.2500],
         [1215557.7500,       0.0000],
         ...,
         [ 919602.7500,       0.0000],
         [ 912045.3125,       0.0000],
         [ 903287.0625,       0.0000]],

        [[1123483.7500,       0.0000],
         [1104502.5000,       0.0000],
         [1073528.3750,       0.0000],
         ...,
         [ 927721.6875,       0.0000],
         [ 925173.5625,       0.0000],
         [ 921000.0625,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4718728.0000,   847100.5000],
        [24813440.0000,        0.0000],
        [21541412.0000,        0.0000],
        [13683963.0000,   589565.9375],
        [13040529.0000,  1557998.5000],
        [20021466.0000,   859297.0000],
        [24581182.0000,  1385495.2500],
        [23852962.0000,  1225726.0000],
        [22890010.0000,  1099549.2500],
        [12839506.0000,   916150.7500],
        [17069098.0000,  3588096.0000],
        [17795572.0000,        0.0000],
        [13240175.0000,   803341.1250],
        [21777124.0000,  1183174.0000],
        [22443854.0000,        0.0000],
        [20553946.0000,        0.0000],
        [22114472.0000,  1076387.5000],
        [20940474.0000,  2209843.5000],
        [16811876.0000,  4503815.0000],
        [15282850.0000,  1619308.5000],
        [19728574.0000,  1074123.3750],
        [16347892.0000,  3067814.5000],
        [25186386.0000,        0.0000],
        [21845628.0000,        0.0000],
        [15901838.0000,   843406.6875],
        [23312170.0000,        0.0000],
        [22886554.0000,  1288118.3750],
        [23215088.0000,        0.0000],
        [25043908.0000,        0.0000],
        [22213358.0000,        0.0000],
        [26116808.0000,        0.0000],
        [23375076.0000,        0.0000],
        [10525680.0000,  1308785.7500],
        [20498292.0000,        0.0000],
        [17280028.0000,  2813367.5000],
        [20684382.0000,  2255733.5000],
        [16717507.0000,  2125920.0000],
        [16838300.0000,  2078903.2500],
        [14779071.0000,  2613577.2500],
        [24048730.0000,  1228578.0000],
        [13549948.0000,  1415858.7500],
        [18060696.0000,        0.0000],
        [13139307.0000,   497085.8125],
        [12738733.0000,        0.0000],
        [13938219.0000,  4550264.5000],
        [ 8185230.0000,   834509.7500],
        [22746468.0000,        0.0000],
        [ 5346535.0000,  1785989.2500],
        [ 8764669.0000,  3950662.2500],
        [19869490.0000,  4621038.5000],
        [ 9214406.0000,  3446077.0000],
        [14585964.0000,  4818692.5000],
        [13233514.0000,  4348212.0000],
        [13403743.0000,  1363609.7500],
        [17666668.0000,   925633.3750],
        [20416092.0000,        0.0000],
        [14059052.0000,  5291095.5000],
        [14533394.0000,  3797332.7500],
        [12737164.0000,  3352981.5000],
        [12208768.0000,  2587930.0000],
        [16175889.0000,  1907621.2500],
        [13144912.0000,  1546267.1250],
        [18501472.0000,  2165885.0000],
        [18976756.0000,  1058811.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 126/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:44, 57.39s/it]  7%|▋         | 2/30 [00:57<11:09, 23.89s/it] 10%|█         | 3/30 [00:58<05:55, 13.19s/it] 13%|█▎        | 4/30 [00:59<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.75s/it] 20%|██        | 6/30 [01:00<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 4.283705234527588
Epoch 127/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:48, 59.60s/it]  7%|▋         | 2/30 [01:00<11:34, 24.80s/it] 10%|█         | 3/30 [01:00<06:09, 13.68s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.45s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 4.23723414738973
Epoch 128/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:11, 60.38s/it]  7%|▋         | 2/30 [01:00<11:43, 25.12s/it] 10%|█         | 3/30 [01:01<06:14, 13.85s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.56s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.63s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.247808869679769
Epoch 129/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:34, 57.07s/it]  7%|▋         | 2/30 [00:57<11:05, 23.76s/it] 10%|█         | 3/30 [00:59<06:08, 13.64s/it] 13%|█▎        | 4/30 [00:59<03:39,  8.43s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.69s/it] 20%|██        | 6/30 [01:00<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 4.31464729309082
Epoch 130/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:24, 56.72s/it]  7%|▋         | 2/30 [00:59<11:44, 25.18s/it] 10%|█         | 3/30 [01:00<06:14, 13.88s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.58s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.64s/it] 20%|██        | 6/30 [01:01<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 4.197121397654215
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0484, -0.0575,  0.1031,  ..., -0.0410,  0.1088,  0.0667],
        [ 0.0453, -0.0351,  0.1177,  ..., -0.0151,  0.0714,  0.1094],
        [ 0.0248, -0.0746,  0.0037,  ..., -0.0770,  0.0611,  0.1061],
        ...,
        [-0.0769, -0.0819,  0.0589,  ...,  0.0285,  0.0857,  0.0355],
        [-0.0548, -0.1071,  0.0646,  ...,  0.0079,  0.0962,  0.0597],
        [ 0.0172, -0.0898,  0.1235,  ..., -0.0087,  0.0585,  0.0820]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9289, 0.9036, 0.8981,  ..., 0.8540, 0.8530, 0.8527],
        [0.9908, 0.9863, 0.9862,  ..., 0.9764, 0.9763, 0.9759],
        [0.9889, 0.9873, 0.9846,  ..., 0.9580, 0.9574, 0.9565],
        ...,
        [0.9699, 0.9583, 0.9552,  ..., 0.9311, 0.9284, 0.9272],
        [0.9815, 0.9805, 0.9787,  ..., 0.9583, 0.9578, 0.9573],
        [0.9722, 0.9706, 0.9704,  ..., 0.9591, 0.9588, 0.9584]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 1],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 1, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 579831.8750,  404008.8438,  373314.0938,  ...,  198926.7969,
          195950.3281,  195159.9688],
        [1402480.8750, 1316340.8750, 1314763.8750,  ..., 1142545.8750,
         1140466.6250, 1133781.1250],
        [1366482.3750, 1334318.7500, 1284177.5000,  ...,  878219.4375,
          870811.0625,  859293.6875],
        ...,
        [1040419.9375,  881550.7500,  844273.3750,  ...,  598166.4375,
          575515.5000,  565679.5000],
        [1228968.2500, 1210791.0000, 1180645.7500,  ...,  882609.0000,
          875257.9375,  869346.5000],
        [1075292.6250, 1051025.8750, 1048562.0000,  ...,  891943.0625,
          887930.3125,  882813.5625]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 579831.8750,       0.0000],
         [ 404008.8438,       0.0000],
         [ 373314.0938,       0.0000],
         ...,
         [ 198926.7969,       0.0000],
         [ 195950.3281,       0.0000],
         [      0.0000,  195159.9688]],

        [[1402480.8750,       0.0000],
         [1316340.8750,       0.0000],
         [1314763.8750,       0.0000],
         ...,
         [1142545.8750,       0.0000],
         [1140466.6250,       0.0000],
         [1133781.1250,       0.0000]],

        [[1366482.3750,       0.0000],
         [1334318.7500,       0.0000],
         [1284177.5000,       0.0000],
         ...,
         [ 878219.4375,       0.0000],
         [ 870811.0625,       0.0000],
         [ 859293.6875,       0.0000]],

        ...,

        [[1040419.9375,       0.0000],
         [ 881550.7500,       0.0000],
         [      0.0000,  844273.3750],
         ...,
         [ 598166.4375,       0.0000],
         [ 575515.5000,       0.0000],
         [ 565679.5000,       0.0000]],

        [[1228968.2500,       0.0000],
         [      0.0000, 1210791.0000],
         [1180645.7500,       0.0000],
         ...,
         [      0.0000,  882609.0000],
         [ 875257.9375,       0.0000],
         [ 869346.5000,       0.0000]],

        [[1075292.6250,       0.0000],
         [      0.0000, 1051025.8750],
         [1048562.0000,       0.0000],
         ...,
         [ 891943.0625,       0.0000],
         [ 887930.3125,       0.0000],
         [ 882813.5625,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4593823.0000,   809939.8750],
        [24502940.0000,        0.0000],
        [20886792.0000,        0.0000],
        [12433342.0000,  1105267.2500],
        [12156396.0000,  1468881.0000],
        [19176380.0000,   818055.1250],
        [22989024.0000,  2433897.5000],
        [23216064.0000,  1174182.6250],
        [22306140.0000,  1068434.7500],
        [12363778.0000,   917593.7500],
        [16730747.0000,  3489715.0000],
        [16274680.0000,        0.0000],
        [12629702.0000,   723297.0000],
        [21361924.0000,  1145389.0000],
        [22166154.0000,        0.0000],
        [20084994.0000,        0.0000],
        [21691738.0000,  1056148.2500],
        [20501272.0000,  2167902.0000],
        [16112730.0000,  4344857.0000],
        [15020012.0000,  1544209.2500],
        [18574332.0000,  1849596.2500],
        [15774396.0000,  2902171.5000],
        [24890968.0000,        0.0000],
        [21399574.0000,        0.0000],
        [15266965.0000,   790730.3750],
        [22837452.0000,        0.0000],
        [22513980.0000,  1261707.5000],
        [22924264.0000,        0.0000],
        [24711280.0000,        0.0000],
        [21880760.0000,        0.0000],
        [25797746.0000,        0.0000],
        [23041882.0000,        0.0000],
        [10288128.0000,   712870.1250],
        [19448056.0000,        0.0000],
        [16768274.0000,  2760456.0000],
        [19920288.0000,  2203546.5000],
        [15265118.0000,  2816028.5000],
        [16011444.0000,  2023701.0000],
        [13300347.0000,  3242589.5000],
        [23714222.0000,  1216218.6250],
        [12725713.0000,  1324915.7500],
        [17103100.0000,        0.0000],
        [12725496.0000,   470252.7500],
        [11850586.0000,        0.0000],
        [13316122.0000,  4352448.0000],
        [ 6564991.5000,   809032.0625],
        [21972436.0000,        0.0000],
        [ 4848366.0000,  1882757.0000],
        [ 7658991.0000,  3546201.2500],
        [19377788.0000,  4459163.0000],
        [ 9224543.0000,  2814137.2500],
        [14172092.0000,  4688811.5000],
        [12734262.0000,  4262714.0000],
        [12561018.0000,  1333659.2500],
        [17198764.0000,   906397.8750],
        [19797614.0000,        0.0000],
        [13704136.0000,  5103213.0000],
        [13981186.0000,  3659785.5000],
        [11450014.0000,  3923864.5000],
        [11398450.0000,  2522658.0000],
        [14480443.0000,  2637720.7500],
        [12528090.0000,  1460992.2500],
        [17151048.0000,  3030647.7500],
        [18255336.0000,  1051025.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 131/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:54, 59.81s/it]  7%|▋         | 2/30 [01:00<11:36, 24.89s/it] 10%|█         | 3/30 [01:00<06:10, 13.73s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.48s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.58s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 4.2256081104278564
Epoch 132/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:05, 56.04s/it]  7%|▋         | 2/30 [01:00<12:02, 25.80s/it] 10%|█         | 3/30 [01:01<06:23, 14.22s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.78s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.77s/it] 20%|██        | 6/30 [01:02<01:35,  3.96s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.223646354675293
Epoch 133/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:20, 58.64s/it]  7%|▋         | 2/30 [00:59<11:23, 24.41s/it] 10%|█         | 3/30 [00:59<06:03, 13.46s/it] 13%|█▎        | 4/30 [00:59<03:36,  8.32s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.48s/it] 20%|██        | 6/30 [01:00<01:30,  3.77s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.68s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.97s/it] 30%|███       | 9/30 [01:02<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 4.1752156734466555
Epoch 134/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:13, 56.33s/it]  7%|▋         | 2/30 [01:00<11:59, 25.71s/it] 10%|█         | 3/30 [01:01<06:22, 14.17s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.75s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.75s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.199138919512431
Epoch 135/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:51, 55.56s/it]  7%|▋         | 2/30 [00:56<10:59, 23.57s/it] 10%|█         | 3/30 [00:59<06:18, 14.02s/it] 13%|█▎        | 4/30 [00:59<03:45,  8.66s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.70s/it] 20%|██        | 6/30 [01:00<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.15it/s] 70%|███████   | 21/30 [01:07<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 4.185147754351298
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0489, -0.0536,  0.1038,  ..., -0.0417,  0.1085,  0.0649],
        [ 0.0433, -0.0342,  0.1174,  ..., -0.0157,  0.0726,  0.1094],
        [ 0.0224, -0.0711,  0.0044,  ..., -0.0784,  0.0599,  0.1072],
        ...,
        [-0.0753, -0.0781,  0.0609,  ...,  0.0298,  0.0823,  0.0362],
        [-0.0555, -0.1069,  0.0656,  ...,  0.0069,  0.0933,  0.0586],
        [ 0.0169, -0.0884,  0.1227,  ..., -0.0107,  0.0563,  0.0826]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9284, 0.9025, 0.8960,  ..., 0.8534, 0.8513, 0.8472],
        [0.9899, 0.9857, 0.9854,  ..., 0.9760, 0.9753, 0.9742],
        [0.9875, 0.9855, 0.9827,  ..., 0.9542, 0.9527, 0.9525],
        ...,
        [0.9677, 0.9545, 0.9519,  ..., 0.9258, 0.9252, 0.9220],
        [0.9801, 0.9793, 0.9771,  ..., 0.9552, 0.9550, 0.9532],
        [0.9701, 0.9687, 0.9676,  ..., 0.9563, 0.9562, 0.9549]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 575753.7500,  397669.7812,  362256.5625,  ...,  197086.6250,
          191133.8906,  180468.3281],
        [1385745.0000, 1303774.7500, 1299089.6250,  ..., 1135204.8750,
         1123755.8750, 1106199.6250],
        [1338726.3750, 1301386.1250, 1250048.0000,  ...,  831567.9375,
          814121.0000,  811390.3125],
        ...,
        [1008461.5000,  835523.4375,  805482.2500,  ...,  554300.8750,
          549650.6250,  525258.1875],
        [1205069.2500, 1191222.8750, 1153839.6250,  ...,  844308.0000,
          841951.2500,  820383.3125],
        [1044339.6250, 1023451.8750, 1006887.3750,  ...,  857439.5625,
          856544.6250,  840563.3125]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 575753.7500,       0.0000],
         [ 397669.7812,       0.0000],
         [ 362256.5625,       0.0000],
         ...,
         [ 197086.6250,       0.0000],
         [ 191133.8906,       0.0000],
         [ 180468.3281,       0.0000]],

        [[1385745.0000,       0.0000],
         [1303774.7500,       0.0000],
         [1299089.6250,       0.0000],
         ...,
         [1135204.8750,       0.0000],
         [1123755.8750,       0.0000],
         [1106199.6250,       0.0000]],

        [[1338726.3750,       0.0000],
         [1301386.1250,       0.0000],
         [1250048.0000,       0.0000],
         ...,
         [ 831567.9375,       0.0000],
         [ 814121.0000,       0.0000],
         [ 811390.3125,       0.0000]],

        ...,

        [[1008461.5000,       0.0000],
         [ 835523.4375,       0.0000],
         [      0.0000,  805482.2500],
         ...,
         [ 554300.8750,       0.0000],
         [ 549650.6250,       0.0000],
         [ 525258.1875,       0.0000]],

        [[1205069.2500,       0.0000],
         [      0.0000, 1191222.8750],
         [1153839.6250,       0.0000],
         ...,
         [ 844308.0000,       0.0000],
         [ 841951.2500,       0.0000],
         [ 820383.3125,       0.0000]],

        [[      0.0000, 1044339.6250],
         [1023451.8750,       0.0000],
         [1006887.3750,       0.0000],
         ...,
         [ 857439.5625,       0.0000],
         [ 856544.6250,       0.0000],
         [ 840563.3125,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4634337.0000,   584978.1250],
        [24122410.0000,        0.0000],
        [19370404.0000,   833637.8750],
        [12374916.0000,   567674.1875],
        [11299496.0000,  1376559.1250],
        [18353458.0000,   774215.5000],
        [22528562.0000,  2379612.5000],
        [22519960.0000,  1120744.1250],
        [21669840.0000,  1037609.8125],
        [11507070.0000,  1270542.6250],
        [16370239.0000,  3370333.5000],
        [14723466.0000,        0.0000],
        [12067116.0000,   645798.2500],
        [20955442.0000,  1109925.7500],
        [21874386.0000,        0.0000],
        [19591806.0000,        0.0000],
        [21206926.0000,  1035887.3750],
        [20055018.0000,  2115468.0000],
        [15408100.0000,  4170316.0000],
        [15383056.0000,   815961.5625],
        [18251582.0000,  1786684.3750],
        [15190793.0000,  2729615.0000],
        [24580922.0000,        0.0000],
        [20967500.0000,        0.0000],
        [14574910.0000,   733749.0000],
        [22367588.0000,        0.0000],
        [22140054.0000,  1232904.3750],
        [22669258.0000,        0.0000],
        [24388422.0000,        0.0000],
        [21543562.0000,        0.0000],
        [25453208.0000,        0.0000],
        [22697862.0000,        0.0000],
        [ 9564100.0000,   639405.3125],
        [18318800.0000,        0.0000],
        [16225662.0000,  2694094.5000],
        [19050456.0000,  2143738.0000],
        [14569828.0000,  2709845.2500],
        [15068802.0000,  1956949.7500],
        [12461296.0000,  3155757.0000],
        [23339452.0000,  1200679.0000],
        [11480390.0000,  1727749.3750],
        [16122049.0000,        0.0000],
        [12741287.0000,        0.0000],
        [10974206.0000,        0.0000],
        [12664034.0000,  4128607.7500],
        [ 5129395.0000,   777893.8750],
        [21172792.0000,        0.0000],
        [ 4566455.5000,  1792237.1250],
        [ 6645515.0000,  3149504.5000],
        [17860952.0000,  5256987.0000],
        [ 9217449.0000,  2219609.2500],
        [13727596.0000,  4552489.0000],
        [11618523.0000,  4801541.0000],
        [11729156.0000,  1300435.5000],
        [16796040.0000,   887279.3750],
        [19141518.0000,        0.0000],
        [13311186.0000,  4902114.0000],
        [13339730.0000,  3501857.5000],
        [10850782.0000,  3873280.0000],
        [10561493.0000,  2459481.5000],
        [13651266.0000,  2512721.2500],
        [11941641.0000,  1382385.8750],
        [16659816.0000,  2986754.5000],
        [17521200.0000,  1044339.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 136/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:04, 56.03s/it]  7%|▋         | 2/30 [00:59<11:36, 24.89s/it] 10%|█         | 3/30 [00:59<06:10, 13.73s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.48s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.58s/it] 20%|██        | 6/30 [01:00<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:01<00:43,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 4.13350427945455
Epoch 137/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:02, 58.01s/it]  7%|▋         | 2/30 [00:58<11:16, 24.15s/it] 10%|█         | 3/30 [00:59<06:07, 13.60s/it] 13%|█▎        | 4/30 [01:00<03:48,  8.81s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.79s/it] 20%|██        | 6/30 [01:01<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 4.136594398816427
Epoch 138/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:25, 56.73s/it]  7%|▋         | 2/30 [00:57<11:11, 23.98s/it] 10%|█         | 3/30 [00:58<05:57, 13.23s/it] 13%|█▎        | 4/30 [00:58<03:32,  8.18s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.78s/it] 20%|██        | 6/30 [01:00<01:35,  3.96s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.06s/it] 30%|███       | 9/30 [01:01<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 4.121121366818746
Epoch 139/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:48, 55.46s/it]  7%|▋         | 2/30 [00:59<11:43, 25.11s/it] 10%|█         | 3/30 [00:59<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.63s/it] 20%|██        | 6/30 [01:01<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 4.124868114789327
Epoch 140/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:25, 60.86s/it]  7%|▋         | 2/30 [01:01<11:48, 25.32s/it] 10%|█         | 3/30 [01:01<06:16, 13.96s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.67s/it] 20%|██        | 6/30 [01:03<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 4.190329202016195
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0482, -0.0512,  0.1042,  ..., -0.0427,  0.1084,  0.0637],
        [ 0.0408, -0.0339,  0.1173,  ..., -0.0158,  0.0739,  0.1088],
        [ 0.0198, -0.0685,  0.0058,  ..., -0.0786,  0.0593,  0.1085],
        ...,
        [-0.0733, -0.0736,  0.0630,  ...,  0.0298,  0.0796,  0.0362],
        [-0.0560, -0.1054,  0.0670,  ...,  0.0061,  0.0910,  0.0565],
        [ 0.0166, -0.0856,  0.1220,  ..., -0.0122,  0.0544,  0.0829]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9282, 0.9027, 0.8946,  ..., 0.8516, 0.8505, 0.8465],
        [0.9889, 0.9851, 0.9843,  ..., 0.9749, 0.9738, 0.9728],
        [0.9860, 0.9837, 0.9807,  ..., 0.9498, 0.9483, 0.9480],
        ...,
        [0.9648, 0.9504, 0.9483,  ..., 0.9214, 0.9198, 0.9167],
        [0.9782, 0.9779, 0.9755,  ..., 0.9534, 0.9512, 0.9497],
        [0.9692, 0.9654, 0.9645,  ..., 0.9528, 0.9524, 0.9517]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 573952.3125,  398448.0000,  354958.2812,  ...,  191985.1875,
          188995.0469,  178497.1875],
        [1364736.0000, 1293373.3750, 1279524.7500,  ..., 1117802.3750,
         1100593.1250, 1085727.0000],
        [1310398.8750, 1268342.7500, 1215156.7500,  ...,  780890.7500,
          764144.8125,  761393.6875],
        ...,
        [ 967453.8750,  787450.0625,  765108.8125,  ...,  520913.1562,
          509068.0312,  486772.1562],
        [1172359.8750, 1167895.1250, 1128074.5000,  ...,  822583.9375,
          796515.0000,  779718.0000],
        [1030528.1250,  976052.9375,  963389.0000,  ...,  815718.0000,
          810937.7500,  802861.6875]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 573952.3125,       0.0000],
         [ 398448.0000,       0.0000],
         [ 354958.2812,       0.0000],
         ...,
         [ 191985.1875,       0.0000],
         [ 188995.0469,       0.0000],
         [ 178497.1875,       0.0000]],

        [[1364736.0000,       0.0000],
         [1293373.3750,       0.0000],
         [1279524.7500,       0.0000],
         ...,
         [1117802.3750,       0.0000],
         [1100593.1250,       0.0000],
         [1085727.0000,       0.0000]],

        [[1310398.8750,       0.0000],
         [1268342.7500,       0.0000],
         [1215156.7500,       0.0000],
         ...,
         [ 780890.7500,       0.0000],
         [ 764144.8125,       0.0000],
         [ 761393.6875,       0.0000]],

        ...,

        [[ 967453.8750,       0.0000],
         [ 787450.0625,       0.0000],
         [      0.0000,  765108.8125],
         ...,
         [ 520913.1562,       0.0000],
         [ 509068.0312,       0.0000],
         [ 486772.1562,       0.0000]],

        [[1172359.8750,       0.0000],
         [      0.0000, 1167895.1250],
         [1128074.5000,       0.0000],
         ...,
         [ 822583.9375,       0.0000],
         [ 796515.0000,       0.0000],
         [ 779718.0000,       0.0000]],

        [[      0.0000, 1030528.1250],
         [ 976052.9375,       0.0000],
         [ 963389.0000,       0.0000],
         ...,
         [ 815718.0000,       0.0000],
         [ 810937.7500,       0.0000],
         [ 802861.6875,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4573849.0000,   568490.6875],
        [23695368.0000,        0.0000],
        [18754984.0000,   832220.8125],
        [11915190.0000,   551393.6875],
        [10501556.0000,  1285498.0000],
        [17426184.0000,   724458.1875],
        [21958866.0000,  2310638.2500],
        [21778704.0000,  1063963.8750],
        [21001964.0000,  1006767.3125],
        [11031932.0000,  1253464.8750],
        [15983761.0000,  3227449.0000],
        [12749960.0000,   511574.4688],
        [11627240.0000,   574693.3750],
        [20582884.0000,  1075314.2500],
        [21578002.0000,        0.0000],
        [19052620.0000,        0.0000],
        [20705130.0000,  1015747.8750],
        [19589100.0000,  2060204.0000],
        [14735046.0000,  3986159.5000],
        [15006035.0000,   767374.8750],
        [17936322.0000,  1715063.5000],
        [14637604.0000,  2551365.5000],
        [24202980.0000,        0.0000],
        [20455260.0000,        0.0000],
        [14005127.0000,   685616.8125],
        [21868794.0000,        0.0000],
        [21713692.0000,  1202649.0000],
        [22349424.0000,        0.0000],
        [24013078.0000,        0.0000],
        [21172818.0000,        0.0000],
        [25044674.0000,        0.0000],
        [22292952.0000,        0.0000],
        [ 8948817.0000,   570887.0625],
        [17179254.0000,        0.0000],
        [15686272.0000,  2617107.7500],
        [18156316.0000,  2083887.0000],
        [14592708.0000,  1959398.0000],
        [14038778.0000,  1881431.3750],
        [11532875.0000,  3055565.7500],
        [22955780.0000,  1182899.8750],
        [10777518.0000,  1638246.0000],
        [15135477.0000,        0.0000],
        [12267258.0000,        0.0000],
        [10126107.0000,        0.0000],
        [11995590.0000,  3884655.5000],
        [ 4028435.0000,   744668.6875],
        [20354424.0000,        0.0000],
        [ 4316100.0000,  1707430.7500],
        [ 5713965.0000,  2777670.0000],
        [17350916.0000,  5072363.0000],
        [ 8738751.0000,  2065165.5000],
        [13234504.0000,  4405479.5000],
        [11153761.0000,  4694447.0000],
        [10945340.0000,  1259320.2500],
        [16416908.0000,   869255.3125],
        [17635344.0000,   815665.9375],
        [12901888.0000,  4715122.0000],
        [12707952.0000,  3335172.5000],
        [10222636.0000,  3809614.0000],
        [ 9315840.0000,  2820603.5000],
        [12916242.0000,  2388471.5000],
        [11302434.0000,  1300958.2500],
        [16103131.0000,  2931350.7500],
        [16746558.0000,  1030528.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 141/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:47, 57.51s/it]  7%|▋         | 2/30 [00:59<11:39, 25.00s/it] 10%|█         | 3/30 [01:00<06:12, 13.79s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.52s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 4.060387992858887
Epoch 142/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:26, 56.77s/it]  7%|▋         | 2/30 [00:57<11:01, 23.64s/it] 10%|█         | 3/30 [01:00<06:24, 14.24s/it] 13%|█▎        | 4/30 [01:00<03:48,  8.79s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.78s/it] 20%|██        | 6/30 [01:01<01:35,  3.96s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 4.103977743784586
Epoch 143/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:59, 59.99s/it]  7%|▋         | 2/30 [01:00<11:44, 25.15s/it] 10%|█         | 3/30 [01:03<06:41, 14.87s/it] 13%|█▎        | 4/30 [01:03<03:58,  9.18s/it] 17%|█▋        | 5/30 [01:04<02:30,  6.03s/it] 20%|██        | 6/30 [01:04<01:39,  4.13s/it] 23%|██▎       | 7/30 [01:05<01:07,  2.92s/it] 27%|██▋       | 8/30 [01:05<00:46,  2.13s/it] 30%|███       | 9/30 [01:06<00:33,  1.60s/it] 33%|███▎      | 10/30 [01:06<00:24,  1.24s/it] 37%|███▋      | 11/30 [01:06<00:18,  1.00it/s] 40%|████      | 12/30 [01:07<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:07<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:08<00:10,  1.59it/s] 50%|█████     | 15/30 [01:08<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:09<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:09<00:06,  1.98it/s] 60%|██████    | 18/30 [01:10<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:10<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:10<00:04,  2.16it/s] 70%|███████   | 21/30 [01:11<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:11<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:12<00:03,  2.23it/s] 80%|████████  | 24/30 [01:12<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:13<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:13<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:14<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:15<00:00,  2.27it/s]100%|██████████| 30/30 [01:15<00:00,  2.52s/it]
Epoch loss is 4.0402172088623045
Epoch 144/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:11, 58.31s/it]  7%|▋         | 2/30 [00:59<11:38, 24.94s/it] 10%|█         | 3/30 [01:01<06:31, 14.48s/it] 13%|█▎        | 4/30 [01:02<03:56,  9.09s/it] 17%|█▋        | 5/30 [01:03<02:29,  5.97s/it] 20%|██        | 6/30 [01:03<01:38,  4.09s/it] 23%|██▎       | 7/30 [01:04<01:06,  2.90s/it] 27%|██▋       | 8/30 [01:04<00:46,  2.11s/it] 30%|███       | 9/30 [01:04<00:33,  1.59s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.24s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.01it/s] 40%|████      | 12/30 [01:06<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:06<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:07<00:10,  1.59it/s] 50%|█████     | 15/30 [01:07<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.97it/s] 60%|██████    | 18/30 [01:08<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.10it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.15it/s] 70%|███████   | 21/30 [01:10<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.22it/s] 80%|████████  | 24/30 [01:11<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 4.039195942878723
Epoch 145/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:24, 56.69s/it]  7%|▋         | 2/30 [00:59<11:37, 24.90s/it] 10%|█         | 3/30 [01:00<06:23, 14.20s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.77s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.77s/it] 20%|██        | 6/30 [01:02<01:34,  3.96s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 4.100428477923075
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0473, -0.0493,  0.1047,  ..., -0.0429,  0.1081,  0.0626],
        [ 0.0376, -0.0337,  0.1170,  ..., -0.0157,  0.0748,  0.1093],
        [ 0.0169, -0.0658,  0.0067,  ..., -0.0787,  0.0591,  0.1101],
        ...,
        [-0.0721, -0.0701,  0.0655,  ...,  0.0304,  0.0777,  0.0362],
        [-0.0576, -0.1044,  0.0683,  ...,  0.0063,  0.0893,  0.0548],
        [ 0.0147, -0.0829,  0.1214,  ..., -0.0126,  0.0531,  0.0837]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9279, 0.9016, 0.8923,  ..., 0.8482, 0.8482, 0.8446],
        [0.9877, 0.9844, 0.9832,  ..., 0.9730, 0.9723, 0.9714],
        [0.9843, 0.9817, 0.9786,  ..., 0.9448, 0.9441, 0.9434],
        ...,
        [0.9615, 0.9459, 0.9444,  ..., 0.9159, 0.9133, 0.9122],
        [0.9763, 0.9758, 0.9736,  ..., 0.9512, 0.9473, 0.9466],
        [0.9680, 0.9633, 0.9617,  ..., 0.9482, 0.9482, 0.9481]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 0, 1],
        [1, 0, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 571590.3750,  392214.1875,  343477.4375,  ...,  183024.1562,
          182951.5625,  173749.6094],
        [1341640.5000, 1281406.6250, 1259654.0000,  ..., 1088262.6250,
         1077939.7500, 1062966.8750],
        [1278191.7500, 1232021.6250, 1178099.3750,  ...,  727641.8750,
          720275.8125,  712899.4375],
        ...,
        [ 923735.6875,  738588.3125,  723531.5625,  ...,  481572.5625,
          463646.1562,  456842.9375],
        [1141499.2500, 1133351.8750, 1096921.3750,  ...,  796635.7500,
          754049.7500,  746518.8750],
        [1013140.6250,  946901.2500,  926039.5000,  ...,  763941.5000,
          763824.9375,  761959.5000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 571590.3750,       0.0000],
         [ 392214.1875,       0.0000],
         [ 343477.4375,       0.0000],
         ...,
         [ 183024.1562,       0.0000],
         [ 182951.5625,       0.0000],
         [ 173749.6094,       0.0000]],

        [[1341640.5000,       0.0000],
         [1281406.6250,       0.0000],
         [1259654.0000,       0.0000],
         ...,
         [1088262.6250,       0.0000],
         [1077939.7500,       0.0000],
         [1062966.8750,       0.0000]],

        [[1278191.7500,       0.0000],
         [1232021.6250,       0.0000],
         [1178099.3750,       0.0000],
         ...,
         [ 727641.8750,       0.0000],
         [ 720275.8125,       0.0000],
         [ 712899.4375,       0.0000]],

        ...,

        [[ 923735.6875,       0.0000],
         [ 738588.3125,       0.0000],
         [      0.0000,  723531.5625],
         ...,
         [ 481572.5625,       0.0000],
         [ 463646.1562,       0.0000],
         [      0.0000,  456842.9375]],

        [[      0.0000, 1141499.2500],
         [1133351.8750,       0.0000],
         [1096921.3750,       0.0000],
         ...,
         [ 796635.7500,       0.0000],
         [ 754049.7500,       0.0000],
         [ 746518.8750,       0.0000]],

        [[      0.0000, 1013140.6250],
         [ 946901.2500,       0.0000],
         [ 926039.5000,       0.0000],
         ...,
         [ 763941.5000,       0.0000],
         [ 763824.9375,       0.0000],
         [ 761959.5000,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4446646.5000,   543592.3125],
        [23220054.0000,        0.0000],
        [18079996.0000,   826536.2500],
        [11457914.0000,   531501.9375],
        [ 9757397.0000,  1194698.0000],
        [17220040.0000,        0.0000],
        [21390372.0000,  2245598.2500],
        [20984328.0000,  1003755.1875],
        [20250878.0000,   974270.1875],
        [10920438.0000,   878009.5000],
        [15622330.0000,  3067002.2500],
        [11469624.0000,   452605.2500],
        [11183463.0000,   510223.8125],
        [20267796.0000,  1041719.5625],
        [21326506.0000,        0.0000],
        [18590874.0000,        0.0000],
        [20137596.0000,   988097.3125],
        [19049648.0000,  1994349.0000],
        [14107922.0000,  3787404.2500],
        [14580594.0000,   717037.5000],
        [17567860.0000,  1625664.8750],
        [14087436.0000,  2369238.0000],
        [23813110.0000,        0.0000],
        [19930402.0000,        0.0000],
        [13443276.0000,   638000.6250],
        [21337052.0000,        0.0000],
        [21279368.0000,  1172200.0000],
        [22002280.0000,        0.0000],
        [23635052.0000,        0.0000],
        [20808556.0000,        0.0000],
        [24627982.0000,        0.0000],
        [21891584.0000,        0.0000],
        [ 8423639.0000,   503455.9375],
        [15341722.0000,   706275.1250],
        [14376746.0000,  3273661.0000],
        [17211076.0000,  2017415.8750],
        [13899919.0000,  1908663.5000],
        [12272996.0000,  2448363.7500],
        [ 9934128.0000,  3489847.0000],
        [22507262.0000,  1163095.6250],
        [10125525.0000,  1554899.8750],
        [14241676.0000,        0.0000],
        [11801147.0000,        0.0000],
        [ 9389097.0000,        0.0000],
        [10723820.0000,  4255045.0000],
        [ 3121343.5000,   871039.6250],
        [19642772.0000,        0.0000],
        [ 4080350.5000,  1620335.6250],
        [ 4590239.0000,  2706306.5000],
        [16810804.0000,  4874963.5000],
        [ 8276994.5000,  1900708.5000],
        [12765833.0000,  4262915.0000],
        [10149303.0000,  5168984.0000],
        [10237975.0000,  1211920.5000],
        [16057228.0000,   852006.7500],
        [16967024.0000,   790965.6875],
        [12510680.0000,  4534128.5000],
        [12072356.0000,  3172217.5000],
        [ 9171202.0000,  4237230.0000],
        [ 8532306.0000,  2739959.5000],
        [12240032.0000,  2264324.0000],
        [10202604.0000,  1674233.0000],
        [15510672.0000,  2875991.2500],
        [15990466.0000,  1013140.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 146/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:58, 57.90s/it]  7%|▋         | 2/30 [00:58<11:14, 24.10s/it] 10%|█         | 3/30 [00:58<05:59, 13.30s/it] 13%|█▎        | 4/30 [00:59<03:33,  8.23s/it] 17%|█▋        | 5/30 [00:59<02:15,  5.42s/it] 20%|██        | 6/30 [01:00<01:29,  3.73s/it] 23%|██▎       | 7/30 [01:00<01:00,  2.65s/it] 27%|██▋       | 8/30 [01:00<00:42,  1.95s/it] 30%|███       | 9/30 [01:01<00:31,  1.48s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.16s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.07it/s] 40%|████      | 12/30 [01:02<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.47it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.01it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.23it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.23it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.24it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.25it/s]100%|██████████| 30/30 [01:10<00:00,  2.25it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 4.042181261380514
Epoch 147/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:01, 55.90s/it]  7%|▋         | 2/30 [00:56<10:51, 23.28s/it] 10%|█         | 3/30 [00:56<05:47, 12.85s/it] 13%|█▎        | 4/30 [01:01<04:13,  9.74s/it] 17%|█▋        | 5/30 [01:02<02:39,  6.38s/it] 20%|██        | 6/30 [01:02<01:44,  4.36s/it] 23%|██▎       | 7/30 [01:03<01:10,  3.08s/it] 27%|██▋       | 8/30 [01:03<00:49,  2.24s/it] 30%|███       | 9/30 [01:03<00:35,  1.68s/it] 33%|███▎      | 10/30 [01:04<00:25,  1.30s/it] 37%|███▋      | 11/30 [01:04<00:19,  1.03s/it] 40%|████      | 12/30 [01:05<00:15,  1.17it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.37it/s] 47%|████▋     | 14/30 [01:06<00:10,  1.56it/s] 50%|█████     | 15/30 [01:06<00:08,  1.72it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.85it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.96it/s] 60%|██████    | 18/30 [01:07<00:05,  2.04it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.14it/s] 70%|███████   | 21/30 [01:09<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.21it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 4.035428778330485
Epoch 148/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:08, 58.22s/it]  7%|▋         | 2/30 [00:59<11:34, 24.79s/it] 10%|█         | 3/30 [01:00<06:09, 13.67s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.67s/it] 20%|██        | 6/30 [01:01<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 4.02887921333313
Epoch 149/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:03, 60.12s/it]  7%|▋         | 2/30 [01:00<11:40, 25.01s/it] 10%|█         | 3/30 [01:01<06:12, 13.79s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.52s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.048593425750733
Epoch 150/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:33, 57.03s/it]  7%|▋         | 2/30 [01:01<12:04, 25.88s/it] 10%|█         | 3/30 [01:01<06:25, 14.26s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.81s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.79s/it] 20%|██        | 6/30 [01:02<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:04<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 4.0381260712941485
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0479, -0.0477,  0.1058,  ..., -0.0447,  0.1079,  0.0622],
        [ 0.0355, -0.0341,  0.1174,  ..., -0.0164,  0.0757,  0.1097],
        [ 0.0146, -0.0624,  0.0086,  ..., -0.0786,  0.0587,  0.1115],
        ...,
        [-0.0707, -0.0666,  0.0682,  ...,  0.0313,  0.0761,  0.0360],
        [-0.0581, -0.1033,  0.0697,  ...,  0.0062,  0.0879,  0.0530],
        [ 0.0137, -0.0807,  0.1208,  ..., -0.0126,  0.0527,  0.0845]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9276, 0.9015, 0.8906,  ..., 0.8446, 0.8445, 0.8424],
        [0.9864, 0.9836, 0.9821,  ..., 0.9708, 0.9707, 0.9700],
        [0.9825, 0.9798, 0.9766,  ..., 0.9413, 0.9402, 0.9398],
        ...,
        [0.9577, 0.9407, 0.9398,  ..., 0.9097, 0.9087, 0.9063],
        [0.9742, 0.9729, 0.9712,  ..., 0.9473, 0.9432, 0.9426],
        [0.9664, 0.9611, 0.9587,  ..., 0.9452, 0.9446, 0.9443]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 0, 1, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 568677.1250,  391787.2500,  335313.5312,  ...,  173902.6250,
          173548.7344,  168471.2031],
        [1318235.3750, 1266625.1250, 1238400.5000,  ..., 1055114.3750,
         1052373.8750, 1041819.8125],
        [1245718.5000, 1198479.1250, 1144921.5000,  ...,  691573.0000,
          680927.0625,  677512.1875],
        ...,
        [ 874362.6875,  686350.7500,  677273.7500,  ...,  440416.7500,
          434259.9688,  419818.4062],
        [1106769.5000, 1086761.8750, 1059803.7500,  ...,  753990.0625,
          710711.5000,  705296.4375],
        [ 990164.0625,  918380.1875,  887065.3750,  ...,  731810.4375,
          725121.0625,  721997.2500]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 568677.1250,       0.0000],
         [ 391787.2500,       0.0000],
         [ 335313.5312,       0.0000],
         ...,
         [ 173902.6250,       0.0000],
         [ 173548.7344,       0.0000],
         [ 168471.2031,       0.0000]],

        [[1318235.3750,       0.0000],
         [1266625.1250,       0.0000],
         [1238400.5000,       0.0000],
         ...,
         [1055114.3750,       0.0000],
         [1052373.8750,       0.0000],
         [1041819.8125,       0.0000]],

        [[1245718.5000,       0.0000],
         [1198479.1250,       0.0000],
         [1144921.5000,       0.0000],
         ...,
         [ 691573.0000,       0.0000],
         [ 680927.0625,       0.0000],
         [ 677512.1875,       0.0000]],

        ...,

        [[ 874362.6875,       0.0000],
         [ 686350.7500,       0.0000],
         [      0.0000,  677273.7500],
         ...,
         [ 440416.7500,       0.0000],
         [      0.0000,  434259.9688],
         [ 419818.4062,       0.0000]],

        [[      0.0000, 1106769.5000],
         [1086761.8750,       0.0000],
         [1059803.7500,       0.0000],
         ...,
         [ 753990.0625,       0.0000],
         [ 710711.5000,       0.0000],
         [ 705296.4375,       0.0000]],

        [[      0.0000,  990164.0625],
         [ 918380.1875,       0.0000],
         [ 887065.3750,       0.0000],
         ...,
         [ 731810.4375,       0.0000],
         [ 725121.0625,       0.0000],
         [ 721997.2500,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4337561.0000,   520646.0000],
        [22725638.0000,        0.0000],
        [17467510.0000,   817333.1250],
        [11013975.0000,   507059.1875],
        [ 8672506.0000,  1486258.5000],
        [16420717.0000,        0.0000],
        [20814136.0000,  2188836.5000],
        [20145202.0000,   944196.8750],
        [19476954.0000,   939398.9375],
        [10479502.0000,   847722.7500],
        [15295133.0000,  2910903.2500],
        [10364531.0000,   397700.9062],
        [10762090.0000,   453178.8438],
        [20040342.0000,  1011756.0000],
        [21090298.0000,        0.0000],
        [18171902.0000,        0.0000],
        [19586424.0000,   963112.5000],
        [18519638.0000,  1921102.5000],
        [13540909.0000,  3586698.7500],
        [14154345.0000,   668629.8125],
        [17238616.0000,  1546853.0000],
        [13551867.0000,  2196546.0000],
        [23408956.0000,        0.0000],
        [19480708.0000,        0.0000],
        [12947976.0000,   595575.3125],
        [19896378.0000,   927033.6250],
        [20819532.0000,  1138691.8750],
        [21614470.0000,        0.0000],
        [23243756.0000,        0.0000],
        [20454792.0000,        0.0000],
        [24209146.0000,        0.0000],
        [21489880.0000,        0.0000],
        [ 7996098.0000,   445836.5312],
        [14364089.0000,   699917.8750],
        [13883028.0000,  3172480.5000],
        [15457444.0000,  2726004.5000],
        [13251204.0000,  1865843.6250],
        [11234439.0000,  2322662.0000],
        [ 8997009.0000,  3331991.0000],
        [22037186.0000,  1140494.8750],
        [ 9551014.0000,  1482355.5000],
        [13421728.0000,        0.0000],
        [11336348.0000,        0.0000],
        [ 8747516.0000,        0.0000],
        [ 9523976.0000,  4563849.0000],
        [ 2546040.0000,   828806.0625],
        [18926108.0000,        0.0000],
        [ 4033447.5000,  1398720.5000],
        [ 3977003.2500,  2425244.7500],
        [17072592.0000,  3871662.5000],
        [ 8557198.0000,   996028.4375],
        [12318691.0000,  4127852.7500],
        [ 9752068.0000,  5059458.0000],
        [ 9281264.0000,  1548796.3750],
        [15750646.0000,   835446.9375],
        [16369465.0000,   766972.5000],
        [12816513.0000,  3658508.0000],
        [11444868.0000,  3004951.7500],
        [ 8650913.0000,  4151802.5000],
        [ 7801293.0000,  2660552.2500],
        [11654712.0000,  2143567.7500],
        [ 9561688.0000,  1562697.5000],
        [14834118.0000,  2800871.7500],
        [15275114.0000,   990164.0625]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 151/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:02, 58.03s/it]  7%|▋         | 2/30 [01:01<12:01, 25.76s/it] 10%|█         | 3/30 [01:01<06:23, 14.20s/it] 13%|█▎        | 4/30 [01:02<03:47,  8.77s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.76s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:04<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 3.944141419728597
Epoch 152/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:45, 59.49s/it]  7%|▋         | 2/30 [00:59<11:33, 24.76s/it] 10%|█         | 3/30 [01:00<06:08, 13.66s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.73s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.74s/it] 20%|██        | 6/30 [01:02<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 4.025554124514262
Epoch 153/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:09, 56.20s/it]  7%|▋         | 2/30 [00:57<11:04, 23.74s/it] 10%|█         | 3/30 [00:57<05:53, 13.11s/it] 13%|█▎        | 4/30 [00:58<03:30,  8.11s/it] 17%|█▋        | 5/30 [01:00<02:27,  5.90s/it] 20%|██        | 6/30 [01:00<01:37,  4.05s/it] 23%|██▎       | 7/30 [01:01<01:06,  2.87s/it] 27%|██▋       | 8/30 [01:01<00:46,  2.10s/it] 30%|███       | 9/30 [01:01<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.01it/s] 40%|████      | 12/30 [01:03<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:03<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.59it/s] 50%|█████     | 15/30 [01:04<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.97it/s] 60%|██████    | 18/30 [01:05<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.15it/s] 70%|███████   | 21/30 [01:07<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 3.9585644960403443
Epoch 154/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:27, 58.87s/it]  7%|▋         | 2/30 [01:00<11:44, 25.17s/it] 10%|█         | 3/30 [01:00<06:14, 13.88s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.25it/s]100%|██████████| 30/30 [01:12<00:00,  2.25it/s]100%|██████████| 30/30 [01:13<00:00,  2.43s/it]
Epoch loss is 3.9921454429626464
Epoch 155/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:56, 55.76s/it]  7%|▋         | 2/30 [00:57<11:18, 24.22s/it] 10%|█         | 3/30 [00:59<06:09, 13.68s/it] 13%|█▎        | 4/30 [01:00<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.72s/it] 20%|██        | 6/30 [01:01<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 3.9929944038391114
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0482, -0.0464,  0.1061,  ..., -0.0458,  0.1084,  0.0619],
        [ 0.0338, -0.0348,  0.1173,  ..., -0.0177,  0.0768,  0.1103],
        [ 0.0123, -0.0586,  0.0096,  ..., -0.0774,  0.0586,  0.1133],
        ...,
        [-0.0687, -0.0633,  0.0707,  ...,  0.0301,  0.0736,  0.0362],
        [-0.0587, -0.1016,  0.0706,  ...,  0.0054,  0.0864,  0.0510],
        [ 0.0130, -0.0777,  0.1200,  ..., -0.0134,  0.0519,  0.0853]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9265, 0.9015, 0.8887,  ..., 0.8412, 0.8405, 0.8393],
        [0.9851, 0.9827, 0.9807,  ..., 0.9686, 0.9683, 0.9680],
        [0.9805, 0.9776, 0.9746,  ..., 0.9396, 0.9365, 0.9349],
        ...,
        [0.9531, 0.9350, 0.9348,  ..., 0.9042, 0.9026, 0.8999],
        [0.9718, 0.9697, 0.9680,  ..., 0.9432, 0.9390, 0.9388],
        [0.9646, 0.9587, 0.9552,  ..., 0.9426, 0.9410, 0.9404]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 1,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 559701.5000,  392082.9062,  326229.1562,  ...,  165650.3438,
          163870.5625,  161170.9688],
        [1292796.2500, 1250151.6250, 1215506.7500,  ..., 1022305.6875,
         1017518.2500, 1012582.3125],
        [1210489.7500, 1162164.2500, 1113310.6250,  ...,  675387.1250,
          645811.2500,  631245.8125],
        ...,
        [ 819352.0000,  632280.2500,  630544.9375,  ...,  406981.5000,
          398073.9062,  383170.5625],
        [1069354.2500, 1037444.5000, 1012913.6250,  ...,  710508.8750,
          669620.1250,  667236.0625],
        [ 964593.2500,  886669.5625,  843553.8750,  ...,  704456.1875,
          688983.1875,  682856.5625]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 559701.5000,       0.0000],
         [ 392082.9062,       0.0000],
         [ 326229.1562,       0.0000],
         ...,
         [ 165650.3438,       0.0000],
         [ 163870.5625,       0.0000],
         [ 161170.9688,       0.0000]],

        [[1292796.2500,       0.0000],
         [1250151.6250,       0.0000],
         [1215506.7500,       0.0000],
         ...,
         [1022305.6875,       0.0000],
         [1017518.2500,       0.0000],
         [1012582.3125,       0.0000]],

        [[1210489.7500,       0.0000],
         [1162164.2500,       0.0000],
         [1113310.6250,       0.0000],
         ...,
         [ 675387.1250,       0.0000],
         [ 645811.2500,       0.0000],
         [ 631245.8125,       0.0000]],

        ...,

        [[ 819352.0000,       0.0000],
         [ 632280.2500,       0.0000],
         [      0.0000,  630544.9375],
         ...,
         [      0.0000,  406981.5000],
         [ 398073.9062,       0.0000],
         [ 383170.5625,       0.0000]],

        [[      0.0000, 1069354.2500],
         [1037444.5000,       0.0000],
         [1012913.6250,       0.0000],
         ...,
         [ 710508.8750,       0.0000],
         [ 669620.1250,       0.0000],
         [ 667236.0625,       0.0000]],

        [[      0.0000,  964593.2500],
         [ 886669.5625,       0.0000],
         [ 843553.8750,       0.0000],
         ...,
         [ 704456.1875,       0.0000],
         [ 688983.1875,       0.0000],
         [ 682856.5625,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4224851.0000,   498651.0938],
        [22190270.0000,        0.0000],
        [16842652.0000,   805195.8125],
        [10552424.0000,   479937.1250],
        [ 7973954.5000,  1366830.1250],
        [15518762.0000,        0.0000],
        [19331242.0000,  2984887.2500],
        [19301970.0000,   888249.6875],
        [18688956.0000,   902106.7500],
        [10044863.0000,   818005.6250],
        [14945848.0000,  2738860.7500],
        [ 9441366.0000,   350363.5000],
        [10320220.0000,   396966.1875],
        [19777706.0000,   980442.3750],
        [20803354.0000,        0.0000],
        [17721520.0000,        0.0000],
        [19025992.0000,   933614.1250],
        [17982664.0000,  1837847.0000],
        [13054776.0000,  3378135.7500],
        [13674698.0000,   613505.9375],
        [16908524.0000,  1463257.2500],
        [13069779.0000,  2037076.7500],
        [22988538.0000,        0.0000],
        [19065008.0000,        0.0000],
        [12460126.0000,   552678.3125],
        [20306000.0000,        0.0000],
        [20309770.0000,  1104118.1250],
        [21227686.0000,        0.0000],
        [22793148.0000,        0.0000],
        [20067292.0000,        0.0000],
        [23759792.0000,        0.0000],
        [21046142.0000,        0.0000],
        [ 7651939.0000,   394820.5312],
        [13429405.0000,   693983.8125],
        [13358492.0000,  3078600.5000],
        [15187555.0000,  1879982.5000],
        [12611904.0000,  1822768.5000],
        [10203716.0000,  2186365.2500],
        [ 8068578.0000,  3158052.0000],
        [21551148.0000,  1115184.1250],
        [ 8990300.0000,  1408572.3750],
        [12668588.0000,        0.0000],
        [10853344.0000,        0.0000],
        [ 8196079.0000,        0.0000],
        [ 9536033.0000,  3731748.5000],
        [ 2032582.1250,   883972.5625],
        [18150070.0000,        0.0000],
        [ 3844760.0000,  1333653.6250],
        [ 3444120.0000,  2179414.0000],
        [16487268.0000,  3744692.2500],
        [ 8030728.0000,   889143.0000],
        [11847923.0000,  3977130.2500],
        [ 9360981.0000,  4940602.0000],
        [ 8807103.0000,  1490914.2500],
        [15408940.0000,   816867.1250],
        [15728916.0000,   739615.3125],
        [13052931.0000,  2886877.0000],
        [10223868.0000,  3469502.7500],
        [ 8151508.5000,  4056434.2500],
        [ 7077472.5000,  2567707.0000],
        [11694016.0000,  1451183.0000],
        [ 8876346.0000,  1446405.2500],
        [14092814.0000,  2714707.0000],
        [14510584.0000,   964593.2500]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 156/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:02, 55.93s/it]  7%|▋         | 2/30 [00:56<10:59, 23.55s/it] 10%|█         | 3/30 [00:59<06:22, 14.16s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.74s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.75s/it] 20%|██        | 6/30 [01:01<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 3.9687745809555053
Epoch 157/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:02<30:00, 62.07s/it]  7%|▋         | 2/30 [01:02<12:02, 25.82s/it] 10%|█         | 3/30 [01:02<06:24, 14.23s/it] 13%|█▎        | 4/30 [01:03<03:48,  8.79s/it] 17%|█▋        | 5/30 [01:03<02:24,  5.78s/it] 20%|██        | 6/30 [01:04<01:35,  3.96s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:05<00:45,  2.06s/it] 30%|███       | 9/30 [01:05<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:06<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:06<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:07<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:08<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:09<00:06,  1.99it/s] 60%|██████    | 18/30 [01:09<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:10<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:10<00:04,  2.16it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:11<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.23it/s] 80%|████████  | 24/30 [01:12<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:13<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:14<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.26it/s]100%|██████████| 30/30 [01:15<00:00,  2.50s/it]
Epoch loss is 4.003228584925334
Epoch 158/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:11, 58.34s/it]  7%|▋         | 2/30 [00:59<11:33, 24.78s/it] 10%|█         | 3/30 [01:00<06:08, 13.67s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.45s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.9012500206629435
Epoch 159/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:10, 56.23s/it]  7%|▋         | 2/30 [01:00<12:00, 25.74s/it] 10%|█         | 3/30 [01:01<06:23, 14.19s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.76s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.76s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.9162410895029702
Epoch 160/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:51, 59.69s/it]  7%|▋         | 2/30 [01:00<11:35, 24.84s/it] 10%|█         | 3/30 [01:00<06:09, 13.70s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.46s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.9673810323079426
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0489, -0.0459,  0.1058,  ..., -0.0472,  0.1090,  0.0614],
        [ 0.0316, -0.0356,  0.1166,  ..., -0.0193,  0.0784,  0.1108],
        [ 0.0100, -0.0540,  0.0105,  ..., -0.0758,  0.0585,  0.1149],
        ...,
        [-0.0674, -0.0600,  0.0726,  ...,  0.0290,  0.0718,  0.0364],
        [-0.0599, -0.1000,  0.0705,  ...,  0.0038,  0.0862,  0.0489],
        [ 0.0115, -0.0746,  0.1185,  ..., -0.0143,  0.0526,  0.0861]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9247, 0.9018, 0.8869,  ..., 0.8387, 0.8379, 0.8337],
        [0.9837, 0.9817, 0.9792,  ..., 0.9664, 0.9663, 0.9650],
        [0.9783, 0.9752, 0.9725,  ..., 0.9378, 0.9326, 0.9316],
        ...,
        [0.9479, 0.9296, 0.9287,  ..., 0.8971, 0.8971, 0.8953],
        [0.9689, 0.9658, 0.9644,  ..., 0.9387, 0.9350, 0.9350],
        [0.9623, 0.9558, 0.9519,  ..., 0.9376, 0.9372, 0.9369]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 1, 0,  ..., 1, 1, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 546153.9375,  393564.5625,  318129.7500,  ...,  159646.4062,
          157954.3438,  148739.1406],
        [1267680.1250, 1232474.1250, 1188663.7500,  ...,  989759.9375,
          988512.8750,  970876.3750],
        [1173442.6250, 1123546.8750, 1081147.7500,  ...,  658454.5625,
          610958.5625,  602307.3750],
        ...,
        [ 759775.4375,  585380.2500,  578193.0000,  ...,  367987.5938,
          367879.5000,  358487.8438],
        [1026572.1875,  982301.1250,  962909.5000,  ...,  667030.5625,
          631998.1875,  631932.5000],
        [ 933909.8125,  850684.1875,  805020.0000,  ...,  655901.8750,
          652695.7500,  649629.3125]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 546153.9375,       0.0000],
         [ 393564.5625,       0.0000],
         [ 318129.7500,       0.0000],
         ...,
         [ 159646.4062,       0.0000],
         [ 157954.3438,       0.0000],
         [ 148739.1406,       0.0000]],

        [[1267680.1250,       0.0000],
         [1232474.1250,       0.0000],
         [1188663.7500,       0.0000],
         ...,
         [ 989759.9375,       0.0000],
         [ 988512.8750,       0.0000],
         [ 970876.3750,       0.0000]],

        [[1173442.6250,       0.0000],
         [1123546.8750,       0.0000],
         [1081147.7500,       0.0000],
         ...,
         [ 658454.5625,       0.0000],
         [ 610958.5625,       0.0000],
         [      0.0000,  602307.3750]],

        ...,

        [[ 759775.4375,       0.0000],
         [      0.0000,  585380.2500],
         [ 578193.0000,       0.0000],
         ...,
         [      0.0000,  367987.5938],
         [      0.0000,  367879.5000],
         [ 358487.8438,       0.0000]],

        [[      0.0000, 1026572.1875],
         [ 982301.1250,       0.0000],
         [ 962909.5000,       0.0000],
         ...,
         [ 667030.5625,       0.0000],
         [ 631998.1875,       0.0000],
         [ 631932.5000,       0.0000]],

        [[      0.0000,  933909.8125],
         [ 850684.1875,       0.0000],
         [ 805020.0000,       0.0000],
         ...,
         [ 655901.8750,       0.0000],
         [ 652695.7500,       0.0000],
         [ 649629.3125,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4126131.0000,   475846.1250],
        [21642476.0000,        0.0000],
        [15597865.0000,  1390677.1250],
        [10132734.0000,   449666.3438],
        [ 7301642.0000,  1251458.2500],
        [14634279.0000,        0.0000],
        [18709392.0000,  2915515.5000],
        [18429596.0000,   831376.0625],
        [17898324.0000,   865544.3750],
        [ 9614239.0000,   782534.4375],
        [14588754.0000,  2557819.0000],
        [ 8660730.0000,   308576.1250],
        [ 9896745.0000,   345361.8438],
        [19520664.0000,   951398.1875],
        [20497160.0000,        0.0000],
        [17263576.0000,        0.0000],
        [18477328.0000,   899833.2500],
        [17450226.0000,  1748398.7500],
        [12564696.0000,  3159248.0000],
        [13184914.0000,   563155.0000],
        [16507121.0000,  1382655.5000],
        [13144698.0000,  1364397.5000],
        [22500260.0000,        0.0000],
        [18636700.0000,        0.0000],
        [12030192.0000,   508706.5000],
        [19793316.0000,        0.0000],
        [19837640.0000,  1069343.0000],
        [20808714.0000,        0.0000],
        [22324054.0000,        0.0000],
        [19660706.0000,        0.0000],
        [23318560.0000,        0.0000],
        [20575452.0000,        0.0000],
        [ 7327256.5000,   350005.5000],
        [11986626.0000,  1252551.1250],
        [12822152.0000,  2978908.0000],
        [14142574.0000,  1802559.2500],
        [11955871.0000,  1778950.7500],
        [ 9215828.0000,  2053481.5000],
        [ 7271153.0000,  2994063.0000],
        [21024964.0000,  1086281.1250],
        [ 8831456.0000,   979342.0625],
        [11933522.0000,        0.0000],
        [10331294.0000,        0.0000],
        [ 7690692.0000,        0.0000],
        [ 8470936.0000,  4012709.0000],
        [ 1563528.0000,  1000708.8750],
        [17348202.0000,        0.0000],
        [ 3640417.7500,  1264652.5000],
        [ 2996561.7500,  1968004.0000],
        [15881728.0000,  3615988.5000],
        [ 7511448.0000,   785836.8750],
        [11357396.0000,  3819276.5000],
        [ 8968293.0000,  4804350.0000],
        [ 8353987.0000,  1424287.2500],
        [15042362.0000,   799338.1250],
        [15046530.0000,   711429.6875],
        [12562379.0000,  2833507.0000],
        [10238972.0000,  2742311.5000],
        [ 7650535.0000,  3939935.5000],
        [ 6144689.5000,  2782748.7500],
        [11169130.0000,  1386464.2500],
        [ 7853020.0000,  1700240.0000],
        [13308171.0000,  2612499.5000],
        [13732787.0000,   933909.8125]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 161/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:54, 57.74s/it]  7%|▋         | 2/30 [00:59<11:40, 25.01s/it] 10%|█         | 3/30 [01:00<06:12, 13.79s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.52s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.9001397132873534
Epoch 162/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:53, 57.69s/it]  7%|▋         | 2/30 [00:59<11:29, 24.62s/it] 10%|█         | 3/30 [01:00<06:12, 13.81s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.902778395016988
Epoch 163/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:06, 56.08s/it]  7%|▋         | 2/30 [00:59<11:48, 25.31s/it] 10%|█         | 3/30 [01:00<06:16, 13.95s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.67s/it] 20%|██        | 6/30 [01:01<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.8665342410405477
Epoch 164/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<28:00, 57.96s/it]  7%|▋         | 2/30 [00:58<11:15, 24.13s/it] 10%|█         | 3/30 [00:58<05:59, 13.31s/it] 13%|█▎        | 4/30 [00:59<03:34,  8.23s/it] 17%|█▋        | 5/30 [01:00<02:26,  5.84s/it] 20%|██        | 6/30 [01:01<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.08s/it] 30%|███       | 9/30 [01:02<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.60it/s] 50%|█████     | 15/30 [01:05<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 3.904372493426005
Epoch 165/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:47, 57.50s/it]  7%|▋         | 2/30 [00:57<11:10, 23.94s/it] 10%|█         | 3/30 [01:00<06:23, 14.19s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.76s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.76s/it] 20%|██        | 6/30 [01:01<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.8516504128774005
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0492, -0.0462,  0.1055,  ..., -0.0485,  0.1097,  0.0610],
        [ 0.0295, -0.0369,  0.1158,  ..., -0.0208,  0.0797,  0.1110],
        [ 0.0077, -0.0497,  0.0111,  ..., -0.0742,  0.0576,  0.1164],
        ...,
        [-0.0654, -0.0570,  0.0743,  ...,  0.0271,  0.0701,  0.0364],
        [-0.0601, -0.0981,  0.0703,  ...,  0.0026,  0.0857,  0.0467],
        [ 0.0104, -0.0718,  0.1171,  ..., -0.0147,  0.0536,  0.0866]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9231, 0.9023, 0.8857,  ..., 0.8362, 0.8346, 0.8319],
        [0.9821, 0.9806, 0.9774,  ..., 0.9642, 0.9638, 0.9637],
        [0.9759, 0.9729, 0.9702,  ..., 0.9362, 0.9298, 0.9282],
        ...,
        [0.9426, 0.9244, 0.9226,  ..., 0.8947, 0.8902, 0.8901],
        [0.9656, 0.9616, 0.9605,  ..., 0.9336, 0.9319, 0.9306],
        [0.9596, 0.9526, 0.9497,  ..., 0.9337, 0.9336, 0.9318]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 0,  ..., 1, 0, 1],
        [1, 0, 0,  ..., 0, 1, 0],
        [1, 0, 0,  ..., 0, 0, 1]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [0., 1.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 533221.5000,  396554.4688,  312537.3125,  ...,  154188.9688,
          150766.3750,  145012.8594],
        [1239515.8750, 1213393.1250, 1158932.3750,  ...,  959484.8125,
          954763.0625,  952229.6875],
        [1134009.2500, 1086632.3750, 1045284.1875,  ...,  643124.1875,
          586789.3125,  574154.3125],
        ...,
        [ 705137.6875,  543158.9375,  529669.7500,  ...,  355655.6562,
          333339.2812,  332758.3438],
        [ 979377.9375,  924541.1875,  910140.6875,  ...,  620179.2500,
          604740.8750,  593985.3750],
        [ 898389.2500,  813261.9375,  779623.5625,  ...,  620489.1875,
          620111.8125,  603921.8750]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 533221.5000,       0.0000],
         [ 396554.4688,       0.0000],
         [ 312537.3125,       0.0000],
         ...,
         [ 154188.9688,       0.0000],
         [ 150766.3750,       0.0000],
         [ 145012.8594,       0.0000]],

        [[1239515.8750,       0.0000],
         [1213393.1250,       0.0000],
         [1158932.3750,       0.0000],
         ...,
         [ 959484.8125,       0.0000],
         [ 954763.0625,       0.0000],
         [ 952229.6875,       0.0000]],

        [[1134009.2500,       0.0000],
         [1086632.3750,       0.0000],
         [1045284.1875,       0.0000],
         ...,
         [ 643124.1875,       0.0000],
         [ 586789.3125,       0.0000],
         [ 574154.3125,       0.0000]],

        ...,

        [[ 705137.6875,       0.0000],
         [      0.0000,  543158.9375],
         [ 529669.7500,       0.0000],
         ...,
         [      0.0000,  355655.6562],
         [ 333339.2812,       0.0000],
         [      0.0000,  332758.3438]],

        [[      0.0000,  979377.9375],
         [ 924541.1875,       0.0000],
         [ 910140.6875,       0.0000],
         ...,
         [ 620179.2500,       0.0000],
         [      0.0000,  604740.8750],
         [ 593985.3750,       0.0000]],

        [[      0.0000,  898389.2500],
         [ 813261.9375,       0.0000],
         [ 779623.5625,       0.0000],
         ...,
         [ 620489.1875,       0.0000],
         [ 620111.8125,       0.0000],
         [      0.0000,  603921.8750]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 4044364.0000,   452198.6875],
        [21101612.0000,        0.0000],
        [15542050.0000,   768116.5625],
        [ 9738883.0000,   415560.5625],
        [ 6691974.0000,  1144045.3750],
        [13774676.0000,        0.0000],
        [18071794.0000,  2847720.5000],
        [17619476.0000,   777583.0625],
        [17108976.0000,   828869.5625],
        [ 9516404.0000,   414059.6875],
        [14175067.0000,  2367468.0000],
        [ 7998082.0000,   271897.3125],
        [ 9473771.0000,   302258.4375],
        [19253790.0000,   923169.4375],
        [20169164.0000,        0.0000],
        [16831062.0000,        0.0000],
        [17901540.0000,   860598.5000],
        [16943200.0000,  1653070.0000],
        [12106800.0000,  2941721.7500],
        [13229374.0000,        0.0000],
        [16713914.0000,   659951.3750],
        [12657548.0000,  1262977.5000],
        [21977970.0000,        0.0000],
        [18224874.0000,        0.0000],
        [11639936.0000,   467965.3438],
        [19285448.0000,        0.0000],
        [19326034.0000,  1031363.8125],
        [20393150.0000,        0.0000],
        [21809472.0000,        0.0000],
        [19247212.0000,        0.0000],
        [22914476.0000,        0.0000],
        [20117524.0000,        0.0000],
        [ 7066224.0000,   311377.3438],
        [11288973.0000,  1224073.7500],
        [12272657.0000,  2878577.0000],
        [13146288.0000,  1725566.6250],
        [11301014.0000,  1728030.6250],
        [ 7845422.5000,  2346268.0000],
        [ 6530045.0000,  2819269.5000],
        [20490748.0000,  1056233.8750],
        [ 7951275.5000,  1302458.6250],
        [11273452.0000,        0.0000],
        [ 9824994.0000,        0.0000],
        [ 6982211.0000,   253178.4219],
        [ 7940712.0000,  3755283.5000],
        [ 1294183.2500,  1023284.3125],
        [16579098.0000,        0.0000],
        [ 3444245.7500,  1188122.6250],
        [ 2619093.2500,  1785012.6250],
        [14575702.0000,  4173748.5000],
        [ 7273359.0000,   381389.6250],
        [11476064.0000,  3049792.2500],
        [ 8581401.0000,  4657892.0000],
        [ 7921941.0000,  1352510.0000],
        [14698340.0000,   780615.3125],
        [14364961.0000,   682115.8750],
        [12054843.0000,  2780054.0000],
        [ 9110854.0000,  3201338.0000],
        [ 7220913.0000,  3812184.7500],
        [ 5581071.5000,  2681812.0000],
        [10644416.0000,  1324311.5000],
        [ 7283102.5000,  1587479.7500],
        [11911590.0000,  3100263.7500],
        [12361918.0000,  1502311.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 166/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:14, 60.51s/it]  7%|▋         | 2/30 [01:00<11:44, 25.17s/it] 10%|█         | 3/30 [01:01<06:14, 13.88s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 3.8385705312093097
Epoch 167/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:02, 55.95s/it]  7%|▋         | 2/30 [01:00<12:06, 25.93s/it] 10%|█         | 3/30 [01:01<06:25, 14.29s/it] 13%|█▎        | 4/30 [01:01<03:49,  8.82s/it] 17%|█▋        | 5/30 [01:02<02:25,  5.80s/it] 20%|██        | 6/30 [01:02<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 3.8453500270843506
Epoch 168/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:37, 55.08s/it]  7%|▋         | 2/30 [00:55<10:48, 23.17s/it] 10%|█         | 3/30 [00:59<06:28, 14.41s/it] 13%|█▎        | 4/30 [01:00<03:51,  8.89s/it] 17%|█▋        | 5/30 [01:00<02:26,  5.85s/it] 20%|██        | 6/30 [01:01<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.08s/it] 30%|███       | 9/30 [01:02<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.60it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 3.864721099535624
Epoch 169/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:02, 58.02s/it]  7%|▋         | 2/30 [00:58<11:16, 24.15s/it] 10%|█         | 3/30 [01:00<06:14, 13.87s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.64s/it] 20%|██        | 6/30 [01:01<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.758379093805949
Epoch 170/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:20, 56.56s/it]  7%|▋         | 2/30 [00:57<10:59, 23.55s/it] 10%|█         | 3/30 [00:59<06:11, 13.75s/it] 13%|█▎        | 4/30 [00:59<03:40,  8.50s/it] 17%|█▋        | 5/30 [00:59<02:19,  5.59s/it] 20%|██        | 6/30 [01:00<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 3.7478888511657713
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0495, -0.0473,  0.1050,  ..., -0.0502,  0.1097,  0.0606],
        [ 0.0267, -0.0384,  0.1150,  ..., -0.0228,  0.0803,  0.1111],
        [ 0.0057, -0.0456,  0.0118,  ..., -0.0736,  0.0564,  0.1182],
        ...,
        [-0.0647, -0.0549,  0.0758,  ...,  0.0246,  0.0684,  0.0359],
        [-0.0617, -0.0968,  0.0701,  ...,  0.0014,  0.0852,  0.0440],
        [ 0.0080, -0.0688,  0.1163,  ..., -0.0152,  0.0544,  0.0868]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9213, 0.9027, 0.8843,  ..., 0.8339, 0.8309, 0.8298],
        [0.9806, 0.9794, 0.9760,  ..., 0.9624, 0.9621, 0.9615],
        [0.9733, 0.9702, 0.9674,  ..., 0.9316, 0.9281, 0.9248],
        ...,
        [0.9371, 0.9193, 0.9167,  ..., 0.8903, 0.8854, 0.8846],
        [0.9620, 0.9570, 0.9567,  ..., 0.9293, 0.9288, 0.9275],
        [0.9565, 0.9493, 0.9474,  ..., 0.9283, 0.9280, 0.9275]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 1, 0,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 1, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [0., 1.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 520150.1875,  398528.2188,  306580.5625,  ...,  149167.5781,
          142917.7656,  140724.0469],
        [1213095.6250, 1192745.0000, 1135490.7500,  ...,  935735.6250,
          930852.8125,  923926.8125],
        [1092253.1250, 1044919.3750, 1005071.3125,  ...,  602548.6875,
          572582.2500,  546381.6250],
        ...,
        [ 651740.3750,  504952.8125,  486637.1250,  ...,  334020.2812,
          311374.0625,  307677.4688],
        [ 929498.1875,  865302.6250,  862282.6250,  ...,  582788.3750,
          578836.3125,  567696.8750],
        [ 859521.5625,  775749.8750,  754579.2500,  ...,  574228.8125,
          572231.8125,  567794.8750]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 520150.1875,       0.0000],
         [ 398528.2188,       0.0000],
         [ 306580.5625,       0.0000],
         ...,
         [ 149167.5781,       0.0000],
         [ 142917.7656,       0.0000],
         [ 140724.0469,       0.0000]],

        [[1213095.6250,       0.0000],
         [1192745.0000,       0.0000],
         [1135490.7500,       0.0000],
         ...,
         [ 935735.6250,       0.0000],
         [ 930852.8125,       0.0000],
         [ 923926.8125,       0.0000]],

        [[1092253.1250,       0.0000],
         [1044919.3750,       0.0000],
         [1005071.3125,       0.0000],
         ...,
         [ 602548.6875,       0.0000],
         [ 572582.2500,       0.0000],
         [      0.0000,  546381.6250]],

        ...,

        [[ 651740.3750,       0.0000],
         [      0.0000,  504952.8125],
         [ 486637.1250,       0.0000],
         ...,
         [      0.0000,  334020.2812],
         [ 311374.0625,       0.0000],
         [ 307677.4688,       0.0000]],

        [[      0.0000,  929498.1875],
         [ 865302.6250,       0.0000],
         [ 862282.6250,       0.0000],
         ...,
         [ 582788.3750,       0.0000],
         [ 578836.3125,       0.0000],
         [ 567696.8750,       0.0000]],

        [[      0.0000,  859521.5625],
         [ 775749.8750,       0.0000],
         [ 754579.2500,       0.0000],
         ...,
         [      0.0000,  574228.8125],
         [ 572231.8125,       0.0000],
         [ 567794.8750,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3954896.5000,   425976.5000],
        [20590334.0000,        0.0000],
        [14308180.0000,  1293615.6250],
        [ 9402609.0000,   383925.1875],
        [ 6171225.0000,  1046446.1875],
        [12925329.0000,        0.0000],
        [17390980.0000,  2776304.0000],
        [16757619.0000,   722839.1875],
        [16386215.0000,   797343.4375],
        [ 8780286.0000,   702018.5000],
        [13786918.0000,  2197238.0000],
        [ 7393864.0000,   236676.3281],
        [ 9290277.0000,        0.0000],
        [19001636.0000,   892491.8125],
        [19857580.0000,        0.0000],
        [16451752.0000,        0.0000],
        [17348820.0000,   826315.5625],
        [16452310.0000,  1552407.5000],
        [12209167.0000,  2179698.7500],
        [12739716.0000,        0.0000],
        [16268666.0000,   617735.5000],
        [12698118.0000,   681711.3750],
        [21472142.0000,        0.0000],
        [17872288.0000,        0.0000],
        [11269909.0000,   429300.9688],
        [18795346.0000,        0.0000],
        [18845752.0000,   991695.9375],
        [20028090.0000,        0.0000],
        [21355444.0000,        0.0000],
        [18877552.0000,        0.0000],
        [22542112.0000,        0.0000],
        [19709332.0000,        0.0000],
        [ 7132632.5000,        0.0000],
        [10199671.0000,  1698000.5000],
        [11797974.0000,  2784791.5000],
        [12208351.0000,  1644512.0000],
        [10635662.0000,  1676653.8750],
        [ 7098634.0000,  2222813.5000],
        [ 5643861.0000,  2996772.2500],
        [19959304.0000,  1026118.0000],
        [ 7172924.0000,  1594535.8750],
        [10722758.0000,        0.0000],
        [ 9380690.0000,        0.0000],
        [ 6631962.0000,   242465.5469],
        [ 7465361.0000,  3511439.7500],
        [ 1149144.3750,   984849.5625],
        [15904993.0000,        0.0000],
        [ 3271997.5000,  1115435.6250],
        [ 2211792.0000,  1762416.7500],
        [13935407.0000,  3987509.5000],
        [ 6768692.5000,   343678.6250],
        [10967184.0000,  2934723.5000],
        [ 8239003.0000,  4517557.0000],
        [ 7581999.0000,  1282841.1250],
        [14354366.0000,   762214.6250],
        [13707397.0000,   656333.5625],
        [11568936.0000,  2726130.0000],
        [ 8599262.0000,  3115960.7500],
        [ 6835915.5000,  3683326.0000],
        [ 5074981.0000,  2574265.5000],
        [10624750.0000,   766375.8750],
        [ 7045442.0000,  1181893.5000],
        [11176174.0000,  2967300.0000],
        [11656715.0000,  1433750.3750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 171/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:53, 59.78s/it]  7%|▋         | 2/30 [01:00<11:36, 24.88s/it] 10%|█         | 3/30 [01:00<06:10, 13.72s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.48s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.58s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.807108187675476
Epoch 172/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:07, 56.12s/it]  7%|▋         | 2/30 [00:57<11:16, 24.15s/it] 10%|█         | 3/30 [00:58<05:59, 13.33s/it] 13%|█▎        | 4/30 [00:58<03:34,  8.24s/it] 17%|█▋        | 5/30 [00:59<02:21,  5.65s/it] 20%|██        | 6/30 [01:00<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:00<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.02s/it] 30%|███       | 9/30 [01:01<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:02<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:06<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 3.7787232478459676
Epoch 173/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:08, 60.28s/it]  7%|▋         | 2/30 [01:00<11:42, 25.08s/it] 10%|█         | 3/30 [01:01<06:13, 13.83s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.62s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.7813939174016316
Epoch 174/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:54, 59.82s/it]  7%|▋         | 2/30 [01:00<11:37, 24.91s/it] 10%|█         | 3/30 [01:00<06:10, 13.74s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.49s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.7410797278086343
Epoch 175/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:44, 57.41s/it]  7%|▋         | 2/30 [01:00<11:53, 25.47s/it] 10%|█         | 3/30 [01:00<06:19, 14.04s/it] 13%|█▎        | 4/30 [01:01<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.70s/it] 20%|██        | 6/30 [01:02<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.79342782497406
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0494, -0.0482,  0.1038,  ..., -0.0518,  0.1093,  0.0605],
        [ 0.0242, -0.0398,  0.1138,  ..., -0.0243,  0.0808,  0.1113],
        [ 0.0033, -0.0422,  0.0122,  ..., -0.0731,  0.0552,  0.1203],
        ...,
        [-0.0635, -0.0527,  0.0772,  ...,  0.0223,  0.0659,  0.0353],
        [-0.0631, -0.0954,  0.0693,  ...,  0.0005,  0.0846,  0.0416],
        [ 0.0054, -0.0656,  0.1150,  ..., -0.0148,  0.0549,  0.0873]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9194, 0.9032, 0.8831,  ..., 0.8317, 0.8274, 0.8265],
        [0.9791, 0.9782, 0.9746,  ..., 0.9604, 0.9600, 0.9600],
        [0.9704, 0.9672, 0.9645,  ..., 0.9260, 0.9257, 0.9219],
        ...,
        [0.9311, 0.9136, 0.9126,  ..., 0.8838, 0.8806, 0.8800],
        [0.9581, 0.9549, 0.9519,  ..., 0.9237, 0.9231, 0.9227],
        [0.9529, 0.9457, 0.9450,  ..., 0.9245, 0.9237, 0.9227]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 505984.4062,  401641.2500,  301410.7188,  ...,  144496.9844,
          135888.7031,  134198.1406],
        [1186481.3750, 1171776.3750, 1112891.3750,  ...,  909390.2500,
          904088.5000,  903196.6250],
        [1048990.1250, 1000950.5000,  963826.4375,  ...,  556094.7500,
          553838.5625,  524603.8750],
        ...,
        [ 597753.5625,  465768.5312,  459475.0625,  ...,  304262.0938,
          290671.3125,  288193.7188],
        [ 879167.1875,  840104.9375,  805489.9375,  ...,  538333.1250,
          533287.6250,  530404.6250],
        [ 816857.0000,  737194.3125,  729117.3125,  ...,  544317.3750,
          537871.2500,  530140.6875]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 505984.4062,       0.0000],
         [ 401641.2500,       0.0000],
         [ 301410.7188,       0.0000],
         ...,
         [ 144496.9844,       0.0000],
         [ 135888.7031,       0.0000],
         [ 134198.1406,       0.0000]],

        [[1186481.3750,       0.0000],
         [1171776.3750,       0.0000],
         [1112891.3750,       0.0000],
         ...,
         [ 909390.2500,       0.0000],
         [ 904088.5000,       0.0000],
         [ 903196.6250,       0.0000]],

        [[1048990.1250,       0.0000],
         [1000950.5000,       0.0000],
         [ 963826.4375,       0.0000],
         ...,
         [ 556094.7500,       0.0000],
         [ 553838.5625,       0.0000],
         [      0.0000,  524603.8750]],

        ...,

        [[ 597753.5625,       0.0000],
         [      0.0000,  465768.5312],
         [ 459475.0625,       0.0000],
         ...,
         [ 304262.0938,       0.0000],
         [ 290671.3125,       0.0000],
         [ 288193.7188,       0.0000]],

        [[      0.0000,  879167.1875],
         [ 840104.9375,       0.0000],
         [ 805489.9375,       0.0000],
         ...,
         [      0.0000,  538333.1250],
         [ 533287.6250,       0.0000],
         [ 530404.6250,       0.0000]],

        [[      0.0000,  816857.0000],
         [ 737194.3125,       0.0000],
         [ 729117.3125,       0.0000],
         ...,
         [ 544317.3750,       0.0000],
         [ 537871.2500,       0.0000],
         [ 530140.6875,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3859726.5000,   402145.1250],
        [20090288.0000,        0.0000],
        [13656813.0000,  1252416.5000],
        [ 9052424.0000,   353211.1562],
        [ 5448175.0000,  1192381.3750],
        [12070994.0000,        0.0000],
        [16653852.0000,  2699537.5000],
        [16001192.0000,   673119.1875],
        [15786490.0000,   769227.8750],
        [ 8407769.0000,   660599.6250],
        [13417326.0000,  2030549.2500],
        [ 6876867.0000,   207749.8594],
        [ 8892167.0000,        0.0000],
        [18776772.0000,   865342.2500],
        [19533640.0000,        0.0000],
        [16095654.0000,        0.0000],
        [16825404.0000,   792688.9375],
        [16011351.0000,  1458424.8750],
        [11778770.0000,  2021608.2500],
        [12328173.0000,        0.0000],
        [16444186.0000,        0.0000],
        [12282568.0000,   633779.3125],
        [20959480.0000,        0.0000],
        [17539416.0000,        0.0000],
        [11346482.0000,        0.0000],
        [18327408.0000,        0.0000],
        [18356832.0000,   949758.2500],
        [19653640.0000,        0.0000],
        [20929608.0000,        0.0000],
        [18511928.0000,        0.0000],
        [22233386.0000,        0.0000],
        [19303492.0000,        0.0000],
        [ 6952374.5000,        0.0000],
        [ 9704450.0000,  1653642.2500],
        [11314196.0000,  2708959.0000],
        [11366782.0000,  1571904.3750],
        [ 9610188.0000,  2055892.5000],
        [ 6421847.0000,  2106368.0000],
        [ 5142795.0000,  2851452.7500],
        [19450570.0000,   998744.0625],
        [ 6804267.5000,  1559799.8750],
        [10229252.0000,        0.0000],
        [ 8940321.0000,        0.0000],
        [ 6336530.0000,   232322.7031],
        [ 7023318.5000,  3269609.5000],
        [ 1045672.9375,   951008.0000],
        [15203830.0000,        0.0000],
        [ 3124440.0000,  1046820.9375],
        [ 2101799.5000,  1494211.2500],
        [13304872.0000,  3815426.0000],
        [ 6282142.5000,   307504.7188],
        [10495624.0000,  2830518.5000],
        [ 7921199.5000,  4374223.0000],
        [ 7306999.0000,  1215607.7500],
        [14056375.0000,   743132.8125],
        [13072669.0000,   628636.7500],
        [11118044.0000,  2669822.5000],
        [ 8118141.0000,  3033272.7500],
        [ 6486246.5000,  3551358.7500],
        [ 4644977.0000,  2476680.7500],
        [10146799.0000,   748084.0000],
        [ 6479165.0000,  1103886.7500],
        [ 9927113.0000,  3368252.7500],
        [10998222.0000,  1364135.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 176/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:19, 56.55s/it]  7%|▋         | 2/30 [00:57<11:11, 24.00s/it] 10%|█         | 3/30 [00:58<05:57, 13.24s/it] 13%|█▎        | 4/30 [01:00<03:53,  8.97s/it] 17%|█▋        | 5/30 [01:01<02:27,  5.89s/it] 20%|██        | 6/30 [01:01<01:36,  4.04s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.86s/it] 27%|██▋       | 8/30 [01:02<00:46,  2.09s/it] 30%|███       | 9/30 [01:02<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.60it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.7308871030807493
Epoch 177/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:03, 60.13s/it]  7%|▋         | 2/30 [01:00<11:40, 25.02s/it] 10%|█         | 3/30 [01:01<06:12, 13.80s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.7564011891682942
Epoch 178/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:07, 58.17s/it]  7%|▋         | 2/30 [01:01<11:58, 25.65s/it] 10%|█         | 3/30 [01:01<06:21, 14.14s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.73s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.74s/it] 20%|██        | 6/30 [01:02<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 3.7364060084025064
Epoch 179/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:34, 59.12s/it]  7%|▋         | 2/30 [00:59<11:28, 24.60s/it] 10%|█         | 3/30 [01:00<06:06, 13.57s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.39s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.52s/it] 20%|██        | 6/30 [01:01<01:31,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 3.7445146878560385
Epoch 180/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:49, 57.56s/it]  7%|▋         | 2/30 [00:58<11:10, 23.96s/it] 10%|█         | 3/30 [00:58<05:58, 13.29s/it] 13%|█▎        | 4/30 [00:59<03:33,  8.22s/it] 17%|█▋        | 5/30 [00:59<02:19,  5.59s/it] 20%|██        | 6/30 [01:00<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.08s/it] 30%|███       | 9/30 [01:02<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 3.666130606333415
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0494, -0.0496,  0.1027,  ..., -0.0528,  0.1094,  0.0605],
        [ 0.0222, -0.0410,  0.1126,  ..., -0.0248,  0.0816,  0.1117],
        [ 0.0010, -0.0387,  0.0124,  ..., -0.0722,  0.0543,  0.1225],
        ...,
        [-0.0617, -0.0499,  0.0788,  ...,  0.0191,  0.0637,  0.0340],
        [-0.0637, -0.0937,  0.0686,  ..., -0.0011,  0.0844,  0.0390],
        [ 0.0036, -0.0617,  0.1139,  ..., -0.0148,  0.0558,  0.0875]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9166, 0.9035, 0.8819,  ..., 0.8301, 0.8257, 0.8233],
        [0.9775, 0.9769, 0.9729,  ..., 0.9581, 0.9578, 0.9576],
        [0.9675, 0.9640, 0.9616,  ..., 0.9228, 0.9203, 0.9188],
        ...,
        [0.9248, 0.9085, 0.9078,  ..., 0.8789, 0.8767, 0.8763],
        [0.9536, 0.9530, 0.9461,  ..., 0.9185, 0.9165, 0.9163],
        [0.9491, 0.9424, 0.9419,  ..., 0.9195, 0.9192, 0.9177]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 1],
        ...,
        [0, 0, 1,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 486275.2500,  403457.5000,  296203.6562,  ...,  141305.2656,
          132776.9219,  128188.8750],
        [1159622.2500, 1149848.8750, 1085916.5000,  ...,  879818.1250,
          875572.6250,  873087.8125],
        [1005277.3750,  956429.8125,  925261.8125,  ...,  531310.3750,
          512183.6562,  501854.8750],
        ...,
        [ 546954.5625,  432769.9375,  428423.6562,  ...,  283648.3438,
          275106.2812,  273469.8438],
        [ 825096.5625,  817932.6875,  740828.1250,  ...,  499751.0000,
          485480.5938,  483858.1875],
        [ 773347.6875,  702442.1875,  698020.1250,  ...,  506955.2500,
          504397.9062,  493821.3750]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 486275.2500,       0.0000],
         [ 403457.5000,       0.0000],
         [ 296203.6562,       0.0000],
         ...,
         [ 141305.2656,       0.0000],
         [ 132776.9219,       0.0000],
         [ 128188.8750,       0.0000]],

        [[1159622.2500,       0.0000],
         [1149848.8750,       0.0000],
         [1085916.5000,       0.0000],
         ...,
         [ 879818.1250,       0.0000],
         [ 875572.6250,       0.0000],
         [ 873087.8125,       0.0000]],

        [[1005277.3750,       0.0000],
         [ 956429.8125,       0.0000],
         [ 925261.8125,       0.0000],
         ...,
         [ 531310.3750,       0.0000],
         [ 512183.6562,       0.0000],
         [      0.0000,  501854.8750]],

        ...,

        [[ 546954.5625,       0.0000],
         [ 432769.9375,       0.0000],
         [      0.0000,  428423.6562],
         ...,
         [      0.0000,  283648.3438],
         [ 275106.2812,       0.0000],
         [ 273469.8438,       0.0000]],

        [[      0.0000,  825096.5625],
         [ 817932.6875,       0.0000],
         [ 740828.1250,       0.0000],
         ...,
         [ 499751.0000,       0.0000],
         [ 485480.5938,       0.0000],
         [ 483858.1875,       0.0000]],

        [[      0.0000,  773347.6875],
         [ 702442.1875,       0.0000],
         [ 698020.1250,       0.0000],
         ...,
         [ 506955.2500,       0.0000],
         [ 504397.9062,       0.0000],
         [ 493821.3750,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3773618.0000,   379298.2500],
        [19586572.0000,        0.0000],
        [12981634.0000,  1208626.0000],
        [ 8692755.0000,   325239.7812],
        [ 5227115.0000,   878941.0000],
        [11250946.0000,        0.0000],
        [15920290.0000,  2631888.7500],
        [15270144.0000,   627063.1875],
        [15182624.0000,   743456.6875],
        [ 8086545.0000,   622991.3750],
        [13062974.0000,  1876232.6250],
        [ 6399407.0000,   182397.2344],
        [ 8504325.0000,        0.0000],
        [19385648.0000,        0.0000],
        [19185872.0000,        0.0000],
        [15755449.0000,        0.0000],
        [16266090.0000,   758376.8750],
        [16257158.0000,   718031.1250],
        [11379558.0000,  1869259.5000],
        [11486075.0000,   483814.8125],
        [16021492.0000,        0.0000],
        [11896206.0000,   586723.2500],
        [20459372.0000,        0.0000],
        [17172760.0000,        0.0000],
        [11012472.0000,        0.0000],
        [17873828.0000,        0.0000],
        [17854172.0000,   904807.0625],
        [19317226.0000,        0.0000],
        [20498346.0000,        0.0000],
        [18117364.0000,        0.0000],
        [21973170.0000,        0.0000],
        [18914976.0000,        0.0000],
        [ 6804405.0000,        0.0000],
        [ 9243424.0000,  1607796.1250],
        [10858768.0000,  2635317.0000],
        [10554135.0000,  1492783.5000],
        [ 9050292.0000,  1989948.7500],
        [ 5871398.0000,  1999305.0000],
        [ 4693123.0000,  2706522.0000],
        [18896852.0000,   968520.0625],
        [ 6448561.0000,  1523468.1250],
        [ 9769548.0000,        0.0000],
        [ 8559093.0000,        0.0000],
        [ 6075513.0000,   219542.2969],
        [ 6233277.0000,  3419817.0000],
        [  956740.8750,   915427.8750],
        [13925217.0000,   581760.0000],
        [ 2999559.0000,   984173.2500],
        [ 1911819.6250,  1379954.6250],
        [12112945.0000,  4232495.0000],
        [ 5830810.0000,   275405.5625],
        [10505672.0000,  2211394.2500],
        [ 7201913.0000,  4624652.5000],
        [ 7091964.0000,  1151612.0000],
        [13749802.0000,   722421.5000],
        [12449425.0000,   599316.4375],
        [10642784.0000,  2609994.0000],
        [ 7651300.0000,  2943044.2500],
        [ 6179253.5000,  3419372.2500],
        [ 4266163.0000,  2378438.0000],
        [ 9256503.0000,  1196377.1250],
        [ 5685462.0000,  1316118.3750],
        [ 9247665.0000,  3195201.0000],
        [10348938.0000,  1295335.5000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 50.0
Top1 accuracy for validation set is 50.0 size is torch.Size([64, 1])
Epoch 181/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.10s/it]  7%|▋         | 2/30 [01:00<11:47, 25.26s/it] 10%|█         | 3/30 [01:00<06:16, 13.93s/it] 13%|█▎        | 4/30 [01:00<03:43,  8.60s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.66s/it] 20%|██        | 6/30 [01:01<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.7012959082921344
Epoch 182/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:53, 59.76s/it]  7%|▋         | 2/30 [01:00<11:36, 24.87s/it] 10%|█         | 3/30 [01:00<06:10, 13.71s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.47s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.58s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.6939011255900067
Epoch 183/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:29, 56.88s/it]  7%|▋         | 2/30 [00:57<11:04, 23.72s/it] 10%|█         | 3/30 [00:58<05:56, 13.21s/it] 13%|█▎        | 4/30 [00:58<03:35,  8.28s/it] 17%|█▋        | 5/30 [00:59<02:19,  5.57s/it] 20%|██        | 6/30 [01:00<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:01<01:07,  2.92s/it] 27%|██▋       | 8/30 [01:01<00:46,  2.13s/it] 30%|███       | 9/30 [01:01<00:33,  1.60s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.24s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.00it/s] 40%|████      | 12/30 [01:03<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:03<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.59it/s] 50%|█████     | 15/30 [01:04<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.98it/s] 60%|██████    | 18/30 [01:05<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 3.680788238843282
Epoch 184/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:54, 55.67s/it]  7%|▋         | 2/30 [01:00<11:55, 25.55s/it] 10%|█         | 3/30 [01:00<06:20, 14.08s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.72s/it] 20%|██        | 6/30 [01:01<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.6735509395599366
Epoch 185/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:03, 60.10s/it]  7%|▋         | 2/30 [01:00<11:40, 25.01s/it] 10%|█         | 3/30 [01:00<06:12, 13.79s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.52s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.6773919820785523
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0491, -0.0506,  0.1012,  ..., -0.0535,  0.1093,  0.0609],
        [ 0.0204, -0.0425,  0.1115,  ..., -0.0251,  0.0824,  0.1118],
        [-0.0021, -0.0356,  0.0126,  ..., -0.0715,  0.0532,  0.1246],
        ...,
        [-0.0604, -0.0478,  0.0795,  ...,  0.0156,  0.0616,  0.0327],
        [-0.0644, -0.0925,  0.0673,  ..., -0.0027,  0.0844,  0.0361],
        [ 0.0017, -0.0583,  0.1122,  ..., -0.0148,  0.0568,  0.0874]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9134, 0.9027, 0.8795,  ..., 0.8277, 0.8233, 0.8226],
        [0.9758, 0.9755, 0.9709,  ..., 0.9569, 0.9567, 0.9555],
        [0.9643, 0.9606, 0.9600,  ..., 0.9174, 0.9157, 0.9146],
        ...,
        [0.9191, 0.9045, 0.9027,  ..., 0.8747, 0.8717, 0.8706],
        [0.9512, 0.9490, 0.9397,  ..., 0.9144, 0.9129, 0.9127],
        [0.9448, 0.9391, 0.9372,  ..., 0.9138, 0.9130, 0.9126]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        ...,
        [0, 0, 0,  ..., 1, 0, 0],
        [0, 1, 0,  ..., 0, 1, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 464389.1250,  398738.0625,  286076.1875,  ...,  136461.5469,
          128290.5078,  126883.2188],
        [1133343.2500, 1127868.0000, 1056210.7500,  ...,  864015.3750,
          862119.8125,  847353.9375],
        [ 960658.5625,  911609.6250,  903398.1875,  ...,  491662.5625,
          479698.7500,  472555.0000],
        ...,
        [ 503992.0625,  408895.1875,  398802.3125,  ...,  267165.0000,
          255942.2969,  252059.3594],
        [ 797376.8750,  772194.3750,  676162.5000,  ...,  471208.5000,
          461131.2812,  459580.2188],
        [ 727694.6250,  670714.3750,  652799.7500,  ...,  466948.0000,
          461591.0938,  458992.8750]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 464389.1250,       0.0000],
         [ 398738.0625,       0.0000],
         [ 286076.1875,       0.0000],
         ...,
         [ 136461.5469,       0.0000],
         [ 128290.5078,       0.0000],
         [ 126883.2188,       0.0000]],

        [[1133343.2500,       0.0000],
         [1127868.0000,       0.0000],
         [1056210.7500,       0.0000],
         ...,
         [ 864015.3750,       0.0000],
         [ 862119.8125,       0.0000],
         [ 847353.9375,       0.0000]],

        [[ 960658.5625,       0.0000],
         [ 911609.6250,       0.0000],
         [ 903398.1875,       0.0000],
         ...,
         [ 491662.5625,       0.0000],
         [      0.0000,  479698.7500],
         [ 472555.0000,       0.0000]],

        ...,

        [[ 503992.0625,       0.0000],
         [ 408895.1875,       0.0000],
         [ 398802.3125,       0.0000],
         ...,
         [      0.0000,  267165.0000],
         [ 255942.2969,       0.0000],
         [ 252059.3594,       0.0000]],

        [[ 797376.8750,       0.0000],
         [      0.0000,  772194.3750],
         [ 676162.5000,       0.0000],
         ...,
         [ 471208.5000,       0.0000],
         [      0.0000,  461131.2812],
         [ 459580.2188,       0.0000]],

        [[      0.0000,  727694.6250],
         [ 670714.3750,       0.0000],
         [ 652799.7500,       0.0000],
         ...,
         [ 466948.0000,       0.0000],
         [ 461591.0938,       0.0000],
         [ 458992.8750,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3649879.0000,   352548.8438],
        [19109074.0000,        0.0000],
        [12292872.0000,  1164695.2500],
        [ 8326025.5000,   298415.8125],
        [ 4810766.0000,   816517.7500],
        [10519621.0000,        0.0000],
        [15168076.0000,  2566176.0000],
        [14602102.0000,   584092.0625],
        [14578440.0000,   717327.5625],
        [ 7760215.0000,   583241.5625],
        [13237432.0000,  1210526.7500],
        [ 6034940.0000,   161882.1875],
        [ 8141098.0000,        0.0000],
        [19090738.0000,        0.0000],
        [18811004.0000,        0.0000],
        [15388816.0000,        0.0000],
        [15753833.0000,   723303.2500],
        [15805362.0000,   687300.5625],
        [11012121.0000,  1722386.7500],
        [11165029.0000,   474735.7812],
        [15595804.0000,        0.0000],
        [11550519.0000,   543379.1250],
        [19982128.0000,        0.0000],
        [16837710.0000,        0.0000],
        [10671152.0000,        0.0000],
        [17388332.0000,        0.0000],
        [17340198.0000,   859978.2500],
        [18921066.0000,        0.0000],
        [20041460.0000,        0.0000],
        [17698538.0000,        0.0000],
        [21683474.0000,        0.0000],
        [18494996.0000,        0.0000],
        [ 6633766.0000,        0.0000],
        [ 8793933.0000,  1556435.8750],
        [10395172.0000,  2557127.0000],
        [ 9743717.0000,  1414483.7500],
        [ 8478849.0000,  1921737.3750],
        [ 5409057.0000,  1896554.5000],
        [ 4303069.5000,  2565985.2500],
        [18343590.0000,   939515.3750],
        [ 6109685.0000,  1483920.0000],
        [ 9325342.0000,        0.0000],
        [ 8157950.5000,        0.0000],
        [ 5818430.0000,   207279.0625],
        [ 5883362.5000,  3212533.7500],
        [  878223.1250,   881916.1875],
        [13276982.0000,   558376.1250],
        [ 2863683.0000,   922934.6250],
        [ 1649760.2500,  1374046.7500],
        [11530998.0000,  4043559.7500],
        [ 5416362.5000,   246488.2500],
        [ 9981929.0000,  2135042.5000],
        [ 7298218.0000,  4065359.2500],
        [ 6880334.5000,  1084792.2500],
        [13418696.0000,   701995.5000],
        [11828614.0000,   569538.4375],
        [10177423.0000,  2545075.0000],
        [ 7230932.5000,  2852689.0000],
        [ 5869173.0000,  3275017.2500],
        [ 3925753.2500,  2283009.2500],
        [ 8863266.0000,  1171354.2500],
        [ 5247000.0000,  1241489.3750],
        [ 8176615.0000,  3484589.7500],
        [ 9650156.0000,  1222310.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 186/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:50, 57.59s/it]  7%|▋         | 2/30 [00:58<11:18, 24.22s/it] 10%|█         | 3/30 [00:58<06:02, 13.41s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.29s/it] 17%|█▋        | 5/30 [00:59<02:16,  5.46s/it] 20%|██        | 6/30 [01:00<01:30,  3.75s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.67s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.96s/it] 30%|███       | 9/30 [01:01<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:06<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 3.679712438583374
Epoch 187/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:54, 57.76s/it]  7%|▋         | 2/30 [01:00<11:43, 25.12s/it] 10%|█         | 3/30 [01:00<06:18, 14.00s/it] 13%|█▎        | 4/30 [01:01<03:44,  8.65s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.69s/it] 20%|██        | 6/30 [01:02<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.6489511410395306
Epoch 188/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:09, 58.27s/it]  7%|▋         | 2/30 [00:58<11:19, 24.25s/it] 10%|█         | 3/30 [00:59<06:01, 13.38s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.28s/it] 17%|█▋        | 5/30 [01:00<02:16,  5.45s/it] 20%|██        | 6/30 [01:00<01:30,  3.75s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.67s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.96s/it] 30%|███       | 9/30 [01:01<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.16s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.15it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 3.6300343672434487
Epoch 189/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:14, 56.37s/it]  7%|▋         | 2/30 [00:56<10:57, 23.47s/it] 10%|█         | 3/30 [00:59<06:14, 13.88s/it] 13%|█▎        | 4/30 [00:59<03:42,  8.58s/it] 17%|█▋        | 5/30 [01:00<02:21,  5.64s/it] 20%|██        | 6/30 [01:00<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.02s/it] 30%|███       | 9/30 [01:01<00:32,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 3.5968392372131346
Epoch 190/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:35, 55.03s/it]  7%|▋         | 2/30 [00:56<10:51, 23.25s/it] 10%|█         | 3/30 [01:01<06:44, 15.00s/it] 13%|█▎        | 4/30 [01:01<04:00,  9.25s/it] 17%|█▋        | 5/30 [01:02<02:31,  6.07s/it] 20%|██        | 6/30 [01:02<01:39,  4.16s/it] 23%|██▎       | 7/30 [01:02<01:07,  2.94s/it] 27%|██▋       | 8/30 [01:03<00:47,  2.15s/it] 30%|███       | 9/30 [01:03<00:33,  1.61s/it] 33%|███▎      | 10/30 [01:04<00:25,  1.25s/it] 37%|███▋      | 11/30 [01:04<00:19,  1.00s/it] 40%|████      | 12/30 [01:05<00:14,  1.20it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:06<00:10,  1.58it/s] 50%|█████     | 15/30 [01:06<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.6223676919937136
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0492, -0.0518,  0.0994,  ..., -0.0544,  0.1098,  0.0618],
        [ 0.0193, -0.0437,  0.1101,  ..., -0.0259,  0.0836,  0.1121],
        [-0.0041, -0.0332,  0.0129,  ..., -0.0714,  0.0526,  0.1263],
        ...,
        [-0.0588, -0.0456,  0.0797,  ...,  0.0131,  0.0595,  0.0313],
        [-0.0649, -0.0914,  0.0655,  ..., -0.0041,  0.0846,  0.0330],
        [ 0.0005, -0.0551,  0.1103,  ..., -0.0150,  0.0583,  0.0876]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9103, 0.9020, 0.8811,  ..., 0.8231, 0.8218, 0.8214],
        [0.9742, 0.9740, 0.9690,  ..., 0.9562, 0.9561, 0.9533],
        [0.9610, 0.9585, 0.9570,  ..., 0.9116, 0.9100, 0.9092],
        ...,
        [0.9129, 0.9004, 0.8981,  ..., 0.8669, 0.8668, 0.8661],
        [0.9493, 0.9436, 0.9330,  ..., 0.9094, 0.9083, 0.9083],
        [0.9404, 0.9356, 0.9321,  ..., 0.9070, 0.9069, 0.9068]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 1, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 444238.1562,  394771.9688,  292668.1875,  ...,  127778.2812,
          125456.4219,  124714.5469],
        [1107412.5000, 1104441.3750, 1027532.0000,  ...,  856242.3750,
          854399.7500,  820986.8125],
        [ 916876.7500,  884001.4375,  866110.0000,  ...,  452696.3750,
          442349.2500,  437146.5312],
        ...,
        [ 461181.0000,  385477.0938,  373060.6875,  ...,  239061.6250,
          238724.4531,  236328.9844],
        [ 775512.4375,  715158.1250,  614312.1875,  ...,  438373.0938,
          431965.4375,  431911.9062],
        [ 683045.4375,  637473.9375,  606477.5625,  ...,  423830.3438,
          423547.5000,  422512.2812]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 444238.1562,       0.0000],
         [ 394771.9688,       0.0000],
         [ 292668.1875,       0.0000],
         ...,
         [ 127778.2812,       0.0000],
         [ 125456.4219,       0.0000],
         [ 124714.5469,       0.0000]],

        [[1107412.5000,       0.0000],
         [1104441.3750,       0.0000],
         [1027532.0000,       0.0000],
         ...,
         [ 856242.3750,       0.0000],
         [ 854399.7500,       0.0000],
         [ 820986.8125,       0.0000]],

        [[ 916876.7500,       0.0000],
         [ 884001.4375,       0.0000],
         [ 866110.0000,       0.0000],
         ...,
         [ 452696.3750,       0.0000],
         [ 442349.2500,       0.0000],
         [ 437146.5312,       0.0000]],

        ...,

        [[ 461181.0000,       0.0000],
         [ 385477.0938,       0.0000],
         [ 373060.6875,       0.0000],
         ...,
         [ 239061.6250,       0.0000],
         [ 238724.4531,       0.0000],
         [ 236328.9844,       0.0000]],

        [[ 775512.4375,       0.0000],
         [      0.0000,  715158.1250],
         [ 614312.1875,       0.0000],
         ...,
         [      0.0000,  438373.0938],
         [ 431965.4375,       0.0000],
         [ 431911.9062,       0.0000]],

        [[      0.0000,  683045.4375],
         [ 637473.9375,       0.0000],
         [ 606477.5625,       0.0000],
         ...,
         [ 423830.3438,       0.0000],
         [ 423547.5000,       0.0000],
         [ 422512.2812,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3545117.2500,   328292.8750],
        [18648470.0000,        0.0000],
        [11614110.0000,  1122937.1250],
        [ 7983217.5000,   276012.4375],
        [ 4258390.0000,   952095.4375],
        [ 9829226.0000,        0.0000],
        [14378542.0000,  2488047.2500],
        [13974886.0000,   545833.6875],
        [14008398.0000,   690038.0000],
        [ 7465197.0000,   551003.3750],
        [12881041.0000,  1114507.7500],
        [ 5752532.5000,   146838.6875],
        [ 7821048.0000,        0.0000],
        [18820018.0000,        0.0000],
        [18432884.0000,        0.0000],
        [15031647.0000,        0.0000],
        [15292656.0000,   690899.2500],
        [15426920.0000,   655819.8750],
        [10695108.0000,  1591457.5000],
        [10875204.0000,   467600.8750],
        [15181207.0000,        0.0000],
        [11241881.0000,   505342.0938],
        [19474336.0000,        0.0000],
        [16527553.0000,        0.0000],
        [10348356.0000,        0.0000],
        [16903994.0000,        0.0000],
        [16822716.0000,   811942.9375],
        [18510356.0000,        0.0000],
        [19573956.0000,        0.0000],
        [17284800.0000,        0.0000],
        [21381516.0000,        0.0000],
        [18068838.0000,        0.0000],
        [ 6479708.5000,        0.0000],
        [ 8417248.0000,  1508320.1250],
        [ 9998910.0000,  2484311.0000],
        [ 8624037.0000,  1773163.2500],
        [ 7607543.0000,  2205516.0000],
        [ 5289058.0000,  1564474.5000],
        [ 3757771.5000,  2674612.2500],
        [17819612.0000,   908455.8125],
        [ 5814637.5000,  1443482.3750],
        [ 8907344.0000,        0.0000],
        [ 7821560.5000,        0.0000],
        [ 5595494.0000,   195659.0156],
        [ 5884948.0000,  2687241.7500],
        [  824524.2500,   857485.1250],
        [12696127.0000,   538843.1875],
        [ 2739522.0000,   867076.6875],
        [ 1514568.3750,  1275808.3750],
        [11005050.0000,  3865828.5000],
        [ 5060215.0000,   221690.8594],
        [ 9473312.0000,  2057171.2500],
        [ 7021128.5000,  3920991.2500],
        [ 6685290.0000,  1026501.2500],
        [13106520.0000,   684780.3750],
        [11253908.0000,   540982.0625],
        [ 9747437.0000,  2478535.5000],
        [ 6867099.5000,  2762593.7500],
        [ 5579914.0000,  3133187.7500],
        [ 3620408.5000,  2191886.2500],
        [ 8538861.0000,  1148866.3750],
        [ 4824988.5000,  1175550.7500],
        [ 7554965.0000,  3278629.5000],
        [ 8947132.0000,  1152416.5000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 191/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:02<30:17, 62.66s/it]  7%|▋         | 2/30 [01:03<12:09, 26.06s/it] 10%|█         | 3/30 [01:03<06:27, 14.36s/it] 13%|█▎        | 4/30 [01:03<03:50,  8.87s/it] 17%|█▋        | 5/30 [01:04<02:25,  5.84s/it] 20%|██        | 6/30 [01:04<01:36,  4.00s/it] 23%|██▎       | 7/30 [01:05<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:05<00:45,  2.08s/it] 30%|███       | 9/30 [01:06<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:06<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:07<00:18,  1.02it/s] 40%|████      | 12/30 [01:07<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:07<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:08<00:09,  1.60it/s] 50%|█████     | 15/30 [01:08<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:09<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:09<00:06,  1.98it/s] 60%|██████    | 18/30 [01:10<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:10<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:11<00:04,  2.16it/s] 70%|███████   | 21/30 [01:11<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:11<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:12<00:03,  2.23it/s] 80%|████████  | 24/30 [01:12<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:13<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:13<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:14<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:14<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:15<00:00,  2.26it/s]100%|██████████| 30/30 [01:15<00:00,  2.26it/s]100%|██████████| 30/30 [01:15<00:00,  2.52s/it]
Epoch loss is 3.5959463278452555
Epoch 192/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:43, 57.37s/it]  7%|▋         | 2/30 [01:01<12:04, 25.88s/it] 10%|█         | 3/30 [01:01<06:25, 14.26s/it] 13%|█▎        | 4/30 [01:02<03:48,  8.81s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.79s/it] 20%|██        | 6/30 [01:02<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:04<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 3.56809032758077
Epoch 193/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:56, 57.79s/it]  7%|▋         | 2/30 [00:58<11:13, 24.06s/it] 10%|█         | 3/30 [00:58<05:58, 13.28s/it] 13%|█▎        | 4/30 [00:59<03:33,  8.21s/it] 17%|█▋        | 5/30 [00:59<02:17,  5.51s/it] 20%|██        | 6/30 [01:00<01:30,  3.79s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.69s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:01<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 3.616169540087382
Epoch 194/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:57, 59.91s/it]  7%|▋         | 2/30 [01:00<11:37, 24.93s/it] 10%|█         | 3/30 [01:00<06:11, 13.75s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.49s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.5798443953196206
Epoch 195/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:06<32:10, 66.58s/it]  7%|▋         | 2/30 [01:07<12:54, 27.68s/it] 10%|█         | 3/30 [01:07<06:55, 15.39s/it] 13%|█▎        | 4/30 [01:08<04:06,  9.49s/it] 17%|█▋        | 5/30 [01:08<02:35,  6.23s/it] 20%|██        | 6/30 [01:09<01:42,  4.26s/it] 23%|██▎       | 7/30 [01:09<01:09,  3.01s/it] 27%|██▋       | 8/30 [01:10<00:48,  2.20s/it] 30%|███       | 9/30 [01:10<00:34,  1.65s/it] 33%|███▎      | 10/30 [01:10<00:25,  1.28s/it] 37%|███▋      | 11/30 [01:11<00:19,  1.02s/it] 40%|████      | 12/30 [01:11<00:15,  1.18it/s] 43%|████▎     | 13/30 [01:12<00:12,  1.38it/s] 47%|████▋     | 14/30 [01:12<00:10,  1.57it/s] 50%|█████     | 15/30 [01:13<00:08,  1.73it/s] 53%|█████▎    | 16/30 [01:13<00:07,  1.86it/s] 57%|█████▋    | 17/30 [01:13<00:06,  1.97it/s] 60%|██████    | 18/30 [01:14<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:14<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:15<00:04,  2.15it/s] 70%|███████   | 21/30 [01:15<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:16<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:16<00:03,  2.23it/s] 80%|████████  | 24/30 [01:17<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:17<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:17<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:18<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:18<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:19<00:00,  2.26it/s]100%|██████████| 30/30 [01:19<00:00,  2.26it/s]100%|██████████| 30/30 [01:19<00:00,  2.66s/it]
Epoch loss is 3.5269722143809
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0494, -0.0529,  0.0978,  ..., -0.0555,  0.1097,  0.0628],
        [ 0.0182, -0.0441,  0.1085,  ..., -0.0257,  0.0840,  0.1121],
        [-0.0057, -0.0311,  0.0129,  ..., -0.0716,  0.0515,  0.1281],
        ...,
        [-0.0569, -0.0431,  0.0800,  ...,  0.0105,  0.0574,  0.0300],
        [-0.0657, -0.0900,  0.0638,  ..., -0.0055,  0.0843,  0.0301],
        [-0.0012, -0.0515,  0.1086,  ..., -0.0150,  0.0592,  0.0880]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9074, 0.9011, 0.8825,  ..., 0.8198, 0.8189, 0.8184],
        [0.9725, 0.9724, 0.9670,  ..., 0.9551, 0.9551, 0.9511],
        [0.9578, 0.9569, 0.9533,  ..., 0.9059, 0.9057, 0.9053],
        ...,
        [0.9070, 0.8968, 0.8940,  ..., 0.8627, 0.8616, 0.8590],
        [0.9473, 0.9381, 0.9273,  ..., 0.9043, 0.9036, 0.9022],
        [0.9360, 0.9319, 0.9267,  ..., 0.9017, 0.9011, 0.9004]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 1, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 426180.7500,  389685.9375,  298697.1250,  ...,  121894.3359,
          120418.3984,  119489.2812],
        [1080746.6250, 1078854.0000,  998656.4375,  ...,  843180.6875,
          842273.3750,  795522.7500],
        [ 876210.7500,  864472.8125,  821139.4375,  ...,  417327.0938,
          416194.3438,  413714.3125],
        ...,
        [ 423784.2500,  366276.8750,  352078.4688,  ...,  225136.6719,
          221681.7656,  213488.7344],
        [ 753258.4375,  661362.6875,  566236.5000,  ...,  407892.2812,
          403537.9375,  395718.4688],
        [ 641233.0000,  604521.7500,  561350.6250,  ...,  392834.0938,
          389549.5938,  385691.8125]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 426180.7500,       0.0000],
         [ 389685.9375,       0.0000],
         [ 298697.1250,       0.0000],
         ...,
         [      0.0000,  121894.3359],
         [ 120418.3984,       0.0000],
         [ 119489.2812,       0.0000]],

        [[1080746.6250,       0.0000],
         [1078854.0000,       0.0000],
         [ 998656.4375,       0.0000],
         ...,
         [ 843180.6875,       0.0000],
         [ 842273.3750,       0.0000],
         [ 795522.7500,       0.0000]],

        [[ 876210.7500,       0.0000],
         [ 864472.8125,       0.0000],
         [ 821139.4375,       0.0000],
         ...,
         [ 417327.0938,       0.0000],
         [ 416194.3438,       0.0000],
         [ 413714.3125,       0.0000]],

        ...,

        [[ 423784.2500,       0.0000],
         [ 366276.8750,       0.0000],
         [ 352078.4688,       0.0000],
         ...,
         [ 225136.6719,       0.0000],
         [ 221681.7656,       0.0000],
         [ 213488.7344,       0.0000]],

        [[ 753258.4375,       0.0000],
         [      0.0000,  661362.6875],
         [ 566236.5000,       0.0000],
         ...,
         [ 407892.2812,       0.0000],
         [ 403537.9375,       0.0000],
         [ 395718.4688,       0.0000]],

        [[      0.0000,  641233.0000],
         [ 604521.7500,       0.0000],
         [ 561350.6250,       0.0000],
         ...,
         [ 392834.0938,       0.0000],
         [ 389549.5938,       0.0000],
         [ 385691.8125,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3425585.5000,   303285.9688],
        [18178016.0000,        0.0000],
        [10995160.0000,  1081864.6250],
        [ 7657581.0000,   254207.3906],
        [ 3941759.5000,   892868.9375],
        [ 9154418.0000,        0.0000],
        [13605437.0000,  2407262.0000],
        [13355165.0000,   510553.8750],
        [13420807.0000,   661003.2500],
        [ 7188537.0000,   518469.8750],
        [13043712.0000,   536051.8125],
        [ 5502460.5000,   133197.2344],
        [ 7504163.0000,        0.0000],
        [18536946.0000,        0.0000],
        [18070190.0000,        0.0000],
        [14694532.0000,        0.0000],
        [14806524.0000,   661200.6250],
        [15036206.0000,   623817.1875],
        [10370366.0000,  1469546.8750],
        [10596045.0000,   460253.0625],
        [14780482.0000,        0.0000],
        [10909797.0000,   468928.0625],
        [18993176.0000,        0.0000],
        [16250599.0000,        0.0000],
        [ 9997668.0000,        0.0000],
        [16461502.0000,        0.0000],
        [16302845.0000,   764159.3750],
        [18114312.0000,        0.0000],
        [19129606.0000,        0.0000],
        [16905624.0000,        0.0000],
        [21074044.0000,        0.0000],
        [17636572.0000,        0.0000],
        [ 6319469.0000,        0.0000],
        [ 8055763.5000,  1458615.7500],
        [ 9605566.0000,  2412347.0000],
        [ 7979935.0000,  1684354.3750],
        [ 7115429.5000,  2131086.0000],
        [ 4934908.0000,  1507527.2500],
        [ 3499042.0000,  2553292.2500],
        [17294642.0000,   882956.7500],
        [ 5554335.0000,  1398953.8750],
        [ 8532214.0000,        0.0000],
        [ 7481977.5000,        0.0000],
        [ 5405840.0000,   185792.4062],
        [ 5548706.0000,  2550196.5000],
        [  744027.5000,   873647.9375],
        [12150248.0000,   520403.2188],
        [ 2608964.5000,   814256.8125],
        [ 1399804.3750,  1189833.2500],
        [10459380.0000,  3684268.0000],
        [ 4732909.0000,   200954.8281],
        [ 8991234.0000,  1982819.2500],
        [ 6754543.0000,  3779858.0000],
        [ 6527990.0000,   973881.5625],
        [12806308.0000,   666755.1875],
        [10740635.0000,   515345.4062],
        [ 8895854.0000,  2875603.7500],
        [ 6569733.5000,  2677489.7500],
        [ 5319727.0000,  2995887.0000],
        [ 3363242.7500,  2105911.7500],
        [ 8251727.5000,  1127651.3750],
        [ 4459749.5000,  1115263.1250],
        [ 6972377.5000,  3079251.0000],
        [ 8287771.0000,  1085708.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 196/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:02<30:18, 62.71s/it]  7%|▋         | 2/30 [01:03<12:10, 26.08s/it] 10%|█         | 3/30 [01:04<06:44, 15.00s/it] 13%|█▎        | 4/30 [01:05<04:00,  9.25s/it] 17%|█▋        | 5/30 [01:05<02:31,  6.08s/it] 20%|██        | 6/30 [01:06<01:39,  4.16s/it] 23%|██▎       | 7/30 [01:06<01:07,  2.94s/it] 27%|██▋       | 8/30 [01:07<00:47,  2.15s/it] 30%|███       | 9/30 [01:07<00:33,  1.61s/it] 33%|███▎      | 10/30 [01:08<00:25,  1.25s/it] 37%|███▋      | 11/30 [01:08<00:19,  1.00s/it] 40%|████      | 12/30 [01:08<00:14,  1.20it/s] 43%|████▎     | 13/30 [01:09<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:09<00:10,  1.58it/s] 50%|█████     | 15/30 [01:10<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:10<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:11<00:06,  1.97it/s] 60%|██████    | 18/30 [01:11<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:12<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:12<00:04,  2.15it/s] 70%|███████   | 21/30 [01:12<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:13<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:13<00:03,  2.23it/s] 80%|████████  | 24/30 [01:14<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:14<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:15<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:15<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:16<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:16<00:00,  2.26it/s]100%|██████████| 30/30 [01:16<00:00,  2.26it/s]100%|██████████| 30/30 [01:17<00:00,  2.57s/it]
Epoch loss is 3.5864980618158975
Epoch 197/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:55, 57.76s/it]  7%|▋         | 2/30 [00:58<11:13, 24.04s/it] 10%|█         | 3/30 [00:58<05:58, 13.27s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.70s/it] 20%|██        | 6/30 [01:01<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 3.545084524154663
Epoch 198/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:28, 61.00s/it]  7%|▋         | 2/30 [01:01<11:50, 25.38s/it] 10%|█         | 3/30 [01:01<06:17, 13.99s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.64s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.68s/it] 20%|██        | 6/30 [01:03<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.47s/it]
Epoch loss is 3.5128183205922445
Epoch 199/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:39, 59.31s/it]  7%|▋         | 2/30 [00:59<11:31, 24.68s/it] 10%|█         | 3/30 [01:00<06:07, 13.61s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.41s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.54s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.4788970708847047
Epoch 200/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.07s/it]  7%|▋         | 2/30 [01:00<11:49, 25.35s/it] 10%|█         | 3/30 [01:00<06:17, 13.98s/it] 13%|█▎        | 4/30 [01:01<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.71s/it] 20%|██        | 6/30 [01:02<01:33,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.509139633178711
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0499, -0.0540,  0.0960,  ..., -0.0560,  0.1095,  0.0634],
        [ 0.0173, -0.0446,  0.1067,  ..., -0.0255,  0.0848,  0.1121],
        [-0.0076, -0.0294,  0.0129,  ..., -0.0709,  0.0510,  0.1293],
        ...,
        [-0.0556, -0.0407,  0.0800,  ...,  0.0081,  0.0549,  0.0290],
        [-0.0664, -0.0887,  0.0625,  ..., -0.0069,  0.0839,  0.0274],
        [-0.0030, -0.0479,  0.1071,  ..., -0.0154,  0.0604,  0.0884]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9038, 0.8998, 0.8835,  ..., 0.8167, 0.8156, 0.8134],
        [0.9707, 0.9706, 0.9648,  ..., 0.9537, 0.9535, 0.9490],
        [0.9554, 0.9548, 0.9495,  ..., 0.9041, 0.9014, 0.9005],
        ...,
        [0.9006, 0.8931, 0.8898,  ..., 0.8585, 0.8569, 0.8510],
        [0.9454, 0.9326, 0.9213,  ..., 0.9004, 0.8958, 0.8933],
        [0.9312, 0.9276, 0.9208,  ..., 0.8965, 0.8952, 0.8949]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 404841.9688,  382306.2188,  302887.7812,  ...,  116667.6641,
          114878.2891,  111299.2734],
        [1053616.1250, 1051647.5000,  967694.6250,  ...,  826140.6250,
          823154.5000,  772305.6250],
        [ 845947.3750,  839421.8125,  777726.9375,  ...,  406521.4375,
          391110.0625,  386436.6562],
        ...,
        [ 386761.0938,  347404.6250,  331480.9688,  ...,  212094.7969,
          207201.2031,  190412.3281],
        [ 733392.1875,  610930.5625,  519981.0312,  ...,  385557.9688,
          361179.9062,  348263.7812],
        [ 598588.1250,  568962.5000,  515875.9688,  ...,  364761.9062,
          358189.5000,  356515.5000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 404841.9688,       0.0000],
         [ 382306.2188,       0.0000],
         [ 302887.7812,       0.0000],
         ...,
         [ 116667.6641,       0.0000],
         [ 114878.2891,       0.0000],
         [ 111299.2734,       0.0000]],

        [[1053616.1250,       0.0000],
         [1051647.5000,       0.0000],
         [ 967694.6250,       0.0000],
         ...,
         [ 826140.6250,       0.0000],
         [ 823154.5000,       0.0000],
         [ 772305.6250,       0.0000]],

        [[ 845947.3750,       0.0000],
         [ 839421.8125,       0.0000],
         [ 777726.9375,       0.0000],
         ...,
         [ 406521.4375,       0.0000],
         [ 391110.0625,       0.0000],
         [ 386436.6562,       0.0000]],

        ...,

        [[ 386761.0938,       0.0000],
         [ 347404.6250,       0.0000],
         [ 331480.9688,       0.0000],
         ...,
         [ 212094.7969,       0.0000],
         [ 207201.2031,       0.0000],
         [ 190412.3281,       0.0000]],

        [[ 733392.1875,       0.0000],
         [      0.0000,  610930.5625],
         [ 519981.0312,       0.0000],
         ...,
         [ 385557.9688,       0.0000],
         [ 361179.9062,       0.0000],
         [ 348263.7812,       0.0000]],

        [[      0.0000,  598588.1250],
         [ 568962.5000,       0.0000],
         [ 515875.9688,       0.0000],
         ...,
         [ 364761.9062,       0.0000],
         [ 358189.5000,       0.0000],
         [ 356515.5000,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3411225.5000,   171388.0156],
        [17690962.0000,        0.0000],
        [10424888.0000,  1043245.7500],
        [ 7331425.5000,   233949.3125],
        [ 3498810.5000,   992038.6250],
        [ 8529638.0000,        0.0000],
        [12838221.0000,  2323031.5000],
        [12797647.0000,   480153.6562],
        [12880067.0000,   633537.5625],
        [ 6941648.5000,   488753.2812],
        [12712085.0000,   492412.4062],
        [ 5273515.5000,   120902.2656],
        [ 7222740.5000,        0.0000],
        [18280440.0000,        0.0000],
        [17720356.0000,        0.0000],
        [14365534.0000,        0.0000],
        [14368042.0000,   635294.0000],
        [14685724.0000,   592138.1875],
        [10044137.0000,  1359106.8750],
        [10340372.0000,   452464.5938],
        [14392162.0000,        0.0000],
        [10597406.0000,   436874.8125],
        [18549464.0000,        0.0000],
        [15988728.0000,        0.0000],
        [ 9668241.0000,        0.0000],
        [16033453.0000,        0.0000],
        [15807374.0000,   718795.0625],
        [17779044.0000,        0.0000],
        [18684046.0000,        0.0000],
        [16538332.0000,        0.0000],
        [20751608.0000,        0.0000],
        [17203866.0000,        0.0000],
        [ 6170429.5000,        0.0000],
        [ 7732427.0000,  1410680.8750],
        [ 9245814.0000,  2346638.5000],
        [ 7428967.0000,  1604439.0000],
        [ 6636162.0000,  2056898.5000],
        [ 4649152.0000,  1446875.2500],
        [ 3284646.5000,  2441381.5000],
        [16785780.0000,   855475.1250],
        [ 5318643.0000,  1348346.7500],
        [ 8185071.5000,        0.0000],
        [ 7171706.0000,        0.0000],
        [ 5228319.5000,   174387.4062],
        [ 5233732.0000,  2428160.7500],
        [  712542.1875,   849874.3750],
        [11629932.0000,   503664.3438],
        [ 2474975.5000,   767893.6875],
        [ 1296118.3750,  1102498.5000],
        [ 9922656.0000,  3507981.5000],
        [ 4435600.5000,   181638.6562],
        [ 8541030.0000,  1902942.7500],
        [ 6475737.5000,  3636209.5000],
        [ 6377066.0000,   922180.0000],
        [12503701.0000,   649472.6250],
        [10244096.0000,   491791.9688],
        [ 8953394.0000,  2344218.5000],
        [ 6288347.0000,  2591419.5000],
        [ 4822797.0000,  3093810.7500],
        [ 2968696.0000,  2185094.7500],
        [ 8003590.0000,  1105606.1250],
        [ 4112411.5000,  1060159.1250],
        [ 6427916.0000,  2886868.0000],
        [ 7655764.0000,  1020002.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 201/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:21, 56.59s/it]  7%|▋         | 2/30 [00:57<10:59, 23.56s/it] 10%|█         | 3/30 [00:57<05:51, 13.01s/it] 13%|█▎        | 4/30 [01:01<04:01,  9.30s/it] 17%|█▋        | 5/30 [01:01<02:32,  6.11s/it] 20%|██        | 6/30 [01:01<01:40,  4.18s/it] 23%|██▎       | 7/30 [01:02<01:08,  2.96s/it] 27%|██▋       | 8/30 [01:02<00:47,  2.16s/it] 30%|███       | 9/30 [01:03<00:34,  1.62s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:04<00:19,  1.01s/it] 40%|████      | 12/30 [01:04<00:15,  1.20it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.58it/s] 50%|█████     | 15/30 [01:05<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.4930177132288613
Epoch 202/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:15, 56.39s/it]  7%|▋         | 2/30 [00:58<11:23, 24.43s/it] 10%|█         | 3/30 [01:01<06:31, 14.50s/it] 13%|█▎        | 4/30 [01:01<03:52,  8.95s/it] 17%|█▋        | 5/30 [01:02<02:26,  5.88s/it] 20%|██        | 6/30 [01:02<01:36,  4.03s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.86s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.09s/it] 30%|███       | 9/30 [01:03<00:33,  1.57s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.495655639966329
Epoch 203/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:30, 58.99s/it]  7%|▋         | 2/30 [00:59<11:27, 24.56s/it] 10%|█         | 3/30 [00:59<06:05, 13.55s/it] 13%|█▎        | 4/30 [01:00<03:37,  8.37s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.52s/it] 20%|██        | 6/30 [01:01<01:30,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 3.4955477555592855
Epoch 204/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:33, 57.02s/it]  7%|▋         | 2/30 [00:58<11:23, 24.39s/it] 10%|█         | 3/30 [00:59<06:03, 13.46s/it] 13%|█▎        | 4/30 [00:59<03:36,  8.32s/it] 17%|█▋        | 5/30 [01:01<02:30,  6.03s/it] 20%|██        | 6/30 [01:01<01:39,  4.13s/it] 23%|██▎       | 7/30 [01:02<01:07,  2.93s/it] 27%|██▋       | 8/30 [01:02<00:46,  2.13s/it] 30%|███       | 9/30 [01:03<00:33,  1.61s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.25s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.00it/s] 40%|████      | 12/30 [01:04<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.59it/s] 50%|█████     | 15/30 [01:05<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.4667290767033894
Epoch 205/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:34, 57.05s/it]  7%|▋         | 2/30 [01:01<12:06, 25.95s/it] 10%|█         | 3/30 [01:01<06:26, 14.30s/it] 13%|█▎        | 4/30 [01:02<03:49,  8.83s/it] 17%|█▋        | 5/30 [01:02<02:25,  5.81s/it] 20%|██        | 6/30 [01:02<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.07s/it] 30%|███       | 9/30 [01:04<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 3.4559223890304565
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0499, -0.0552,  0.0940,  ..., -0.0565,  0.1097,  0.0638],
        [ 0.0168, -0.0449,  0.1046,  ..., -0.0254,  0.0857,  0.1120],
        [-0.0087, -0.0273,  0.0122,  ..., -0.0699,  0.0509,  0.1301],
        ...,
        [-0.0538, -0.0388,  0.0795,  ...,  0.0055,  0.0526,  0.0280],
        [-0.0670, -0.0880,  0.0609,  ..., -0.0081,  0.0837,  0.0250],
        [-0.0042, -0.0451,  0.1050,  ..., -0.0153,  0.0617,  0.0889]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.9000, 0.8985, 0.8838,  ..., 0.8140, 0.8134, 0.8126],
        [0.9689, 0.9688, 0.9626,  ..., 0.9517, 0.9514, 0.9475],
        [0.9539, 0.9516, 0.9456,  ..., 0.9009, 0.8980, 0.8978],
        ...,
        [0.8948, 0.8898, 0.8860,  ..., 0.8528, 0.8526, 0.8437],
        [0.9439, 0.9269, 0.9157,  ..., 0.8959, 0.8894, 0.8853],
        [0.9265, 0.9231, 0.9167,  ..., 0.8914, 0.8897, 0.8896]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 383397.9062,  375485.0000,  304213.3438,  ...,  112232.7656,
          111311.2656,  109964.4141],
        [1026893.3125, 1024558.3750,  937828.8750,  ...,  803073.8125,
          798893.8750,  756449.6875],
        [ 828126.8750,  801482.3750,  735882.1875,  ...,  388511.8750,
          372556.1875,  371650.9062],
        ...,
        [ 356269.4062,  331620.4062,  313869.5000,  ...,  195378.5938,
          194724.5625,  171519.6406],
        [ 717633.3750,  563017.0000,  479635.5938,  ...,  361634.5625,
          329596.8438,  311016.1562],
        [ 560297.5000,  533677.3125,  486727.5938,  ...,  339422.0938,
          330858.7812,  330774.2188]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 383397.9062,       0.0000],
         [ 375485.0000,       0.0000],
         [ 304213.3438,       0.0000],
         ...,
         [ 112232.7656,       0.0000],
         [ 111311.2656,       0.0000],
         [ 109964.4141,       0.0000]],

        [[1026893.3125,       0.0000],
         [1024558.3750,       0.0000],
         [ 937828.8750,       0.0000],
         ...,
         [ 803073.8125,       0.0000],
         [ 798893.8750,       0.0000],
         [ 756449.6875,       0.0000]],

        [[ 828126.8750,       0.0000],
         [ 801482.3750,       0.0000],
         [ 735882.1875,       0.0000],
         ...,
         [ 388511.8750,       0.0000],
         [ 372556.1875,       0.0000],
         [ 371650.9062,       0.0000]],

        ...,

        [[ 356269.4062,       0.0000],
         [ 331620.4062,       0.0000],
         [ 313869.5000,       0.0000],
         ...,
         [ 195378.5938,       0.0000],
         [ 194724.5625,       0.0000],
         [ 171519.6406,       0.0000]],

        [[ 717633.3750,       0.0000],
         [      0.0000,  563017.0000],
         [ 479635.5938,       0.0000],
         ...,
         [ 361634.5625,       0.0000],
         [ 329596.8438,       0.0000],
         [ 311016.1562,       0.0000]],

        [[      0.0000,  560297.5000],
         [ 533677.3125,       0.0000],
         [ 486727.5938,       0.0000],
         ...,
         [ 339422.0938,       0.0000],
         [ 330858.7812,       0.0000],
         [ 330774.2188,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3305686.2500,   163908.2344],
        [17230342.0000,        0.0000],
        [ 9893659.0000,  1003745.5000],
        [ 7009092.0000,   215165.2188],
        [ 3107939.2500,  1073687.3750],
        [ 7937893.5000,        0.0000],
        [12121900.0000,  2240755.2500],
        [12264821.0000,   450377.4688],
        [12363712.0000,   609135.2500],
        [ 6934575.5000,   241955.0469],
        [12824701.0000,        0.0000],
        [ 5061286.0000,   110028.2969],
        [ 6954490.0000,        0.0000],
        [18040296.0000,        0.0000],
        [17392032.0000,        0.0000],
        [14095138.0000,        0.0000],
        [13956254.0000,   608971.4375],
        [14954276.0000,        0.0000],
        [ 9734668.0000,  1256847.2500],
        [10086237.0000,   446663.4062],
        [14013386.0000,        0.0000],
        [10293162.0000,   408849.1562],
        [18125058.0000,        0.0000],
        [15760506.0000,        0.0000],
        [ 9341454.0000,        0.0000],
        [15615475.0000,        0.0000],
        [15351764.0000,   673986.3750],
        [17413832.0000,        0.0000],
        [18275124.0000,        0.0000],
        [16199990.0000,        0.0000],
        [20438808.0000,        0.0000],
        [16802984.0000,        0.0000],
        [ 6047193.5000,        0.0000],
        [ 7449703.0000,  1361872.7500],
        [ 8924854.0000,  2282953.2500],
        [ 6925554.0000,  1529777.0000],
        [ 6197499.0000,  1982050.0000],
        [ 4387746.0000,  1383853.8750],
        [ 3258790.0000,  2162340.0000],
        [16289937.0000,   830017.3750],
        [ 5107355.0000,  1297186.2500],
        [ 7865715.5000,        0.0000],
        [ 6915231.5000,        0.0000],
        [ 5079850.5000,   164801.0312],
        [ 4936139.5000,  2314519.2500],
        [  652509.6875,   855447.1875],
        [11168810.0000,   489560.3750],
        [ 2268508.0000,   800109.6875],
        [ 1205191.2500,  1018842.6250],
        [ 9387016.0000,  3341064.2500],
        [ 3991489.7500,   333785.3750],
        [ 8135153.0000,  1829106.7500],
        [ 6227818.0000,  3503661.2500],
        [ 6241455.5000,   876314.7500],
        [12207436.0000,   635367.2500],
        [ 9782606.0000,   472055.8750],
        [ 8152322.5000,  2706330.5000],
        [ 6042835.0000,  2505805.0000],
        [ 4613960.0000,  2956744.5000],
        [ 2786044.5000,  2100107.5000],
        [ 7753336.0000,  1080331.2500],
        [ 3825645.5000,  1013735.3750],
        [ 5938929.5000,  2707677.0000],
        [ 7077077.0000,   960793.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 206/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:15, 56.40s/it]  7%|▋         | 2/30 [00:58<11:18, 24.22s/it] 10%|█         | 3/30 [01:00<06:30, 14.47s/it] 13%|█▎        | 4/30 [01:01<03:52,  8.93s/it] 17%|█▋        | 5/30 [01:01<02:26,  5.87s/it] 20%|██        | 6/30 [01:02<01:36,  4.02s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.08s/it] 30%|███       | 9/30 [01:03<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.442454202969869
Epoch 207/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:39, 57.22s/it]  7%|▋         | 2/30 [00:58<11:19, 24.28s/it] 10%|█         | 3/30 [01:00<06:17, 13.98s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.64s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.68s/it] 20%|██        | 6/30 [01:01<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.4844441493352254
Epoch 208/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:09, 60.31s/it]  7%|▋         | 2/30 [01:00<11:42, 25.10s/it] 10%|█         | 3/30 [01:01<06:13, 13.84s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.63s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.4505489667256675
Epoch 209/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:07, 58.19s/it]  7%|▋         | 2/30 [01:00<11:54, 25.53s/it] 10%|█         | 3/30 [01:01<06:19, 14.07s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.69s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.72s/it] 20%|██        | 6/30 [01:02<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 3.4872925837834674
Epoch 210/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:05, 58.13s/it]  7%|▋         | 2/30 [01:00<11:51, 25.42s/it] 10%|█         | 3/30 [01:01<06:18, 14.01s/it] 13%|█▎        | 4/30 [01:01<03:45,  8.65s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.69s/it] 20%|██        | 6/30 [01:02<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.4194698254267375
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0500, -0.0568,  0.0924,  ..., -0.0567,  0.1102,  0.0641],
        [ 0.0162, -0.0456,  0.1029,  ..., -0.0251,  0.0869,  0.1118],
        [-0.0103, -0.0259,  0.0115,  ..., -0.0687,  0.0510,  0.1308],
        ...,
        [-0.0520, -0.0375,  0.0795,  ...,  0.0025,  0.0503,  0.0276],
        [-0.0683, -0.0881,  0.0592,  ..., -0.0099,  0.0837,  0.0231],
        [-0.0058, -0.0431,  0.1031,  ..., -0.0159,  0.0629,  0.0898]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8972, 0.8961, 0.8837,  ..., 0.8117, 0.8114, 0.8096],
        [0.9673, 0.9669, 0.9601,  ..., 0.9494, 0.9488, 0.9461],
        [0.9525, 0.9481, 0.9415,  ..., 0.8958, 0.8955, 0.8939],
        ...,
        [0.8876, 0.8855, 0.8809,  ..., 0.8471, 0.8450, 0.8354],
        [0.9424, 0.9213, 0.9131,  ..., 0.8905, 0.8830, 0.8817],
        [0.9221, 0.9186, 0.9135,  ..., 0.8845, 0.8843, 0.8840]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[ 368704.5312,  362541.0000,  304034.0938,  ...,  108572.4453,
          108097.7031,  105455.8594],
        [1002870.1250,  997467.5000,  904921.8750,  ...,  776411.5625,
          770584.0000,  740444.6250],
        [ 811641.8125,  762506.1250,  693934.1875,  ...,  361319.4688,
          359460.4062,  351644.2188],
        ...,
        [ 321164.7188,  311722.3125,  291876.0625,  ...,  180055.7500,
          174762.5000,  152434.3438],
        [ 702954.9375,  519924.0312,  462167.2188,  ...,  334852.7188,
          300853.8750,  295394.6250],
        [ 526133.5000,  500556.6562,  465356.0312,  ...,  307393.8750,
          306356.0938,  305232.7812]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[ 368704.5312,       0.0000],
         [ 362541.0000,       0.0000],
         [ 304034.0938,       0.0000],
         ...,
         [ 108572.4453,       0.0000],
         [ 108097.7031,       0.0000],
         [ 105455.8594,       0.0000]],

        [[1002870.1250,       0.0000],
         [ 997467.5000,       0.0000],
         [ 904921.8750,       0.0000],
         ...,
         [ 776411.5625,       0.0000],
         [ 770584.0000,       0.0000],
         [ 740444.6250,       0.0000]],

        [[ 811641.8125,       0.0000],
         [ 762506.1250,       0.0000],
         [ 693934.1875,       0.0000],
         ...,
         [ 361319.4688,       0.0000],
         [ 359460.4062,       0.0000],
         [ 351644.2188,       0.0000]],

        ...,

        [[ 321164.7188,       0.0000],
         [ 311722.3125,       0.0000],
         [ 291876.0625,       0.0000],
         ...,
         [ 180055.7500,       0.0000],
         [ 174762.5000,       0.0000],
         [ 152434.3438,       0.0000]],

        [[ 702954.9375,       0.0000],
         [      0.0000,  519924.0312],
         [      0.0000,  462167.2188],
         ...,
         [ 334852.7188,       0.0000],
         [ 300853.8750,       0.0000],
         [ 295394.6250,       0.0000]],

        [[      0.0000,  526133.5000],
         [ 500556.6562,       0.0000],
         [ 465356.0312,       0.0000],
         ...,
         [ 307393.8750,       0.0000],
         [ 306356.0938,       0.0000],
         [ 305232.7812,       0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3216047.0000,   156186.0469],
        [16764952.0000,        0.0000],
        [ 9351473.0000,   967478.3750],
        [ 6703059.0000,   197635.2812],
        [ 2877411.7500,  1017123.8750],
        [ 7385245.0000,        0.0000],
        [11463758.0000,  2163983.0000],
        [11725721.0000,   421480.8125],
        [11847774.0000,   584412.4375],
        [ 6729853.5000,   224730.1562],
        [12456292.0000,        0.0000],
        [ 4864053.5000,   101134.4531],
        [ 6716739.0000,        0.0000],
        [17786050.0000,        0.0000],
        [17074588.0000,        0.0000],
        [13845220.0000,        0.0000],
        [13573814.0000,   581872.0625],
        [14641818.0000,        0.0000],
        [ 9447390.0000,  1160767.1250],
        [ 9852705.0000,   439037.9062],
        [13651595.0000,        0.0000],
        [10008798.0000,   380459.6562],
        [17745344.0000,        0.0000],
        [15534469.0000,        0.0000],
        [ 9018148.0000,        0.0000],
        [15245606.0000,        0.0000],
        [15583036.0000,        0.0000],
        [17086024.0000,        0.0000],
        [17876672.0000,        0.0000],
        [15867251.0000,        0.0000],
        [20125160.0000,        0.0000],
        [16415407.0000,        0.0000],
        [ 5908173.5000,        0.0000],
        [ 7186625.0000,  1316860.7500],
        [ 8625533.0000,  2220900.5000],
        [ 6156026.0000,  1780093.1250],
        [ 6059615.0000,  1623484.6250],
        [ 4154104.0000,  1320574.2500],
        [ 3066216.0000,  2079119.3750],
        [15813010.0000,   801503.7500],
        [ 4914080.5000,  1244452.7500],
        [ 7572914.5000,        0.0000],
        [ 6686802.0000,        0.0000],
        [ 5113621.5000,        0.0000],
        [ 4674896.0000,  2214568.5000],
        [  661182.0000,   801362.3750],
        [10714530.0000,   476789.8125],
        [ 2155974.7500,   760883.1250],
        [ 1119151.5000,   942572.5000],
        [ 8872277.0000,  3184074.5000],
        [ 3902698.0000,   169935.2656],
        [ 7760242.0000,  1764654.0000],
        [ 5994728.0000,  3380951.2500],
        [ 6104657.0000,   835747.8750],
        [11925370.0000,   621465.1875],
        [ 9340276.0000,   452179.0000],
        [ 7827742.0000,  2624079.0000],
        [ 5819232.0000,  2427669.5000],
        [ 4414359.5000,  2828213.7500],
        [ 2631482.7500,  2018607.2500],
        [ 7508528.5000,  1056197.5000],
        [ 3499538.7500,   966788.7500],
        [ 5520094.5000,  2543852.0000],
        [ 6546935.0000,   907464.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 211/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:39, 61.38s/it]  7%|▋         | 2/30 [01:01<11:54, 25.53s/it] 10%|█         | 3/30 [01:02<06:19, 14.07s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.69s/it] 17%|█▋        | 5/30 [01:03<02:22,  5.72s/it] 20%|██        | 6/30 [01:03<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 3.4135486125946044
Epoch 212/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:27, 60.96s/it]  7%|▋         | 2/30 [01:01<11:50, 25.36s/it] 10%|█         | 3/30 [01:01<06:17, 13.98s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.63s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.68s/it] 20%|██        | 6/30 [01:03<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 3.409973621368408
Epoch 213/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:11, 60.41s/it]  7%|▋         | 2/30 [01:00<11:43, 25.13s/it] 10%|█         | 3/30 [01:01<06:14, 13.86s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.56s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.63s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.401948428153992
Epoch 214/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:06, 60.24s/it]  7%|▋         | 2/30 [01:00<11:41, 25.06s/it] 10%|█         | 3/30 [01:01<06:13, 13.82s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.54s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.62s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.3974372307459513
Epoch 215/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:40, 59.34s/it]  7%|▋         | 2/30 [00:59<11:31, 24.69s/it] 10%|█         | 3/30 [01:00<06:07, 13.62s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.42s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.54s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.01it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.18it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.3665950934092206
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0503, -0.0585,  0.0912,  ..., -0.0572,  0.1105,  0.0644],
        [ 0.0159, -0.0457,  0.1013,  ..., -0.0252,  0.0879,  0.1116],
        [-0.0117, -0.0251,  0.0110,  ..., -0.0681,  0.0510,  0.1311],
        ...,
        [-0.0509, -0.0362,  0.0794,  ..., -0.0006,  0.0488,  0.0271],
        [-0.0693, -0.0879,  0.0577,  ..., -0.0118,  0.0842,  0.0215],
        [-0.0072, -0.0408,  0.1012,  ..., -0.0166,  0.0646,  0.0906]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8962, 0.8926, 0.8828,  ..., 0.8101, 0.8087, 0.8079],
        [0.9655, 0.9652, 0.9577,  ..., 0.9467, 0.9462, 0.9446],
        [0.9509, 0.9448, 0.9372,  ..., 0.8923, 0.8900, 0.8895],
        ...,
        [0.8820, 0.8812, 0.8762,  ..., 0.8423, 0.8379, 0.8283],
        [0.9408, 0.9155, 0.9102,  ..., 0.8842, 0.8776, 0.8769],
        [0.9179, 0.9141, 0.9101,  ..., 0.8789, 0.8783, 0.8781]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[363071.7500, 344953.3438, 300167.1875,  ..., 106157.9531,
         104139.7266, 102821.7734],
        [978066.5625, 973162.3750, 874182.5625,  ..., 747769.4375,
         742054.8750, 725233.0625],
        [794039.5000, 726910.1875, 652734.3750,  ..., 343607.5000,
         332366.0312, 330126.5938],
        ...,
        [296712.2812, 293117.6250, 272936.7812,  ..., 168131.7500,
         157831.9219, 137728.4531],
        [687065.2500, 478592.9062, 443705.0625,  ..., 305941.2500,
         278601.7500, 275748.7812],
        [495522.5000, 469080.5938, 443032.3750,  ..., 283614.8125,
         281223.3750, 280357.9062]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[363071.7500,      0.0000],
         [344953.3438,      0.0000],
         [300167.1875,      0.0000],
         ...,
         [106157.9531,      0.0000],
         [104139.7266,      0.0000],
         [102821.7734,      0.0000]],

        [[978066.5625,      0.0000],
         [973162.3750,      0.0000],
         [874182.5625,      0.0000],
         ...,
         [747769.4375,      0.0000],
         [742054.8750,      0.0000],
         [725233.0625,      0.0000]],

        [[794039.5000,      0.0000],
         [726910.1875,      0.0000],
         [652734.3750,      0.0000],
         ...,
         [343607.5000,      0.0000],
         [332366.0312,      0.0000],
         [330126.5938,      0.0000]],

        ...,

        [[296712.2812,      0.0000],
         [293117.6250,      0.0000],
         [272936.7812,      0.0000],
         ...,
         [168131.7500,      0.0000],
         [157831.9219,      0.0000],
         [137728.4531,      0.0000]],

        [[687065.2500,      0.0000],
         [     0.0000, 478592.9062],
         [     0.0000, 443705.0625],
         ...,
         [305941.2500,      0.0000],
         [278601.7500,      0.0000],
         [275748.7812,      0.0000]],

        [[     0.0000, 495522.5000],
         [469080.5938,      0.0000],
         [443032.3750,      0.0000],
         ...,
         [283614.8125,      0.0000],
         [281223.3750,      0.0000],
         [280357.9062,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3118589.7500,   149209.8281],
        [16305171.0000,        0.0000],
        [ 8825549.0000,   932476.5625],
        [ 6597966.5000,        0.0000],
        [ 2652224.0000,   967829.3125],
        [ 6869319.0000,        0.0000],
        [10803773.0000,  2079251.2500],
        [11245387.0000,   395413.6250],
        [11346389.0000,   560493.1250],
        [ 6542664.0000,   209964.5625],
        [12105662.0000,        0.0000],
        [ 4670309.5000,    93207.6406],
        [ 6493113.0000,        0.0000],
        [17515768.0000,        0.0000],
        [16789618.0000,        0.0000],
        [13598329.0000,        0.0000],
        [13186756.0000,   552678.8125],
        [14309370.0000,        0.0000],
        [ 9143326.0000,  1070029.0000],
        [ 9612375.0000,   430824.2188],
        [13311240.0000,        0.0000],
        [ 9714348.0000,   353766.3750],
        [17414150.0000,        0.0000],
        [15295720.0000,        0.0000],
        [ 8686946.0000,        0.0000],
        [14892584.0000,        0.0000],
        [15162304.0000,        0.0000],
        [16746331.0000,        0.0000],
        [17443652.0000,        0.0000],
        [15549791.0000,        0.0000],
        [19813764.0000,        0.0000],
        [16008624.0000,        0.0000],
        [ 5754899.5000,        0.0000],
        [ 6941998.0000,  1278209.6250],
        [ 7938866.0000,  2574355.5000],
        [ 5777424.0000,  1708322.0000],
        [ 5665645.5000,  1575885.0000],
        [ 3938099.0000,  1260760.5000],
        [ 2894106.0000,  1990775.2500],
        [15318740.0000,   775236.6250],
        [ 4735649.0000,  1192754.1250],
        [ 7275479.0000,        0.0000],
        [ 6481988.0000,        0.0000],
        [ 4980585.0000,        0.0000],
        [ 4433042.0000,  2121900.5000],
        [  639831.0000,   780574.1250],
        [10281311.0000,   461827.5312],
        [ 2044112.6250,   731401.2500],
        [ 1035823.1875,   868060.3125],
        [ 8376619.5000,  3033818.5000],
        [ 3661954.0000,   172993.2031],
        [ 7396514.0000,  1699854.0000],
        [ 5488758.5000,  3550797.0000],
        [ 5964490.0000,   798028.5000],
        [11632459.0000,   610330.2500],
        [ 8923680.0000,   434559.4688],
        [ 7540742.0000,  2547679.2500],
        [ 5622913.0000,  2356349.0000],
        [ 4226103.5000,  2705484.5000],
        [ 2493206.7500,  1941461.7500],
        [ 7278946.5000,  1029057.8750],
        [ 3238088.0000,   927709.7500],
        [ 5125977.5000,  2382676.5000],
        [ 6044729.0000,   858543.3750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 216/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:12, 56.29s/it]  7%|▋         | 2/30 [00:57<11:14, 24.10s/it] 10%|█         | 3/30 [00:58<06:00, 13.36s/it] 13%|█▎        | 4/30 [00:59<03:36,  8.31s/it] 17%|█▋        | 5/30 [01:00<02:25,  5.83s/it] 20%|██        | 6/30 [01:00<01:35,  3.99s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.83s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.07s/it] 30%|███       | 9/30 [01:02<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 3.397558561960856
Epoch 217/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:45, 59.48s/it]  7%|▋         | 2/30 [01:00<11:39, 24.97s/it] 10%|█         | 3/30 [01:00<06:11, 13.77s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.60s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.3531724850336713
Epoch 218/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:58, 57.89s/it]  7%|▋         | 2/30 [01:00<11:56, 25.60s/it] 10%|█         | 3/30 [01:01<06:21, 14.11s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.72s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.73s/it] 20%|██        | 6/30 [01:02<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 3.3499322652816774
Epoch 219/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:05, 58.14s/it]  7%|▋         | 2/30 [00:58<11:17, 24.20s/it] 10%|█         | 3/30 [00:59<06:11, 13.77s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.60s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 3.374454379081726
Epoch 220/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:38, 61.31s/it]  7%|▋         | 2/30 [01:01<11:54, 25.51s/it] 10%|█         | 3/30 [01:02<06:19, 14.07s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.69s/it] 17%|█▋        | 5/30 [01:03<02:22,  5.71s/it] 20%|██        | 6/30 [01:03<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 3.3342002471288046
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0504, -0.0597,  0.0902,  ..., -0.0573,  0.1110,  0.0644],
        [ 0.0153, -0.0454,  0.0999,  ..., -0.0249,  0.0888,  0.1113],
        [-0.0127, -0.0237,  0.0108,  ..., -0.0674,  0.0512,  0.1310],
        ...,
        [-0.0493, -0.0346,  0.0795,  ..., -0.0033,  0.0471,  0.0265],
        [-0.0701, -0.0878,  0.0563,  ..., -0.0131,  0.0842,  0.0199],
        [-0.0088, -0.0387,  0.0994,  ..., -0.0166,  0.0660,  0.0910]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8944, 0.8893, 0.8822,  ..., 0.8092, 0.8055, 0.8054],
        [0.9637, 0.9634, 0.9552,  ..., 0.9440, 0.9434, 0.9430],
        [0.9495, 0.9413, 0.9338,  ..., 0.8873, 0.8852, 0.8844],
        ...,
        [0.8788, 0.8754, 0.8722,  ..., 0.8378, 0.8316, 0.8230],
        [0.9390, 0.9097, 0.9070,  ..., 0.8781, 0.8730, 0.8706],
        [0.9138, 0.9093, 0.9068,  ..., 0.8731, 0.8727, 0.8726]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[354209.6250, 329074.5312, 297575.7500,  ..., 104820.5547,
          99358.1172,  99347.1328],
        [953007.2500, 948113.8750, 844079.3750,  ..., 718773.0625,
         712555.5000, 709078.6250],
        [777583.7500, 691967.5000, 621957.8750,  ..., 319748.8125,
         310605.0312, 307050.2188],
        ...,
        [283452.3125, 269955.6562, 257779.2344,  ..., 157808.1406,
         144452.4688, 127580.2969],
        [669163.7500, 440475.9688, 423598.3750,  ..., 280577.7500,
         260934.8125, 251818.3750],
        [466992.0938, 437751.0625, 422727.0938,  ..., 261247.0469,
         259673.2188, 259215.2344]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[354209.6250,      0.0000],
         [329074.5312,      0.0000],
         [297575.7500,      0.0000],
         ...,
         [104820.5547,      0.0000],
         [ 99358.1172,      0.0000],
         [ 99347.1328,      0.0000]],

        [[953007.2500,      0.0000],
         [948113.8750,      0.0000],
         [844079.3750,      0.0000],
         ...,
         [718773.0625,      0.0000],
         [712555.5000,      0.0000],
         [709078.6250,      0.0000]],

        [[777583.7500,      0.0000],
         [691967.5000,      0.0000],
         [621957.8750,      0.0000],
         ...,
         [319748.8125,      0.0000],
         [310605.0312,      0.0000],
         [307050.2188,      0.0000]],

        ...,

        [[283452.3125,      0.0000],
         [269955.6562,      0.0000],
         [257779.2344,      0.0000],
         ...,
         [157808.1406,      0.0000],
         [144452.4688,      0.0000],
         [127580.2969,      0.0000]],

        [[669163.7500,      0.0000],
         [     0.0000, 440475.9688],
         [     0.0000, 423598.3750],
         ...,
         [280577.7500,      0.0000],
         [260934.8125,      0.0000],
         [251818.3750,      0.0000]],

        [[     0.0000, 466992.0938],
         [437751.0625,      0.0000],
         [422727.0938,      0.0000],
         ...,
         [261247.0469,      0.0000],
         [259673.2188,      0.0000],
         [259215.2344,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 3013376.5000,   143113.0781],
        [15842866.0000,        0.0000],
        [ 8335767.5000,   899465.6250],
        [ 6319013.0000,        0.0000],
        [ 2459859.2500,   926228.7500],
        [ 6374434.0000,        0.0000],
        [ 9770008.0000,  2406879.2500],
        [11078802.0000,        0.0000],
        [10885159.0000,   537680.4375],
        [ 6574841.0000,        0.0000],
        [11757837.0000,        0.0000],
        [ 4474562.0000,    85804.2812],
        [ 6294606.5000,        0.0000],
        [17248500.0000,        0.0000],
        [16499127.0000,        0.0000],
        [13339543.0000,        0.0000],
        [12828305.0000,   527263.1875],
        [14034699.0000,        0.0000],
        [ 9147778.0000,   677013.7500],
        [ 9382222.0000,   422039.9062],
        [12993528.0000,        0.0000],
        [ 9780256.0000,        0.0000],
        [17096364.0000,        0.0000],
        [15067532.0000,        0.0000],
        [ 8392264.0000,        0.0000],
        [14565320.0000,        0.0000],
        [14744792.0000,        0.0000],
        [16461598.0000,        0.0000],
        [17035322.0000,        0.0000],
        [15232121.0000,        0.0000],
        [19489496.0000,        0.0000],
        [15612440.0000,        0.0000],
        [ 5640966.5000,        0.0000],
        [ 6706155.0000,  1242518.3750],
        [ 7673235.5000,  2510675.5000],
        [ 5153247.5000,  1928125.6250],
        [ 5299891.0000,  1528691.1250],
        [ 3736132.2500,  1198868.5000],
        [ 2744768.0000,  1912383.5000],
        [14850854.0000,   747368.6875],
        [ 4571633.5000,  1140832.7500],
        [ 7028185.0000,        0.0000],
        [ 6282683.0000,        0.0000],
        [ 4852857.0000,        0.0000],
        [ 4203432.0000,  2035489.5000],
        [  621261.8750,   760645.8750],
        [ 9866033.0000,   446892.2188],
        [ 1867611.1250,   768083.7500],
        [  914959.8750,   859973.7500],
        [ 7892917.5000,  2884186.5000],
        [ 3416000.0000,   175464.0625],
        [ 7047489.0000,  1635030.8750],
        [ 5287913.0000,  3431672.5000],
        [ 6050919.0000,   540165.6875],
        [11324014.0000,   596833.6250],
        [ 8519118.0000,   417014.8125],
        [ 7233630.5000,  2472851.7500],
        [ 5425989.0000,  2285313.7500],
        [ 4042788.5000,  2584267.0000],
        [ 2364630.5000,  1870760.0000],
        [ 7048414.0000,  1000761.7500],
        [ 3018773.7500,   889589.5000],
        [ 4757473.5000,  2226105.0000],
        [ 5567355.5000,   812683.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 221/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:38, 61.34s/it]  7%|▋         | 2/30 [01:01<11:54, 25.52s/it] 10%|█         | 3/30 [01:02<06:19, 14.07s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.69s/it] 17%|█▋        | 5/30 [01:03<02:22,  5.71s/it] 20%|██        | 6/30 [01:03<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.25it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 3.345183753967285
Epoch 222/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:23, 58.75s/it]  7%|▋         | 2/30 [01:01<11:56, 25.58s/it] 10%|█         | 3/30 [01:01<06:20, 14.10s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.71s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.73s/it] 20%|██        | 6/30 [01:02<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 3.272817103068034
Epoch 223/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:36, 57.11s/it]  7%|▋         | 2/30 [00:57<11:05, 23.77s/it] 10%|█         | 3/30 [00:57<05:54, 13.12s/it] 13%|█▎        | 4/30 [01:00<03:48,  8.77s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.77s/it] 20%|██        | 6/30 [01:00<01:34,  3.96s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 3.2950119733810426
Epoch 224/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:36, 59.20s/it]  7%|▋         | 2/30 [00:59<11:29, 24.64s/it] 10%|█         | 3/30 [01:00<06:06, 13.59s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.40s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.53s/it] 20%|██        | 6/30 [01:01<01:31,  3.80s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.2938414096832274
Epoch 225/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:58, 57.87s/it]  7%|▋         | 2/30 [00:58<11:14, 24.09s/it] 10%|█         | 3/30 [01:00<06:16, 13.96s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.67s/it] 20%|██        | 6/30 [01:01<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.349707309405009
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0506, -0.0613,  0.0896,  ..., -0.0575,  0.1113,  0.0642],
        [ 0.0151, -0.0450,  0.0987,  ..., -0.0245,  0.0901,  0.1107],
        [-0.0135, -0.0229,  0.0109,  ..., -0.0667,  0.0519,  0.1309],
        ...,
        [-0.0479, -0.0329,  0.0796,  ..., -0.0057,  0.0456,  0.0255],
        [-0.0713, -0.0879,  0.0548,  ..., -0.0145,  0.0847,  0.0182],
        [-0.0105, -0.0369,  0.0978,  ..., -0.0167,  0.0677,  0.0913]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8933, 0.8864, 0.8817,  ..., 0.8067, 0.8043, 0.8027],
        [0.9620, 0.9617, 0.9542,  ..., 0.9418, 0.9416, 0.9413],
        [0.9481, 0.9383, 0.9311,  ..., 0.8820, 0.8812, 0.8804],
        ...,
        [0.8746, 0.8688, 0.8673,  ..., 0.8322, 0.8251, 0.8170],
        [0.9372, 0.9037, 0.9036,  ..., 0.8715, 0.8682, 0.8644],
        [0.9102, 0.9043, 0.9035,  ..., 0.8673, 0.8672, 0.8671]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[348285.0625, 315779.6250, 295101.7812,  ..., 101106.6797,
          97677.1406,  95474.7969],
        [930335.3750, 925299.8125, 831442.6250,  ..., 696468.1250,
         695227.1250, 692150.3750],
        [762207.3750, 662463.6250, 597739.8750,  ..., 296534.0625,
         293310.8750, 290054.0938],
        ...,
        [266923.8125, 245696.4062, 240287.9062,  ..., 145506.5938,
         131475.8125, 117245.2109],
        [652751.1250, 404260.5312, 403808.9375,  ..., 255250.5000,
         243496.0156, 230590.3906],
        [443561.2188, 407877.8750, 403360.1562,  ..., 240480.7031,
         240085.6562, 239614.4531]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[348285.0625,      0.0000],
         [315779.6250,      0.0000],
         [295101.7812,      0.0000],
         ...,
         [101106.6797,      0.0000],
         [ 97677.1406,      0.0000],
         [ 95474.7969,      0.0000]],

        [[930335.3750,      0.0000],
         [925299.8125,      0.0000],
         [831442.6250,      0.0000],
         ...,
         [696468.1250,      0.0000],
         [695227.1250,      0.0000],
         [692150.3750,      0.0000]],

        [[762207.3750,      0.0000],
         [662463.6250,      0.0000],
         [597739.8750,      0.0000],
         ...,
         [296534.0625,      0.0000],
         [293310.8750,      0.0000],
         [290054.0938,      0.0000]],

        ...,

        [[266923.8125,      0.0000],
         [245696.4062,      0.0000],
         [240287.9062,      0.0000],
         ...,
         [145506.5938,      0.0000],
         [131475.8125,      0.0000],
         [117245.2109,      0.0000]],

        [[652751.1250,      0.0000],
         [     0.0000, 404260.5312],
         [     0.0000, 403808.9375],
         ...,
         [255250.5000,      0.0000],
         [243496.0156,      0.0000],
         [     0.0000, 230590.3906]],

        [[     0.0000, 443561.2188],
         [407877.8750,      0.0000],
         [403360.1562,      0.0000],
         ...,
         [240480.7031,      0.0000],
         [240085.6562,      0.0000],
         [239614.4531,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2929895.0000,   137103.8750],
        [15435634.0000,        0.0000],
        [ 7911980.0000,   869230.1250],
        [ 6092292.5000,        0.0000],
        [ 2379816.7500,   811174.3750],
        [ 5948782.0000,        0.0000],
        [ 9193460.0000,  2309727.5000],
        [10527401.0000,        0.0000],
        [10443040.0000,   515112.4688],
        [ 6413282.5000,        0.0000],
        [11470677.0000,        0.0000],
        [ 4305710.0000,    79943.9141],
        [ 6125489.0000,        0.0000],
        [16985172.0000,        0.0000],
        [16222197.0000,        0.0000],
        [13125516.0000,        0.0000],
        [13006720.0000,        0.0000],
        [13787542.0000,        0.0000],
        [ 8854527.0000,   626587.6875],
        [ 9197850.0000,   413888.3438],
        [12708174.0000,        0.0000],
        [ 9520366.0000,        0.0000],
        [16774498.0000,        0.0000],
        [14886537.0000,        0.0000],
        [ 8089322.0000,        0.0000],
        [14275024.0000,        0.0000],
        [14324754.0000,        0.0000],
        [16186296.0000,        0.0000],
        [16674871.0000,        0.0000],
        [14954622.0000,        0.0000],
        [19196268.0000,        0.0000],
        [15261415.0000,        0.0000],
        [ 5532343.5000,        0.0000],
        [ 6502065.0000,  1213134.2500],
        [ 7449082.5000,  2452269.7500],
        [ 4872693.5000,  1881148.3750],
        [ 4738534.0000,  1712712.5000],
        [ 3580055.5000,  1146148.0000],
        [ 2619105.5000,  1842351.2500],
        [14400449.0000,   722637.9375],
        [ 4424392.0000,  1090714.7500],
        [ 6782424.0000,        0.0000],
        [ 6093647.5000,        0.0000],
        [ 4727295.0000,        0.0000],
        [ 3981622.7500,  1954426.5000],
        [  602226.4375,   740358.0625],
        [ 9466684.0000,   431773.1250],
        [ 1772928.0000,   743265.6875],
        [  858276.3750,   807458.1250],
        [ 7435905.0000,  2745311.2500],
        [ 3219428.0000,   177615.8750],
        [ 6724655.0000,  1576902.6250],
        [ 5106740.5000,  3322439.7500],
        [ 5918472.0000,   525791.8125],
        [11028904.0000,   583631.5625],
        [ 8174956.0000,   402162.1562],
        [ 6940536.0000,  2394287.0000],
        [ 5258999.0000,  2217184.0000],
        [ 3871614.5000,  2468847.0000],
        [ 2253318.5000,  1796482.2500],
        [ 6814022.0000,   973074.1250],
        [ 2782206.0000,   849116.0000],
        [ 4174269.7500,  2308645.0000],
        [ 4892380.5000,  1014322.0625]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 226/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:07, 56.11s/it]  7%|▋         | 2/30 [00:56<10:54, 23.36s/it] 10%|█         | 3/30 [00:59<06:24, 14.23s/it] 13%|█▎        | 4/30 [01:00<03:48,  8.79s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.78s/it] 20%|██        | 6/30 [01:01<01:35,  3.96s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 3.280709393819173
Epoch 227/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:39, 55.16s/it]  7%|▋         | 2/30 [00:55<10:44, 23.00s/it] 10%|█         | 3/30 [01:00<06:37, 14.73s/it] 13%|█▎        | 4/30 [01:01<04:02,  9.33s/it] 17%|█▋        | 5/30 [01:02<02:33,  6.12s/it] 20%|██        | 6/30 [01:02<01:40,  4.19s/it] 23%|██▎       | 7/30 [01:02<01:08,  2.97s/it] 27%|██▋       | 8/30 [01:03<00:47,  2.16s/it] 30%|███       | 9/30 [01:03<00:34,  1.62s/it] 33%|███▎      | 10/30 [01:04<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:04<00:19,  1.01s/it] 40%|████      | 12/30 [01:05<00:15,  1.20it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.39it/s] 47%|████▋     | 14/30 [01:06<00:10,  1.58it/s] 50%|█████     | 15/30 [01:06<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.97it/s] 60%|██████    | 18/30 [01:07<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.21it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.25it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.2838199536005654
Epoch 228/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:04, 56.00s/it]  7%|▋         | 2/30 [00:59<11:38, 24.95s/it] 10%|█         | 3/30 [00:59<06:11, 13.76s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.50s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.59s/it] 20%|██        | 6/30 [01:00<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 3.280688174565633
Epoch 229/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:52, 59.75s/it]  7%|▋         | 2/30 [01:00<11:36, 24.86s/it] 10%|█         | 3/30 [01:00<06:10, 13.71s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.47s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.58s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.279294967651367
Epoch 230/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:51, 55.56s/it]  7%|▋         | 2/30 [00:55<10:47, 23.14s/it] 10%|█         | 3/30 [00:56<05:44, 12.77s/it] 13%|█▎        | 4/30 [01:00<04:00,  9.26s/it] 17%|█▋        | 5/30 [01:01<02:37,  6.32s/it] 20%|██        | 6/30 [01:01<01:43,  4.32s/it] 23%|██▎       | 7/30 [01:02<01:10,  3.05s/it] 27%|██▋       | 8/30 [01:02<00:48,  2.22s/it] 30%|███       | 9/30 [01:03<00:34,  1.66s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.29s/it] 37%|███▋      | 11/30 [01:04<00:19,  1.03s/it] 40%|████      | 12/30 [01:04<00:15,  1.17it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.37it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.56it/s] 50%|█████     | 15/30 [01:05<00:08,  1.72it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.85it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.96it/s] 60%|██████    | 18/30 [01:07<00:05,  2.04it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.22it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.24941246509552
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0513, -0.0623,  0.0891,  ..., -0.0578,  0.1118,  0.0639],
        [ 0.0155, -0.0444,  0.0979,  ..., -0.0240,  0.0914,  0.1101],
        [-0.0134, -0.0216,  0.0111,  ..., -0.0662,  0.0522,  0.1314],
        ...,
        [-0.0463, -0.0307,  0.0792,  ..., -0.0078,  0.0439,  0.0249],
        [-0.0717, -0.0885,  0.0533,  ..., -0.0161,  0.0853,  0.0168],
        [-0.0114, -0.0351,  0.0960,  ..., -0.0168,  0.0692,  0.0918]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8915, 0.8834, 0.8809,  ..., 0.8031, 0.8030, 0.7998],
        [0.9602, 0.9600, 0.9534,  ..., 0.9396, 0.9394, 0.9392],
        [0.9464, 0.9349, 0.9280,  ..., 0.8771, 0.8765, 0.8760],
        ...,
        [0.8713, 0.8644, 0.8640,  ..., 0.8264, 0.8193, 0.8144],
        [0.9358, 0.9013, 0.9003,  ..., 0.8653, 0.8638, 0.8598],
        [0.9066, 0.9002, 0.8997,  ..., 0.8621, 0.8620, 0.8612]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 1,  ..., 0, 0, 1],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[339791.9375, 302590.9688, 291962.3750,  ...,  96025.3359,
          95913.5781,  91712.1094],
        [906946.9375, 903458.5000, 822438.8750,  ..., 675029.8125,
         672982.5000, 671859.6250],
        [744300.9375, 631361.4375, 572163.6250,  ..., 276681.2812,
         274280.8438, 272154.1562],
        ...,
        [254444.3438, 230685.6250, 229332.0000,  ..., 133996.8438,
         121083.7734, 112887.5703],
        [639596.8125, 390784.9375, 384991.7500,  ..., 233464.7656,
         228814.4688, 216066.0625],
        [421514.9688, 384558.4062, 381973.5000,  ..., 223252.1562,
         222955.7812, 220281.3594]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[339791.9375,      0.0000],
         [302590.9688,      0.0000],
         [291962.3750,      0.0000],
         ...,
         [ 96025.3359,      0.0000],
         [ 95913.5781,      0.0000],
         [ 91712.1094,      0.0000]],

        [[906946.9375,      0.0000],
         [903458.5000,      0.0000],
         [822438.8750,      0.0000],
         ...,
         [675029.8125,      0.0000],
         [672982.5000,      0.0000],
         [671859.6250,      0.0000]],

        [[744300.9375,      0.0000],
         [631361.4375,      0.0000],
         [572163.6250,      0.0000],
         ...,
         [276681.2812,      0.0000],
         [274280.8438,      0.0000],
         [272154.1562,      0.0000]],

        ...,

        [[254444.3438,      0.0000],
         [     0.0000, 230685.6250],
         [     0.0000, 229332.0000],
         ...,
         [133996.8438,      0.0000],
         [121083.7734,      0.0000],
         [     0.0000, 112887.5703]],

        [[639596.8125,      0.0000],
         [     0.0000, 390784.9375],
         [     0.0000, 384991.7500],
         ...,
         [233464.7656,      0.0000],
         [228814.4688,      0.0000],
         [     0.0000, 216066.0625]],

        [[     0.0000, 421514.9688],
         [384558.4062,      0.0000],
         [381973.5000,      0.0000],
         ...,
         [223252.1562,      0.0000],
         [222955.7812,      0.0000],
         [220281.3594,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2837220.5000,   132413.7656],
        [15052047.0000,        0.0000],
        [ 7476882.5000,   837503.7500],
        [ 5874240.5000,        0.0000],
        [ 2228066.5000,   788169.4375],
        [ 5551423.0000,        0.0000],
        [ 8668024.0000,  2212443.0000],
        [ 9996012.0000,        0.0000],
        [ 9982814.0000,   490400.0625],
        [ 6261018.0000,        0.0000],
        [11182485.0000,        0.0000],
        [ 4139187.5000,    74311.6797],
        [ 5942600.0000,        0.0000],
        [16689609.0000,        0.0000],
        [15976009.0000,        0.0000],
        [12944272.0000,        0.0000],
        [12661728.0000,        0.0000],
        [13519386.0000,        0.0000],
        [ 8825477.0000,   303214.0625],
        [ 9010960.0000,   405880.2812],
        [12367800.0000,        0.0000],
        [ 9235984.0000,        0.0000],
        [16466453.0000,        0.0000],
        [14702466.0000,        0.0000],
        [ 7789239.5000,        0.0000],
        [14002791.0000,        0.0000],
        [13958276.0000,        0.0000],
        [15946587.0000,        0.0000],
        [16326892.0000,        0.0000],
        [14702098.0000,        0.0000],
        [18903670.0000,        0.0000],
        [14954514.0000,        0.0000],
        [ 5427034.5000,        0.0000],
        [ 6281072.5000,  1178600.2500],
        [ 7219024.0000,  2392002.2500],
        [ 4587335.5000,  1825397.3750],
        [ 4437252.0000,  1646971.8750],
        [ 3431434.0000,  1094918.2500],
        [ 2505572.5000,  1779151.1250],
        [13928569.0000,   695308.0625],
        [ 4294425.0000,  1043571.8125],
        [ 6543903.0000,        0.0000],
        [ 5926595.0000,        0.0000],
        [ 4601552.5000,        0.0000],
        [ 3774558.0000,  1874924.8750],
        [  585018.6875,   723480.8750],
        [ 9110073.0000,   417273.3750],
        [ 1681879.6250,   717105.6875],
        [  801707.1250,   757208.2500],
        [ 6999288.0000,  2616401.0000],
        [ 3043314.0000,   180510.1562],
        [ 6417113.5000,  1519114.5000],
        [ 4940308.0000,  3224699.7500],
        [ 6014509.0000,   300325.2500],
        [10752324.0000,   570982.9375],
        [ 7857477.0000,   387567.0938],
        [ 6674113.0000,  2325621.0000],
        [ 5121215.0000,  2158011.2500],
        [ 3722417.0000,  2367776.0000],
        [ 2159181.2500,  1733475.2500],
        [ 6588796.0000,   944978.7500],
        [ 2485769.0000,   930602.7500],
        [ 3892393.0000,  2164152.0000],
        [ 4535519.5000,   966095.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 231/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:47, 57.50s/it]  7%|▋         | 2/30 [00:59<11:34, 24.82s/it] 10%|█         | 3/30 [01:00<06:23, 14.20s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.77s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.76s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.246022367477417
Epoch 232/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:56, 55.73s/it]  7%|▋         | 2/30 [00:58<11:34, 24.82s/it] 10%|█         | 3/30 [01:01<06:30, 14.47s/it] 13%|█▎        | 4/30 [01:01<03:52,  8.93s/it] 17%|█▋        | 5/30 [01:01<02:26,  5.87s/it] 20%|██        | 6/30 [01:02<01:36,  4.02s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.09s/it] 30%|███       | 9/30 [01:03<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.2824780782063803
Epoch 233/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:41, 55.22s/it]  7%|▋         | 2/30 [00:55<10:43, 23.00s/it] 10%|█         | 3/30 [00:59<06:21, 14.12s/it] 13%|█▎        | 4/30 [00:59<03:46,  8.72s/it] 17%|█▋        | 5/30 [01:01<02:32,  6.08s/it] 20%|██        | 6/30 [01:01<01:39,  4.16s/it] 23%|██▎       | 7/30 [01:01<01:07,  2.95s/it] 27%|██▋       | 8/30 [01:02<00:47,  2.15s/it] 30%|███       | 9/30 [01:02<00:33,  1.61s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.25s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.00s/it] 40%|████      | 12/30 [01:04<00:14,  1.20it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.58it/s] 50%|█████     | 15/30 [01:05<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.2360190868377687
Epoch 234/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:20, 56.57s/it]  7%|▋         | 2/30 [01:00<11:49, 25.32s/it] 10%|█         | 3/30 [01:01<06:24, 14.25s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.80s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.79s/it] 20%|██        | 6/30 [01:02<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.1872993230819704
Epoch 235/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:29, 58.96s/it]  7%|▋         | 2/30 [00:59<11:27, 24.54s/it] 10%|█         | 3/30 [00:59<06:05, 13.53s/it] 13%|█▎        | 4/30 [01:00<03:37,  8.36s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.51s/it] 20%|██        | 6/30 [01:01<01:30,  3.78s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.69s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 3.2362908999125164
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0519, -0.0636,  0.0885,  ..., -0.0578,  0.1117,  0.0635],
        [ 0.0158, -0.0445,  0.0967,  ..., -0.0234,  0.0920,  0.1094],
        [-0.0132, -0.0207,  0.0110,  ..., -0.0654,  0.0523,  0.1315],
        ...,
        [-0.0445, -0.0285,  0.0789,  ..., -0.0105,  0.0425,  0.0243],
        [-0.0720, -0.0888,  0.0512,  ..., -0.0177,  0.0857,  0.0161],
        [-0.0125, -0.0334,  0.0939,  ..., -0.0170,  0.0705,  0.0925]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8898, 0.8799, 0.8799,  ..., 0.7993, 0.7989, 0.7968],
        [0.9584, 0.9582, 0.9528,  ..., 0.9369, 0.9368, 0.9364],
        [0.9449, 0.9314, 0.9250,  ..., 0.8728, 0.8724, 0.8724],
        ...,
        [0.8678, 0.8629, 0.8613,  ..., 0.8205, 0.8165, 0.8138],
        [0.9342, 0.8995, 0.8965,  ..., 0.8574, 0.8573, 0.8552],
        [0.9028, 0.8967, 0.8946,  ..., 0.8564, 0.8557, 0.8549]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 1, 0],
        ...,
        [0, 1, 1,  ..., 0, 1, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[331593.5312, 287839.1250, 287834.1875,  ...,  90976.8828,
          90472.8906,  87828.6875],
        [883758.6875, 880939.7500, 815429.5000,  ..., 649271.3125,
         649060.8125, 645089.8125],
        [728816.2500, 600958.5000, 548307.2500,  ..., 260208.6875,
         258619.1719, 258422.4375],
        ...,
        [242152.4219, 225870.6562, 220532.9688,  ..., 123247.5938,
         116259.1562, 111998.8203],
        [625191.2500, 380679.9375, 364865.5938,  ..., 208677.9844,
         208439.2969, 202318.0000],
        [399362.1875, 365873.6562, 355028.7188,  ..., 205769.9844,
         203817.3281, 201251.3438]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[331593.5312,      0.0000],
         [287839.1250,      0.0000],
         [287834.1875,      0.0000],
         ...,
         [ 90976.8828,      0.0000],
         [ 90472.8906,      0.0000],
         [ 87828.6875,      0.0000]],

        [[883758.6875,      0.0000],
         [880939.7500,      0.0000],
         [815429.5000,      0.0000],
         ...,
         [649271.3125,      0.0000],
         [649060.8125,      0.0000],
         [645089.8125,      0.0000]],

        [[728816.2500,      0.0000],
         [600958.5000,      0.0000],
         [548307.2500,      0.0000],
         ...,
         [260208.6875,      0.0000],
         [     0.0000, 258619.1719],
         [258422.4375,      0.0000]],

        ...,

        [[242152.4219,      0.0000],
         [     0.0000, 225870.6562],
         [     0.0000, 220532.9688],
         ...,
         [123247.5938,      0.0000],
         [     0.0000, 116259.1562],
         [111998.8203,      0.0000]],

        [[625191.2500,      0.0000],
         [     0.0000, 380679.9375],
         [     0.0000, 364865.5938],
         ...,
         [208677.9844,      0.0000],
         [208439.2969,      0.0000],
         [202318.0000,      0.0000]],

        [[     0.0000, 399362.1875],
         [365873.6562,      0.0000],
         [355028.7188,      0.0000],
         ...,
         [205769.9844,      0.0000],
         [203817.3281,      0.0000],
         [201251.3438,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2741328.2500,   127927.1641],
        [14664357.0000,        0.0000],
        [ 6817383.0000,  1064723.2500],
        [ 5658309.0000,        0.0000],
        [ 2087654.0000,   764466.1250],
        [ 5156325.5000,        0.0000],
        [ 8150659.5000,  2112357.7500],
        [ 9521642.0000,        0.0000],
        [ 9528362.0000,   467725.3125],
        [ 6117219.0000,        0.0000],
        [10895134.0000,        0.0000],
        [ 3984288.2500,    69360.5000],
        [ 5767012.5000,        0.0000],
        [16373552.0000,        0.0000],
        [15747438.0000,        0.0000],
        [12749574.0000,        0.0000],
        [12338650.0000,        0.0000],
        [13264937.0000,        0.0000],
        [ 8526260.0000,   282187.8438],
        [ 8819863.0000,   396461.4688],
        [12045606.0000,        0.0000],
        [ 8960372.0000,        0.0000],
        [16164856.0000,        0.0000],
        [14521012.0000,        0.0000],
        [ 7495801.0000,        0.0000],
        [13742438.0000,        0.0000],
        [13597267.0000,        0.0000],
        [15698924.0000,        0.0000],
        [16009042.0000,        0.0000],
        [14448012.0000,        0.0000],
        [18608762.0000,        0.0000],
        [14660517.0000,        0.0000],
        [ 5304205.0000,        0.0000],
        [ 6074454.0000,  1145767.5000],
        [ 7004620.0000,  2329359.0000],
        [ 4110428.2500,  2006755.6250],
        [ 4144334.7500,  1584828.2500],
        [ 3290967.0000,  1045313.4375],
        [ 2399586.5000,  1715355.5000],
        [13479395.0000,   670259.0625],
        [ 4169891.0000,   997410.3750],
        [ 6348636.5000,        0.0000],
        [ 5769985.0000,        0.0000],
        [ 4482388.0000,        0.0000],
        [ 3575433.5000,  1806513.2500],
        [  569984.4375,   705647.2500],
        [ 8783426.0000,   406028.9688],
        [ 1580248.7500,   689490.8125],
        [  745118.8750,   704766.0000],
        [ 6584671.0000,  2497343.5000],
        [ 2866089.0000,   181939.7969],
        [ 6114689.0000,  1463363.3750],
        [ 4789307.0000,  3127607.0000],
        [ 5887580.0000,   291732.4375],
        [10475640.0000,   558573.7500],
        [ 7548123.0000,   373472.5625],
        [ 6433113.5000,  2259014.0000],
        [ 4995250.0000,  2103422.0000],
        [ 3579596.5000,  2267317.2500],
        [ 2073605.1250,  1669746.7500],
        [ 6371345.5000,   917644.2500],
        [ 2321473.5000,   903842.1250],
        [ 3824643.2500,  1820976.3750],
        [ 4174910.7500,   920267.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 236/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:54, 59.83s/it]  7%|▋         | 2/30 [01:00<11:37, 24.90s/it] 10%|█         | 3/30 [01:00<06:10, 13.73s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.48s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.58s/it] 20%|██        | 6/30 [01:02<01:32,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.232337252298991
Epoch 237/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<28:00, 57.95s/it]  7%|▋         | 2/30 [00:58<11:19, 24.28s/it] 10%|█         | 3/30 [00:59<06:01, 13.39s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.64s/it] 20%|██        | 6/30 [01:01<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 3.1656142632166544
Epoch 238/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:35, 59.15s/it]  7%|▋         | 2/30 [01:00<11:39, 25.00s/it] 10%|█         | 3/30 [01:00<06:12, 13.80s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.1686566273371377
Epoch 239/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:28, 60.97s/it]  7%|▋         | 2/30 [01:01<11:50, 25.37s/it] 10%|█         | 3/30 [01:01<06:17, 13.99s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.64s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.68s/it] 20%|██        | 6/30 [01:03<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 3.2147004048029584
Epoch 240/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:04<31:00, 64.15s/it]  7%|▋         | 2/30 [01:08<13:37, 29.21s/it] 10%|█         | 3/30 [01:09<07:14, 16.08s/it] 13%|█▎        | 4/30 [01:09<04:17,  9.90s/it] 17%|█▋        | 5/30 [01:10<02:42,  6.49s/it] 20%|██        | 6/30 [01:10<01:46,  4.43s/it] 23%|██▎       | 7/30 [01:11<01:11,  3.13s/it] 27%|██▋       | 8/30 [01:11<00:50,  2.27s/it] 30%|███       | 9/30 [01:11<00:35,  1.70s/it] 33%|███▎      | 10/30 [01:12<00:26,  1.31s/it] 37%|███▋      | 11/30 [01:12<00:19,  1.05s/it] 40%|████      | 12/30 [01:13<00:15,  1.16it/s] 43%|████▎     | 13/30 [01:13<00:12,  1.36it/s] 47%|████▋     | 14/30 [01:14<00:10,  1.55it/s] 50%|█████     | 15/30 [01:14<00:08,  1.71it/s] 53%|█████▎    | 16/30 [01:15<00:07,  1.85it/s] 57%|█████▋    | 17/30 [01:15<00:06,  1.95it/s] 60%|██████    | 18/30 [01:15<00:05,  2.04it/s] 63%|██████▎   | 19/30 [01:16<00:05,  2.10it/s] 67%|██████▋   | 20/30 [01:16<00:04,  2.15it/s] 70%|███████   | 21/30 [01:17<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:17<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:18<00:03,  2.22it/s] 80%|████████  | 24/30 [01:18<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:19<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:19<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:19<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:20<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:20<00:00,  2.26it/s]100%|██████████| 30/30 [01:21<00:00,  2.26it/s]100%|██████████| 30/30 [01:21<00:00,  2.72s/it]
Epoch loss is 3.1877159118652343
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0526, -0.0654,  0.0880,  ..., -0.0575,  0.1115,  0.0630],
        [ 0.0161, -0.0447,  0.0955,  ..., -0.0229,  0.0929,  0.1083],
        [-0.0137, -0.0199,  0.0112,  ..., -0.0644,  0.0524,  0.1313],
        ...,
        [-0.0421, -0.0270,  0.0788,  ..., -0.0130,  0.0413,  0.0237],
        [-0.0720, -0.0896,  0.0490,  ..., -0.0192,  0.0864,  0.0153],
        [-0.0134, -0.0321,  0.0915,  ..., -0.0171,  0.0721,  0.0928]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8882, 0.8792, 0.8765,  ..., 0.7959, 0.7954, 0.7945],
        [0.9567, 0.9565, 0.9521,  ..., 0.9355, 0.9345, 0.9336],
        [0.9434, 0.9281, 0.9220,  ..., 0.8690, 0.8686, 0.8678],
        ...,
        [0.8637, 0.8615, 0.8583,  ..., 0.8147, 0.8147, 0.8075],
        [0.9329, 0.8978, 0.8930,  ..., 0.8512, 0.8498, 0.8497],
        [0.8993, 0.8934, 0.8895,  ..., 0.8502, 0.8494, 0.8494]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 1, 0, 0],
        ...,
        [0, 1, 1,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 1, 1],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[324107.7500, 285030.5000, 274208.9062,  ...,  86634.5078,
          86015.9062,  84954.5469],
        [862117.3125, 859895.4375, 807478.1250,  ..., 637223.5625,
         628220.8125, 619544.3125],
        [713316.9375, 573024.1875, 525350.8125,  ..., 246254.9219,
         244780.0625, 242079.9219],
        ...,
        [228176.2188, 221415.5312, 211251.5938,  ..., 113468.5859,
         113321.2969, 102292.2500],
        [613291.8750, 371828.5312, 347166.1562,  ..., 190899.6094,
         187081.8125, 187021.5156],
        [379487.7500, 348906.7188, 330012.9688,  ..., 188336.3438,
         186244.7812, 186050.3906]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[324107.7500,      0.0000],
         [285030.5000,      0.0000],
         [274208.9062,      0.0000],
         ...,
         [ 86634.5078,      0.0000],
         [ 86015.9062,      0.0000],
         [ 84954.5469,      0.0000]],

        [[862117.3125,      0.0000],
         [859895.4375,      0.0000],
         [807478.1250,      0.0000],
         ...,
         [637223.5625,      0.0000],
         [628220.8125,      0.0000],
         [619544.3125,      0.0000]],

        [[713316.9375,      0.0000],
         [573024.1875,      0.0000],
         [525350.8125,      0.0000],
         ...,
         [     0.0000, 246254.9219],
         [244780.0625,      0.0000],
         [242079.9219,      0.0000]],

        ...,

        [[228176.2188,      0.0000],
         [     0.0000, 221415.5312],
         [     0.0000, 211251.5938],
         ...,
         [113468.5859,      0.0000],
         [113321.2969,      0.0000],
         [102292.2500,      0.0000]],

        [[613291.8750,      0.0000],
         [     0.0000, 371828.5312],
         [     0.0000, 347166.1562],
         ...,
         [190899.6094,      0.0000],
         [     0.0000, 187081.8125],
         [     0.0000, 187021.5156]],

        [[     0.0000, 379487.7500],
         [348906.7188,      0.0000],
         [330012.9688,      0.0000],
         ...,
         [188336.3438,      0.0000],
         [186244.7812,      0.0000],
         [186050.3906,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2661387.0000,   124312.2344],
        [14312038.0000,        0.0000],
        [ 6462517.0000,  1022236.7500],
        [ 5469048.0000,        0.0000],
        [ 1965502.2500,   745027.5000],
        [ 4779990.5000,        0.0000],
        [ 7628384.0000,  2016066.0000],
        [ 9057876.0000,        0.0000],
        [ 9114175.0000,   446702.1562],
        [ 5985615.0000,        0.0000],
        [10618221.0000,        0.0000],
        [ 3850534.0000,    65405.2578],
        [ 5613819.0000,        0.0000],
        [16063944.0000,        0.0000],
        [15527835.0000,        0.0000],
        [12567198.0000,        0.0000],
        [12043059.0000,        0.0000],
        [13031687.0000,        0.0000],
        [ 8505741.0000,        0.0000],
        [ 8649984.0000,   387717.9375],
        [11741044.0000,        0.0000],
        [ 8714980.0000,        0.0000],
        [15877407.0000,        0.0000],
        [14351354.0000,        0.0000],
        [ 7222742.5000,        0.0000],
        [13482728.0000,        0.0000],
        [13251657.0000,        0.0000],
        [15488308.0000,        0.0000],
        [15712006.0000,        0.0000],
        [14201007.0000,        0.0000],
        [18314222.0000,        0.0000],
        [14402030.0000,        0.0000],
        [ 5202157.0000,        0.0000],
        [ 5632562.0000,  1369723.2500],
        [ 6806077.5000,  2274926.0000],
        [ 3899637.2500,  1965164.2500],
        [ 3898185.2500,  1528039.2500],
        [ 3168450.5000,   999102.2500],
        [ 2304003.0000,  1657905.5000],
        [13066978.0000,   645036.3125],
        [ 4057717.0000,   955630.4375],
        [ 6167422.0000,        0.0000],
        [ 5627110.5000,        0.0000],
        [ 4372635.0000,        0.0000],
        [ 3390741.2500,  1744554.3750],
        [  556453.1250,   686991.3750],
        [ 8473050.0000,   395495.0938],
        [ 1546784.1250,   621304.9375],
        [  700954.5000,   665422.1250],
        [ 6200641.0000,  2375502.5000],
        [ 2615286.0000,   287793.0938],
        [ 5826448.0000,  1414426.2500],
        [ 4651087.0000,  3042463.5000],
        [ 5775602.5000,   282615.0000],
        [10219092.0000,   546020.6250],
        [ 7255939.5000,   359685.6875],
        [ 6198487.0000,  2197570.2500],
        [ 4871082.0000,  2047813.3750],
        [ 3444855.0000,  2175307.7500],
        [ 1994124.8750,  1612052.5000],
        [ 6161306.0000,   889912.2500],
        [ 2146118.5000,   876105.0625],
        [ 3209071.2500,  2086665.0000],
        [ 3854210.5000,   879595.1875]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 241/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:16, 56.44s/it]  7%|▋         | 2/30 [00:57<11:16, 24.15s/it] 10%|█         | 3/30 [00:58<05:59, 13.33s/it] 13%|█▎        | 4/30 [00:59<03:39,  8.43s/it] 17%|█▋        | 5/30 [00:59<02:18,  5.55s/it] 20%|██        | 6/30 [01:00<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.99s/it] 30%|███       | 9/30 [01:01<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:06<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 3.146758445103963
Epoch 242/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:14, 56.38s/it]  7%|▋         | 2/30 [00:56<10:58, 23.51s/it] 10%|█         | 3/30 [00:58<06:01, 13.38s/it] 13%|█▎        | 4/30 [00:58<03:35,  8.27s/it] 17%|█▋        | 5/30 [00:59<02:19,  5.60s/it] 20%|██        | 6/30 [00:59<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:00<00:44,  2.01s/it] 30%|███       | 9/30 [01:01<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:02<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.62it/s] 50%|█████     | 15/30 [01:03<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 3.184908970197042
Epoch 243/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:06, 58.15s/it]  7%|▋         | 2/30 [00:59<11:27, 24.54s/it] 10%|█         | 3/30 [00:59<06:05, 13.54s/it] 13%|█▎        | 4/30 [01:00<03:37,  8.37s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.51s/it] 20%|██        | 6/30 [01:00<01:30,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.69s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 3.180946969985962
Epoch 244/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:58, 59.96s/it]  7%|▋         | 2/30 [01:00<11:38, 24.95s/it] 10%|█         | 3/30 [01:00<06:11, 13.76s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.50s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.1489185730616254
Epoch 245/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:48, 57.54s/it]  7%|▋         | 2/30 [00:57<11:10, 23.95s/it] 10%|█         | 3/30 [00:58<05:56, 13.22s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:01<02:29,  5.97s/it] 20%|██        | 6/30 [01:01<01:38,  4.09s/it] 23%|██▎       | 7/30 [01:02<01:06,  2.90s/it] 27%|██▋       | 8/30 [01:02<00:46,  2.12s/it] 30%|███       | 9/30 [01:03<00:33,  1.59s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.24s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.01it/s] 40%|████      | 12/30 [01:04<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.59it/s] 50%|█████     | 15/30 [01:05<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.178642209370931
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0529, -0.0673,  0.0872,  ..., -0.0576,  0.1115,  0.0632],
        [ 0.0166, -0.0445,  0.0943,  ..., -0.0225,  0.0938,  0.1077],
        [-0.0135, -0.0189,  0.0111,  ..., -0.0637,  0.0526,  0.1313],
        ...,
        [-0.0400, -0.0252,  0.0787,  ..., -0.0157,  0.0403,  0.0229],
        [-0.0720, -0.0901,  0.0471,  ..., -0.0207,  0.0869,  0.0148],
        [-0.0143, -0.0308,  0.0890,  ..., -0.0174,  0.0734,  0.0931]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8863, 0.8784, 0.8730,  ..., 0.7926, 0.7921, 0.7918],
        [0.9550, 0.9548, 0.9513,  ..., 0.9333, 0.9322, 0.9315],
        [0.9417, 0.9249, 0.9192,  ..., 0.8655, 0.8646, 0.8635],
        ...,
        [0.8602, 0.8601, 0.8558,  ..., 0.8096, 0.8089, 0.8018],
        [0.9315, 0.8962, 0.8895,  ..., 0.8463, 0.8449, 0.8449],
        [0.8961, 0.8900, 0.8846,  ..., 0.8447, 0.8442, 0.8435]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 1, 1,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 1, 1, 1],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[315158.0625, 281643.4062, 260901.9531,  ...,  82716.3438,
          82148.0547,  81791.0391],
        [841371.7500, 838976.0000, 797862.1875,  ..., 616795.3750,
         607772.7500, 601410.8125],
        [696188.5625, 547103.2500, 504303.6250,  ..., 234192.4219,
         231295.3906, 227556.6562],
        ...,
        [217235.3125, 217030.7188, 204054.7969,  ..., 105475.5703,
         104371.9766,  94243.1406],
        [601535.3125, 363251.8438, 330172.9062,  ..., 178150.2500,
         174600.5781, 174579.2656],
        [362883.4375, 332573.0938, 307776.9688,  ..., 174028.0469,
         172743.9219, 171081.3281]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[315158.0625,      0.0000],
         [281643.4062,      0.0000],
         [260901.9531,      0.0000],
         ...,
         [ 82716.3438,      0.0000],
         [ 82148.0547,      0.0000],
         [ 81791.0391,      0.0000]],

        [[841371.7500,      0.0000],
         [838976.0000,      0.0000],
         [797862.1875,      0.0000],
         ...,
         [616795.3750,      0.0000],
         [607772.7500,      0.0000],
         [601410.8125,      0.0000]],

        [[696188.5625,      0.0000],
         [547103.2500,      0.0000],
         [504303.6250,      0.0000],
         ...,
         [234192.4219,      0.0000],
         [231295.3906,      0.0000],
         [227556.6562,      0.0000]],

        ...,

        [[217235.3125,      0.0000],
         [     0.0000, 217030.7188],
         [     0.0000, 204054.7969],
         ...,
         [105475.5703,      0.0000],
         [104371.9766,      0.0000],
         [ 94243.1406,      0.0000]],

        [[601535.3125,      0.0000],
         [     0.0000, 363251.8438],
         [     0.0000, 330172.9062],
         ...,
         [     0.0000, 178150.2500],
         [     0.0000, 174600.5781],
         [     0.0000, 174579.2656]],

        [[     0.0000, 362883.4375],
         [332573.0938,      0.0000],
         [307776.9688,      0.0000],
         ...,
         [174028.0469,      0.0000],
         [172743.9219,      0.0000],
         [171081.3281,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2574826.2500,   120004.3125],
        [13964413.0000,        0.0000],
        [ 6133717.5000,   984294.7500],
        [ 5310881.0000,        0.0000],
        [ 1863538.7500,   728726.3125],
        [ 4473430.0000,        0.0000],
        [ 7212623.5000,  1934749.3750],
        [ 8635056.0000,        0.0000],
        [ 8747629.0000,   426983.0000],
        [ 5848981.0000,        0.0000],
        [10357154.0000,        0.0000],
        [ 3735519.5000,    61991.9336],
        [ 5460697.5000,        0.0000],
        [15760505.0000,        0.0000],
        [15304308.0000,        0.0000],
        [12375558.0000,        0.0000],
        [11741488.0000,        0.0000],
        [12796105.0000,        0.0000],
        [ 8207184.0000,        0.0000],
        [ 8480018.0000,   378205.1875],
        [11449468.0000,        0.0000],
        [ 8467745.0000,        0.0000],
        [15609828.0000,        0.0000],
        [14172130.0000,        0.0000],
        [ 6955998.0000,        0.0000],
        [13229100.0000,        0.0000],
        [12929526.0000,        0.0000],
        [15303014.0000,        0.0000],
        [15423034.0000,        0.0000],
        [13967160.0000,        0.0000],
        [18028164.0000,        0.0000],
        [14144788.0000,        0.0000],
        [ 5100493.0000,        0.0000],
        [ 5459651.0000,  1339048.7500],
        [ 6945260.0000,  1888677.0000],
        [ 3719732.0000,  1926914.3750],
        [ 3689845.0000,  1476269.5000],
        [ 3062352.7500,   955360.0625],
        [ 2217907.2500,  1602815.2500],
        [12687901.0000,   619318.6875],
        [ 3954729.0000,   916075.8750],
        [ 5988770.0000,        0.0000],
        [ 5478058.0000,        0.0000],
        [ 4261306.0000,        0.0000],
        [ 3229406.2500,  1686998.7500],
        [  541158.9375,   666998.6250],
        [ 8162953.0000,   384122.1875],
        [ 1464516.0000,   604287.1250],
        [  664405.1875,   633732.8750],
        [ 5852434.0000,  2261928.0000],
        [ 2487248.0000,   291393.8438],
        [ 5548836.0000,  1367368.8750],
        [ 4508253.0000,  2960719.0000],
        [ 5663334.0000,   274005.8125],
        [ 9958829.0000,   533865.6875],
        [ 6993579.0000,   347400.6562],
        [ 5969686.0000,  2135094.5000],
        [ 4755361.0000,  1994409.0000],
        [ 3321475.2500,  2090001.7500],
        [ 1921889.5000,  1558895.1250],
        [ 5964980.5000,   863220.0000],
        [ 2003760.7500,   850063.6250],
        [ 3034539.5000,  1967402.7500],
        [ 3570490.2500,   842491.9375]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 246/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:04<31:00, 64.16s/it]  7%|▋         | 2/30 [01:04<12:26, 26.68s/it] 10%|█         | 3/30 [01:05<06:36, 14.70s/it] 13%|█▎        | 4/30 [01:05<03:55,  9.07s/it] 17%|█▋        | 5/30 [01:05<02:28,  5.96s/it] 20%|██        | 6/30 [01:06<01:37,  4.08s/it] 23%|██▎       | 7/30 [01:06<01:06,  2.89s/it] 27%|██▋       | 8/30 [01:07<00:46,  2.11s/it] 30%|███       | 9/30 [01:07<00:33,  1.59s/it] 33%|███▎      | 10/30 [01:08<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:08<00:18,  1.01it/s] 40%|████      | 12/30 [01:08<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:09<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:09<00:10,  1.60it/s] 50%|█████     | 15/30 [01:10<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:10<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:11<00:06,  1.99it/s] 60%|██████    | 18/30 [01:11<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:12<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:12<00:04,  2.17it/s] 70%|███████   | 21/30 [01:12<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:13<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:13<00:03,  2.24it/s] 80%|████████  | 24/30 [01:14<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:14<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:15<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:15<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:16<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:16<00:00,  2.27it/s]100%|██████████| 30/30 [01:16<00:00,  2.27it/s]100%|██████████| 30/30 [01:17<00:00,  2.57s/it]
Epoch loss is 3.138700850804647
Epoch 247/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:52, 59.75s/it]  7%|▋         | 2/30 [01:01<11:53, 25.50s/it] 10%|█         | 3/30 [01:01<06:19, 14.06s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.71s/it] 20%|██        | 6/30 [01:03<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 3.1165984710057577
Epoch 248/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:18, 60.64s/it]  7%|▋         | 2/30 [01:01<11:46, 25.23s/it] 10%|█         | 3/30 [01:01<06:15, 13.91s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.59s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.65s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 3.1292563597361247
Epoch 249/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:02, 60.09s/it]  7%|▋         | 2/30 [01:00<11:40, 25.00s/it] 10%|█         | 3/30 [01:00<06:12, 13.79s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.71s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.73s/it] 20%|██        | 6/30 [01:02<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.14it/s] 70%|███████   | 21/30 [01:09<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 3.1853084564208984
Epoch 250/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:01, 55.91s/it]  7%|▋         | 2/30 [00:56<10:53, 23.34s/it] 10%|█         | 3/30 [01:00<06:35, 14.66s/it] 13%|█▎        | 4/30 [01:01<03:55,  9.04s/it] 17%|█▋        | 5/30 [01:01<02:28,  5.94s/it] 20%|██        | 6/30 [01:02<01:37,  4.07s/it] 23%|██▎       | 7/30 [01:02<01:06,  2.88s/it] 27%|██▋       | 8/30 [01:02<00:46,  2.11s/it] 30%|███       | 9/30 [01:03<00:33,  1.59s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.01it/s] 40%|████      | 12/30 [01:04<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.59it/s] 50%|█████     | 15/30 [01:06<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.97it/s] 60%|██████    | 18/30 [01:07<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.10it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.0881782452265423
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0536, -0.0689,  0.0866,  ..., -0.0576,  0.1115,  0.0633],
        [ 0.0173, -0.0441,  0.0933,  ..., -0.0219,  0.0943,  0.1072],
        [-0.0133, -0.0184,  0.0111,  ..., -0.0632,  0.0529,  0.1313],
        ...,
        [-0.0386, -0.0234,  0.0783,  ..., -0.0181,  0.0394,  0.0224],
        [-0.0719, -0.0906,  0.0454,  ..., -0.0222,  0.0871,  0.0142],
        [-0.0154, -0.0297,  0.0868,  ..., -0.0173,  0.0742,  0.0936]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8848, 0.8775, 0.8703,  ..., 0.7909, 0.7894, 0.7891],
        [0.9532, 0.9531, 0.9505,  ..., 0.9309, 0.9301, 0.9299],
        [0.9401, 0.9215, 0.9162,  ..., 0.8615, 0.8609, 0.8591],
        ...,
        [0.8586, 0.8573, 0.8542,  ..., 0.8048, 0.8040, 0.7968],
        [0.9303, 0.8950, 0.8865,  ..., 0.8435, 0.8405, 0.8387],
        [0.8934, 0.8868, 0.8797,  ..., 0.8397, 0.8383, 0.8382]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [1, 0, 1,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 1, 1, 1],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[308691.7812, 277920.0000, 250847.1406,  ...,  80654.9531,
          78963.4297,  78680.8594],
        [820517.8750, 819411.4375, 788951.9375,  ..., 596253.3125,
         589177.5625, 588251.1250],
        [680266.9375, 521690.6875, 483363.3125,  ..., 221389.3594,
         219280.9531, 213959.7812],
        ...,
        [212384.4375, 208241.8125, 199403.9375,  ...,  98400.6094,
          97262.2891,  87847.2031],
        [591255.6250, 357253.0000, 316230.1562,  ..., 171139.9062,
         163969.0469, 159868.6875],
        [348845.1562, 317821.6562, 286810.1875,  ..., 161981.3438,
         158934.2500, 158571.0469]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[308691.7812,      0.0000],
         [277920.0000,      0.0000],
         [250847.1406,      0.0000],
         ...,
         [ 80654.9531,      0.0000],
         [ 78963.4297,      0.0000],
         [ 78680.8594,      0.0000]],

        [[820517.8750,      0.0000],
         [819411.4375,      0.0000],
         [788951.9375,      0.0000],
         ...,
         [596253.3125,      0.0000],
         [589177.5625,      0.0000],
         [588251.1250,      0.0000]],

        [[680266.9375,      0.0000],
         [521690.6875,      0.0000],
         [483363.3125,      0.0000],
         ...,
         [221389.3594,      0.0000],
         [219280.9531,      0.0000],
         [213959.7812,      0.0000]],

        ...,

        [[     0.0000, 212384.4375],
         [208241.8125,      0.0000],
         [     0.0000, 199403.9375],
         ...,
         [ 98400.6094,      0.0000],
         [ 97262.2891,      0.0000],
         [ 87847.2031,      0.0000]],

        [[591255.6250,      0.0000],
         [     0.0000, 357253.0000],
         [     0.0000, 316230.1562],
         ...,
         [     0.0000, 171139.9062],
         [     0.0000, 163969.0469],
         [     0.0000, 159868.6875]],

        [[     0.0000, 348845.1562],
         [317821.6562,      0.0000],
         [286810.1875,      0.0000],
         ...,
         [161981.3438,      0.0000],
         [158934.2500,      0.0000],
         [158571.0469,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2505552.5000,   116100.2734],
        [13647052.0000,        0.0000],
        [ 5819975.0000,   947361.2500],
        [ 5174748.5000,        0.0000],
        [ 1772675.2500,   715205.8750],
        [ 4181704.2500,        0.0000],
        [ 6811100.0000,  1855290.5000],
        [ 8214806.0000,        0.0000],
        [ 8387657.0000,   407236.5938],
        [ 5718639.0000,        0.0000],
        [10104140.0000,        0.0000],
        [ 3624654.0000,    58895.8125],
        [ 5314877.0000,        0.0000],
        [15487106.0000,        0.0000],
        [15098152.0000,        0.0000],
        [12199364.0000,        0.0000],
        [11439644.0000,        0.0000],
        [12584467.0000,        0.0000],
        [ 7936048.0000,        0.0000],
        [ 8314280.0000,   370481.7188],
        [11163865.0000,        0.0000],
        [ 8244734.0000,        0.0000],
        [15355217.0000,        0.0000],
        [14017407.0000,        0.0000],
        [ 6717477.0000,        0.0000],
        [12999322.0000,        0.0000],
        [12627278.0000,        0.0000],
        [15120453.0000,        0.0000],
        [15153749.0000,        0.0000],
        [13768924.0000,        0.0000],
        [17757914.0000,        0.0000],
        [13910852.0000,        0.0000],
        [ 4989180.5000,        0.0000],
        [ 5281184.5000,  1311623.7500],
        [ 6753478.0000,  1854281.1250],
        [ 3361260.5000,  2094015.2500],
        [ 3649443.2500,  1262400.7500],
        [ 2964937.0000,   917355.7500],
        [ 2140433.0000,  1555192.3750],
        [12350453.0000,   595643.5000],
        [ 3852218.5000,   876119.1875],
        [ 5856708.5000,        0.0000],
        [ 5352911.0000,        0.0000],
        [ 4180008.0000,        0.0000],
        [ 3094026.0000,  1639824.2500],
        [  529558.1875,   649140.7500],
        [ 7878018.0000,   373035.0625],
        [ 1386802.2500,   588378.6250],
        [  631207.5000,   605564.1250],
        [ 5781771.0000,  1896642.8750],
        [ 2368671.5000,   293708.3750],
        [ 5297683.0000,  1326905.6250],
        [ 4378270.0000,  2885616.5000],
        [ 5552256.0000,   266787.9062],
        [ 9740228.0000,   524421.3125],
        [ 6756450.5000,   336844.9062],
        [ 5760809.5000,  2075479.5000],
        [ 4649077.0000,  1945298.7500],
        [ 3216203.7500,  2015611.5000],
        [ 1859683.1250,  1506780.7500],
        [ 5774677.5000,   838176.7500],
        [ 1890391.2500,   829382.9375],
        [ 2883262.2500,  1868226.7500],
        [ 3320216.0000,   809502.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 251/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:47, 55.45s/it]  7%|▋         | 2/30 [00:56<11:01, 23.62s/it] 10%|█         | 3/30 [00:57<05:52, 13.04s/it] 13%|█▎        | 4/30 [00:57<03:29,  8.07s/it] 17%|█▋        | 5/30 [01:01<02:41,  6.48s/it] 20%|██        | 6/30 [01:01<01:46,  4.43s/it] 23%|██▎       | 7/30 [01:02<01:11,  3.12s/it] 27%|██▋       | 8/30 [01:02<00:49,  2.27s/it] 30%|███       | 9/30 [01:03<00:35,  1.70s/it] 33%|███▎      | 10/30 [01:03<00:26,  1.31s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.04s/it] 40%|████      | 12/30 [01:04<00:15,  1.16it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.36it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.54it/s] 50%|█████     | 15/30 [01:05<00:08,  1.71it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.85it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.96it/s] 60%|██████    | 18/30 [01:07<00:05,  2.04it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.144926412900289
Epoch 252/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:47, 57.51s/it]  7%|▋         | 2/30 [00:59<11:32, 24.73s/it] 10%|█         | 3/30 [00:59<06:08, 13.64s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.66s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.70s/it] 20%|██        | 6/30 [01:01<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 3.117337950070699
Epoch 253/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:16, 60.57s/it]  7%|▋         | 2/30 [01:01<11:46, 25.23s/it] 10%|█         | 3/30 [01:01<06:15, 13.91s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.59s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.65s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 3.1086045583089192
Epoch 254/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:00, 60.00s/it]  7%|▋         | 2/30 [01:00<11:46, 25.25s/it] 10%|█         | 3/30 [01:01<06:15, 13.92s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.60s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.66s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 3.048669958114624
Epoch 255/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:47, 57.50s/it]  7%|▋         | 2/30 [00:58<11:21, 24.33s/it] 10%|█         | 3/30 [01:01<06:28, 14.40s/it] 13%|█▎        | 4/30 [01:01<03:51,  8.89s/it] 17%|█▋        | 5/30 [01:02<02:26,  5.84s/it] 20%|██        | 6/30 [01:02<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.08s/it] 30%|███       | 9/30 [01:03<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.0680213371912637
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0543, -0.0701,  0.0861,  ..., -0.0576,  0.1109,  0.0632],
        [ 0.0180, -0.0436,  0.0926,  ..., -0.0216,  0.0945,  0.1065],
        [-0.0129, -0.0181,  0.0110,  ..., -0.0624,  0.0530,  0.1312],
        ...,
        [-0.0368, -0.0222,  0.0781,  ..., -0.0205,  0.0385,  0.0216],
        [-0.0720, -0.0912,  0.0441,  ..., -0.0235,  0.0872,  0.0137],
        [-0.0163, -0.0287,  0.0851,  ..., -0.0173,  0.0751,  0.0941]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8833, 0.8768, 0.8678,  ..., 0.7883, 0.7875, 0.7871],
        [0.9515, 0.9515, 0.9497,  ..., 0.9286, 0.9284, 0.9279],
        [0.9385, 0.9184, 0.9134,  ..., 0.8579, 0.8573, 0.8551],
        ...,
        [0.8573, 0.8540, 0.8523,  ..., 0.7998, 0.7985, 0.7915],
        [0.9289, 0.8938, 0.8831,  ..., 0.8388, 0.8357, 0.8330],
        [0.8906, 0.8837, 0.8749,  ..., 0.8341, 0.8329, 0.8329]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [1, 0, 1,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 1, 1, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[301987.8750, 275470.6875, 241944.8906,  ...,  77757.4531,
          76891.7188,  76398.1172],
        [800103.8750, 799990.9375, 780561.6875,  ..., 576912.4375,
         575455.1250, 571449.7500],
        [664984.7500, 498856.7500, 464533.0938,  ..., 210328.7031,
         208474.6875, 202048.0625],
        ...,
        [208366.7500, 198681.6562, 194112.8750,  ...,  91683.1641,
          90024.1328,  81393.6562],
        [579688.1250, 351110.7500, 301081.4688,  ..., 159982.0156,
         153027.5938, 147217.2812],
        [335094.5312, 303637.4062, 268008.9062,  ..., 149671.0156,
         147132.7812, 147100.0938]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[301987.8750,      0.0000],
         [275470.6875,      0.0000],
         [241944.8906,      0.0000],
         ...,
         [ 77757.4531,      0.0000],
         [ 76891.7188,      0.0000],
         [ 76398.1172,      0.0000]],

        [[800103.8750,      0.0000],
         [799990.9375,      0.0000],
         [780561.6875,      0.0000],
         ...,
         [576912.4375,      0.0000],
         [575455.1250,      0.0000],
         [571449.7500,      0.0000]],

        [[664984.7500,      0.0000],
         [498856.7500,      0.0000],
         [464533.0938,      0.0000],
         ...,
         [210328.7031,      0.0000],
         [208474.6875,      0.0000],
         [202048.0625,      0.0000]],

        ...,

        [[     0.0000, 208366.7500],
         [198681.6562,      0.0000],
         [     0.0000, 194112.8750],
         ...,
         [ 91683.1641,      0.0000],
         [ 90024.1328,      0.0000],
         [ 81393.6562,      0.0000]],

        [[579688.1250,      0.0000],
         [     0.0000, 351110.7500],
         [     0.0000, 301081.4688],
         ...,
         [     0.0000, 159982.0156],
         [     0.0000, 153027.5938],
         [147217.2812,      0.0000]],

        [[     0.0000, 335094.5312],
         [303637.4062,      0.0000],
         [268008.9062,      0.0000],
         ...,
         [149671.0156,      0.0000],
         [147132.7812,      0.0000],
         [147100.0938,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2444412.7500,   112390.5312],
        [13342533.0000,        0.0000],
        [ 5539752.0000,   915306.7500],
        [ 5043756.0000,        0.0000],
        [ 1687517.3750,   700761.4375],
        [ 3765989.2500,   141770.9688],
        [ 6438904.5000,  1779830.2500],
        [ 7844274.0000,        0.0000],
        [ 8041665.5000,   388424.8438],
        [ 5591265.5000,        0.0000],
        [ 9869409.0000,        0.0000],
        [ 3574139.2500,        0.0000],
        [ 5175496.5000,        0.0000],
        [15216611.0000,        0.0000],
        [14887199.0000,        0.0000],
        [12037465.0000,        0.0000],
        [11166740.0000,        0.0000],
        [12381130.0000,        0.0000],
        [ 7675882.0000,        0.0000],
        [ 8149698.5000,   363327.3750],
        [10888398.0000,        0.0000],
        [ 8032633.5000,        0.0000],
        [15108337.0000,        0.0000],
        [13872162.0000,        0.0000],
        [ 6485382.0000,        0.0000],
        [12775656.0000,        0.0000],
        [12352268.0000,        0.0000],
        [14942084.0000,        0.0000],
        [14889949.0000,        0.0000],
        [13569284.0000,        0.0000],
        [17490984.0000,        0.0000],
        [13702938.0000,        0.0000],
        [ 4881900.0000,        0.0000],
        [ 5112601.5000,  1283501.5000],
        [ 6576733.0000,  1823814.2500],
        [ 3218092.5000,  2053042.2500],
        [ 3467824.0000,  1229127.3750],
        [ 2872884.7500,   883831.8750],
        [ 2070551.0000,  1513129.0000],
        [12034211.0000,   573536.5000],
        [ 3763427.7500,   836734.1875],
        [ 5713255.0000,        0.0000],
        [ 5240841.0000,        0.0000],
        [ 4105750.7500,        0.0000],
        [ 2800506.0000,  1764258.7500],
        [  519293.7812,   633066.8125],
        [ 7594104.0000,   361109.6875],
        [ 1318222.1250,   575722.3750],
        [  635940.6875,   545214.8750],
        [ 5470157.0000,  1811769.2500],
        [ 2260484.5000,   295614.8125],
        [ 5068859.0000,  1289131.7500],
        [ 4252838.0000,  2813722.2500],
        [ 5454547.0000,   259976.0156],
        [ 9529651.0000,   514220.1875],
        [ 6547130.5000,   327187.2500],
        [ 5559577.5000,  2018173.2500],
        [ 4555994.0000,  1899330.2500],
        [ 3118908.7500,  1944090.6250],
        [ 1801685.6250,  1454561.6250],
        [ 5609340.5000,   812967.5000],
        [ 1773541.2500,   810565.5625],
        [ 2879737.7500,  1623193.3750],
        [ 3098374.7500,   778405.1875]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 256/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:23, 60.82s/it]  7%|▋         | 2/30 [01:01<11:48, 25.30s/it] 10%|█         | 3/30 [01:01<06:16, 13.95s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.67s/it] 20%|██        | 6/30 [01:03<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 3.089391342798869
Epoch 257/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:54, 57.73s/it]  7%|▋         | 2/30 [00:58<11:12, 24.03s/it] 10%|█         | 3/30 [00:58<05:58, 13.26s/it] 13%|█▎        | 4/30 [00:59<03:33,  8.20s/it] 17%|█▋        | 5/30 [00:59<02:15,  5.40s/it] 20%|██        | 6/30 [00:59<01:29,  3.72s/it] 23%|██▎       | 7/30 [01:00<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.02s/it] 30%|███       | 9/30 [01:01<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:02<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 3.0647536834081013
Epoch 258/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:36, 61.24s/it]  7%|▋         | 2/30 [01:01<11:53, 25.48s/it] 10%|█         | 3/30 [01:02<06:19, 14.05s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:03<02:22,  5.71s/it] 20%|██        | 6/30 [01:03<01:33,  3.92s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 3.0424810647964478
Epoch 259/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:37, 61.31s/it]  7%|▋         | 2/30 [01:01<11:54, 25.50s/it] 10%|█         | 3/30 [01:02<06:19, 14.06s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:03<02:22,  5.71s/it] 20%|██        | 6/30 [01:03<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 3.025262435277303
Epoch 260/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:49, 59.62s/it]  7%|▋         | 2/30 [01:00<11:34, 24.81s/it] 10%|█         | 3/30 [01:00<06:09, 13.68s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.46s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.094143541653951
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0546, -0.0716,  0.0859,  ..., -0.0574,  0.1104,  0.0630],
        [ 0.0185, -0.0427,  0.0921,  ..., -0.0212,  0.0949,  0.1060],
        [-0.0127, -0.0181,  0.0109,  ..., -0.0616,  0.0532,  0.1310],
        ...,
        [-0.0353, -0.0209,  0.0778,  ..., -0.0227,  0.0376,  0.0211],
        [-0.0720, -0.0918,  0.0427,  ..., -0.0244,  0.0874,  0.0132],
        [-0.0173, -0.0278,  0.0834,  ..., -0.0171,  0.0762,  0.0943]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8818, 0.8761, 0.8655,  ..., 0.7857, 0.7854, 0.7846],
        [0.9498, 0.9497, 0.9489,  ..., 0.9270, 0.9265, 0.9260],
        [0.9369, 0.9150, 0.9106,  ..., 0.8542, 0.8536, 0.8507],
        ...,
        [0.8555, 0.8514, 0.8510,  ..., 0.7953, 0.7939, 0.7870],
        [0.9277, 0.8927, 0.8796,  ..., 0.8334, 0.8308, 0.8296],
        [0.8879, 0.8806, 0.8702,  ..., 0.8293, 0.8289, 0.8286]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [1, 0, 1,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 1, 1, 0],
        [1, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[295773.7500, 272656.8438, 234409.3594,  ...,  74915.1641,
          74649.3594,  73739.4297],
        [781427.9375, 780495.4375, 771662.8750,  ..., 564188.6875,
         559751.6875, 556140.9375],
        [649833.8125, 474988.9688, 445957.2500,  ..., 199428.6406,
         197699.1875, 189690.7812],
        ...,
        [203231.7344, 191505.7188, 190322.8281,  ...,  85984.1641,
          84293.1797,  76291.4609],
        [569504.2500, 345463.6562, 286369.0938,  ..., 148140.0469,
         142807.2812, 140201.7500],
        [322545.0625, 290521.6875, 250612.3438,  ..., 139645.0312,
         138840.0469, 138291.7812]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[295773.7500,      0.0000],
         [272656.8438,      0.0000],
         [234409.3594,      0.0000],
         ...,
         [ 74915.1641,      0.0000],
         [ 74649.3594,      0.0000],
         [ 73739.4297,      0.0000]],

        [[781427.9375,      0.0000],
         [780495.4375,      0.0000],
         [771662.8750,      0.0000],
         ...,
         [564188.6875,      0.0000],
         [559751.6875,      0.0000],
         [556140.9375,      0.0000]],

        [[649833.8125,      0.0000],
         [474988.9688,      0.0000],
         [445957.2500,      0.0000],
         ...,
         [199428.6406,      0.0000],
         [197699.1875,      0.0000],
         [189690.7812,      0.0000]],

        ...,

        [[     0.0000, 203231.7344],
         [191505.7188,      0.0000],
         [     0.0000, 190322.8281],
         ...,
         [ 85984.1641,      0.0000],
         [ 84293.1797,      0.0000],
         [ 76291.4609,      0.0000]],

        [[569504.2500,      0.0000],
         [     0.0000, 345463.6562],
         [     0.0000, 286369.0938],
         ...,
         [     0.0000, 148140.0469],
         [     0.0000, 142807.2812],
         [140201.7500,      0.0000]],

        [[     0.0000, 322545.0625],
         [290521.6875,      0.0000],
         [250612.3438,      0.0000],
         ...,
         [139645.0312,      0.0000],
         [138840.0469,      0.0000],
         [138291.7812,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2387004.7500,   108582.0703],
        [13044310.0000,        0.0000],
        [ 5262923.5000,   881016.5000],
        [ 4919617.5000,        0.0000],
        [ 1612621.0000,   692548.1250],
        [ 3519023.5000,   136471.9688],
        [ 6098281.5000,  1709797.8750],
        [ 7484168.0000,        0.0000],
        [ 7693069.5000,   370962.5312],
        [ 5471865.5000,        0.0000],
        [ 9651604.0000,        0.0000],
        [ 3457944.5000,        0.0000],
        [ 5033179.5000,        0.0000],
        [14949281.0000,        0.0000],
        [14683370.0000,        0.0000],
        [11876058.0000,        0.0000],
        [10889616.0000,        0.0000],
        [12158764.0000,        0.0000],
        [ 7418535.5000,        0.0000],
        [ 7988505.0000,   356964.2188],
        [10608407.0000,        0.0000],
        [ 7805538.5000,        0.0000],
        [14866677.0000,        0.0000],
        [13736940.0000,        0.0000],
        [ 6243030.0000,        0.0000],
        [12571918.0000,        0.0000],
        [12097593.0000,        0.0000],
        [14770419.0000,        0.0000],
        [14631522.0000,        0.0000],
        [13369331.0000,        0.0000],
        [17215786.0000,        0.0000],
        [13490323.0000,        0.0000],
        [ 4776493.5000,        0.0000],
        [ 4949515.0000,  1254943.7500],
        [ 6404298.5000,  1790388.1250],
        [ 3076354.7500,  2011323.0000],
        [ 3307013.7500,  1198403.0000],
        [ 2775611.0000,   850925.3750],
        [ 1999553.5000,  1467493.0000],
        [11699476.0000,   551539.9375],
        [ 3669602.0000,   798534.0000],
        [ 5578758.0000,        0.0000],
        [ 5135632.0000,        0.0000],
        [ 4023561.0000,        0.0000],
        [ 2692377.0000,  1724115.2500],
        [  508598.8125,   615485.6250],
        [ 7336004.0000,   351372.7188],
        [ 1258577.2500,   563977.2500],
        [  603911.2500,   520363.2500],
        [ 5179883.5000,  1731891.1250],
        [ 2164784.5000,   298275.6875],
        [ 4849776.5000,  1253514.8750],
        [ 4130980.5000,  2744234.2500],
        [ 5350647.5000,   254348.5156],
        [ 9327739.0000,   503731.1562],
        [ 6341864.0000,   317800.1562],
        [ 5367638.0000,  1966379.5000],
        [ 4474725.0000,  1857541.1250],
        [ 3023233.2500,  1871640.2500],
        [ 1745358.7500,  1406111.0000],
        [ 5443699.0000,   788549.8750],
        [ 1678770.3750,   790459.6250],
        [ 2736809.2500,  1545406.0000],
        [ 2901651.0000,   749942.0625]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 261/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:06, 56.09s/it]  7%|▋         | 2/30 [01:01<12:18, 26.37s/it] 10%|█         | 3/30 [01:02<06:32, 14.53s/it] 13%|█▎        | 4/30 [01:02<03:53,  8.97s/it] 17%|█▋        | 5/30 [01:02<02:27,  5.89s/it] 20%|██        | 6/30 [01:03<01:36,  4.04s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.86s/it] 27%|██▋       | 8/30 [01:04<00:46,  2.09s/it] 30%|███       | 9/30 [01:04<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.01it/s] 40%|████      | 12/30 [01:06<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:10,  1.60it/s] 50%|█████     | 15/30 [01:07<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 3.011159610748291
Epoch 262/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:31, 61.09s/it]  7%|▋         | 2/30 [01:01<11:51, 25.41s/it] 10%|█         | 3/30 [01:01<06:18, 14.01s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.65s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.69s/it] 20%|██        | 6/30 [01:03<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 3.009325313568115
Epoch 263/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:24, 56.69s/it]  7%|▋         | 2/30 [01:00<11:59, 25.70s/it] 10%|█         | 3/30 [01:01<06:22, 14.17s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.75s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.75s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 3.031902519861857
Epoch 264/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:33, 57.01s/it]  7%|▋         | 2/30 [00:58<11:23, 24.40s/it] 10%|█         | 3/30 [00:59<06:14, 13.86s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.77s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.76s/it] 20%|██        | 6/30 [01:01<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.0433737516403196
Epoch 265/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:08, 56.14s/it]  7%|▋         | 2/30 [00:58<11:19, 24.26s/it] 10%|█         | 3/30 [00:59<06:14, 13.89s/it] 13%|█▎        | 4/30 [01:00<03:43,  8.58s/it] 17%|█▋        | 5/30 [01:00<02:21,  5.65s/it] 20%|██        | 6/30 [01:00<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.02s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.9991531213124594
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0550, -0.0730,  0.0855,  ..., -0.0573,  0.1102,  0.0630],
        [ 0.0191, -0.0414,  0.0912,  ..., -0.0208,  0.0954,  0.1058],
        [-0.0123, -0.0178,  0.0106,  ..., -0.0609,  0.0536,  0.1307],
        ...,
        [-0.0337, -0.0193,  0.0775,  ..., -0.0248,  0.0366,  0.0208],
        [-0.0718, -0.0926,  0.0412,  ..., -0.0255,  0.0876,  0.0131],
        [-0.0181, -0.0267,  0.0814,  ..., -0.0170,  0.0771,  0.0949]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8803, 0.8749, 0.8632,  ..., 0.7836, 0.7835, 0.7835],
        [0.9482, 0.9481, 0.9480,  ..., 0.9255, 0.9255, 0.9240],
        [0.9353, 0.9116, 0.9078,  ..., 0.8503, 0.8497, 0.8466],
        ...,
        [0.8534, 0.8501, 0.8489,  ..., 0.7915, 0.7897, 0.7842],
        [0.9265, 0.8918, 0.8763,  ..., 0.8283, 0.8266, 0.8262],
        [0.8854, 0.8775, 0.8666,  ..., 0.8254, 0.8249, 0.8248]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 1, 1, 0],
        [1, 0, 1,  ..., 0, 0, 1]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [0., 1.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[289620.3750, 268056.7188, 226754.9219,  ...,  72745.0703,
          72608.8750,  72565.2656],
        [763926.9375, 762260.4375, 761430.7500,  ..., 552273.6250,
         551763.0000, 540589.5625],
        [634924.5000, 452571.1875, 428764.9375,  ..., 188471.1094,
         186960.1719, 178855.7031],
        ...,
        [197212.6094, 188004.0000, 184895.5469,  ...,  81414.9297,
          79308.3203,  73388.9297],
        [560320.0000, 340881.1875, 273291.7812,  ..., 137638.9062,
         134404.8594, 133555.2969],
        [311112.0000, 278045.6562, 237850.2188,  ..., 132044.7812,
         131127.7031, 131001.8438]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[289620.3750,      0.0000],
         [268056.7188,      0.0000],
         [226754.9219,      0.0000],
         ...,
         [ 72745.0703,      0.0000],
         [ 72608.8750,      0.0000],
         [ 72565.2656,      0.0000]],

        [[763926.9375,      0.0000],
         [762260.4375,      0.0000],
         [761430.7500,      0.0000],
         ...,
         [552273.6250,      0.0000],
         [551763.0000,      0.0000],
         [540589.5625,      0.0000]],

        [[634924.5000,      0.0000],
         [452571.1875,      0.0000],
         [428764.9375,      0.0000],
         ...,
         [188471.1094,      0.0000],
         [186960.1719,      0.0000],
         [178855.7031,      0.0000]],

        ...,

        [[     0.0000, 197212.6094],
         [     0.0000, 188004.0000],
         [184895.5469,      0.0000],
         ...,
         [ 81414.9297,      0.0000],
         [ 79308.3203,      0.0000],
         [ 73388.9297,      0.0000]],

        [[560320.0000,      0.0000],
         [     0.0000, 340881.1875],
         [     0.0000, 273291.7812],
         ...,
         [     0.0000, 137638.9062],
         [     0.0000, 134404.8594],
         [133555.2969,      0.0000]],

        [[     0.0000, 311112.0000],
         [278045.6562,      0.0000],
         [     0.0000, 237850.2188],
         ...,
         [132044.7812,      0.0000],
         [131127.7031,      0.0000],
         [     0.0000, 131001.8438]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2331102.7500,   105325.0938],
        [12764512.0000,        0.0000],
        [ 5006681.0000,   849884.0000],
        [ 4815388.5000,        0.0000],
        [ 1485851.2500,   744539.5000],
        [ 3186406.0000,   252943.0625],
        [ 5574955.5000,  1866225.0000],
        [ 7125591.0000,        0.0000],
        [ 7374640.0000,   354335.3125],
        [ 5360849.5000,        0.0000],
        [ 9449919.0000,        0.0000],
        [ 3349415.0000,        0.0000],
        [ 4902636.0000,        0.0000],
        [14673651.0000,        0.0000],
        [14478966.0000,        0.0000],
        [11706121.0000,        0.0000],
        [10629624.0000,        0.0000],
        [11947047.0000,        0.0000],
        [ 7167939.5000,        0.0000],
        [ 7833976.5000,   350863.4062],
        [10336376.0000,        0.0000],
        [ 7587406.0000,        0.0000],
        [14628200.0000,        0.0000],
        [13601109.0000,        0.0000],
        [ 6031033.5000,        0.0000],
        [12390238.0000,        0.0000],
        [11854349.0000,        0.0000],
        [14619504.0000,        0.0000],
        [14371342.0000,        0.0000],
        [13174221.0000,        0.0000],
        [16947106.0000,        0.0000],
        [13269399.0000,        0.0000],
        [ 4674642.0000,        0.0000],
        [ 4800828.5000,  1230829.6250],
        [ 6241047.5000,  1757256.6250],
        [ 2942730.2500,  1971927.5000],
        [ 3166419.0000,  1171516.5000],
        [ 2563166.5000,   939667.2500],
        [ 1932817.6250,  1427908.3750],
        [11384118.0000,   529047.2500],
        [ 3579478.0000,   763193.0625],
        [ 5460939.0000,        0.0000],
        [ 5035375.5000,        0.0000],
        [ 3952178.7500,        0.0000],
        [ 2592645.7500,  1679336.8750],
        [  524789.3750,   569833.2500],
        [ 7070990.0000,   341295.9375],
        [ 1202481.7500,   553272.8125],
        [  609665.6875,   470057.4375],
        [ 4698663.0000,  1881032.2500],
        [ 2010646.0000,   372829.3750],
        [ 4634235.0000,  1219706.6250],
        [ 4010511.0000,  2673537.0000],
        [ 5248424.0000,   248403.2344],
        [ 9124019.0000,   494001.7500],
        [ 6142786.5000,   310149.7812],
        [ 5175220.0000,  1911049.1250],
        [ 4605876.0000,  1593775.0000],
        [ 2929459.5000,  1802787.2500],
        [ 1691277.3750,  1360588.7500],
        [ 5295610.0000,   764598.3750],
        [ 1594209.7500,   769536.3750],
        [ 2612752.7500,  1477916.3750],
        [ 2594676.2500,   854274.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 266/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:09, 58.25s/it]  7%|▋         | 2/30 [00:59<11:39, 24.99s/it] 10%|█         | 3/30 [01:00<06:14, 13.88s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.64s/it] 20%|██        | 6/30 [01:01<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.0090126832326254
Epoch 267/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:05, 60.18s/it]  7%|▋         | 2/30 [01:01<11:54, 25.51s/it] 10%|█         | 3/30 [01:01<06:19, 14.06s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.71s/it] 20%|██        | 6/30 [01:03<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.47s/it]
Epoch loss is 3.047213308016459
Epoch 268/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:57, 59.90s/it]  7%|▋         | 2/30 [01:00<11:37, 24.93s/it] 10%|█         | 3/30 [01:00<06:11, 13.74s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.49s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 3.035046275456746
Epoch 269/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:25, 60.87s/it]  7%|▋         | 2/30 [01:01<11:49, 25.32s/it] 10%|█         | 3/30 [01:01<06:16, 13.96s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.67s/it] 20%|██        | 6/30 [01:03<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 3.0031480232874554
Epoch 270/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:18, 58.58s/it]  7%|▋         | 2/30 [01:00<11:46, 25.24s/it] 10%|█         | 3/30 [01:00<06:15, 13.91s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.59s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.65s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.17it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.43s/it]
Epoch loss is 2.9386245807011924
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0553, -0.0745,  0.0852,  ..., -0.0571,  0.1099,  0.0630],
        [ 0.0199, -0.0402,  0.0906,  ..., -0.0203,  0.0958,  0.1053],
        [-0.0116, -0.0175,  0.0104,  ..., -0.0602,  0.0541,  0.1304],
        ...,
        [-0.0323, -0.0179,  0.0773,  ..., -0.0267,  0.0359,  0.0203],
        [-0.0715, -0.0936,  0.0399,  ..., -0.0265,  0.0878,  0.0129],
        [-0.0187, -0.0255,  0.0796,  ..., -0.0170,  0.0782,  0.0954]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8786, 0.8736, 0.8605,  ..., 0.7828, 0.7812, 0.7812],
        [0.9473, 0.9467, 0.9463,  ..., 0.9247, 0.9239, 0.9220],
        [0.9334, 0.9084, 0.9052,  ..., 0.8464, 0.8459, 0.8435],
        ...,
        [0.8516, 0.8490, 0.8459,  ..., 0.7874, 0.7848, 0.7838],
        [0.9254, 0.8908, 0.8729,  ..., 0.8232, 0.8227, 0.8221],
        [0.8831, 0.8744, 0.8638,  ..., 0.8215, 0.8207, 0.8206]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 1, 0, 1],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[282622.2500, 262971.3125, 218141.0625,  ...,  71877.4062,
          70273.8047,  70263.4141],
        [753735.6250, 747293.8750, 742757.9375,  ..., 545446.5625,
         539755.5625, 525341.8125],
        [618195.6875, 432366.9062, 413070.5312,  ..., 178239.6406,
         177106.4219, 170981.8438],
        ...,
        [192113.7812, 185092.6094, 177189.7031,  ...,  76716.2266,
          73920.3828,  72881.2422],
        [551139.7500, 336282.5625, 260475.5781,  ..., 128009.7812,
         127152.8516, 126005.4688],
        [301221.0312, 266029.5000, 228806.1875,  ..., 125000.2031,
         123534.0156, 123436.5000]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[282622.2500,      0.0000],
         [262971.3125,      0.0000],
         [218141.0625,      0.0000],
         ...,
         [ 71877.4062,      0.0000],
         [ 70273.8047,      0.0000],
         [ 70263.4141,      0.0000]],

        [[753735.6250,      0.0000],
         [747293.8750,      0.0000],
         [742757.9375,      0.0000],
         ...,
         [545446.5625,      0.0000],
         [539755.5625,      0.0000],
         [525341.8125,      0.0000]],

        [[618195.6875,      0.0000],
         [432366.9062,      0.0000],
         [413070.5312,      0.0000],
         ...,
         [178239.6406,      0.0000],
         [177106.4219,      0.0000],
         [170981.8438,      0.0000]],

        ...,

        [[     0.0000, 192113.7812],
         [     0.0000, 185092.6094],
         [177189.7031,      0.0000],
         ...,
         [ 76716.2266,      0.0000],
         [ 73920.3828,      0.0000],
         [ 72881.2422,      0.0000]],

        [[551139.7500,      0.0000],
         [     0.0000, 336282.5625],
         [     0.0000, 260475.5781],
         ...,
         [     0.0000, 128009.7812],
         [127152.8516,      0.0000],
         [     0.0000, 126005.4688]],

        [[     0.0000, 301221.0312],
         [266029.5000,      0.0000],
         [     0.0000, 228806.1875],
         ...,
         [125000.2031,      0.0000],
         [123534.0156,      0.0000],
         [123436.5000,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2271495.7500,   102180.0312],
        [12488538.0000,        0.0000],
        [ 4770486.5000,   818965.5000],
        [ 4713088.0000,        0.0000],
        [ 1426538.2500,   737268.9375],
        [ 3003834.2500,   242505.0312],
        [ 5312218.5000,  1802999.0000],
        [ 6807116.0000,        0.0000],
        [ 7073432.0000,   338968.8750],
        [ 5247187.5000,        0.0000],
        [ 9251950.0000,        0.0000],
        [ 3232243.2500,        0.0000],
        [ 4773386.0000,        0.0000],
        [14405913.0000,        0.0000],
        [14278124.0000,        0.0000],
        [11537128.0000,        0.0000],
        [10387089.0000,        0.0000],
        [11732050.0000,        0.0000],
        [ 6927904.5000,        0.0000],
        [ 7677668.5000,   345206.7500],
        [10068449.0000,        0.0000],
        [ 7378855.5000,        0.0000],
        [14404038.0000,        0.0000],
        [13458771.0000,        0.0000],
        [ 5827969.0000,        0.0000],
        [12212037.0000,        0.0000],
        [11618762.0000,        0.0000],
        [14464309.0000,        0.0000],
        [14115555.0000,        0.0000],
        [12984791.0000,        0.0000],
        [16693191.0000,        0.0000],
        [13042034.0000,        0.0000],
        [ 4566563.0000,        0.0000],
        [ 4652549.5000,  1206804.7500],
        [ 6080561.0000,  1726963.1250],
        [ 2819901.7500,  1936248.2500],
        [ 3032440.2500,  1146916.7500],
        [ 2365143.0000,  1028399.6875],
        [ 1871263.0000,  1392122.3750],
        [11077682.0000,   508702.6250],
        [ 3493303.2500,   730487.9375],
        [ 5343393.5000,        0.0000],
        [ 4925557.5000,        0.0000],
        [ 3870115.5000,        0.0000],
        [ 2498358.2500,  1636951.8750],
        [  512216.2188,   552667.6875],
        [ 6813139.5000,   331902.9375],
        [ 1187556.0000,   506159.8438],
        [  588144.3125,   454427.5000],
        [ 4457838.0000,  1805640.0000],
        [ 1938316.1250,   373886.7500],
        [ 4440687.0000,  1190191.7500],
        [ 3898709.2500,  2608142.0000],
        [ 5143787.0000,   242428.0781],
        [ 8927174.0000,   484732.9375],
        [ 5944595.0000,   302479.3125],
        [ 5019821.0000,  1860706.7500],
        [ 4523711.0000,  1563998.8750],
        [ 2842284.0000,  1737949.0000],
        [ 1644385.6250,  1319983.3750],
        [ 5155054.0000,   742716.6250],
        [ 1509669.0000,   751339.8125],
        [ 2495050.5000,  1414521.7500],
        [ 2434639.5000,   828125.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 271/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:56, 55.76s/it]  7%|▋         | 2/30 [00:58<11:31, 24.68s/it] 10%|█         | 3/30 [00:59<06:07, 13.61s/it] 13%|█▎        | 4/30 [00:59<03:38,  8.42s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.54s/it] 20%|██        | 6/30 [01:00<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.99s/it] 30%|███       | 9/30 [01:01<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 3.0228320121765138
Epoch 272/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:54, 57.73s/it]  7%|▋         | 2/30 [00:58<11:13, 24.04s/it] 10%|█         | 3/30 [00:58<05:58, 13.26s/it] 13%|█▎        | 4/30 [00:59<03:33,  8.20s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.72s/it] 20%|██        | 6/30 [01:00<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.979190802574158
Epoch 273/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:43, 57.37s/it]  7%|▋         | 2/30 [00:59<11:34, 24.80s/it] 10%|█         | 3/30 [00:59<06:09, 13.68s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.45s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.56s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.9759594996770224
Epoch 274/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:47, 57.49s/it]  7%|▋         | 2/30 [00:58<11:19, 24.28s/it] 10%|█         | 3/30 [00:59<06:03, 13.47s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.54s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.62s/it] 20%|██        | 6/30 [01:00<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.959770139058431
Epoch 275/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:02, 58.02s/it]  7%|▋         | 2/30 [00:59<11:32, 24.75s/it] 10%|█         | 3/30 [00:59<06:08, 13.65s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.43s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.55s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.9814496358235676
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0558, -0.0759,  0.0849,  ..., -0.0568,  0.1094,  0.0632],
        [ 0.0207, -0.0388,  0.0900,  ..., -0.0196,  0.0961,  0.1050],
        [-0.0110, -0.0168,  0.0102,  ..., -0.0597,  0.0548,  0.1302],
        ...,
        [-0.0311, -0.0168,  0.0772,  ..., -0.0284,  0.0351,  0.0198],
        [-0.0710, -0.0946,  0.0389,  ..., -0.0273,  0.0880,  0.0126],
        [-0.0192, -0.0245,  0.0781,  ..., -0.0169,  0.0793,  0.0956]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8769, 0.8722, 0.8578,  ..., 0.7821, 0.7797, 0.7792],
        [0.9466, 0.9453, 0.9447,  ..., 0.9225, 0.9223, 0.9204],
        [0.9318, 0.9054, 0.9028,  ..., 0.8429, 0.8424, 0.8411],
        ...,
        [0.8493, 0.8492, 0.8438,  ..., 0.7844, 0.7824, 0.7810],
        [0.9242, 0.8900, 0.8698,  ..., 0.8194, 0.8187, 0.8181],
        [0.8810, 0.8716, 0.8616,  ..., 0.8180, 0.8170, 0.8166]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 1, 1],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[275791.6562, 257863.8438, 209989.5938,  ...,  71135.1953,
          68768.1094,  68297.0781],
        [746432.7500, 732540.1250, 726662.0625,  ..., 528927.6875,
         527135.5000, 513546.3125],
        [604326.9375, 414370.1875, 399377.0312,  ..., 169636.8438,
         168406.1562, 165348.8594],
        ...,
        [185984.7656, 185512.1406, 171807.1094,  ...,  73511.6562,
          71457.0781,  70088.0703],
        [542004.5000, 332589.5625, 249018.9844,  ..., 121336.8203,
         120121.3281, 119057.1406],
        [292236.4688, 255771.9688, 221709.8906,  ..., 118779.7500,
         117231.6875, 116566.7969]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[275791.6562,      0.0000],
         [257863.8438,      0.0000],
         [209989.5938,      0.0000],
         ...,
         [ 71135.1953,      0.0000],
         [ 68768.1094,      0.0000],
         [ 68297.0781,      0.0000]],

        [[746432.7500,      0.0000],
         [732540.1250,      0.0000],
         [726662.0625,      0.0000],
         ...,
         [528927.6875,      0.0000],
         [527135.5000,      0.0000],
         [513546.3125,      0.0000]],

        [[604326.9375,      0.0000],
         [414370.1875,      0.0000],
         [399377.0312,      0.0000],
         ...,
         [169636.8438,      0.0000],
         [168406.1562,      0.0000],
         [165348.8594,      0.0000]],

        ...,

        [[     0.0000, 185984.7656],
         [     0.0000, 185512.1406],
         [171807.1094,      0.0000],
         ...,
         [ 73511.6562,      0.0000],
         [ 71457.0781,      0.0000],
         [ 70088.0703,      0.0000]],

        [[542004.5000,      0.0000],
         [     0.0000, 332589.5625],
         [     0.0000, 249018.9844],
         ...,
         [121336.8203,      0.0000],
         [     0.0000, 120121.3281],
         [     0.0000, 119057.1406]],

        [[     0.0000, 292236.4688],
         [255771.9688,      0.0000],
         [     0.0000, 221709.8906],
         ...,
         [118779.7500,      0.0000],
         [117231.6875,      0.0000],
         [116566.7969,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2213712.7500,    99053.7578],
        [12240807.0000,        0.0000],
        [ 4565058.0000,   791653.6250],
        [ 4616376.0000,        0.0000],
        [ 1373348.7500,   729603.4375],
        [ 2825305.5000,   231186.1562],
        [ 5040122.5000,  1738740.2500],
        [ 6525111.5000,        0.0000],
        [ 6799005.0000,   324156.2812],
        [ 5136439.0000,        0.0000],
        [ 9075640.0000,        0.0000],
        [ 3118210.0000,        0.0000],
        [ 4648235.0000,        0.0000],
        [14173406.0000,        0.0000],
        [14092740.0000,        0.0000],
        [11386793.0000,        0.0000],
        [10154124.0000,        0.0000],
        [11543119.0000,        0.0000],
        [ 6710177.5000,        0.0000],
        [ 7549676.0000,   339734.2500],
        [ 9832675.0000,        0.0000],
        [ 7188494.0000,        0.0000],
        [14191184.0000,        0.0000],
        [13343558.0000,        0.0000],
        [ 5638617.5000,        0.0000],
        [12058940.0000,        0.0000],
        [11412959.0000,        0.0000],
        [14323448.0000,        0.0000],
        [13889204.0000,        0.0000],
        [12824507.0000,        0.0000],
        [16456125.0000,        0.0000],
        [12834333.0000,        0.0000],
        [ 4472620.0000,        0.0000],
        [ 4511644.0000,  1186476.8750],
        [ 5939658.0000,  1699631.7500],
        [ 2708096.5000,  1902299.3750],
        [ 2912593.2500,  1124243.0000],
        [ 2296694.0000,  1002444.9375],
        [ 1819337.1250,  1362872.6250],
        [11292497.0000,        0.0000],
        [ 3414855.5000,   702152.7500],
        [ 5233282.0000,        0.0000],
        [ 4833333.0000,        0.0000],
        [ 3794220.2500,        0.0000],
        [ 2416358.5000,  1600894.5000],
        [  474818.2812,   564148.5000],
        [ 6583501.5000,   322124.2188],
        [ 1107177.2500,   534868.8750],
        [  569049.1875,   440549.7500],
        [ 4046219.0000,  1934062.8750],
        [ 1879489.3750,   374846.2500],
        [ 4259958.5000,  1162596.1250],
        [ 3796182.0000,  2549822.7500],
        [ 5058382.5000,   237602.4375],
        [ 8750936.0000,   476186.3438],
        [ 5785472.5000,   295083.2188],
        [ 4870511.0000,  1814878.7500],
        [ 4434034.0000,  1536029.7500],
        [ 2764257.0000,  1679777.7500],
        [ 1601159.5000,  1280773.0000],
        [ 5017535.0000,   721424.8125],
        [ 1448999.5000,   734057.6250],
        [ 2390901.5000,  1360997.6250],
        [ 2297136.0000,   806323.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 276/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:50, 59.69s/it]  7%|▋         | 2/30 [01:00<11:35, 24.84s/it] 10%|█         | 3/30 [01:00<06:09, 13.70s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.46s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 3.0016876459121704
Epoch 277/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:28, 56.85s/it]  7%|▋         | 2/30 [00:59<11:40, 25.03s/it] 10%|█         | 3/30 [01:00<06:12, 13.80s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.9480907281239825
Epoch 278/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:17, 56.46s/it]  7%|▋         | 2/30 [00:56<10:58, 23.51s/it] 10%|█         | 3/30 [00:59<06:21, 14.14s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.73s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.74s/it] 20%|██        | 6/30 [01:01<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.980213165283203
Epoch 279/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:27, 58.87s/it]  7%|▋         | 2/30 [01:00<11:41, 25.05s/it] 10%|█         | 3/30 [01:00<06:13, 13.82s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.62s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.9776748498280843
Epoch 280/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:14, 60.50s/it]  7%|▋         | 2/30 [01:01<11:56, 25.59s/it] 10%|█         | 3/30 [01:02<06:20, 14.11s/it] 13%|█▎        | 4/30 [01:02<03:46,  8.71s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.73s/it] 20%|██        | 6/30 [01:03<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 2.9240707635879515
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0563, -0.0772,  0.0846,  ..., -0.0565,  0.1088,  0.0634],
        [ 0.0215, -0.0378,  0.0894,  ..., -0.0188,  0.0962,  0.1047],
        [-0.0105, -0.0162,  0.0099,  ..., -0.0590,  0.0554,  0.1297],
        ...,
        [-0.0302, -0.0155,  0.0770,  ..., -0.0303,  0.0342,  0.0195],
        [-0.0707, -0.0956,  0.0381,  ..., -0.0281,  0.0881,  0.0125],
        [-0.0197, -0.0237,  0.0767,  ..., -0.0165,  0.0802,  0.0960]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8755, 0.8710, 0.8556,  ..., 0.7796, 0.7783, 0.7773],
        [0.9458, 0.9439, 0.9432,  ..., 0.9206, 0.9200, 0.9188],
        [0.9303, 0.9025, 0.9005,  ..., 0.8392, 0.8391, 0.8386],
        ...,
        [0.8494, 0.8471, 0.8421,  ..., 0.7812, 0.7805, 0.7781],
        [0.9231, 0.8892, 0.8669,  ..., 0.8160, 0.8149, 0.8143],
        [0.8787, 0.8686, 0.8595,  ..., 0.8140, 0.8131, 0.8127]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 1, 0, 1],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[270127.4062, 253456.2188, 203299.2031,  ...,  68694.0391,
          67372.9609,  66428.3359],
        [738212.3125, 718174.2500, 711152.1875,  ..., 515094.8125,
         510127.5000, 502032.4688],
        [591459.2500, 397218.7500, 386420.0625,  ..., 161020.2656,
         160763.2500, 159614.5938],
        ...,
        [186223.2812, 180019.8594, 167624.2188,  ...,  70217.3984,
          69544.1719,  67176.6406],
        [533640.6875, 328860.9062, 239153.2969,  ..., 115542.3594,
         113654.5391, 112668.4844],
        [283004.4688, 244934.1719, 215171.3750,  ..., 112311.3516,
         110876.8828, 110249.7109]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[270127.4062,      0.0000],
         [253456.2188,      0.0000],
         [203299.2031,      0.0000],
         ...,
         [ 68694.0391,      0.0000],
         [ 67372.9609,      0.0000],
         [ 66428.3359,      0.0000]],

        [[738212.3125,      0.0000],
         [718174.2500,      0.0000],
         [711152.1875,      0.0000],
         ...,
         [515094.8125,      0.0000],
         [510127.5000,      0.0000],
         [502032.4688,      0.0000]],

        [[591459.2500,      0.0000],
         [397218.7500,      0.0000],
         [386420.0625,      0.0000],
         ...,
         [161020.2656,      0.0000],
         [160763.2500,      0.0000],
         [159614.5938,      0.0000]],

        ...,

        [[     0.0000, 186223.2812],
         [     0.0000, 180019.8594],
         [167624.2188,      0.0000],
         ...,
         [ 70217.3984,      0.0000],
         [ 69544.1719,      0.0000],
         [ 67176.6406,      0.0000]],

        [[533640.6875,      0.0000],
         [     0.0000, 328860.9062],
         [     0.0000, 239153.2969],
         ...,
         [     0.0000, 115542.3594],
         [113654.5391,      0.0000],
         [     0.0000, 112668.4844]],

        [[     0.0000, 283004.4688],
         [244934.1719,      0.0000],
         [     0.0000, 215171.3750],
         ...,
         [112311.3516,      0.0000],
         [110876.8828,      0.0000],
         [110249.7109,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2162386.7500,    96032.2031],
        [11999242.0000,        0.0000],
        [ 4372689.0000,   765557.6250],
        [ 4518573.5000,        0.0000],
        [ 1323485.0000,   720133.0625],
        [ 2571751.2500,   315994.1875],
        [ 4800830.5000,  1678041.5000],
        [ 6246296.0000,        0.0000],
        [ 6549355.0000,   311210.2188],
        [ 5043369.0000,        0.0000],
        [ 8894707.0000,        0.0000],
        [ 3015197.5000,        0.0000],
        [ 4531106.5000,        0.0000],
        [13943421.0000,        0.0000],
        [13919778.0000,        0.0000],
        [11241296.0000,        0.0000],
        [ 9923618.0000,        0.0000],
        [11375126.0000,        0.0000],
        [ 6502803.0000,        0.0000],
        [ 7412527.5000,   334108.8438],
        [ 9599124.0000,        0.0000],
        [ 7006871.5000,        0.0000],
        [13992189.0000,        0.0000],
        [13231225.0000,        0.0000],
        [ 5463367.0000,        0.0000],
        [11910729.0000,        0.0000],
        [11235292.0000,        0.0000],
        [14200339.0000,        0.0000],
        [13663486.0000,        0.0000],
        [12664622.0000,        0.0000],
        [16225267.0000,        0.0000],
        [12650948.0000,        0.0000],
        [ 4375053.0000,        0.0000],
        [ 4180064.7500,  1361556.2500],
        [ 5799867.0000,  1672385.0000],
        [ 2605541.5000,  1867005.0000],
        [ 2682312.7500,  1229741.8750],
        [ 2122452.0000,  1085965.0000],
        [ 1769590.2500,  1333016.3750],
        [11002498.0000,        0.0000],
        [ 3339477.5000,   674688.1250],
        [ 5130947.0000,        0.0000],
        [ 4740882.0000,        0.0000],
        [ 3720244.5000,        0.0000],
        [ 2341830.5000,  1566783.3750],
        [  465498.0938,   550340.3750],
        [ 6372761.0000,   313106.5312],
        [ 1097210.3750,   490992.1250],
        [  549862.7500,   426761.5000],
        [ 3857006.0000,  1862727.7500],
        [ 1818587.0000,   374396.4375],
        [ 3897724.0000,  1338990.5000],
        [ 3696711.0000,  2492542.0000],
        [ 4972032.0000,   233078.7969],
        [ 8575769.0000,   468078.7188],
        [ 5632755.0000,   287774.0938],
        [ 4731544.5000,  1773253.0000],
        [ 4359392.5000,  1511915.0000],
        [ 2688999.7500,  1623997.7500],
        [ 1560114.7500,  1244688.5000],
        [ 4891258.0000,   700326.2500],
        [ 1399259.7500,   717407.8750],
        [ 2294301.2500,  1314130.0000],
        [ 2162842.5000,   784635.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 281/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:35, 59.15s/it]  7%|▋         | 2/30 [00:59<11:29, 24.62s/it] 10%|█         | 3/30 [01:00<06:06, 13.58s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.39s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.53s/it] 20%|██        | 6/30 [01:01<01:31,  3.80s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.06it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.01it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.14it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.18it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.9110956748326617
Epoch 282/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:00, 55.87s/it]  7%|▋         | 2/30 [00:59<11:36, 24.89s/it] 10%|█         | 3/30 [00:59<06:10, 13.72s/it] 13%|█▎        | 4/30 [00:59<03:40,  8.48s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.58s/it] 20%|██        | 6/30 [01:00<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:01<00:43,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 2.982839012145996
Epoch 283/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:07, 60.26s/it]  7%|▋         | 2/30 [01:00<11:41, 25.07s/it] 10%|█         | 3/30 [01:01<06:14, 13.88s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.944365684191386
Epoch 284/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:49, 57.58s/it]  7%|▋         | 2/30 [00:58<11:11, 23.97s/it] 10%|█         | 3/30 [01:00<06:24, 14.26s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.80s/it] 17%|█▋        | 5/30 [01:01<02:24,  5.79s/it] 20%|██        | 6/30 [01:02<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.943097408612569
Epoch 285/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:40, 55.19s/it]  7%|▋         | 2/30 [00:57<11:09, 23.90s/it] 10%|█         | 3/30 [00:59<06:23, 14.22s/it] 13%|█▎        | 4/30 [01:00<03:52,  8.94s/it] 17%|█▋        | 5/30 [01:01<02:26,  5.87s/it] 20%|██        | 6/30 [01:01<01:36,  4.02s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.08s/it] 30%|███       | 9/30 [01:02<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.60it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.9215913931528728
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0565, -0.0786,  0.0842,  ..., -0.0560,  0.1081,  0.0634],
        [ 0.0221, -0.0366,  0.0889,  ..., -0.0180,  0.0961,  0.1043],
        [-0.0099, -0.0155,  0.0098,  ..., -0.0586,  0.0560,  0.1290],
        ...,
        [-0.0291, -0.0141,  0.0765,  ..., -0.0320,  0.0333,  0.0194],
        [-0.0704, -0.0960,  0.0371,  ..., -0.0287,  0.0882,  0.0126],
        [-0.0203, -0.0226,  0.0752,  ..., -0.0158,  0.0809,  0.0962]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8738, 0.8698, 0.8532,  ..., 0.7769, 0.7764, 0.7753],
        [0.9452, 0.9426, 0.9418,  ..., 0.9191, 0.9177, 0.9176],
        [0.9288, 0.8997, 0.8985,  ..., 0.8360, 0.8360, 0.8352],
        ...,
        [0.8494, 0.8452, 0.8404,  ..., 0.7776, 0.7776, 0.7749],
        [0.9221, 0.8885, 0.8643,  ..., 0.8137, 0.8107, 0.8102],
        [0.8769, 0.8657, 0.8579,  ..., 0.8098, 0.8093, 0.8089]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[263718.7188, 249152.7188, 196458.7344,  ...,  66045.7266,
          65598.2812,  64538.7930],
        [730987.3750, 704979.6875, 696722.5625,  ..., 503645.6250,
         493611.8438, 493353.0000],
        [578370.5625, 381926.8438, 375310.2812,  ..., 153671.6562,
         153621.1094, 152017.7031],
        ...,
        [186101.3125, 175299.0000, 163600.8906,  ...,  66730.8281,
          66712.7578,  64260.4570],
        [526206.2500, 325211.5625, 230374.7500,  ..., 111769.0938,
         107138.9141, 106399.7891],
        [275807.6875, 234895.2031, 210163.4844,  ..., 105756.2812,
         105028.2891, 104405.7266]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[263718.7188,      0.0000],
         [249152.7188,      0.0000],
         [196458.7344,      0.0000],
         ...,
         [ 66045.7266,      0.0000],
         [ 65598.2812,      0.0000],
         [ 64538.7930,      0.0000]],

        [[730987.3750,      0.0000],
         [704979.6875,      0.0000],
         [696722.5625,      0.0000],
         ...,
         [503645.6250,      0.0000],
         [493611.8438,      0.0000],
         [493353.0000,      0.0000]],

        [[578370.5625,      0.0000],
         [381926.8438,      0.0000],
         [     0.0000, 375310.2812],
         ...,
         [153671.6562,      0.0000],
         [153621.1094,      0.0000],
         [152017.7031,      0.0000]],

        ...,

        [[     0.0000, 186101.3125],
         [     0.0000, 175299.0000],
         [163600.8906,      0.0000],
         ...,
         [ 66730.8281,      0.0000],
         [ 66712.7578,      0.0000],
         [ 64260.4570,      0.0000]],

        [[526206.2500,      0.0000],
         [     0.0000, 325211.5625],
         [     0.0000, 230374.7500],
         ...,
         [111769.0938,      0.0000],
         [107138.9141,      0.0000],
         [     0.0000, 106399.7891]],

        [[     0.0000, 275807.6875],
         [234895.2031,      0.0000],
         [     0.0000, 210163.4844],
         ...,
         [105756.2812,      0.0000],
         [105028.2891,      0.0000],
         [104405.7266,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2109326.0000,    93769.3359],
        [11776682.0000,        0.0000],
        [ 4188318.2500,   738346.6875],
        [ 4425638.0000,        0.0000],
        [ 1275356.0000,   710789.0000],
        [ 2438396.2500,   303280.9375],
        [ 4576179.0000,  1619918.5000],
        [ 5979319.0000,        0.0000],
        [ 6310801.0000,   297948.5938],
        [ 4951556.0000,        0.0000],
        [ 8720257.0000,        0.0000],
        [ 2903902.2500,        0.0000],
        [ 4413298.0000,        0.0000],
        [13707252.0000,        0.0000],
        [13771542.0000,        0.0000],
        [11124431.0000,        0.0000],
        [ 9695930.0000,        0.0000],
        [11196783.0000,        0.0000],
        [ 6290156.0000,        0.0000],
        [ 7284727.5000,   328585.9688],
        [ 9368907.0000,        0.0000],
        [ 6814621.0000,        0.0000],
        [13809782.0000,        0.0000],
        [13117446.0000,        0.0000],
        [ 5285787.0000,        0.0000],
        [11781116.0000,        0.0000],
        [11073776.0000,        0.0000],
        [14091266.0000,        0.0000],
        [13469466.0000,        0.0000],
        [12523895.0000,        0.0000],
        [16031131.0000,        0.0000],
        [12488428.0000,        0.0000],
        [ 4284215.0000,        0.0000],
        [ 4061300.5000,  1339748.7500],
        [ 5410247.0000,  1912012.7500],
        [ 2510323.7500,  1829022.1250],
        [ 2586783.2500,  1210402.2500],
        [ 2065181.2500,  1060824.5000],
        [ 1721299.0000,  1303371.2500],
        [10716712.0000,        0.0000],
        [ 3272581.2500,   649682.9375],
        [ 5040197.0000,        0.0000],
        [ 4652591.0000,        0.0000],
        [ 3661111.5000,        0.0000],
        [ 2272697.5000,  1538090.2500],
        [  456576.6250,   537026.1250],
        [ 6167885.0000,   304611.6250],
        [ 1058275.2500,   483299.4375],
        [  504033.3125,   441483.9375],
        [ 3676575.0000,  1793196.7500],
        [ 1766019.3750,   374533.6875],
        [ 3756017.2500,  1313280.3750],
        [ 3605493.0000,  2445109.7500],
        [ 4895606.5000,   228697.1094],
        [ 8414865.0000,   459198.2188],
        [ 5485841.0000,   280564.3750],
        [ 4602963.0000,  1732845.1250],
        [ 4289095.5000,  1488959.1250],
        [ 2624018.2500,  1573487.8750],
        [ 1521480.6250,  1212640.3750],
        [ 4775292.0000,   680348.3750],
        [ 1349419.1250,   703355.1250],
        [ 2207638.2500,  1273583.2500],
        [ 2041281.7500,   767007.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 286/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:09, 56.18s/it]  7%|▋         | 2/30 [00:57<11:06, 23.81s/it] 10%|█         | 3/30 [00:58<06:06, 13.57s/it] 13%|█▎        | 4/30 [01:00<03:49,  8.82s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.80s/it] 20%|██        | 6/30 [01:01<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.934236200650533
Epoch 287/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:26, 56.78s/it]  7%|▋         | 2/30 [00:57<11:01, 23.64s/it] 10%|█         | 3/30 [00:57<05:52, 13.05s/it] 13%|█▎        | 4/30 [00:58<03:29,  8.07s/it] 17%|█▋        | 5/30 [01:00<02:31,  6.06s/it] 20%|██        | 6/30 [01:01<01:39,  4.15s/it] 23%|██▎       | 7/30 [01:01<01:07,  2.94s/it] 27%|██▋       | 8/30 [01:01<00:47,  2.14s/it] 30%|███       | 9/30 [01:02<00:33,  1.61s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.25s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.00s/it] 40%|████      | 12/30 [01:03<00:14,  1.20it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.59it/s] 50%|█████     | 15/30 [01:04<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.92662676970164
Epoch 288/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:49, 55.51s/it]  7%|▋         | 2/30 [00:56<10:56, 23.46s/it] 10%|█         | 3/30 [00:58<06:07, 13.61s/it] 13%|█▎        | 4/30 [00:58<03:38,  8.41s/it] 17%|█▋        | 5/30 [00:59<02:18,  5.54s/it] 20%|██        | 6/30 [00:59<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:00<00:43,  1.99s/it] 30%|███       | 9/30 [01:01<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:01<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:03<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:07<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch loss is 2.92413018544515
Epoch 289/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:06<32:15, 66.74s/it]  7%|▋         | 2/30 [01:07<12:56, 27.74s/it] 10%|█         | 3/30 [01:07<06:52, 15.28s/it] 13%|█▎        | 4/30 [01:08<04:05,  9.42s/it] 17%|█▋        | 5/30 [01:08<02:34,  6.19s/it] 20%|██        | 6/30 [01:08<01:41,  4.23s/it] 23%|██▎       | 7/30 [01:09<01:08,  3.00s/it] 27%|██▋       | 8/30 [01:09<00:48,  2.18s/it] 30%|███       | 9/30 [01:10<00:34,  1.64s/it] 33%|███▎      | 10/30 [01:10<00:25,  1.27s/it] 37%|███▋      | 11/30 [01:11<00:19,  1.02s/it] 40%|████      | 12/30 [01:11<00:15,  1.19it/s] 43%|████▎     | 13/30 [01:12<00:12,  1.39it/s] 47%|████▋     | 14/30 [01:12<00:10,  1.57it/s] 50%|█████     | 15/30 [01:12<00:08,  1.73it/s] 53%|█████▎    | 16/30 [01:13<00:07,  1.86it/s] 57%|█████▋    | 17/30 [01:13<00:06,  1.96it/s] 60%|██████    | 18/30 [01:14<00:05,  2.04it/s] 63%|██████▎   | 19/30 [01:14<00:05,  2.10it/s] 67%|██████▋   | 20/30 [01:15<00:04,  2.15it/s] 70%|███████   | 21/30 [01:15<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:16<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:16<00:03,  2.22it/s] 80%|████████  | 24/30 [01:16<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:17<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:17<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:18<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:18<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:19<00:00,  2.25it/s]100%|██████████| 30/30 [01:19<00:00,  2.26it/s]100%|██████████| 30/30 [01:19<00:00,  2.66s/it]
Epoch loss is 2.9243303696314493
Epoch 290/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:53, 57.72s/it]  7%|▋         | 2/30 [00:58<11:12, 24.03s/it] 10%|█         | 3/30 [01:00<06:20, 14.09s/it] 13%|█▎        | 4/30 [01:00<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.72s/it] 20%|██        | 6/30 [01:01<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.8999140739440916
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0568, -0.0798,  0.0838,  ..., -0.0559,  0.1073,  0.0632],
        [ 0.0227, -0.0355,  0.0883,  ..., -0.0176,  0.0961,  0.1039],
        [-0.0093, -0.0149,  0.0096,  ..., -0.0581,  0.0564,  0.1284],
        ...,
        [-0.0281, -0.0127,  0.0762,  ..., -0.0333,  0.0325,  0.0191],
        [-0.0699, -0.0965,  0.0363,  ..., -0.0294,  0.0883,  0.0126],
        [-0.0207, -0.0217,  0.0737,  ..., -0.0152,  0.0817,  0.0963]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8721, 0.8685, 0.8510,  ..., 0.7744, 0.7743, 0.7733],
        [0.9444, 0.9413, 0.9405,  ..., 0.9176, 0.9166, 0.9160],
        [0.9273, 0.8968, 0.8966,  ..., 0.8332, 0.8328, 0.8321],
        ...,
        [0.8492, 0.8435, 0.8385,  ..., 0.7743, 0.7737, 0.7716],
        [0.9210, 0.8877, 0.8617,  ..., 0.8108, 0.8067, 0.8061],
        [0.8750, 0.8626, 0.8561,  ..., 0.8054, 0.8050, 0.8048]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 1,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[257393.3281, 244455.5625, 190321.1875,  ...,  63722.8672,
          63630.8047,  62788.3906],
        [722979.8125, 691863.8750, 683907.7500,  ..., 492870.0312,
         485923.3750, 482187.8750],
        [566746.5000, 366164.0625, 365324.5000,  ..., 147674.7031,
         146910.4062, 145368.5781],
        ...,
        [185507.7188, 171197.2031, 159299.5000,  ...,  63676.1562,
          63106.0117,  61238.6289],
        [518019.5312, 321654.5625, 221864.0625,  ..., 107299.2422,
         101189.5391, 100327.6172],
        [268256.9375, 224846.9844, 204859.6875,  ...,  99301.1875,
          98770.3906,  98397.5234]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[257393.3281,      0.0000],
         [244455.5625,      0.0000],
         [190321.1875,      0.0000],
         ...,
         [ 63722.8672,      0.0000],
         [ 63630.8047,      0.0000],
         [ 62788.3906,      0.0000]],

        [[722979.8125,      0.0000],
         [691863.8750,      0.0000],
         [683907.7500,      0.0000],
         ...,
         [492870.0312,      0.0000],
         [485923.3750,      0.0000],
         [482187.8750,      0.0000]],

        [[566746.5000,      0.0000],
         [366164.0625,      0.0000],
         [     0.0000, 365324.5000],
         ...,
         [147674.7031,      0.0000],
         [146910.4062,      0.0000],
         [145368.5781,      0.0000]],

        ...,

        [[     0.0000, 185507.7188],
         [     0.0000, 171197.2031],
         [159299.5000,      0.0000],
         ...,
         [ 63676.1562,      0.0000],
         [ 63106.0117,      0.0000],
         [ 61238.6289,      0.0000]],

        [[518019.5312,      0.0000],
         [     0.0000, 321654.5625],
         [     0.0000, 221864.0625],
         ...,
         [107299.2422,      0.0000],
         [101189.5391,      0.0000],
         [     0.0000, 100327.6172]],

        [[     0.0000, 268256.9375],
         [224846.9844,      0.0000],
         [     0.0000, 204859.6875],
         ...,
         [ 99301.1875,      0.0000],
         [ 98770.3906,      0.0000],
         [ 98397.5234,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2058733.7500,    91299.9531],
        [11562930.0000,        0.0000],
        [ 4016305.7500,   712566.9375],
        [ 4337264.0000,        0.0000],
        [ 1231604.0000,   701241.6875],
        [ 2319600.0000,   291234.7188],
        [ 4364497.0000,  1566781.5000],
        [ 5719676.0000,        0.0000],
        [ 6084582.0000,   284227.5625],
        [ 4861675.0000,        0.0000],
        [ 8554596.0000,        0.0000],
        [ 2809080.5000,        0.0000],
        [ 4308823.0000,        0.0000],
        [13478755.0000,        0.0000],
        [13623631.0000,        0.0000],
        [10993284.0000,        0.0000],
        [ 9480529.0000,        0.0000],
        [11028694.0000,        0.0000],
        [ 6090691.0000,        0.0000],
        [ 7153532.0000,   323577.1875],
        [ 9154084.0000,        0.0000],
        [ 6631465.5000,        0.0000],
        [13629806.0000,        0.0000],
        [12999063.0000,        0.0000],
        [ 5123432.5000,        0.0000],
        [11652262.0000,        0.0000],
        [10910127.0000,        0.0000],
        [13976600.0000,        0.0000],
        [13270396.0000,        0.0000],
        [12379561.0000,        0.0000],
        [15835152.0000,        0.0000],
        [12322186.0000,        0.0000],
        [ 4192653.2500,        0.0000],
        [ 3941512.2500,  1317897.6250],
        [ 5287108.0000,  1885266.8750],
        [ 2422623.2500,  1794163.7500],
        [ 2495299.5000,  1191547.2500],
        [ 2008931.0000,  1035815.9375],
        [ 1680409.6250,  1275787.2500],
        [10458739.0000,        0.0000],
        [ 3207981.0000,   626321.1250],
        [ 4942833.0000,        0.0000],
        [ 4562415.0000,        0.0000],
        [ 3604766.0000,        0.0000],
        [ 2200779.0000,  1505882.5000],
        [  448453.6875,   524311.9375],
        [ 5975405.0000,   297311.3438],
        [ 1022999.5000,   475689.1250],
        [  488329.4062,   429140.9688],
        [ 3505992.7500,  1729262.0000],
        [ 1714024.5000,   375591.5625],
        [ 3619546.5000,  1287724.5000],
        [ 3519756.5000,  2399617.0000],
        [ 4823246.0000,   224064.1875],
        [ 8249746.0000,   449957.6250],
        [ 5350810.0000,   273924.2812],
        [ 4483012.0000,  1692293.3750],
        [ 4221013.0000,  1464975.5000],
        [ 2560007.7500,  1528161.5000],
        [ 1482732.5000,  1182158.8750],
        [ 4671429.0000,   660098.6875],
        [ 1302574.5000,   691050.5625],
        [ 2125596.2500,  1234926.0000],
        [ 1922440.5000,   749211.8125]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 291/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:24, 56.70s/it]  7%|▋         | 2/30 [01:00<11:53, 25.47s/it] 10%|█         | 3/30 [01:00<06:19, 14.04s/it] 13%|█▎        | 4/30 [01:01<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.70s/it] 20%|██        | 6/30 [01:02<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.932922124862671
Epoch 292/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:16, 56.41s/it]  7%|▋         | 2/30 [00:59<11:41, 25.07s/it] 10%|█         | 3/30 [00:59<06:13, 13.82s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.54s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.62s/it] 20%|██        | 6/30 [01:01<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.8657171964645385
Epoch 293/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:50, 55.53s/it]  7%|▋         | 2/30 [00:56<10:48, 23.16s/it] 10%|█         | 3/30 [01:00<06:28, 14.40s/it] 13%|█▎        | 4/30 [01:00<03:51,  8.89s/it] 17%|█▋        | 5/30 [01:00<02:26,  5.84s/it] 20%|██        | 6/30 [01:01<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.08s/it] 30%|███       | 9/30 [01:02<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.60it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.8620540698369346
Epoch 294/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:01, 55.91s/it]  7%|▋         | 2/30 [00:56<11:00, 23.60s/it] 10%|█         | 3/30 [00:57<05:51, 13.02s/it] 13%|█▎        | 4/30 [00:57<03:29,  8.06s/it] 17%|█▋        | 5/30 [00:59<02:22,  5.71s/it] 20%|██        | 6/30 [00:59<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:00<01:04,  2.78s/it] 27%|██▋       | 8/30 [01:00<00:44,  2.04s/it] 30%|███       | 9/30 [01:01<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:01<00:18,  1.03it/s] 40%|████      | 12/30 [01:02<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.61it/s] 50%|█████     | 15/30 [01:03<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:04<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch loss is 2.8486813147862753
Epoch 295/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:04, 58.09s/it]  7%|▋         | 2/30 [00:59<11:35, 24.85s/it] 10%|█         | 3/30 [01:00<06:10, 13.71s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.77s/it] 17%|█▋        | 5/30 [01:02<02:29,  5.97s/it] 20%|██        | 6/30 [01:02<01:38,  4.09s/it] 23%|██▎       | 7/30 [01:03<01:06,  2.90s/it] 27%|██▋       | 8/30 [01:03<00:46,  2.11s/it] 30%|███       | 9/30 [01:04<00:33,  1.59s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.24s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.01it/s] 40%|████      | 12/30 [01:05<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:06<00:10,  1.59it/s] 50%|█████     | 15/30 [01:06<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.8779165983200072
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0573, -0.0810,  0.0834,  ..., -0.0562,  0.1066,  0.0631],
        [ 0.0233, -0.0345,  0.0878,  ..., -0.0176,  0.0961,  0.1035],
        [-0.0088, -0.0146,  0.0095,  ..., -0.0578,  0.0567,  0.1279],
        ...,
        [-0.0269, -0.0118,  0.0758,  ..., -0.0349,  0.0316,  0.0190],
        [-0.0694, -0.0971,  0.0354,  ..., -0.0302,  0.0883,  0.0128],
        [-0.0211, -0.0210,  0.0722,  ..., -0.0148,  0.0824,  0.0966]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8705, 0.8673, 0.8490,  ..., 0.7720, 0.7720, 0.7717],
        [0.9436, 0.9399, 0.9392,  ..., 0.9162, 0.9155, 0.9148],
        [0.9259, 0.8948, 0.8941,  ..., 0.8306, 0.8303, 0.8300],
        ...,
        [0.8486, 0.8419, 0.8364,  ..., 0.7708, 0.7696, 0.7679],
        [0.9201, 0.8868, 0.8590,  ..., 0.8081, 0.8036, 0.8036],
        [0.8732, 0.8600, 0.8544,  ..., 0.8017, 0.8012, 0.8009]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 1],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[251749.9531, 240313.3438, 185126.3281,  ...,  61590.8047,
          61587.6367,  61336.8789],
        [714946.0625, 678482.0000, 671350.5000,  ..., 483270.1875,
         478302.7188, 473912.0625],
        [554993.3125, 356034.3750, 352431.1875,  ..., 142385.0312,
         141728.7812, 141011.6719],
        ...,
        [184086.5625, 167115.6875, 154598.9062,  ...,  60559.0078,
          59510.5508,  58081.0078],
        [511271.5625, 317713.5000, 213585.0781,  ..., 103220.1719,
          96808.3750,  96730.4844],
        [261593.5938, 216548.3594, 199810.9062,  ...,  94152.8594,
          93465.9609,  93152.9062]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[251749.9531,      0.0000],
         [240313.3438,      0.0000],
         [185126.3281,      0.0000],
         ...,
         [ 61590.8047,      0.0000],
         [ 61587.6367,      0.0000],
         [ 61336.8789,      0.0000]],

        [[714946.0625,      0.0000],
         [678482.0000,      0.0000],
         [671350.5000,      0.0000],
         ...,
         [483270.1875,      0.0000],
         [478302.7188,      0.0000],
         [473912.0625,      0.0000]],

        [[554993.3125,      0.0000],
         [     0.0000, 356034.3750],
         [352431.1875,      0.0000],
         ...,
         [142385.0312,      0.0000],
         [141728.7812,      0.0000],
         [     0.0000, 141011.6719]],

        ...,

        [[     0.0000, 184086.5625],
         [     0.0000, 167115.6875],
         [154598.9062,      0.0000],
         ...,
         [ 60559.0078,      0.0000],
         [ 59510.5508,      0.0000],
         [ 58081.0078,      0.0000]],

        [[511271.5625,      0.0000],
         [     0.0000, 317713.5000],
         [     0.0000, 213585.0781],
         ...,
         [103220.1719,      0.0000],
         [ 96808.3750,      0.0000],
         [ 96730.4844,      0.0000]],

        [[     0.0000, 261593.5938],
         [216548.3594,      0.0000],
         [     0.0000, 199810.9062],
         ...,
         [ 94152.8594,      0.0000],
         [ 93465.9609,      0.0000],
         [ 93152.9062,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 2014082.7500,    88548.0938],
        [11363394.0000,        0.0000],
        [ 3722724.5000,   829401.6250],
        [ 4263560.0000,        0.0000],
        [ 1194062.0000,   692335.3125],
        [ 2209741.5000,   279585.3125],
        [ 4005572.5000,  1690638.5000],
        [ 5475784.0000,        0.0000],
        [ 5883335.5000,   272700.7812],
        [ 4788209.0000,        0.0000],
        [ 8386294.5000,        0.0000],
        [ 2711349.2500,        0.0000],
        [ 4216370.0000,        0.0000],
        [13267238.0000,        0.0000],
        [13485774.0000,        0.0000],
        [10868272.0000,        0.0000],
        [ 9272975.0000,        0.0000],
        [10871050.0000,        0.0000],
        [ 5904305.5000,        0.0000],
        [ 7023720.5000,   318432.6875],
        [ 8942487.0000,        0.0000],
        [ 6456936.5000,        0.0000],
        [13459729.0000,        0.0000],
        [12887971.0000,        0.0000],
        [ 4969777.0000,        0.0000],
        [11536055.0000,        0.0000],
        [10745665.0000,        0.0000],
        [13872420.0000,        0.0000],
        [13087279.0000,        0.0000],
        [12232323.0000,        0.0000],
        [15646670.0000,        0.0000],
        [12170610.0000,        0.0000],
        [ 4108564.7500,        0.0000],
        [ 3823027.0000,  1294195.1250],
        [ 5163509.5000,  1856634.7500],
        [ 2342489.7500,  1760473.1250],
        [ 2413629.2500,  1174578.1250],
        [ 1957469.6250,  1010335.7500],
        [ 1640752.1250,  1249772.5000],
        [10218024.0000,        0.0000],
        [ 3147459.7500,   605320.6250],
        [ 4848865.0000,        0.0000],
        [ 4473714.0000,        0.0000],
        [ 3546385.7500,        0.0000],
        [ 2135485.7500,  1476743.3750],
        [  440882.4375,   512635.4375],
        [ 5795340.5000,   290171.9375],
        [  989973.5625,   468083.0000],
        [  473658.1875,   418522.8125],
        [ 3349280.0000,  1670205.7500],
        [ 1668012.7500,   376090.4688],
        [ 3493790.7500,  1264744.2500],
        [ 3441056.0000,  2356167.5000],
        [ 4752908.5000,   219735.0156],
        [ 8104711.0000,   440867.6250],
        [ 5232562.0000,   267758.2812],
        [ 4359244.5000,  1652956.1250],
        [ 4153504.5000,  1442128.2500],
        [ 2614067.0000,  1372605.2500],
        [ 1451012.7500,  1154490.0000],
        [ 4562490.0000,   641297.6250],
        [ 1253079.7500,   677787.8750],
        [ 2150684.0000,  1103787.5000],
        [ 1822142.2500,   733592.7500]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 296/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:19, 56.53s/it]  7%|▋         | 2/30 [00:58<11:25, 24.47s/it] 10%|█         | 3/30 [00:58<06:04, 13.50s/it] 13%|█▎        | 4/30 [00:59<03:36,  8.34s/it] 17%|█▋        | 5/30 [00:59<02:17,  5.49s/it] 20%|██        | 6/30 [01:00<01:30,  3.78s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.69s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.97s/it] 30%|███       | 9/30 [01:01<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.01it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.14it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.18it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.23it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 2.875221570332845
Epoch 297/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:42, 57.33s/it]  7%|▋         | 2/30 [01:00<11:45, 25.19s/it] 10%|█         | 3/30 [01:00<06:15, 13.89s/it] 13%|█▎        | 4/30 [01:00<03:43,  8.58s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.65s/it] 20%|██        | 6/30 [01:01<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.8735145966211957
Epoch 298/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:38, 59.26s/it]  7%|▋         | 2/30 [01:01<11:51, 25.43s/it] 10%|█         | 3/30 [01:01<06:18, 14.02s/it] 13%|█▎        | 4/30 [01:01<03:45,  8.66s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.69s/it] 20%|██        | 6/30 [01:02<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.8965086936950684
Epoch 299/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:40, 59.34s/it]  7%|▋         | 2/30 [01:01<11:55, 25.55s/it] 10%|█         | 3/30 [01:01<06:20, 14.09s/it] 13%|█▎        | 4/30 [01:02<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.72s/it] 20%|██        | 6/30 [01:03<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.8869678179423013
Epoch 300/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:43, 57.36s/it]  7%|▋         | 2/30 [00:58<11:28, 24.57s/it] 10%|█         | 3/30 [00:59<06:05, 13.55s/it] 13%|█▎        | 4/30 [00:59<03:37,  8.38s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.52s/it] 20%|██        | 6/30 [01:00<01:30,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.70s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 2.8720218102137247
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0578, -0.0819,  0.0831,  ..., -0.0564,  0.1058,  0.0629],
        [ 0.0239, -0.0334,  0.0873,  ..., -0.0174,  0.0960,  0.1031],
        [-0.0083, -0.0139,  0.0092,  ..., -0.0573,  0.0570,  0.1274],
        ...,
        [-0.0259, -0.0105,  0.0756,  ..., -0.0360,  0.0310,  0.0190],
        [-0.0690, -0.0975,  0.0346,  ..., -0.0309,  0.0881,  0.0132],
        [-0.0217, -0.0202,  0.0708,  ..., -0.0142,  0.0831,  0.0968]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8690, 0.8660, 0.8471,  ..., 0.7710, 0.7701, 0.7697],
        [0.9427, 0.9385, 0.9378,  ..., 0.9147, 0.9143, 0.9134],
        [0.9244, 0.8931, 0.8916,  ..., 0.8282, 0.8281, 0.8279],
        ...,
        [0.8481, 0.8403, 0.8342,  ..., 0.7672, 0.7654, 0.7640],
        [0.9193, 0.8860, 0.8566,  ..., 0.8054, 0.8021, 0.8012],
        [0.8715, 0.8574, 0.8527,  ..., 0.7986, 0.7977, 0.7974]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 1],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[246201.4062, 236006.0000, 180115.8438,  ...,  60726.3203,
          59958.0273,  59650.6680],
        [705798.3750, 664766.6250, 658426.9375,  ..., 472856.0938,
         470285.5000, 464456.9062],
        [543155.8125, 347308.2500, 340290.3750,  ..., 137471.3750,
         137286.3906, 136877.8594],
        ...,
        [182681.6875, 163440.2656, 149739.1094,  ...,  57526.8320,
          56070.4023,  54955.0781],
        [505421.5938, 313793.7500, 206200.5938,  ...,  99328.3672,
          94680.5000,  93558.2578],
        [255129.3281, 208648.3281, 195111.3906,  ...,  90054.6250,
          88949.3594,  88599.2891]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[246201.4062,      0.0000],
         [236006.0000,      0.0000],
         [180115.8438,      0.0000],
         ...,
         [ 60726.3203,      0.0000],
         [ 59958.0273,      0.0000],
         [ 59650.6680,      0.0000]],

        [[705798.3750,      0.0000],
         [664766.6250,      0.0000],
         [658426.9375,      0.0000],
         ...,
         [472856.0938,      0.0000],
         [470285.5000,      0.0000],
         [464456.9062,      0.0000]],

        [[543155.8125,      0.0000],
         [     0.0000, 347308.2500],
         [340290.3750,      0.0000],
         ...,
         [137471.3750,      0.0000],
         [137286.3906,      0.0000],
         [     0.0000, 136877.8594]],

        ...,

        [[     0.0000, 182681.6875],
         [     0.0000, 163440.2656],
         [149739.1094,      0.0000],
         ...,
         [ 57526.8320,      0.0000],
         [ 56070.4023,      0.0000],
         [ 54955.0781,      0.0000]],

        [[505421.5938,      0.0000],
         [     0.0000, 313793.7500],
         [     0.0000, 206200.5938],
         ...,
         [ 99328.3672,      0.0000],
         [ 94680.5000,      0.0000],
         [ 93558.2578,      0.0000]],

        [[     0.0000, 255129.3281],
         [208648.3281,      0.0000],
         [     0.0000, 195111.3906],
         ...,
         [ 90054.6250,      0.0000],
         [ 88949.3594,      0.0000],
         [ 88599.2891,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1973023.1250,    85663.6484],
        [11158540.0000,        0.0000],
        [ 3590692.5000,   802902.4375],
        [ 4188559.7500,        0.0000],
        [ 1111894.3750,   725805.3750],
        [ 2031984.0000,   345169.4375],
        [ 3834697.0000,  1635536.6250],
        [ 5079693.5000,   167912.8594],
        [ 5694108.5000,   261887.3906],
        [ 4710291.5000,        0.0000],
        [ 8217224.5000,        0.0000],
        [ 2622059.0000,        0.0000],
        [ 4126193.7500,        0.0000],
        [13061800.0000,        0.0000],
        [13356527.0000,        0.0000],
        [10750000.0000,        0.0000],
        [ 9071384.0000,        0.0000],
        [10709236.0000,        0.0000],
        [ 5732492.0000,        0.0000],
        [ 6904606.5000,   312503.6562],
        [ 8735381.0000,        0.0000],
        [ 6297652.5000,        0.0000],
        [13302532.0000,        0.0000],
        [12779105.0000,        0.0000],
        [ 4820307.5000,        0.0000],
        [11429112.0000,        0.0000],
        [10597434.0000,        0.0000],
        [13772554.0000,        0.0000],
        [12908120.0000,        0.0000],
        [12096898.0000,        0.0000],
        [15467084.0000,        0.0000],
        [12021146.0000,        0.0000],
        [ 4022930.5000,        0.0000],
        [ 3705709.5000,  1271008.8750],
        [ 5042550.5000,  1827564.7500],
        [ 2138287.2500,  1861685.8750],
        [ 2336895.2500,  1158954.3750],
        [ 1909323.3750,   987293.3750],
        [ 1601730.1250,  1224642.7500],
        [ 9987588.0000,        0.0000],
        [ 3204279.2500,   470145.1562],
        [ 4756114.0000,        0.0000],
        [ 4381646.5000,        0.0000],
        [ 3487871.5000,        0.0000],
        [ 2073013.0000,  1445472.1250],
        [  432993.7188,   500953.3750],
        [ 5632690.0000,   283852.6562],
        [  957279.2500,   460000.7812],
        [  458276.0625,   407065.0938],
        [ 3201271.7500,  1614962.5000],
        [ 1621035.3750,   374752.5625],
        [ 3373159.2500,  1243481.2500],
        [ 3368911.2500,  2315561.0000],
        [ 4680517.0000,   215452.2656],
        [ 7961114.0000,   432978.0000],
        [ 5116629.0000,   262217.0312],
        [ 4243598.5000,  1615702.2500],
        [ 4088242.2500,  1421007.6250],
        [ 2551701.2500,  1339163.8750],
        [ 1418610.0000,  1129179.6250],
        [ 4459042.5000,   623141.0000],
        [ 1203997.1250,   665344.3125],
        [ 2083285.3750,  1075134.7500],
        [ 1730116.5000,   718871.8125]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 301/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:26, 56.78s/it]  7%|▋         | 2/30 [00:57<11:11, 23.99s/it] 10%|█         | 3/30 [00:59<06:17, 13.98s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.70s/it] 20%|██        | 6/30 [01:01<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.24it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.25it/s]100%|██████████| 30/30 [01:11<00:00,  2.24it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.8349364042282104
Epoch 302/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:24, 60.86s/it]  7%|▋         | 2/30 [01:01<11:52, 25.44s/it] 10%|█         | 3/30 [01:01<06:18, 14.03s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.66s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.70s/it] 20%|██        | 6/30 [01:03<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.25it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 2.8753433068593344
Epoch 303/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:49, 59.62s/it]  7%|▋         | 2/30 [01:00<11:34, 24.81s/it] 10%|█         | 3/30 [01:00<06:09, 13.68s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.46s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.868975305557251
Epoch 304/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:11, 58.33s/it]  7%|▋         | 2/30 [01:00<11:50, 25.39s/it] 10%|█         | 3/30 [01:01<06:17, 14.00s/it] 13%|█▎        | 4/30 [01:01<03:44,  8.64s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.69s/it] 20%|██        | 6/30 [01:02<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.8543599208196
Epoch 305/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:54<26:30, 54.84s/it]  7%|▋         | 2/30 [01:01<12:14, 26.22s/it] 10%|█         | 3/30 [01:01<06:30, 14.45s/it] 13%|█▎        | 4/30 [01:01<03:51,  8.92s/it] 17%|█▋        | 5/30 [01:02<02:26,  5.86s/it] 20%|██        | 6/30 [01:02<01:36,  4.02s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.08s/it] 30%|███       | 9/30 [01:04<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.8796607653299966
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0581, -0.0830,  0.0828,  ..., -0.0565,  0.1050,  0.0627],
        [ 0.0244, -0.0325,  0.0867,  ..., -0.0172,  0.0958,  0.1028],
        [-0.0078, -0.0133,  0.0090,  ..., -0.0571,  0.0573,  0.1269],
        ...,
        [-0.0249, -0.0094,  0.0755,  ..., -0.0371,  0.0307,  0.0189],
        [-0.0688, -0.0979,  0.0339,  ..., -0.0316,  0.0881,  0.0134],
        [-0.0222, -0.0197,  0.0695,  ..., -0.0138,  0.0839,  0.0972]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8675, 0.8646, 0.8453,  ..., 0.7694, 0.7681, 0.7678],
        [0.9419, 0.9372, 0.9366,  ..., 0.9133, 0.9132, 0.9122],
        [0.9228, 0.8913, 0.8892,  ..., 0.8257, 0.8255, 0.8250],
        ...,
        [0.8472, 0.8390, 0.8318,  ..., 0.7634, 0.7619, 0.7613],
        [0.9186, 0.8854, 0.8542,  ..., 0.8028, 0.8006, 0.7991],
        [0.8699, 0.8551, 0.8511,  ..., 0.7953, 0.7953, 0.7944]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 1,  ..., 0, 1, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [0., 1.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[240964.6406, 231414.5469, 175493.3594,  ...,  59322.8242,
          58269.4180,  58000.4180],
        [697791.8125, 652490.4375, 646524.1875,  ..., 463802.6875,
         462989.0938, 456422.7188],
        [530967.4375, 338816.6562, 328706.0000,  ..., 132732.8750,
         132395.8281, 131317.6719],
        ...,
        [180277.5625, 160519.5156, 144704.9375,  ...,  54496.2227,
          53302.4531,  52850.7383],
        [500410.5938, 311194.1875, 199414.9531,  ...,  95647.6797,
          92710.0312,  90673.2812],
        [249418.9688, 201968.1094, 190840.6406,  ...,  85983.8359,
          85982.9375,  84859.6406]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[240964.6406,      0.0000],
         [231414.5469,      0.0000],
         [175493.3594,      0.0000],
         ...,
         [ 59322.8242,      0.0000],
         [ 58269.4180,      0.0000],
         [ 58000.4180,      0.0000]],

        [[697791.8125,      0.0000],
         [652490.4375,      0.0000],
         [646524.1875,      0.0000],
         ...,
         [463802.6875,      0.0000],
         [462989.0938,      0.0000],
         [456422.7188,      0.0000]],

        [[530967.4375,      0.0000],
         [     0.0000, 338816.6562],
         [328706.0000,      0.0000],
         ...,
         [132732.8750,      0.0000],
         [132395.8281,      0.0000],
         [131317.6719,      0.0000]],

        ...,

        [[     0.0000, 180277.5625],
         [     0.0000, 160519.5156],
         [144704.9375,      0.0000],
         ...,
         [ 54496.2227,      0.0000],
         [ 53302.4531,      0.0000],
         [ 52850.7383,      0.0000]],

        [[500410.5938,      0.0000],
         [     0.0000, 311194.1875],
         [     0.0000, 199414.9531],
         ...,
         [ 95647.6797,      0.0000],
         [ 92710.0312,      0.0000],
         [ 90673.2812,      0.0000]],

        [[     0.0000, 249418.9688],
         [201968.1094,      0.0000],
         [     0.0000, 190840.6406],
         ...,
         [ 85983.8359,      0.0000],
         [     0.0000,  85982.9375],
         [ 84859.6406,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1932065.5000,    82801.6719],
        [10968469.0000,        0.0000],
        [ 3463753.0000,   777403.5000],
        [ 4116716.5000,        0.0000],
        [ 1077936.1250,   715127.8750],
        [ 1944213.1250,   333561.5625],
        [ 3690879.0000,  1587036.5000],
        [ 4885801.0000,   162615.9375],
        [ 5519174.5000,   251594.1719],
        [ 4634694.5000,        0.0000],
        [ 8054642.0000,        0.0000],
        [ 2540577.0000,        0.0000],
        [ 4036696.5000,        0.0000],
        [12865145.0000,        0.0000],
        [13235547.0000,        0.0000],
        [10630457.0000,        0.0000],
        [ 8884822.0000,        0.0000],
        [10546640.0000,        0.0000],
        [ 5571171.0000,        0.0000],
        [ 6781833.0000,   307195.4688],
        [ 8536598.0000,        0.0000],
        [ 6147303.0000,        0.0000],
        [13154231.0000,        0.0000],
        [12677935.0000,        0.0000],
        [ 4676070.0000,        0.0000],
        [11340206.0000,        0.0000],
        [10467175.0000,        0.0000],
        [13680842.0000,        0.0000],
        [12755161.0000,        0.0000],
        [11964912.0000,        0.0000],
        [15303030.0000,        0.0000],
        [11896070.0000,        0.0000],
        [ 3817506.0000,   129276.2344],
        [ 3599870.2500,  1247354.8750],
        [ 4936006.0000,  1801109.0000],
        [ 2074446.7500,  1828956.1250],
        [ 2270274.5000,  1144005.0000],
        [ 1862665.2500,   963692.0625],
        [ 1564360.5000,  1199398.2500],
        [ 9767466.0000,        0.0000],
        [ 3145446.0000,   457191.7500],
        [ 4677855.0000,        0.0000],
        [ 4303345.5000,        0.0000],
        [ 3435060.7500,        0.0000],
        [ 2018453.7500,  1417995.3750],
        [  426291.7500,   489267.5625],
        [ 5475961.5000,   277417.1250],
        [  927379.6875,   452402.7188],
        [  445049.7500,   396701.5625],
        [ 3074003.5000,  1565607.7500],
        [ 1579257.1250,   373731.2500],
        [ 3265116.0000,  1225943.2500],
        [ 3302473.7500,  2277631.2500],
        [ 4614592.0000,   211583.8750],
        [ 7825506.0000,   425520.0000],
        [ 5008227.5000,   256594.8281],
        [ 4139730.0000,  1581225.0000],
        [ 4031751.0000,  1400494.3750],
        [ 2496241.5000,  1309384.1250],
        [ 1388976.1250,  1105818.5000],
        [ 4355397.0000,   605705.3750],
        [ 1156047.0000,   653178.8750],
        [ 2023189.7500,  1049830.8750],
        [ 1567941.7500,   791747.9375]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 306/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:45, 61.56s/it]  7%|▋         | 2/30 [01:02<11:57, 25.61s/it] 10%|█         | 3/30 [01:02<06:21, 14.12s/it] 13%|█▎        | 4/30 [01:02<03:46,  8.72s/it] 17%|█▋        | 5/30 [01:03<02:23,  5.73s/it] 20%|██        | 6/30 [01:03<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:05<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:09<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 2.8566838105519614
Epoch 307/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:37, 57.17s/it]  7%|▋         | 2/30 [00:58<11:21, 24.35s/it] 10%|█         | 3/30 [00:58<06:02, 13.44s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.31s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.73s/it] 20%|██        | 6/30 [01:01<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.8396393060684204
Epoch 308/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:46, 59.55s/it]  7%|▋         | 2/30 [00:59<11:33, 24.78s/it] 10%|█         | 3/30 [01:00<06:08, 13.67s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.45s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.56s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.817620062828064
Epoch 309/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:18, 60.64s/it]  7%|▋         | 2/30 [01:01<11:46, 25.23s/it] 10%|█         | 3/30 [01:01<06:15, 13.91s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.59s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.66s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.8465949455897013
Epoch 310/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:37, 57.14s/it]  7%|▋         | 2/30 [01:00<11:55, 25.56s/it] 10%|█         | 3/30 [01:01<06:29, 14.44s/it] 13%|█▎        | 4/30 [01:02<03:51,  8.91s/it] 17%|█▋        | 5/30 [01:02<02:26,  5.86s/it] 20%|██        | 6/30 [01:03<01:36,  4.02s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:04<00:45,  2.08s/it] 30%|███       | 9/30 [01:04<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.60it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.8349626541137694
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0583, -0.0839,  0.0824,  ..., -0.0566,  0.1043,  0.0625],
        [ 0.0249, -0.0315,  0.0861,  ..., -0.0169,  0.0958,  0.1025],
        [-0.0074, -0.0126,  0.0087,  ..., -0.0568,  0.0575,  0.1264],
        ...,
        [-0.0239, -0.0084,  0.0753,  ..., -0.0381,  0.0304,  0.0187],
        [-0.0684, -0.0984,  0.0333,  ..., -0.0322,  0.0883,  0.0136],
        [-0.0226, -0.0195,  0.0682,  ..., -0.0134,  0.0848,  0.0976]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8660, 0.8632, 0.8435,  ..., 0.7676, 0.7663, 0.7658],
        [0.9411, 0.9359, 0.9353,  ..., 0.9121, 0.9120, 0.9111],
        [0.9213, 0.8897, 0.8871,  ..., 0.8232, 0.8229, 0.8225],
        ...,
        [0.8466, 0.8375, 0.8299,  ..., 0.7612, 0.7603, 0.7577],
        [0.9179, 0.8848, 0.8519,  ..., 0.7995, 0.7993, 0.7970],
        [0.8684, 0.8529, 0.8496,  ..., 0.7929, 0.7924, 0.7913]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[235905.2031, 226601.4219, 171146.4375,  ...,  57837.6367,
          56776.3750,  56372.9648],
        [689829.3750, 640823.3750, 634970.5000,  ..., 455583.8438,
         455471.3125, 449141.3125],
        [520045.5312, 331112.2500, 319095.4062,  ..., 127936.7969,
         127391.0000, 126790.3203],
        ...,
        [178797.0312, 157155.2812, 140936.7812,  ...,  52801.0664,
          52119.1719,  50221.6523],
        [495241.3750, 308515.1875, 192800.5781,  ...,  91301.3359,
          91035.5547,  88051.9375],
        [244134.5156, 195672.4531, 186581.1562,  ...,  83024.2578,
          82469.8906,  81143.3203]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[235905.2031,      0.0000],
         [226601.4219,      0.0000],
         [171146.4375,      0.0000],
         ...,
         [ 57837.6367,      0.0000],
         [ 56776.3750,      0.0000],
         [ 56372.9648,      0.0000]],

        [[689829.3750,      0.0000],
         [640823.3750,      0.0000],
         [634970.5000,      0.0000],
         ...,
         [455583.8438,      0.0000],
         [455471.3125,      0.0000],
         [449141.3125,      0.0000]],

        [[520045.5312,      0.0000],
         [     0.0000, 331112.2500],
         [319095.4062,      0.0000],
         ...,
         [127936.7969,      0.0000],
         [127391.0000,      0.0000],
         [126790.3203,      0.0000]],

        ...,

        [[     0.0000, 178797.0312],
         [     0.0000, 157155.2812],
         [140936.7812,      0.0000],
         ...,
         [ 52801.0664,      0.0000],
         [ 52119.1719,      0.0000],
         [ 50221.6523,      0.0000]],

        [[495241.3750,      0.0000],
         [     0.0000, 308515.1875],
         [     0.0000, 192800.5781],
         ...,
         [ 91301.3359,      0.0000],
         [ 91035.5547,      0.0000],
         [ 88051.9375,      0.0000]],

        [[     0.0000, 244134.5156],
         [195672.4531,      0.0000],
         [     0.0000, 186581.1562],
         ...,
         [ 83024.2578,      0.0000],
         [ 82469.8906,      0.0000],
         [ 81143.3203,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1891863.8750,    80144.9844],
        [10787433.0000,        0.0000],
        [ 3347689.5000,   754291.6875],
        [ 4044128.0000,        0.0000],
        [ 1042729.7500,   703728.5625],
        [ 1860336.0000,   321574.2500],
        [ 3549502.0000,  1538949.3750],
        [ 4698713.5000,   157595.1875],
        [ 5355124.0000,   240964.8594],
        [ 4556012.0000,        0.0000],
        [ 7898532.5000,        0.0000],
        [ 2458498.7500,        0.0000],
        [ 3947327.0000,        0.0000],
        [12677608.0000,        0.0000],
        [13120906.0000,        0.0000],
        [10519733.0000,        0.0000],
        [ 8704685.0000,        0.0000],
        [10389898.0000,        0.0000],
        [ 5415469.0000,        0.0000],
        [ 6666480.5000,   302381.5312],
        [ 8346497.0000,        0.0000],
        [ 6002159.5000,        0.0000],
        [13019438.0000,        0.0000],
        [12580748.0000,        0.0000],
        [ 4536797.5000,        0.0000],
        [11250954.0000,        0.0000],
        [10356280.0000,        0.0000],
        [13594754.0000,        0.0000],
        [12595185.0000,        0.0000],
        [11835939.0000,        0.0000],
        [15149474.0000,        0.0000],
        [11782768.0000,        0.0000],
        [ 3742944.0000,   126969.5234],
        [ 3500631.0000,  1224319.6250],
        [ 4836179.0000,  1776089.1250],
        [ 2012490.0000,  1795582.3750],
        [ 2208486.5000,  1130875.5000],
        [ 1816583.0000,   940739.8750],
        [ 1526827.0000,  1173293.2500],
        [ 9563064.0000,        0.0000],
        [ 3092377.7500,   444370.6875],
        [ 4602252.0000,        0.0000],
        [ 4232386.5000,        0.0000],
        [ 3383950.7500,        0.0000],
        [ 1966899.3750,  1390239.0000],
        [  419223.0000,   478401.4688],
        [ 5330235.5000,   271167.0625],
        [  900927.9375,   444891.4062],
        [  432980.9688,   387475.3125],
        [ 2955156.2500,  1517697.1250],
        [ 1540551.0000,   372322.1562],
        [ 3318364.0000,  1053488.5000],
        [ 3237392.2500,  2241033.7500],
        [ 4549064.0000,   207806.5312],
        [ 7697562.5000,   418156.1562],
        [ 4904942.0000,   251138.4688],
        [ 4033383.0000,  1546635.7500],
        [ 3971820.0000,  1379370.7500],
        [ 2444760.0000,  1281657.1250],
        [ 1359323.0000,  1081604.5000],
        [ 4254478.5000,   588964.0000],
        [ 1118879.5000,   641218.4375],
        [ 1967763.5000,  1026141.0000],
        [ 1501478.2500,   777843.4375]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 311/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:51, 55.56s/it]  7%|▋         | 2/30 [00:56<10:51, 23.27s/it] 10%|█         | 3/30 [00:56<05:46, 12.85s/it] 13%|█▎        | 4/30 [01:00<04:05,  9.44s/it] 17%|█▋        | 5/30 [01:01<02:34,  6.20s/it] 20%|██        | 6/30 [01:01<01:41,  4.24s/it] 23%|██▎       | 7/30 [01:02<01:08,  3.00s/it] 27%|██▋       | 8/30 [01:02<00:48,  2.18s/it] 30%|███       | 9/30 [01:03<00:34,  1.64s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.27s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.01s/it] 40%|████      | 12/30 [01:04<00:15,  1.19it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.39it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.58it/s] 50%|█████     | 15/30 [01:05<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.97it/s] 60%|██████    | 18/30 [01:07<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.806961750984192
Epoch 312/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:25, 56.74s/it]  7%|▋         | 2/30 [00:58<11:29, 24.63s/it] 10%|█         | 3/30 [01:00<06:15, 13.89s/it] 13%|█▎        | 4/30 [01:00<03:46,  8.72s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.73s/it] 20%|██        | 6/30 [01:01<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.775020972887675
Epoch 313/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:12, 60.43s/it]  7%|▋         | 2/30 [01:00<11:43, 25.14s/it] 10%|█         | 3/30 [01:01<06:14, 13.86s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.56s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.63s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.812710420290629
Epoch 314/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:46, 59.54s/it]  7%|▋         | 2/30 [00:59<11:33, 24.78s/it] 10%|█         | 3/30 [01:00<06:15, 13.90s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.59s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.65s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.86850323677063
Epoch 315/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:22, 60.77s/it]  7%|▋         | 2/30 [01:01<11:47, 25.28s/it] 10%|█         | 3/30 [01:01<06:16, 13.94s/it] 13%|█▎        | 4/30 [01:02<03:43,  8.61s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.66s/it] 20%|██        | 6/30 [01:02<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.830001886685689
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0584, -0.0849,  0.0820,  ..., -0.0564,  0.1033,  0.0622],
        [ 0.0255, -0.0310,  0.0855,  ..., -0.0166,  0.0957,  0.1020],
        [-0.0069, -0.0126,  0.0085,  ..., -0.0563,  0.0576,  0.1258],
        ...,
        [-0.0229, -0.0078,  0.0748,  ..., -0.0392,  0.0302,  0.0186],
        [-0.0679, -0.0992,  0.0327,  ..., -0.0326,  0.0885,  0.0138],
        [-0.0229, -0.0195,  0.0670,  ..., -0.0127,  0.0854,  0.0977]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8645, 0.8620, 0.8418,  ..., 0.7659, 0.7646, 0.7644],
        [0.9403, 0.9347, 0.9342,  ..., 0.9107, 0.9103, 0.9100],
        [0.9199, 0.8880, 0.8851,  ..., 0.8210, 0.8210, 0.8204],
        ...,
        [0.8462, 0.8360, 0.8283,  ..., 0.7602, 0.7573, 0.7553],
        [0.9171, 0.8841, 0.8495,  ..., 0.7981, 0.7964, 0.7951],
        [0.8670, 0.8509, 0.8481,  ..., 0.7897, 0.7886, 0.7885]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[231109.9531, 222998.1094, 167016.5781,  ...,  56461.1523,
          55448.5117,  55272.5977],
        [682106.7500, 629657.3750, 625435.1250,  ..., 446806.5625,
         444336.4688, 442419.7188],
        [509897.4375, 323019.4062, 309928.0312,  ..., 124104.2344,
         124052.9922, 122989.8672],
        ...,
        [177907.4531, 153739.5312, 137646.5156,  ...,  52073.8086,
          49939.2500,  48552.0117],
        [489904.5625, 305475.0625, 186381.6094,  ...,  89423.2812,
          87323.0625,  85670.4297],
        [239384.0000, 190069.7812, 182738.6562,  ...,  79333.5938,
          78050.0938,  78006.6406]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[231109.9531,      0.0000],
         [222998.1094,      0.0000],
         [167016.5781,      0.0000],
         ...,
         [ 56461.1523,      0.0000],
         [ 55448.5117,      0.0000],
         [ 55272.5977,      0.0000]],

        [[682106.7500,      0.0000],
         [629657.3750,      0.0000],
         [625435.1250,      0.0000],
         ...,
         [446806.5625,      0.0000],
         [444336.4688,      0.0000],
         [442419.7188,      0.0000]],

        [[509897.4375,      0.0000],
         [     0.0000, 323019.4062],
         [309928.0312,      0.0000],
         ...,
         [124104.2344,      0.0000],
         [124052.9922,      0.0000],
         [122989.8672,      0.0000]],

        ...,

        [[     0.0000, 177907.4531],
         [     0.0000, 153739.5312],
         [137646.5156,      0.0000],
         ...,
         [ 52073.8086,      0.0000],
         [ 49939.2500,      0.0000],
         [ 48552.0117,      0.0000]],

        [[489904.5625,      0.0000],
         [     0.0000, 305475.0625],
         [     0.0000, 186381.6094],
         ...,
         [ 89423.2812,      0.0000],
         [ 87323.0625,      0.0000],
         [ 85670.4297,      0.0000]],

        [[     0.0000, 239384.0000],
         [190069.7812,      0.0000],
         [     0.0000, 182738.6562],
         ...,
         [ 79333.5938,      0.0000],
         [ 78050.0938,      0.0000],
         [ 78006.6406,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1856247.5000,    77866.0234],
        [10618626.0000,        0.0000],
        [ 3243128.5000,   732338.1875],
        [ 3980596.0000,        0.0000],
        [ 1012637.5000,   693185.4375],
        [ 1785369.7500,   310462.3438],
        [ 3417537.2500,  1493315.5000],
        [ 4539242.0000,   153139.8594],
        [ 5205405.0000,   231461.1094],
        [ 4487324.5000,        0.0000],
        [ 7752647.0000,        0.0000],
        [ 2386403.5000,        0.0000],
        [ 3867833.5000,        0.0000],
        [12503440.0000,        0.0000],
        [13014784.0000,        0.0000],
        [10415451.0000,        0.0000],
        [ 8539468.0000,        0.0000],
        [10249504.0000,        0.0000],
        [ 5271201.0000,        0.0000],
        [ 6554733.0000,   298073.0625],
        [ 8168608.5000,        0.0000],
        [ 5867536.5000,        0.0000],
        [12900490.0000,        0.0000],
        [12486750.0000,        0.0000],
        [ 4413714.0000,        0.0000],
        [11171972.0000,        0.0000],
        [10253194.0000,        0.0000],
        [13510688.0000,        0.0000],
        [12450608.0000,        0.0000],
        [11721835.0000,        0.0000],
        [15005946.0000,        0.0000],
        [11678670.0000,        0.0000],
        [ 3671694.5000,   124817.9375],
        [ 3412322.7500,  1205554.0000],
        [ 4743837.0000,  1753730.0000],
        [ 1960483.6250,  1767891.3750],
        [ 2154671.0000,  1118785.5000],
        [ 1774454.2500,   920874.8125],
        [ 1493777.3750,  1149721.2500],
        [ 9375474.0000,        0.0000],
        [ 3042748.0000,   432610.9375],
        [ 4538697.5000,        0.0000],
        [ 4172906.5000,        0.0000],
        [ 3340022.0000,        0.0000],
        [ 1922754.7500,  1366750.8750],
        [  413787.5625,   469136.4688],
        [ 5205147.5000,   266306.9688],
        [  850634.3750,   465630.8438],
        [  423175.5625,   379714.4688],
        [ 2850120.7500,  1475992.7500],
        [ 1502856.3750,   371071.8438],
        [ 3223528.7500,  1044937.8125],
        [ 3178422.5000,  2207670.0000],
        [ 4486874.0000,   204467.7656],
        [ 7587360.5000,   412198.8750],
        [ 4816994.5000,   246787.4375],
        [ 3937724.0000,  1514526.8750],
        [ 3919043.5000,  1360144.0000],
        [ 2396757.5000,  1256398.5000],
        [ 1267528.6250,  1125220.5000],
        [ 4160063.5000,   573498.7500],
        [ 1086778.2500,   629887.7500],
        [ 1916824.3750,  1003178.2500],
        [ 1442660.6250,   765326.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 316/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:57, 57.84s/it]  7%|▋         | 2/30 [00:58<11:14, 24.08s/it] 10%|█         | 3/30 [00:59<06:13, 13.84s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.63s/it] 20%|██        | 6/30 [01:01<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.849999928474426
Epoch 317/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:20, 58.63s/it]  7%|▋         | 2/30 [01:00<11:39, 24.98s/it] 10%|█         | 3/30 [01:00<06:11, 13.77s/it] 13%|█▎        | 4/30 [01:01<03:44,  8.65s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.69s/it] 20%|██        | 6/30 [01:02<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.83107533454895
Epoch 318/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:39, 59.28s/it]  7%|▋         | 2/30 [01:01<11:53, 25.49s/it] 10%|█         | 3/30 [01:01<06:19, 14.05s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.71s/it] 20%|██        | 6/30 [01:02<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.8044889132181803
Epoch 319/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:24, 60.85s/it]  7%|▋         | 2/30 [01:01<11:48, 25.31s/it] 10%|█         | 3/30 [01:01<06:16, 13.96s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.67s/it] 20%|██        | 6/30 [01:03<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.7882662296295164
Epoch 320/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:34, 57.04s/it]  7%|▋         | 2/30 [00:57<11:04, 23.75s/it] 10%|█         | 3/30 [00:59<06:16, 13.93s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.76s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.76s/it] 20%|██        | 6/30 [01:01<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.7529834191004436
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0585, -0.0859,  0.0817,  ..., -0.0562,  0.1025,  0.0620],
        [ 0.0259, -0.0304,  0.0850,  ..., -0.0162,  0.0957,  0.1018],
        [-0.0065, -0.0122,  0.0085,  ..., -0.0559,  0.0579,  0.1252],
        ...,
        [-0.0220, -0.0071,  0.0747,  ..., -0.0399,  0.0299,  0.0184],
        [-0.0675, -0.0999,  0.0322,  ..., -0.0328,  0.0886,  0.0139],
        [-0.0232, -0.0192,  0.0658,  ..., -0.0121,  0.0860,  0.0980]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8629, 0.8607, 0.8400,  ..., 0.7640, 0.7631, 0.7630],
        [0.9396, 0.9335, 0.9331,  ..., 0.9092, 0.9090, 0.9084],
        [0.9186, 0.8864, 0.8831,  ..., 0.8187, 0.8183, 0.8182],
        ...,
        [0.8457, 0.8348, 0.8265,  ..., 0.7596, 0.7550, 0.7542],
        [0.9164, 0.8834, 0.8472,  ..., 0.7959, 0.7934, 0.7932],
        [0.8654, 0.8487, 0.8467,  ..., 0.7868, 0.7856, 0.7855]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[225820.9062, 218659.0625, 162825.9062,  ...,  54942.1367,
          54262.0781,  54210.3008],
        [675328.5625, 618500.0000, 615715.7500,  ..., 437225.7500,
         435881.8438, 432713.4062],
        [500368.5625, 315574.9062, 301130.2812,  ..., 119994.9297,
         119358.6328, 119122.5625],
        ...,
        [176684.6719, 151095.7031, 134290.8281,  ...,  51587.6250,
          48312.5273,  47786.3867],
        [484739.8750, 302662.5312, 180286.6719,  ...,  86640.2031,
          83597.4141,  83428.8125],
        [234016.6875, 184313.3438, 179003.4688,  ...,  76126.6953,
          74834.4688,  74699.4922]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[225820.9062,      0.0000],
         [218659.0625,      0.0000],
         [162825.9062,      0.0000],
         ...,
         [ 54942.1367,      0.0000],
         [ 54262.0781,      0.0000],
         [ 54210.3008,      0.0000]],

        [[675328.5625,      0.0000],
         [618500.0000,      0.0000],
         [615715.7500,      0.0000],
         ...,
         [437225.7500,      0.0000],
         [435881.8438,      0.0000],
         [432713.4062,      0.0000]],

        [[500368.5625,      0.0000],
         [     0.0000, 315574.9062],
         [301130.2812,      0.0000],
         ...,
         [119994.9297,      0.0000],
         [119358.6328,      0.0000],
         [119122.5625,      0.0000]],

        ...,

        [[     0.0000, 176684.6719],
         [     0.0000, 151095.7031],
         [134290.8281,      0.0000],
         ...,
         [ 51587.6250,      0.0000],
         [ 48312.5273,      0.0000],
         [ 47786.3867,      0.0000]],

        [[484739.8750,      0.0000],
         [     0.0000, 302662.5312],
         [     0.0000, 180286.6719],
         ...,
         [ 86640.2031,      0.0000],
         [ 83597.4141,      0.0000],
         [ 83428.8125,      0.0000]],

        [[     0.0000, 234016.6875],
         [184313.3438,      0.0000],
         [     0.0000, 179003.4688],
         ...,
         [ 76126.6953,      0.0000],
         [ 74834.4688,      0.0000],
         [ 74699.4922,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1817340.0000,    75831.4219],
        [10447668.0000,        0.0000],
        [ 3141821.7500,   711315.3750],
        [ 3918501.7500,        0.0000],
        [  983725.9375,   682128.3750],
        [ 1716008.5000,   299948.4062],
        [ 3295761.0000,  1452312.2500],
        [ 4384004.0000,   148794.3281],
        [ 5058972.5000,   222510.1406],
        [ 4416670.0000,        0.0000],
        [ 7602189.0000,        0.0000],
        [ 2313833.0000,        0.0000],
        [ 3789695.7500,        0.0000],
        [12330396.0000,        0.0000],
        [12905927.0000,        0.0000],
        [10311264.0000,        0.0000],
        [ 8375916.0000,        0.0000],
        [10109163.0000,        0.0000],
        [ 5129205.0000,        0.0000],
        [ 6442265.5000,   293926.0625],
        [ 8004681.5000,        0.0000],
        [ 5736081.0000,        0.0000],
        [12779792.0000,        0.0000],
        [12389537.0000,        0.0000],
        [ 4295417.5000,        0.0000],
        [11087460.0000,        0.0000],
        [10145619.0000,        0.0000],
        [13424131.0000,        0.0000],
        [12306357.0000,        0.0000],
        [11609118.0000,        0.0000],
        [14865720.0000,        0.0000],
        [11576870.0000,        0.0000],
        [ 3599835.7500,   122667.0234],
        [ 3321337.2500,  1184107.1250],
        [ 4649884.5000,  1730364.2500],
        [ 1909171.0000,  1737857.0000],
        [ 2199524.0000,  1011601.6875],
        [ 1729976.3750,   900204.8750],
        [ 1461549.2500,  1125230.5000],
        [ 9183353.0000,        0.0000],
        [ 2990830.5000,   421320.3125],
        [ 4470804.0000,        0.0000],
        [ 4104917.0000,        0.0000],
        [ 3292537.2500,        0.0000],
        [ 1880418.3750,  1345595.7500],
        [  407679.0000,   458940.7500],
        [ 5079061.0000,   261564.6562],
        [  828887.6250,   458823.4375],
        [  413006.8438,   371255.0000],
        [ 2750830.0000,  1436340.0000],
        [ 1464415.7500,   369481.2812],
        [ 3132191.7500,  1036586.2500],
        [ 3119118.2500,  2171039.5000],
        [ 4422558.0000,   201046.0781],
        [ 7477697.5000,   406056.0625],
        [ 4729510.5000,   242449.5938],
        [ 3845361.0000,  1484280.0000],
        [ 4046329.5000,  1164010.7500],
        [ 2346321.5000,  1230016.2500],
        [ 1241848.2500,  1104496.6250],
        [ 3883648.2500,   741341.9375],
        [ 1055753.8750,   619967.7500],
        [ 1868337.7500,   981272.2500],
        [ 1384595.8750,   751343.3750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 321/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:28, 56.83s/it]  7%|▋         | 2/30 [00:57<11:06, 23.80s/it] 10%|█         | 3/30 [00:58<05:56, 13.19s/it] 13%|█▎        | 4/30 [01:00<03:48,  8.80s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.79s/it] 20%|██        | 6/30 [01:01<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.06s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.821165132522583
Epoch 322/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:03, 58.04s/it]  7%|▋         | 2/30 [00:58<11:16, 24.16s/it] 10%|█         | 3/30 [00:58<05:59, 13.33s/it] 13%|█▎        | 4/30 [00:59<03:37,  8.38s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.52s/it] 20%|██        | 6/30 [01:00<01:31,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:01<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 2.7867852210998536
Epoch 323/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:01, 60.04s/it]  7%|▋         | 2/30 [01:00<11:39, 24.98s/it] 10%|█         | 3/30 [01:00<06:11, 13.78s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.60s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.794932174682617
Epoch 324/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:57, 55.76s/it]  7%|▋         | 2/30 [00:57<11:14, 24.10s/it] 10%|█         | 3/30 [00:59<06:18, 14.01s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.66s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.69s/it] 20%|██        | 6/30 [01:01<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.768186910947164
Epoch 325/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:22, 56.63s/it]  7%|▋         | 2/30 [00:57<11:12, 24.03s/it] 10%|█         | 3/30 [00:58<05:57, 13.26s/it] 13%|█▎        | 4/30 [00:58<03:33,  8.20s/it] 17%|█▋        | 5/30 [00:59<02:15,  5.40s/it] 20%|██        | 6/30 [00:59<01:30,  3.77s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.68s/it] 27%|██▋       | 8/30 [01:00<00:43,  1.97s/it] 30%|███       | 9/30 [01:01<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:01<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:03<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.16it/s] 70%|███████   | 21/30 [01:06<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch loss is 2.812614885965983
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0585, -0.0869,  0.0813,  ..., -0.0559,  0.1018,  0.0619],
        [ 0.0264, -0.0297,  0.0846,  ..., -0.0158,  0.0957,  0.1016],
        [-0.0061, -0.0122,  0.0084,  ..., -0.0554,  0.0583,  0.1246],
        ...,
        [-0.0209, -0.0062,  0.0745,  ..., -0.0404,  0.0296,  0.0184],
        [-0.0669, -0.1006,  0.0317,  ..., -0.0330,  0.0887,  0.0141],
        [-0.0235, -0.0189,  0.0647,  ..., -0.0115,  0.0866,  0.0982]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8614, 0.8594, 0.8385,  ..., 0.7625, 0.7622, 0.7619],
        [0.9390, 0.9323, 0.9321,  ..., 0.9079, 0.9077, 0.9067],
        [0.9174, 0.8849, 0.8812,  ..., 0.8164, 0.8162, 0.8158],
        ...,
        [0.8453, 0.8337, 0.8247,  ..., 0.7575, 0.7545, 0.7512],
        [0.9158, 0.8830, 0.8450,  ..., 0.7928, 0.7919, 0.7916],
        [0.8640, 0.8467, 0.8453,  ..., 0.7842, 0.7830, 0.7829]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 0],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[221008.1562, 214664.7031, 159324.4219,  ...,  53784.0234,
          53570.0938,  53357.4297],
        [669077.5625, 608216.9375, 606256.1250,  ..., 429588.0312,
         428191.2500, 422200.0938],
        [491754.4688, 308901.4688, 293280.6562,  ..., 116153.3203,
         115802.4766, 115131.4297],
        ...,
        [175609.3750, 148656.5938, 130869.3516,  ...,  50058.2656,
          48010.9453,  45740.9883],
        [480483.9375, 300624.1250, 174694.6875,  ...,  82891.9766,
          81811.0156,  81509.3203],
        [229390.6250, 179045.1250, 175648.7500,  ...,  73328.8359,
          72113.4609,  71946.8125]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[221008.1562,      0.0000],
         [214664.7031,      0.0000],
         [159324.4219,      0.0000],
         ...,
         [ 53784.0234,      0.0000],
         [ 53570.0938,      0.0000],
         [ 53357.4297,      0.0000]],

        [[669077.5625,      0.0000],
         [608216.9375,      0.0000],
         [606256.1250,      0.0000],
         ...,
         [429588.0312,      0.0000],
         [428191.2500,      0.0000],
         [422200.0938,      0.0000]],

        [[491754.4688,      0.0000],
         [     0.0000, 308901.4688],
         [293280.6562,      0.0000],
         ...,
         [116153.3203,      0.0000],
         [115802.4766,      0.0000],
         [115131.4297,      0.0000]],

        ...,

        [[     0.0000, 175609.3750],
         [     0.0000, 148656.5938],
         [130869.3516,      0.0000],
         ...,
         [ 50058.2656,      0.0000],
         [ 48010.9453,      0.0000],
         [ 45740.9883,      0.0000]],

        [[480483.9375,      0.0000],
         [     0.0000, 300624.1250],
         [     0.0000, 174694.6875],
         ...,
         [ 82891.9766,      0.0000],
         [ 81811.0156,      0.0000],
         [ 81509.3203,      0.0000]],

        [[     0.0000, 229390.6250],
         [179045.1250,      0.0000],
         [     0.0000, 175648.7500],
         ...,
         [ 73328.8359,      0.0000],
         [ 72113.4609,      0.0000],
         [ 71946.8125,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1782951.2500,    74225.9766],
        [10289409.0000,        0.0000],
        [ 3050105.7500,   692167.2500],
        [ 3867059.2500,        0.0000],
        [  958320.7500,   672566.0000],
        [ 1654606.5000,   290874.5000],
        [ 3190047.5000,  1414087.2500],
        [ 4246681.0000,   144819.9375],
        [ 4932081.0000,   214861.9375],
        [ 4360859.0000,        0.0000],
        [ 7464895.0000,        0.0000],
        [ 2246145.0000,        0.0000],
        [ 3715859.7500,        0.0000],
        [12179604.0000,        0.0000],
        [12802198.0000,        0.0000],
        [10217567.0000,        0.0000],
        [ 8217753.0000,        0.0000],
        [ 9985365.0000,        0.0000],
        [ 5003366.5000,        0.0000],
        [ 6339282.5000,   289869.6562],
        [ 7848193.0000,        0.0000],
        [ 5615334.0000,        0.0000],
        [12664796.0000,        0.0000],
        [12300217.0000,        0.0000],
        [ 4189702.2500,        0.0000],
        [11005012.0000,        0.0000],
        [10055932.0000,        0.0000],
        [13344650.0000,        0.0000],
        [12172174.0000,        0.0000],
        [11503115.0000,        0.0000],
        [14737992.0000,        0.0000],
        [11477944.0000,        0.0000],
        [ 3531596.0000,   120669.4688],
        [ 3236468.5000,  1165248.5000],
        [ 4343952.0000,  1928405.5000],
        [ 1862416.7500,  1712208.3750],
        [ 2150346.2500,  1006360.1250],
        [ 1690152.2500,   882306.2500],
        [ 1436203.2500,  1105827.2500],
        [ 9014898.0000,        0.0000],
        [ 2943879.5000,   410576.3750],
        [ 4405526.5000,        0.0000],
        [ 4042128.0000,        0.0000],
        [ 3247184.5000,        0.0000],
        [ 1732848.2500,  1429975.3750],
        [  402111.4062,   450275.8125],
        [ 4969342.0000,   257558.0938],
        [  809256.0625,   452582.9062],
        [  404342.8125,   364410.6250],
        [ 2660806.7500,  1399182.2500],
        [ 1430617.0000,   368378.6250],
        [ 3051841.5000,  1029914.6250],
        [ 3063765.7500,  2139102.5000],
        [ 4358398.0000,   197801.3906],
        [ 7376057.0000,   399681.8438],
        [ 4649991.0000,   237944.8281],
        [ 3758094.0000,  1456121.6250],
        [ 3992681.5000,  1152665.2500],
        [ 2298831.7500,  1207388.0000],
        [ 1219779.8750,  1086308.5000],
        [ 3802275.5000,   727738.6250],
        [ 1025630.5000,   610549.0000],
        [ 1828417.0000,   962790.6250],
        [ 1333731.2500,   739189.5625]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 51.5625
Top1 accuracy for validation set is 51.5625 size is torch.Size([64, 1])
Epoch 326/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:52, 57.66s/it]  7%|▋         | 2/30 [00:58<11:13, 24.06s/it] 10%|█         | 3/30 [00:58<05:58, 13.27s/it] 13%|█▎        | 4/30 [00:59<03:37,  8.38s/it] 17%|█▋        | 5/30 [00:59<02:17,  5.52s/it] 20%|██        | 6/30 [01:00<01:30,  3.79s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.69s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.08s/it] 30%|███       | 9/30 [01:02<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:03<00:12,  1.42it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.60it/s] 50%|█████     | 15/30 [01:04<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.97it/s] 60%|██████    | 18/30 [01:06<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 2.7973652839660645
Epoch 327/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:55, 55.70s/it]  7%|▋         | 2/30 [00:56<10:49, 23.20s/it] 10%|█         | 3/30 [00:59<06:22, 14.18s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.76s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.76s/it] 20%|██        | 6/30 [01:00<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.7295318682988485
Epoch 328/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:42, 59.39s/it]  7%|▋         | 2/30 [00:59<11:31, 24.71s/it] 10%|█         | 3/30 [01:00<06:11, 13.74s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.49s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:01<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.759785358111064
Epoch 329/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:12, 56.30s/it]  7%|▋         | 2/30 [01:00<11:58, 25.65s/it] 10%|█         | 3/30 [01:00<06:21, 14.14s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.73s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.74s/it] 20%|██        | 6/30 [01:02<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.43s/it]
Epoch loss is 2.7286391735076903
Epoch 330/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:04, 58.09s/it]  7%|▋         | 2/30 [01:00<11:53, 25.49s/it] 10%|█         | 3/30 [01:01<06:19, 14.05s/it] 13%|█▎        | 4/30 [01:01<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.71s/it] 20%|██        | 6/30 [01:02<01:33,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.7906829357147216
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0588, -0.0878,  0.0810,  ..., -0.0555,  0.1011,  0.0619],
        [ 0.0270, -0.0290,  0.0843,  ..., -0.0155,  0.0958,  0.1015],
        [-0.0056, -0.0118,  0.0083,  ..., -0.0551,  0.0586,  0.1241],
        ...,
        [-0.0199, -0.0055,  0.0743,  ..., -0.0411,  0.0293,  0.0183],
        [-0.0663, -0.1013,  0.0313,  ..., -0.0333,  0.0888,  0.0142],
        [-0.0236, -0.0187,  0.0638,  ..., -0.0109,  0.0873,  0.0984]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8600, 0.8581, 0.8371,  ..., 0.7613, 0.7609, 0.7608],
        [0.9383, 0.9311, 0.9311,  ..., 0.9069, 0.9063, 0.9051],
        [0.9162, 0.8835, 0.8795,  ..., 0.8144, 0.8142, 0.8133],
        ...,
        [0.8451, 0.8323, 0.8232,  ..., 0.7547, 0.7536, 0.7498],
        [0.9151, 0.8823, 0.8428,  ..., 0.7907, 0.7899, 0.7897],
        [0.8626, 0.8448, 0.8442,  ..., 0.7817, 0.7808, 0.7803]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 1],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[216557.8594, 210786.1406, 156110.2500,  ...,  52913.6328,
          52579.9688,  52499.0000],
        [663058.3750, 598341.0000, 598145.8750,  ..., 423534.1562,
         419782.3438, 412299.5000],
        [483627.5312, 302843.8438, 285980.4688,  ..., 112858.0781,
         112550.7891, 111201.0234],
        ...,
        [175132.5625, 145835.1406, 127967.0625,  ...,  48101.5078,
          47388.5156,  44845.3711],
        [475539.1562, 298025.3125, 169474.9844,  ...,  80520.9922,
          79597.9297,  79337.5234],
        [224835.4219, 174378.2500, 172709.0000,  ...,  70722.5078,
          69817.4844,  69319.6328]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[216557.8594,      0.0000],
         [210786.1406,      0.0000],
         [156110.2500,      0.0000],
         ...,
         [ 52913.6328,      0.0000],
         [ 52579.9688,      0.0000],
         [ 52499.0000,      0.0000]],

        [[663058.3750,      0.0000],
         [598341.0000,      0.0000],
         [598145.8750,      0.0000],
         ...,
         [423534.1562,      0.0000],
         [419782.3438,      0.0000],
         [412299.5000,      0.0000]],

        [[483627.5312,      0.0000],
         [     0.0000, 302843.8438],
         [285980.4688,      0.0000],
         ...,
         [112858.0781,      0.0000],
         [112550.7891,      0.0000],
         [111201.0234,      0.0000]],

        ...,

        [[     0.0000, 175132.5625],
         [     0.0000, 145835.1406],
         [127967.0625,      0.0000],
         ...,
         [ 48101.5078,      0.0000],
         [ 47388.5156,      0.0000],
         [     0.0000,  44845.3711]],

        [[475539.1562,      0.0000],
         [     0.0000, 298025.3125],
         [     0.0000, 169474.9844],
         ...,
         [ 80520.9922,      0.0000],
         [ 79597.9297,      0.0000],
         [ 79337.5234,      0.0000]],

        [[     0.0000, 224835.4219],
         [174378.2500,      0.0000],
         [     0.0000, 172709.0000],
         ...,
         [ 70722.5078,      0.0000],
         [ 69817.4844,      0.0000],
         [ 69319.6328,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1750546.6250,    72486.0000],
        [10145054.0000,        0.0000],
        [ 2964855.0000,   674468.0000],
        [ 3818903.7500,        0.0000],
        [  933060.1875,   663084.5000],
        [ 1596972.0000,   282297.3438],
        [ 3092814.0000,  1379001.3750],
        [ 4118710.5000,   141241.8125],
        [ 4815193.0000,   207047.1250],
        [ 4303462.0000,        0.0000],
        [ 7342179.5000,        0.0000],
        [ 2181853.0000,        0.0000],
        [ 3644765.7500,        0.0000],
        [12036512.0000,        0.0000],
        [12704381.0000,        0.0000],
        [10134072.0000,        0.0000],
        [ 8072785.0000,        0.0000],
        [ 9866947.0000,        0.0000],
        [ 4891554.0000,        0.0000],
        [ 6247072.0000,   285728.8125],
        [ 7704855.5000,        0.0000],
        [ 5505249.0000,        0.0000],
        [12562023.0000,        0.0000],
        [12217412.0000,        0.0000],
        [ 4091037.5000,        0.0000],
        [10934920.0000,        0.0000],
        [ 9977983.0000,        0.0000],
        [13277826.0000,        0.0000],
        [12050923.0000,        0.0000],
        [11409404.0000,        0.0000],
        [14615372.0000,        0.0000],
        [11393009.0000,        0.0000],
        [ 3470209.5000,   118811.1328],
        [ 3153953.0000,  1148345.0000],
        [ 4268695.0000,  1906631.7500],
        [ 1698548.5000,  1808430.5000],
        [ 2106574.2500,  1001040.5000],
        [ 1651432.6250,   865791.5625],
        [ 1409094.6250,  1086662.6250],
        [ 8860379.0000,        0.0000],
        [ 2900645.5000,   400654.8750],
        [ 4346009.0000,        0.0000],
        [ 3987335.7500,        0.0000],
        [ 3207734.0000,        0.0000],
        [ 1696527.2500,  1407324.2500],
        [  396583.8750,   442376.5625],
        [ 4860121.0000,   253698.3125],
        [  793379.6250,   447371.6250],
        [  396661.2500,   358350.8125],
        [ 2578397.2500,  1365105.6250],
        [ 1400166.1250,   367505.1250],
        [ 2975445.5000,  1022760.0625],
        [ 3014185.0000,  2110699.2500],
        [ 4300642.5000,   194619.1094],
        [ 7281691.0000,   393759.0312],
        [ 4575058.5000,   233873.2344],
        [ 3679187.5000,  1429172.2500],
        [ 3942356.5000,  1141843.0000],
        [ 2257340.7500,  1185887.2500],
        [ 1198247.1250,  1067868.0000],
        [ 3724160.0000,   714191.4375],
        [  955009.0625,   645666.2500],
        [ 1789922.1250,   944655.3125],
        [ 1287510.5000,   727792.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 331/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:55, 57.77s/it]  7%|▋         | 2/30 [00:58<11:13, 24.05s/it] 10%|█         | 3/30 [01:01<06:30, 14.47s/it] 13%|█▎        | 4/30 [01:01<03:52,  8.93s/it] 17%|█▋        | 5/30 [01:02<02:26,  5.87s/it] 20%|██        | 6/30 [01:02<01:36,  4.02s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.08s/it] 30%|███       | 9/30 [01:03<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.773632216453552
Epoch 332/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:41, 59.37s/it]  7%|▋         | 2/30 [00:59<11:31, 24.71s/it] 10%|█         | 3/30 [01:00<06:07, 13.63s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.42s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.54s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.24it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.25it/s]100%|██████████| 30/30 [01:12<00:00,  2.25it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.797761829694112
Epoch 333/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:07, 56.12s/it]  7%|▋         | 2/30 [01:01<12:16, 26.31s/it] 10%|█         | 3/30 [01:02<06:31, 14.50s/it] 13%|█▎        | 4/30 [01:02<03:52,  8.95s/it] 17%|█▋        | 5/30 [01:02<02:27,  5.88s/it] 20%|██        | 6/30 [01:03<01:36,  4.03s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.86s/it] 27%|██▋       | 8/30 [01:04<00:45,  2.09s/it] 30%|███       | 9/30 [01:04<00:33,  1.57s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:10,  1.60it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 2.782403588294983
Epoch 334/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:27, 56.82s/it]  7%|▋         | 2/30 [00:57<11:02, 23.66s/it] 10%|█         | 3/30 [00:57<05:52, 13.06s/it] 13%|█▎        | 4/30 [00:58<03:29,  8.08s/it] 17%|█▋        | 5/30 [00:58<02:13,  5.32s/it] 20%|██        | 6/30 [00:59<01:27,  3.66s/it] 23%|██▎       | 7/30 [00:59<01:00,  2.61s/it] 27%|██▋       | 8/30 [00:59<00:42,  1.92s/it] 30%|███       | 9/30 [01:00<00:30,  1.46s/it] 33%|███▎      | 10/30 [01:00<00:22,  1.14s/it] 37%|███▋      | 11/30 [01:01<00:17,  1.08it/s] 40%|████      | 12/30 [01:01<00:14,  1.28it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.48it/s] 47%|████▋     | 14/30 [01:02<00:09,  1.65it/s] 50%|█████     | 15/30 [01:03<00:08,  1.80it/s] 53%|█████▎    | 16/30 [01:03<00:07,  1.92it/s] 57%|█████▋    | 17/30 [01:03<00:06,  2.01it/s] 60%|██████    | 18/30 [01:04<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:04<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:05<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:06<00:03,  2.23it/s] 80%|████████  | 24/30 [01:06<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:07<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:08<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:08<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch loss is 2.760595965385437
Epoch 335/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:33, 59.09s/it]  7%|▋         | 2/30 [00:59<11:28, 24.60s/it] 10%|█         | 3/30 [00:59<06:06, 13.57s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.39s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.52s/it] 20%|██        | 6/30 [01:01<01:31,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.7464227358500164
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0591, -0.0886,  0.0808,  ..., -0.0553,  0.1005,  0.0619],
        [ 0.0276, -0.0283,  0.0841,  ..., -0.0152,  0.0958,  0.1014],
        [-0.0049, -0.0115,  0.0083,  ..., -0.0548,  0.0588,  0.1236],
        ...,
        [-0.0192, -0.0048,  0.0741,  ..., -0.0419,  0.0290,  0.0183],
        [-0.0656, -0.1018,  0.0309,  ..., -0.0336,  0.0889,  0.0144],
        [-0.0236, -0.0185,  0.0631,  ..., -0.0105,  0.0878,  0.0986]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8587, 0.8568, 0.8357,  ..., 0.7606, 0.7597, 0.7595],
        [0.9377, 0.9301, 0.9300,  ..., 0.9060, 0.9050, 0.9035],
        [0.9151, 0.8821, 0.8778,  ..., 0.8121, 0.8118, 0.8112],
        ...,
        [0.8450, 0.8310, 0.8217,  ..., 0.7528, 0.7521, 0.7490],
        [0.9144, 0.8818, 0.8410,  ..., 0.7898, 0.7884, 0.7868],
        [0.8614, 0.8432, 0.8430,  ..., 0.7792, 0.7788, 0.7779]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 1],
        [0, 1, 1,  ..., 0, 0, 0],
        [1, 0, 1,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[212655.0156, 206873.4375, 153046.1406,  ...,  52384.4688,
          51670.9805,  51523.7070],
        [657015.5625, 589853.8750, 588671.5000,  ..., 417897.8125,
         411687.7500, 403445.9375],
        [476024.7188, 296936.1875, 279450.5625,  ..., 109238.5938,
         108730.6719, 107782.2969],
        ...,
        [174704.8438, 143061.9062, 125353.3281,  ...,  46816.3281,
          46359.2383,  44342.9023],
        [470960.5312, 295728.6250, 165177.0781,  ...,  79432.4609,
          77926.1875,  76137.6562],
        [220855.0000, 170445.2344, 169970.9219,  ...,  68305.0312,
          67925.9844,  66985.6797]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[212655.0156,      0.0000],
         [206873.4375,      0.0000],
         [153046.1406,      0.0000],
         ...,
         [ 52384.4688,      0.0000],
         [ 51670.9805,      0.0000],
         [ 51523.7070,      0.0000]],

        [[657015.5625,      0.0000],
         [589853.8750,      0.0000],
         [588671.5000,      0.0000],
         ...,
         [417897.8125,      0.0000],
         [411687.7500,      0.0000],
         [403445.9375,      0.0000]],

        [[476024.7188,      0.0000],
         [     0.0000, 296936.1875],
         [279450.5625,      0.0000],
         ...,
         [109238.5938,      0.0000],
         [108730.6719,      0.0000],
         [107782.2969,      0.0000]],

        ...,

        [[     0.0000, 174704.8438],
         [     0.0000, 143061.9062],
         [125353.3281,      0.0000],
         ...,
         [ 46816.3281,      0.0000],
         [ 46359.2383,      0.0000],
         [     0.0000,  44342.9023]],

        [[470960.5312,      0.0000],
         [     0.0000, 295728.6250],
         [     0.0000, 165177.0781],
         ...,
         [ 79432.4609,      0.0000],
         [ 77926.1875,      0.0000],
         [ 76137.6562,      0.0000]],

        [[     0.0000, 220855.0000],
         [170445.2344,      0.0000],
         [     0.0000, 169970.9219],
         ...,
         [ 68305.0312,      0.0000],
         [ 67925.9844,      0.0000],
         [ 66985.6797,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1720163.7500,    71022.1328],
        [10005751.0000,        0.0000],
        [ 2886569.0000,   658126.3750],
        [ 3771417.0000,        0.0000],
        [  910145.1250,   652713.3750],
        [ 1543869.2500,   273938.3125],
        [ 3004092.5000,  1347492.7500],
        [ 3997531.7500,   137614.4844],
        [ 4702188.0000,   199928.5312],
        [ 4242048.5000,        0.0000],
        [ 7226309.0000,        0.0000],
        [ 2118776.0000,        0.0000],
        [ 3578048.5000,        0.0000],
        [11899890.0000,        0.0000],
        [12608392.0000,        0.0000],
        [10051058.0000,        0.0000],
        [ 7929979.5000,        0.0000],
        [ 9749722.0000,        0.0000],
        [ 4783876.0000,        0.0000],
        [ 6155003.0000,   281783.3750],
        [ 7568074.5000,        0.0000],
        [ 5401323.5000,        0.0000],
        [12467924.0000,        0.0000],
        [12139977.0000,        0.0000],
        [ 3997155.0000,        0.0000],
        [10872478.0000,        0.0000],
        [ 9905057.0000,        0.0000],
        [13206811.0000,        0.0000],
        [11939672.0000,        0.0000],
        [11323859.0000,        0.0000],
        [14502999.0000,        0.0000],
        [11316994.0000,        0.0000],
        [ 3413352.5000,   117013.4297],
        [ 3076055.0000,  1131850.0000],
        [ 4199975.0000,  1885941.0000],
        [ 1660541.0000,  1783764.2500],
        [ 2066958.1250,   995776.4375],
        [ 1613983.5000,   850424.0625],
        [ 1383113.8750,  1067486.1250],
        [ 8713817.0000,        0.0000],
        [ 2963941.7500,   290124.2812],
        [ 4292903.5000,        0.0000],
        [ 3939595.2500,        0.0000],
        [ 3170322.0000,        0.0000],
        [ 1662339.3750,  1387490.7500],
        [  391433.9062,   435276.6250],
        [ 4762909.0000,   250559.0469],
        [  778275.8125,   443035.5312],
        [  389328.5000,   352548.4375],
        [ 2500930.7500,  1332366.0000],
        [ 1370738.6250,   366597.5000],
        [ 2902738.7500,  1016156.4375],
        [ 2968269.5000,  2083559.0000],
        [ 4246106.0000,   191842.7969],
        [ 7190522.0000,   387791.9062],
        [ 4501330.5000,   229733.0312],
        [ 3605892.0000,  1403460.7500],
        [ 3893708.0000,  1130901.3750],
        [ 2218239.5000,  1165431.3750],
        [ 1179077.8750,  1050539.5000],
        [ 3647668.2500,   701850.0000],
        [  932370.6250,   635872.3750],
        [ 1755778.1250,   929228.2500],
        [ 1247911.5000,   717532.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 336/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:03<30:50, 63.81s/it]  7%|▋         | 2/30 [01:04<12:23, 26.54s/it] 10%|█         | 3/30 [01:04<06:37, 14.73s/it] 13%|█▎        | 4/30 [01:05<03:58,  9.19s/it] 17%|█▋        | 5/30 [01:06<02:30,  6.03s/it] 20%|██        | 6/30 [01:06<01:39,  4.13s/it] 23%|██▎       | 7/30 [01:06<01:07,  2.93s/it] 27%|██▋       | 8/30 [01:07<00:46,  2.13s/it] 30%|███       | 9/30 [01:07<00:33,  1.61s/it] 33%|███▎      | 10/30 [01:08<00:24,  1.25s/it] 37%|███▋      | 11/30 [01:08<00:19,  1.00s/it] 40%|████      | 12/30 [01:09<00:14,  1.20it/s] 43%|████▎     | 13/30 [01:09<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:10<00:10,  1.58it/s] 50%|█████     | 15/30 [01:10<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:10<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:11<00:06,  1.98it/s] 60%|██████    | 18/30 [01:11<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:12<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:12<00:04,  2.16it/s] 70%|███████   | 21/30 [01:13<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:13<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:14<00:03,  2.22it/s] 80%|████████  | 24/30 [01:14<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:14<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:15<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:15<00:01,  2.24it/s] 93%|█████████▎| 28/30 [01:16<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:16<00:00,  2.25it/s]100%|██████████| 30/30 [01:17<00:00,  2.26it/s]100%|██████████| 30/30 [01:17<00:00,  2.58s/it]
Epoch loss is 2.7636369466781616
Epoch 337/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:36, 55.05s/it]  7%|▋         | 2/30 [00:56<10:51, 23.27s/it] 10%|█         | 3/30 [01:01<06:42, 14.91s/it] 13%|█▎        | 4/30 [01:01<03:59,  9.20s/it] 17%|█▋        | 5/30 [01:01<02:31,  6.04s/it] 20%|██        | 6/30 [01:02<01:39,  4.14s/it] 23%|██▎       | 7/30 [01:02<01:07,  2.93s/it] 27%|██▋       | 8/30 [01:03<00:47,  2.14s/it] 30%|███       | 9/30 [01:03<00:33,  1.61s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.25s/it] 37%|███▋      | 11/30 [01:04<00:19,  1.00s/it] 40%|████      | 12/30 [01:05<00:14,  1.20it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.59it/s] 50%|█████     | 15/30 [01:06<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.7341418981552126
Epoch 338/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:05<31:50, 65.89s/it]  7%|▋         | 2/30 [01:11<14:13, 30.48s/it] 10%|█         | 3/30 [01:12<07:35, 16.87s/it] 13%|█▎        | 4/30 [01:12<04:30, 10.39s/it] 17%|█▋        | 5/30 [01:13<02:49,  6.80s/it] 20%|██        | 6/30 [01:13<01:51,  4.64s/it] 23%|██▎       | 7/30 [01:14<01:15,  3.27s/it] 27%|██▋       | 8/30 [01:14<00:52,  2.37s/it] 30%|███       | 9/30 [01:14<00:37,  1.76s/it] 33%|███▎      | 10/30 [01:15<00:27,  1.36s/it] 37%|███▋      | 11/30 [01:15<00:20,  1.08s/it] 40%|████      | 12/30 [01:16<00:15,  1.13it/s] 43%|████▎     | 13/30 [01:16<00:12,  1.34it/s] 47%|████▋     | 14/30 [01:17<00:10,  1.52it/s] 50%|█████     | 15/30 [01:17<00:08,  1.69it/s] 53%|█████▎    | 16/30 [01:18<00:07,  1.83it/s] 57%|█████▋    | 17/30 [01:18<00:06,  1.94it/s] 60%|██████    | 18/30 [01:18<00:05,  2.03it/s] 63%|██████▎   | 19/30 [01:19<00:05,  2.09it/s] 67%|██████▋   | 20/30 [01:19<00:04,  2.14it/s] 70%|███████   | 21/30 [01:20<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:20<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:21<00:03,  2.22it/s] 80%|████████  | 24/30 [01:21<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:21<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:22<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:22<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:23<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:23<00:00,  2.26it/s]100%|██████████| 30/30 [01:24<00:00,  2.26it/s]100%|██████████| 30/30 [01:24<00:00,  2.81s/it]
Epoch loss is 2.727390432357788
Epoch 339/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:41, 57.29s/it]  7%|▋         | 2/30 [00:57<11:07, 23.85s/it] 10%|█         | 3/30 [00:58<05:55, 13.16s/it] 13%|█▎        | 4/30 [00:58<03:31,  8.14s/it] 17%|█▋        | 5/30 [00:59<02:14,  5.37s/it] 20%|██        | 6/30 [00:59<01:28,  3.69s/it] 23%|██▎       | 7/30 [00:59<01:00,  2.63s/it] 27%|██▋       | 8/30 [01:00<00:42,  1.93s/it] 30%|███       | 9/30 [01:00<00:30,  1.47s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.15s/it] 37%|███▋      | 11/30 [01:01<00:17,  1.07it/s] 40%|████      | 12/30 [01:02<00:14,  1.28it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.47it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:03<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:03<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.01it/s] 60%|██████    | 18/30 [01:04<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:08<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.34s/it]
Epoch loss is 2.7295389652252195
Epoch 340/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:00, 55.89s/it]  7%|▋         | 2/30 [00:56<10:57, 23.50s/it] 10%|█         | 3/30 [00:59<06:13, 13.82s/it] 13%|█▎        | 4/30 [01:00<03:53,  8.98s/it] 17%|█▋        | 5/30 [01:01<02:27,  5.90s/it] 20%|██        | 6/30 [01:01<01:37,  4.04s/it] 23%|██▎       | 7/30 [01:01<01:05,  2.87s/it] 27%|██▋       | 8/30 [01:02<00:46,  2.09s/it] 30%|███       | 9/30 [01:02<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.01it/s] 40%|████      | 12/30 [01:04<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.60it/s] 50%|█████     | 15/30 [01:05<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.7284262736638385
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0594, -0.0894,  0.0805,  ..., -0.0550,  0.0999,  0.0619],
        [ 0.0281, -0.0276,  0.0838,  ..., -0.0149,  0.0958,  0.1014],
        [-0.0043, -0.0113,  0.0082,  ..., -0.0546,  0.0590,  0.1231],
        ...,
        [-0.0185, -0.0041,  0.0739,  ..., -0.0426,  0.0287,  0.0184],
        [-0.0649, -0.1025,  0.0305,  ..., -0.0339,  0.0889,  0.0147],
        [-0.0237, -0.0184,  0.0623,  ..., -0.0101,  0.0883,  0.0987]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8575, 0.8554, 0.8344,  ..., 0.7598, 0.7587, 0.7585],
        [0.9371, 0.9292, 0.9289,  ..., 0.9051, 0.9038, 0.9021],
        [0.9140, 0.8809, 0.8763,  ..., 0.8101, 0.8093, 0.8092],
        ...,
        [0.8447, 0.8297, 0.8204,  ..., 0.7510, 0.7496, 0.7482],
        [0.9137, 0.8812, 0.8392,  ..., 0.7888, 0.7870, 0.7847],
        [0.8602, 0.8420, 0.8415,  ..., 0.7768, 0.7766, 0.7754]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 0,  ..., 0, 0, 1],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[208998.6406, 202859.1719, 150237.7500,  ...,  51792.1523,
          50942.1875,  50826.8828],
        [651123.5000, 582094.6250, 579684.2500,  ..., 412341.5938,
         404713.3750, 395334.8438],
        [468745.2188, 291832.9062, 273544.4375,  ..., 106232.5938,
         104925.6719, 104869.1484],
        ...,
        [174038.3281, 140431.2344, 122930.4062,  ...,  45614.1367,
          44720.9180,  43836.8281],
        [466441.5312, 293054.4688, 160790.7031,  ...,  78345.9375,
          76317.2891,  73873.3828],
        [217088.8750, 167387.1719, 166342.9219,  ...,  65941.3125,
          65806.4297,  64697.1680]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[208998.6406,      0.0000],
         [202859.1719,      0.0000],
         [150237.7500,      0.0000],
         ...,
         [ 51792.1523,      0.0000],
         [ 50942.1875,      0.0000],
         [ 50826.8828,      0.0000]],

        [[651123.5000,      0.0000],
         [582094.6250,      0.0000],
         [579684.2500,      0.0000],
         ...,
         [412341.5938,      0.0000],
         [404713.3750,      0.0000],
         [395334.8438,      0.0000]],

        [[468745.2188,      0.0000],
         [     0.0000, 291832.9062],
         [273544.4375,      0.0000],
         ...,
         [106232.5938,      0.0000],
         [104925.6719,      0.0000],
         [104869.1484,      0.0000]],

        ...,

        [[     0.0000, 174038.3281],
         [     0.0000, 140431.2344],
         [122930.4062,      0.0000],
         ...,
         [ 45614.1367,      0.0000],
         [ 44720.9180,      0.0000],
         [     0.0000,  43836.8281]],

        [[466441.5312,      0.0000],
         [     0.0000, 293054.4688],
         [     0.0000, 160790.7031],
         ...,
         [ 78345.9375,      0.0000],
         [ 76317.2891,      0.0000],
         [     0.0000,  73873.3828]],

        [[     0.0000, 217088.8750],
         [     0.0000, 167387.1719],
         [166342.9219,      0.0000],
         ...,
         [ 65941.3125,      0.0000],
         [ 65806.4297,      0.0000],
         [ 64697.1680,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1692234.0000,    69640.9297],
        [ 9873742.0000,        0.0000],
        [ 2818048.0000,   643849.1250],
        [ 3727595.2500,        0.0000],
        [  888950.3125,   643667.6875],
        [ 1494432.7500,   266189.4375],
        [ 2921408.0000,  1317433.6250],
        [ 3900727.0000,   134350.6406],
        [ 4598351.0000,   193700.8750],
        [ 4191855.7500,        0.0000],
        [ 7121097.5000,        0.0000],
        [ 2062897.0000,        0.0000],
        [ 3519004.5000,        0.0000],
        [11774208.0000,        0.0000],
        [12515857.0000,        0.0000],
        [ 9969582.0000,        0.0000],
        [ 7802445.5000,        0.0000],
        [ 9643601.0000,        0.0000],
        [ 4690532.0000,        0.0000],
        [ 6072575.0000,   277846.8438],
        [ 7439183.5000,        0.0000],
        [ 5306148.0000,        0.0000],
        [12369378.0000,        0.0000],
        [12058916.0000,        0.0000],
        [ 3912199.0000,        0.0000],
        [10804729.0000,        0.0000],
        [ 9828372.0000,        0.0000],
        [13130268.0000,        0.0000],
        [11824311.0000,        0.0000],
        [11234808.0000,        0.0000],
        [14394266.0000,        0.0000],
        [11234960.0000,        0.0000],
        [ 3359587.0000,   115294.8047],
        [ 3007233.5000,  1117488.3750],
        [ 4138490.2500,  1865723.3750],
        [ 1628160.1250,  1762396.2500],
        [ 2033511.2500,   990922.2500],
        [ 1580560.0000,   835967.3125],
        [ 1360785.7500,  1051437.8750],
        [ 8583435.0000,        0.0000],
        [ 2925745.7500,   285209.3750],
        [ 4238362.5000,        0.0000],
        [ 3888009.5000,        0.0000],
        [ 3130157.5000,        0.0000],
        [ 1627502.8750,  1367358.8750],
        [  366385.9375,   448516.0938],
        [ 4671745.0000,   247598.3906],
        [  764350.5000,   439201.2188],
        [  382992.7500,   347815.0625],
        [ 2435577.5000,  1304850.3750],
        [ 1343104.2500,   365409.8125],
        [ 2833432.0000,  1009688.0625],
        [ 2924180.2500,  2057433.5000],
        [ 4196421.5000,   189281.2969],
        [ 7104131.5000,   382136.7188],
        [ 4432090.0000,   225940.0156],
        [ 3538326.7500,  1380817.2500],
        [ 3847134.2500,  1120392.8750],
        [ 2181537.5000,  1146839.5000],
        [ 1160643.1250,  1034494.8750],
        [ 3579717.0000,   691331.5625],
        [  911486.7500,   626554.3750],
        [ 1649105.1250,   986781.4375],
        [ 1207906.6250,   707844.5000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 341/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:53, 55.65s/it]  7%|▋         | 2/30 [00:56<10:48, 23.18s/it] 10%|█         | 3/30 [00:56<05:50, 12.99s/it] 13%|█▎        | 4/30 [00:57<03:33,  8.21s/it] 17%|█▋        | 5/30 [00:58<02:18,  5.56s/it] 20%|██        | 6/30 [01:00<01:41,  4.22s/it] 23%|██▎       | 7/30 [01:00<01:08,  2.98s/it] 27%|██▋       | 8/30 [01:01<00:47,  2.17s/it] 30%|███       | 9/30 [01:01<00:34,  1.63s/it] 33%|███▎      | 10/30 [01:02<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:02<00:19,  1.01s/it] 40%|████      | 12/30 [01:02<00:15,  1.19it/s] 43%|████▎     | 13/30 [01:03<00:12,  1.39it/s] 47%|████▋     | 14/30 [01:03<00:10,  1.58it/s] 50%|█████     | 15/30 [01:04<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.98it/s] 60%|██████    | 18/30 [01:05<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:06<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.25it/s]100%|██████████| 30/30 [01:10<00:00,  2.25it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 2.6981014172236124
Epoch 342/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:31, 56.95s/it]  7%|▋         | 2/30 [01:00<11:46, 25.25s/it] 10%|█         | 3/30 [01:00<06:15, 13.92s/it] 13%|█▎        | 4/30 [01:00<03:43,  8.60s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.66s/it] 20%|██        | 6/30 [01:01<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.7127570629119875
Epoch 343/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:45, 55.36s/it]  7%|▋         | 2/30 [01:00<12:00, 25.73s/it] 10%|█         | 3/30 [01:00<06:22, 14.18s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.76s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.76s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.773158574104309
Epoch 344/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:45, 55.35s/it]  7%|▋         | 2/30 [01:00<11:55, 25.56s/it] 10%|█         | 3/30 [01:00<06:20, 14.09s/it] 13%|█▎        | 4/30 [01:00<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.72s/it] 20%|██        | 6/30 [01:01<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.7301947434743243
Epoch 345/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:15, 56.40s/it]  7%|▋         | 2/30 [01:00<11:59, 25.71s/it] 10%|█         | 3/30 [01:01<06:22, 14.17s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.75s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.76s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.6967710892359418
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0596, -0.0902,  0.0803,  ..., -0.0547,  0.0993,  0.0619],
        [ 0.0286, -0.0270,  0.0835,  ..., -0.0145,  0.0957,  0.1013],
        [-0.0037, -0.0110,  0.0081,  ..., -0.0543,  0.0591,  0.1228],
        ...,
        [-0.0178, -0.0037,  0.0737,  ..., -0.0434,  0.0285,  0.0184],
        [-0.0644, -0.1030,  0.0301,  ..., -0.0341,  0.0890,  0.0148],
        [-0.0238, -0.0182,  0.0616,  ..., -0.0096,  0.0888,  0.0988]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8564, 0.8541, 0.8331,  ..., 0.7589, 0.7580, 0.7573],
        [0.9365, 0.9283, 0.9278,  ..., 0.9041, 0.9027, 0.9008],
        [0.9130, 0.8797, 0.8750,  ..., 0.8082, 0.8074, 0.8069],
        ...,
        [0.8446, 0.8286, 0.8196,  ..., 0.7486, 0.7477, 0.7473],
        [0.9131, 0.8806, 0.8375,  ..., 0.7873, 0.7855, 0.7832],
        [0.8589, 0.8410, 0.8399,  ..., 0.7744, 0.7737, 0.7730]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 1, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[205620.5000, 199041.2344, 147471.6250,  ...,  51117.7227,
          50451.6914,  49965.6836],
        [645595.6875, 574199.7500, 570736.8125,  ..., 406442.7500,
         398363.3125, 387742.3438],
        [461737.2500, 287163.8125, 268207.8438,  ..., 103292.5469,
         102117.3984, 101398.5859],
        ...,
        [173708.7031, 138310.2500, 121558.6172,  ...,  44098.9414,
          43515.4766,  43273.0938],
        [462750.7188, 290727.5938, 157014.1562,  ...,  76608.1641,
          74696.7188,  72277.2656],
        [213106.7344, 165098.0156, 162436.6094,  ...,  63792.5508,
          63093.6758,  62464.2617]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[205620.5000,      0.0000],
         [199041.2344,      0.0000],
         [147471.6250,      0.0000],
         ...,
         [ 51117.7227,      0.0000],
         [ 50451.6914,      0.0000],
         [ 49965.6836,      0.0000]],

        [[645595.6875,      0.0000],
         [574199.7500,      0.0000],
         [570736.8125,      0.0000],
         ...,
         [406442.7500,      0.0000],
         [398363.3125,      0.0000],
         [387742.3438,      0.0000]],

        [[461737.2500,      0.0000],
         [     0.0000, 287163.8125],
         [268207.8438,      0.0000],
         ...,
         [103292.5469,      0.0000],
         [102117.3984,      0.0000],
         [101398.5859,      0.0000]],

        ...,

        [[     0.0000, 173708.7031],
         [     0.0000, 138310.2500],
         [     0.0000, 121558.6172],
         ...,
         [ 44098.9414,      0.0000],
         [     0.0000,  43515.4766],
         [ 43273.0938,      0.0000]],

        [[462750.7188,      0.0000],
         [     0.0000, 290727.5938],
         [     0.0000, 157014.1562],
         ...,
         [ 76608.1641,      0.0000],
         [ 74696.7188,      0.0000],
         [     0.0000,  72277.2656]],

        [[     0.0000, 213106.7344],
         [     0.0000, 165098.0156],
         [162436.6094,      0.0000],
         ...,
         [ 63792.5508,      0.0000],
         [ 63093.6758,      0.0000],
         [ 62464.2617,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1665510.7500,    68249.4219],
        [ 9748396.0000,        0.0000],
        [ 2754745.0000,   630486.5000],
        [ 3687019.7500,        0.0000],
        [  870404.4375,   634906.5625],
        [ 1449315.8750,   259302.1562],
        [ 2848032.5000,  1288843.5000],
        [ 3807477.2500,   131226.9062],
        [ 4500685.0000,   188432.8125],
        [ 4143481.0000,        0.0000],
        [ 7026857.0000,        0.0000],
        [ 2013067.1250,        0.0000],
        [ 3462446.2500,        0.0000],
        [11653327.0000,        0.0000],
        [12423854.0000,        0.0000],
        [ 9895680.0000,        0.0000],
        [ 7680007.0000,        0.0000],
        [ 9541114.0000,        0.0000],
        [ 4605213.5000,        0.0000],
        [ 5996144.0000,   274381.5625],
        [ 7318354.5000,        0.0000],
        [ 5216744.5000,        0.0000],
        [12279644.0000,        0.0000],
        [11982004.0000,        0.0000],
        [ 3833983.5000,        0.0000],
        [10738981.0000,        0.0000],
        [ 9751380.0000,        0.0000],
        [13057213.0000,        0.0000],
        [11714410.0000,        0.0000],
        [11148332.0000,        0.0000],
        [14286958.0000,        0.0000],
        [11154743.0000,        0.0000],
        [ 3307567.2500,   113585.0781],
        [ 2945127.7500,  1104792.3750],
        [ 4081975.5000,  1846969.0000],
        [ 1598581.5000,  1742659.2500],
        [ 2001726.3750,   986170.3125],
        [ 1549784.3750,   822505.3125],
        [ 1339984.5000,  1037014.1875],
        [ 8465068.0000,        0.0000],
        [ 2888579.0000,   280316.1562],
        [ 4188770.0000,        0.0000],
        [ 3838509.7500,        0.0000],
        [ 3093019.0000,        0.0000],
        [ 1594867.8750,  1348904.6250],
        [  362629.9688,   442385.4062],
        [ 4587593.0000,   244864.1094],
        [  751614.3125,   435108.3750],
        [  376386.1250,   342845.0000],
        [ 2374110.2500,  1278873.2500],
        [ 1317906.3750,   364298.8438],
        [ 2771000.5000,  1004112.3750],
        [ 2880787.5000,  2031603.5000],
        [ 4149141.5000,   186604.0938],
        [ 7021235.0000,   376821.2500],
        [ 4363964.0000,   222367.5938],
        [ 3476735.0000,  1358790.1250],
        [ 3802614.0000,  1110196.0000],
        [ 2146967.7500,  1129153.6250],
        [ 1142116.0000,  1018604.3125],
        [ 3514247.0000,   681156.3750],
        [  893263.8750,   619176.2500],
        [ 1621706.0000,   970867.1250],
        [ 1169105.0000,   698382.0625]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 346/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:19, 58.61s/it]  7%|▋         | 2/30 [01:00<11:50, 25.37s/it] 10%|█         | 3/30 [01:01<06:17, 13.99s/it] 13%|█▎        | 4/30 [01:01<03:44,  8.64s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.68s/it] 20%|██        | 6/30 [01:02<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.7070234298706053
Epoch 347/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:39, 59.30s/it]  7%|▋         | 2/30 [01:00<11:36, 24.88s/it] 10%|█         | 3/30 [01:00<06:10, 13.72s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.48s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.58s/it] 20%|██        | 6/30 [01:01<01:32,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.25it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.73933629989624
Epoch 348/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:10, 56.21s/it]  7%|▋         | 2/30 [00:59<11:40, 25.03s/it] 10%|█         | 3/30 [00:59<06:12, 13.80s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.731015149752299
Epoch 349/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:16, 56.45s/it]  7%|▋         | 2/30 [01:00<12:02, 25.81s/it] 10%|█         | 3/30 [01:01<06:24, 14.23s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.78s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.78s/it] 20%|██        | 6/30 [01:02<01:35,  3.96s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.7190765062967936
Epoch 350/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:27, 56.80s/it]  7%|▋         | 2/30 [01:00<11:56, 25.57s/it] 10%|█         | 3/30 [01:00<06:20, 14.10s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.71s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.73s/it] 20%|██        | 6/30 [01:02<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.697635809580485
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0598, -0.0909,  0.0801,  ..., -0.0545,  0.0987,  0.0619],
        [ 0.0291, -0.0264,  0.0833,  ..., -0.0142,  0.0957,  0.1013],
        [-0.0032, -0.0108,  0.0081,  ..., -0.0542,  0.0593,  0.1225],
        ...,
        [-0.0171, -0.0033,  0.0735,  ..., -0.0439,  0.0284,  0.0184],
        [-0.0638, -0.1034,  0.0297,  ..., -0.0342,  0.0892,  0.0150],
        [-0.0238, -0.0179,  0.0611,  ..., -0.0090,  0.0892,  0.0990]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8554, 0.8528, 0.8319,  ..., 0.7582, 0.7574, 0.7568],
        [0.9359, 0.9274, 0.9269,  ..., 0.9031, 0.9016, 0.8995],
        [0.9120, 0.8786, 0.8736,  ..., 0.8063, 0.8057, 0.8054],
        ...,
        [0.8445, 0.8276, 0.8191,  ..., 0.7470, 0.7465, 0.7452],
        [0.9126, 0.8801, 0.8359,  ..., 0.7859, 0.7842, 0.7817],
        [0.8577, 0.8401, 0.8384,  ..., 0.7721, 0.7711, 0.7708]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[202681.6562, 195527.7031, 144970.1406,  ...,  50559.3906,
          49995.7188,  49596.3828],
        [640203.3750, 567401.3750, 562881.6875,  ..., 400856.0312,
         392531.5000, 380991.2188],
        [455329.3125, 282586.1562, 263019.2188,  ..., 100517.1406,
          99719.9844,  99243.0547],
        ...,
        [173486.5156, 136239.5938, 120745.6719,  ...,  43130.7461,
          42790.9766,  41984.5430],
        [459343.1875, 288543.5625, 153492.0938,  ...,  75144.6406,
          73360.3750,  70782.7656],
        [209612.4375, 162944.8750, 159050.2500,  ...,  61669.9805,
          60850.2070,  60601.4180]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[202681.6562,      0.0000],
         [195527.7031,      0.0000],
         [144970.1406,      0.0000],
         ...,
         [ 50559.3906,      0.0000],
         [ 49995.7188,      0.0000],
         [ 49596.3828,      0.0000]],

        [[640203.3750,      0.0000],
         [567401.3750,      0.0000],
         [562881.6875,      0.0000],
         ...,
         [400856.0312,      0.0000],
         [392531.5000,      0.0000],
         [380991.2188,      0.0000]],

        [[455329.3125,      0.0000],
         [     0.0000, 282586.1562],
         [263019.2188,      0.0000],
         ...,
         [100517.1406,      0.0000],
         [ 99719.9844,      0.0000],
         [ 99243.0547,      0.0000]],

        ...,

        [[     0.0000, 173486.5156],
         [     0.0000, 136239.5938],
         [     0.0000, 120745.6719],
         ...,
         [     0.0000,  43130.7461],
         [ 42790.9766,      0.0000],
         [ 41984.5430,      0.0000]],

        [[459343.1875,      0.0000],
         [     0.0000, 288543.5625],
         [     0.0000, 153492.0938],
         ...,
         [ 75144.6406,      0.0000],
         [ 73360.3750,      0.0000],
         [     0.0000,  70782.7656]],

        [[     0.0000, 209612.4375],
         [     0.0000, 162944.8750],
         [159050.2500,      0.0000],
         ...,
         [ 61669.9805,      0.0000],
         [ 60850.2070,      0.0000],
         [ 60601.4180,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1641680.8750,    66941.9297],
        [ 9631788.0000,        0.0000],
        [ 2697537.0000,   617769.2500],
        [ 3646754.5000,        0.0000],
        [  854503.0000,   626729.5000],
        [ 1410044.2500,   253267.7188],
        [ 2779098.0000,  1263085.2500],
        [ 3724182.7500,   128464.3516],
        [ 4413968.5000,   183770.2812],
        [ 4097539.7500,        0.0000],
        [ 6937722.0000,        0.0000],
        [ 1968028.8750,        0.0000],
        [ 3409441.5000,        0.0000],
        [11540143.0000,        0.0000],
        [12341310.0000,        0.0000],
        [ 9830999.0000,        0.0000],
        [ 7569278.0000,        0.0000],
        [ 9447088.0000,        0.0000],
        [ 4526246.0000,        0.0000],
        [ 5927075.0000,   270917.8750],
        [ 7206989.0000,        0.0000],
        [ 5133462.0000,        0.0000],
        [12193546.0000,        0.0000],
        [11907249.0000,        0.0000],
        [ 3759480.7500,        0.0000],
        [10680904.0000,        0.0000],
        [ 9682900.0000,        0.0000],
        [12994236.0000,        0.0000],
        [11612292.0000,        0.0000],
        [11074834.0000,        0.0000],
        [14185916.0000,        0.0000],
        [11079979.0000,        0.0000],
        [ 3259106.5000,   112144.0703],
        [ 2885838.0000,  1093560.7500],
        [ 4027733.0000,  1828734.3750],
        [ 1568020.2500,  1723364.0000],
        [ 1972838.5000,   981869.7500],
        [ 1519840.0000,   810467.3750],
        [ 1320072.8750,  1023937.1250],
        [ 8350140.0000,        0.0000],
        [ 2853465.0000,   275683.4375],
        [ 4142837.2500,        0.0000],
        [ 3793599.0000,        0.0000],
        [ 3057955.0000,        0.0000],
        [ 1565483.8750,  1331786.2500],
        [  359180.3125,   436550.8438],
        [ 4510163.0000,   242323.8438],
        [  739525.8125,   431410.6250],
        [  370389.9688,   338387.4375],
        [ 2318907.7500,  1255305.6250],
        [ 1295620.7500,   363159.0625],
        [ 2713383.0000,   998021.1875],
        [ 2842149.0000,  2007879.0000],
        [ 4105671.5000,   183995.2812],
        [ 6943873.5000,   372054.1250],
        [ 4302034.5000,   219004.6562],
        [ 3420666.7500,  1338784.7500],
        [ 3763384.2500,  1101650.1250],
        [ 2115629.0000,  1112930.2500],
        [ 1125380.6250,  1005377.0000],
        [ 3455752.0000,   671543.5000],
        [  877509.6250,   612155.6250],
        [ 1597641.3750,   956231.3125],
        [ 1136355.3750,   689830.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 351/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:14, 60.49s/it]  7%|▋         | 2/30 [01:00<11:44, 25.17s/it] 10%|█         | 3/30 [01:01<06:14, 13.88s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.23it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.24it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.7395060857137046
Epoch 352/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:14, 60.50s/it]  7%|▋         | 2/30 [01:00<11:44, 25.17s/it] 10%|█         | 3/30 [01:01<06:14, 13.88s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:04<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.7097434600194297
Epoch 353/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:10, 60.36s/it]  7%|▋         | 2/30 [01:00<11:43, 25.11s/it] 10%|█         | 3/30 [01:01<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.63s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.7117337544759113
Epoch 354/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:53, 55.63s/it]  7%|▋         | 2/30 [00:59<11:52, 25.46s/it] 10%|█         | 3/30 [01:00<06:18, 14.03s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.70s/it] 20%|██        | 6/30 [01:01<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.7103530406951903
Epoch 355/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:36, 55.05s/it]  7%|▋         | 2/30 [01:01<12:12, 26.17s/it] 10%|█         | 3/30 [01:01<06:29, 14.42s/it] 13%|█▎        | 4/30 [01:01<03:51,  8.90s/it] 17%|█▋        | 5/30 [01:02<02:26,  5.85s/it] 20%|██        | 6/30 [01:02<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.08s/it] 30%|███       | 9/30 [01:04<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.7027414560317995
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0600, -0.0914,  0.0799,  ..., -0.0542,  0.0981,  0.0618],
        [ 0.0295, -0.0257,  0.0831,  ..., -0.0139,  0.0957,  0.1013],
        [-0.0028, -0.0106,  0.0081,  ..., -0.0539,  0.0596,  0.1221],
        ...,
        [-0.0164, -0.0029,  0.0734,  ..., -0.0444,  0.0284,  0.0184],
        [-0.0634, -0.1038,  0.0295,  ..., -0.0342,  0.0894,  0.0151],
        [-0.0238, -0.0177,  0.0605,  ..., -0.0085,  0.0897,  0.0991]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8544, 0.8517, 0.8307,  ..., 0.7574, 0.7566, 0.7562],
        [0.9353, 0.9266, 0.9259,  ..., 0.9021, 0.9006, 0.8983],
        [0.9111, 0.8775, 0.8722,  ..., 0.8044, 0.8041, 0.8040],
        ...,
        [0.8442, 0.8266, 0.8186,  ..., 0.7466, 0.7445, 0.7431],
        [0.9122, 0.8796, 0.8345,  ..., 0.7847, 0.7831, 0.7804],
        [0.8566, 0.8391, 0.8369,  ..., 0.7698, 0.7689, 0.7687]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[199840.6406, 192255.8125, 142474.0000,  ...,  49979.4609,
          49423.1484,  49153.6172],
        [635132.8750, 560661.0000, 555236.8125,  ..., 395359.3438,
         386678.5000, 374446.5312],
        [449414.2188, 278026.8438, 257921.1406,  ...,  97913.3828,
          97515.1875,  97315.7266],
        ...,
        [172722.0156, 134468.9688, 119968.0312,  ...,  42836.2578,
          41613.0234,  40751.8398],
        [456236.9062, 286605.4375, 150448.8125,  ...,  73831.8984,
          72177.0391,  69485.7656],
        [206262.9219, 160776.2812, 155654.3125,  ...,  59704.7383,
          58941.3867,  58782.7461]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[199840.6406,      0.0000],
         [192255.8125,      0.0000],
         [142474.0000,      0.0000],
         ...,
         [ 49979.4609,      0.0000],
         [ 49423.1484,      0.0000],
         [ 49153.6172,      0.0000]],

        [[635132.8750,      0.0000],
         [560661.0000,      0.0000],
         [555236.8125,      0.0000],
         ...,
         [395359.3438,      0.0000],
         [386678.5000,      0.0000],
         [374446.5312,      0.0000]],

        [[449414.2188,      0.0000],
         [     0.0000, 278026.8438],
         [257921.1406,      0.0000],
         ...,
         [ 97913.3828,      0.0000],
         [ 97515.1875,      0.0000],
         [ 97315.7266,      0.0000]],

        ...,

        [[     0.0000, 172722.0156],
         [     0.0000, 134468.9688],
         [     0.0000, 119968.0312],
         ...,
         [     0.0000,  42836.2578],
         [ 41613.0234,      0.0000],
         [ 40751.8398,      0.0000]],

        [[456236.9062,      0.0000],
         [     0.0000, 286605.4375],
         [     0.0000, 150448.8125],
         ...,
         [ 73831.8984,      0.0000],
         [ 72177.0391,      0.0000],
         [     0.0000,  69485.7656]],

        [[     0.0000, 206262.9219],
         [     0.0000, 160776.2812],
         [155654.3125,      0.0000],
         ...,
         [ 59704.7383,      0.0000],
         [ 58941.3867,      0.0000],
         [ 58782.7461,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1618385.8750,    65694.6328],
        [ 9519510.0000,        0.0000],
        [ 2644303.0000,   605511.1875],
        [ 3607742.0000,        0.0000],
        [  839865.1250,   618675.0000],
        [ 1375082.5000,   247920.3438],
        [ 2716525.7500,  1240246.8750],
        [ 3642538.0000,   125837.3359],
        [ 4327974.0000,   179051.2812],
        [ 4052536.0000,        0.0000],
        [ 6855558.5000,        0.0000],
        [ 1925896.0000,        0.0000],
        [ 3359219.2500,        0.0000],
        [11434187.0000,        0.0000],
        [12261742.0000,        0.0000],
        [ 9766542.0000,        0.0000],
        [ 7461297.5000,        0.0000],
        [ 9354860.0000,        0.0000],
        [ 4449420.5000,        0.0000],
        [ 5863006.0000,   267686.0312],
        [ 7099766.5000,        0.0000],
        [ 5052473.0000,        0.0000],
        [12115873.0000,        0.0000],
        [11839895.0000,        0.0000],
        [ 3690304.5000,        0.0000],
        [10627331.0000,        0.0000],
        [ 9614460.0000,        0.0000],
        [12940997.0000,        0.0000],
        [11514294.0000,        0.0000],
        [11000386.0000,        0.0000],
        [14090195.0000,        0.0000],
        [11010978.0000,        0.0000],
        [ 3211680.5000,   110762.4219],
        [ 2832500.5000,  1082313.0000],
        [ 3977069.2500,  1810942.6250],
        [ 1539405.7500,  1704177.1250],
        [ 1943139.2500,   977320.1250],
        [ 1491824.0000,   799015.3750],
        [ 1301975.2500,  1012013.2500],
        [ 8240007.0000,        0.0000],
        [ 2819937.7500,   271238.5312],
        [ 4099661.5000,        0.0000],
        [ 3749028.5000,        0.0000],
        [ 3026225.7500,        0.0000],
        [ 1540117.8750,  1316204.1250],
        [  355885.9062,   431394.0938],
        [ 4443539.0000,   240290.6562],
        [  728457.1250,   427787.7812],
        [  364856.4062,   333905.5000],
        [ 2266190.0000,  1232400.7500],
        [ 1274399.7500,   362230.5000],
        [ 2661278.5000,   992123.4375],
        [ 2805015.0000,  1985346.8750],
        [ 4061754.0000,   181735.1719],
        [ 6868244.0000,   367238.4062],
        [ 4242885.5000,   215921.0625],
        [ 3365312.0000,  1319492.5000],
        [ 3725545.5000,  1092720.0000],
        [ 2086040.0000,  1096909.5000],
        [ 1109700.5000,   993351.5625],
        [ 3401469.5000,   662109.1875],
        [  861770.9375,   605474.5625],
        [ 1575945.0000,   943466.0000],
        [ 1106259.7500,   681678.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 356/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:56, 61.94s/it]  7%|▋         | 2/30 [01:02<12:01, 25.77s/it] 10%|█         | 3/30 [01:02<06:23, 14.20s/it] 13%|█▎        | 4/30 [01:03<03:47,  8.77s/it] 17%|█▋        | 5/30 [01:03<02:24,  5.77s/it] 20%|██        | 6/30 [01:04<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:05<00:45,  2.05s/it] 30%|███       | 9/30 [01:05<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:06<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:07<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:08<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  2.00it/s] 60%|██████    | 18/30 [01:09<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:10<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:11<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.24it/s] 80%|████████  | 24/30 [01:12<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.50s/it]
Epoch loss is 2.671100123723348
Epoch 357/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:13, 60.48s/it]  7%|▋         | 2/30 [01:00<11:44, 25.16s/it] 10%|█         | 3/30 [01:01<06:14, 13.87s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.64s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.7213945150375367
Epoch 358/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:42, 59.40s/it]  7%|▋         | 2/30 [00:59<11:32, 24.72s/it] 10%|█         | 3/30 [01:00<06:08, 13.63s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.43s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.55s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.70187828540802
Epoch 359/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:49, 57.59s/it]  7%|▋         | 2/30 [00:58<11:11, 23.97s/it] 10%|█         | 3/30 [00:58<05:57, 13.23s/it] 13%|█▎        | 4/30 [00:58<03:32,  8.18s/it] 17%|█▋        | 5/30 [00:59<02:14,  5.39s/it] 20%|██        | 6/30 [00:59<01:29,  3.71s/it] 23%|██▎       | 7/30 [01:00<01:00,  2.64s/it] 27%|██▋       | 8/30 [01:00<00:42,  1.94s/it] 30%|███       | 9/30 [01:01<00:30,  1.47s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.16s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.07it/s] 40%|████      | 12/30 [01:02<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:03<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch loss is 2.6864705006281535
Epoch 360/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:05, 56.04s/it]  7%|▋         | 2/30 [00:56<10:53, 23.34s/it] 10%|█         | 3/30 [00:57<05:57, 13.24s/it] 13%|█▎        | 4/30 [00:58<03:32,  8.19s/it] 17%|█▋        | 5/30 [00:58<02:14,  5.40s/it] 20%|██        | 6/30 [00:59<01:29,  3.71s/it] 23%|██▎       | 7/30 [00:59<01:00,  2.65s/it] 27%|██▋       | 8/30 [00:59<00:42,  1.95s/it] 30%|███       | 9/30 [01:00<00:30,  1.48s/it] 33%|███▎      | 10/30 [01:00<00:23,  1.16s/it] 37%|███▋      | 11/30 [01:01<00:17,  1.07it/s] 40%|████      | 12/30 [01:01<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:02<00:09,  1.64it/s] 50%|█████     | 15/30 [01:03<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:03<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:03<00:06,  2.00it/s] 60%|██████    | 18/30 [01:04<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:04<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:05<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:06<00:03,  2.24it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:07<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:08<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:08<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch loss is 2.74090256690979
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0601, -0.0920,  0.0797,  ..., -0.0540,  0.0977,  0.0617],
        [ 0.0299, -0.0252,  0.0830,  ..., -0.0136,  0.0957,  0.1012],
        [-0.0025, -0.0105,  0.0080,  ..., -0.0539,  0.0599,  0.1218],
        ...,
        [-0.0158, -0.0025,  0.0732,  ..., -0.0448,  0.0282,  0.0184],
        [-0.0629, -0.1041,  0.0293,  ..., -0.0343,  0.0896,  0.0152],
        [-0.0238, -0.0176,  0.0599,  ..., -0.0080,  0.0901,  0.0992]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8534, 0.8506, 0.8296,  ..., 0.7567, 0.7560, 0.7557],
        [0.9348, 0.9258, 0.9250,  ..., 0.9012, 0.8996, 0.8972],
        [0.9103, 0.8764, 0.8711,  ..., 0.8028, 0.8028, 0.8028],
        ...,
        [0.8439, 0.8258, 0.8183,  ..., 0.7462, 0.7428, 0.7412],
        [0.9117, 0.8792, 0.8332,  ..., 0.7834, 0.7820, 0.7792],
        [0.8556, 0.8383, 0.8355,  ..., 0.7677, 0.7671, 0.7665]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[197129.4844, 189398.6719, 140310.3594,  ...,  49502.6758,
          49037.1289,  48813.5859],
        [630833.0000, 554502.8125, 548351.1250,  ..., 390253.0938,
         381442.7500, 368233.0000],
        [444459.3438, 273902.3438, 253699.9844,  ...,  95622.6016,
          95607.9219,  95600.9922],
        ...,
        [172198.0000, 132843.7969, 119331.4375,  ...,  42588.3906,
          40567.6562,  39683.4609],
        [453350.4375, 284905.4688, 147632.4688,  ...,  72547.4844,
          71102.1641,  68244.2188],
        [203416.9062, 158917.4219, 152679.6406,  ...,  57917.1211,
          57443.8320,  56929.6523]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[197129.4844,      0.0000],
         [189398.6719,      0.0000],
         [140310.3594,      0.0000],
         ...,
         [ 49502.6758,      0.0000],
         [ 49037.1289,      0.0000],
         [ 48813.5859,      0.0000]],

        [[630833.0000,      0.0000],
         [554502.8125,      0.0000],
         [548351.1250,      0.0000],
         ...,
         [390253.0938,      0.0000],
         [381442.7500,      0.0000],
         [368233.0000,      0.0000]],

        [[444459.3438,      0.0000],
         [     0.0000, 273902.3438],
         [253699.9844,      0.0000],
         ...,
         [ 95622.6016,      0.0000],
         [ 95607.9219,      0.0000],
         [ 95600.9922,      0.0000]],

        ...,

        [[     0.0000, 172198.0000],
         [     0.0000, 132843.7969],
         [     0.0000, 119331.4375],
         ...,
         [     0.0000,  42588.3906],
         [ 40567.6562,      0.0000],
         [ 39683.4609,      0.0000]],

        [[453350.4375,      0.0000],
         [     0.0000, 284905.4688],
         [     0.0000, 147632.4688],
         ...,
         [ 72547.4844,      0.0000],
         [ 71102.1641,      0.0000],
         [     0.0000,  68244.2188]],

        [[     0.0000, 203416.9062],
         [     0.0000, 158917.4219],
         [152679.6406,      0.0000],
         ...,
         [ 57917.1211,      0.0000],
         [ 57443.8320,      0.0000],
         [ 56929.6523,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1597629.5000,    64522.9766],
        [ 9415745.0000,        0.0000],
        [ 2597451.5000,   594412.8750],
        [ 3569851.2500,        0.0000],
        [  825656.7500,   610726.2500],
        [ 1342704.5000,   242689.3125],
        [ 2654598.2500,  1218099.5000],
        [ 3569351.5000,   123499.5000],
        [ 4249955.5000,   174719.0156],
        [ 4010482.2500,        0.0000],
        [ 6779917.5000,        0.0000],
        [ 1886453.6250,        0.0000],
        [ 3313927.7500,        0.0000],
        [11338115.0000,        0.0000],
        [12190825.0000,        0.0000],
        [ 9707507.0000,        0.0000],
        [ 7363708.5000,        0.0000],
        [ 9272059.0000,        0.0000],
        [ 4380543.0000,        0.0000],
        [ 5805827.0000,   265074.5000],
        [ 7005076.0000,        0.0000],
        [ 4977515.0000,        0.0000],
        [12050539.0000,        0.0000],
        [11783318.0000,        0.0000],
        [ 3628511.0000,        0.0000],
        [10580840.0000,        0.0000],
        [ 9554055.0000,        0.0000],
        [12890589.0000,        0.0000],
        [11421810.0000,        0.0000],
        [10935262.0000,        0.0000],
        [14001597.0000,        0.0000],
        [10945573.0000,        0.0000],
        [ 3169049.0000,   109538.6250],
        [ 2782460.0000,  1072661.3750],
        [ 3730805.0000,  1995309.1250],
        [ 1513283.7500,  1687179.2500],
        [ 1916225.2500,   973719.6250],
        [ 1467592.8750,   789073.3750],
        [ 1285452.5000,  1000658.3750],
        [ 8141817.0000,        0.0000],
        [ 2790381.5000,   267333.6250],
        [ 4061681.0000,        0.0000],
        [ 3708064.5000,        0.0000],
        [ 2995719.5000,        0.0000],
        [ 1517412.8750,  1303604.2500],
        [  352870.1875,   426816.1250],
        [ 4382882.5000,   238146.4219],
        [  718597.0000,   425522.8750],
        [  360505.5312,   330389.4062],
        [ 2219634.0000,  1212369.0000],
        [ 1256112.7500,   361346.4062],
        [ 2614782.0000,   987544.2500],
        [ 2771557.0000,  1965578.2500],
        [ 4022074.2500,   179794.7500],
        [ 6799761.0000,   362799.0000],
        [ 4189699.7500,   213015.0938],
        [ 3318157.5000,  1301838.5000],
        [ 3692509.0000,  1084604.0000],
        [ 2058690.6250,  1082892.3750],
        [ 1096868.6250,   983635.7500],
        [ 3354246.5000,   653956.5000],
        [  848345.8750,   599704.4375],
        [ 1555590.6250,   931677.6250],
        [ 1079167.6250,   674661.5625]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 361/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:54, 55.66s/it]  7%|▋         | 2/30 [00:56<10:49, 23.21s/it] 10%|█         | 3/30 [00:56<05:46, 12.83s/it] 13%|█▎        | 4/30 [00:58<03:43,  8.59s/it] 17%|█▋        | 5/30 [00:59<02:21,  5.65s/it] 20%|██        | 6/30 [01:00<01:37,  4.05s/it] 23%|██▎       | 7/30 [01:00<01:06,  2.87s/it] 27%|██▋       | 8/30 [01:01<00:46,  2.10s/it] 30%|███       | 9/30 [01:01<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:01<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.01it/s] 40%|████      | 12/30 [01:02<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:03<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:03<00:10,  1.60it/s] 50%|█████     | 15/30 [01:04<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:04<00:06,  1.98it/s] 60%|██████    | 18/30 [01:05<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:06<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.21it/s] 80%|████████  | 24/30 [01:08<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 2.678891881306966
Epoch 362/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:02, 58.03s/it]  7%|▋         | 2/30 [00:58<11:18, 24.22s/it] 10%|█         | 3/30 [00:59<06:00, 13.36s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.74s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.75s/it] 20%|██        | 6/30 [01:01<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.6717871030171714
Epoch 363/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:55, 59.85s/it]  7%|▋         | 2/30 [01:00<11:37, 24.90s/it] 10%|█         | 3/30 [01:00<06:10, 13.73s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.49s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.6941119988759357
Epoch 364/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:38, 57.17s/it]  7%|▋         | 2/30 [01:01<12:04, 25.89s/it] 10%|█         | 3/30 [01:01<06:25, 14.27s/it] 13%|█▎        | 4/30 [01:02<03:49,  8.81s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.79s/it] 20%|██        | 6/30 [01:02<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:04<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.667853569984436
Epoch 365/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:31, 59.01s/it]  7%|▋         | 2/30 [00:59<11:29, 24.64s/it] 10%|█         | 3/30 [01:00<06:07, 13.60s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.40s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.53s/it] 20%|██        | 6/30 [01:01<01:31,  3.80s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.7146809180577596
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0602, -0.0925,  0.0794,  ..., -0.0537,  0.0972,  0.0617],
        [ 0.0303, -0.0246,  0.0828,  ..., -0.0134,  0.0957,  0.1012],
        [-0.0021, -0.0103,  0.0079,  ..., -0.0538,  0.0601,  0.1215],
        ...,
        [-0.0154, -0.0022,  0.0730,  ..., -0.0452,  0.0281,  0.0184],
        [-0.0626, -0.1045,  0.0291,  ..., -0.0343,  0.0897,  0.0153],
        [-0.0238, -0.0175,  0.0594,  ..., -0.0076,  0.0905,  0.0992]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8524, 0.8496, 0.8285,  ..., 0.7559, 0.7553, 0.7551],
        [0.9344, 0.9250, 0.9242,  ..., 0.9003, 0.8987, 0.8960],
        [0.9095, 0.8754, 0.8699,  ..., 0.8015, 0.8014, 0.8011],
        ...,
        [0.8439, 0.8251, 0.8179,  ..., 0.7459, 0.7413, 0.7396],
        [0.9114, 0.8789, 0.8319,  ..., 0.7823, 0.7811, 0.7781],
        [0.8546, 0.8376, 0.8343,  ..., 0.7657, 0.7657, 0.7653]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 1, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [0., 1.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[194274.5625, 186805.4844, 138086.1875,  ...,  48942.7031,
          48556.9688,  48381.9648],
        [626650.0625, 548459.3750, 541826.7500,  ..., 384990.6562,
         376465.2812, 362039.3125],
        [439371.3438, 269712.1875, 249454.6562,  ...,  93950.1484,
          93741.6172,  93358.8828],
        ...,
        [172078.9844, 131603.7812, 118708.5156,  ...,  42450.5273,
          39755.7734,  38798.5195],
        [451201.1875, 283684.8438, 145045.0938,  ...,  71407.5469,
          70126.5156,  67190.1562],
        [200526.9688, 157277.3281, 150118.0156,  ...,  56342.5430,
          56316.9766,  55993.3477]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[194274.5625,      0.0000],
         [186805.4844,      0.0000],
         [138086.1875,      0.0000],
         ...,
         [ 48942.7031,      0.0000],
         [ 48556.9688,      0.0000],
         [ 48381.9648,      0.0000]],

        [[626650.0625,      0.0000],
         [548459.3750,      0.0000],
         [541826.7500,      0.0000],
         ...,
         [384990.6562,      0.0000],
         [376465.2812,      0.0000],
         [362039.3125,      0.0000]],

        [[439371.3438,      0.0000],
         [     0.0000, 269712.1875],
         [249454.6562,      0.0000],
         ...,
         [ 93950.1484,      0.0000],
         [ 93741.6172,      0.0000],
         [ 93358.8828,      0.0000]],

        ...,

        [[     0.0000, 172078.9844],
         [     0.0000, 131603.7812],
         [     0.0000, 118708.5156],
         ...,
         [     0.0000,  42450.5273],
         [ 39755.7734,      0.0000],
         [ 38798.5195,      0.0000]],

        [[451201.1875,      0.0000],
         [     0.0000, 283684.8438],
         [     0.0000, 145045.0938],
         ...,
         [ 71407.5469,      0.0000],
         [ 70126.5156,      0.0000],
         [     0.0000,  67190.1562]],

        [[     0.0000, 200526.9688],
         [     0.0000, 157277.3281],
         [150118.0156,      0.0000],
         ...,
         [     0.0000,  56342.5430],
         [ 56316.9766,      0.0000],
         [ 55993.3477,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1576552.6250,    63456.8242],
        [ 9315422.0000,        0.0000],
        [ 2551559.0000,   583438.0625],
        [ 3535488.2500,        0.0000],
        [  813098.1250,   603970.6250],
        [ 1313102.2500,   237762.0000],
        [ 2596770.5000,  1197271.6250],
        [ 3494049.0000,   121199.3047],
        [ 4178782.7500,   170868.3906],
        [ 3972391.5000,        0.0000],
        [ 6706810.0000,        0.0000],
        [ 1847934.2500,        0.0000],
        [ 3271396.7500,        0.0000],
        [11245279.0000,        0.0000],
        [12123774.0000,        0.0000],
        [ 9656279.0000,        0.0000],
        [ 7268158.0000,        0.0000],
        [ 9191005.0000,        0.0000],
        [ 4314995.0000,        0.0000],
        [ 5748346.0000,   262518.0312],
        [ 6915934.0000,        0.0000],
        [ 4903040.0000,        0.0000],
        [11990752.0000,        0.0000],
        [11725810.0000,        0.0000],
        [ 3569953.0000,        0.0000],
        [10538631.0000,        0.0000],
        [ 9501126.0000,        0.0000],
        [12844755.0000,        0.0000],
        [11339998.0000,        0.0000],
        [10878843.0000,        0.0000],
        [13919732.0000,        0.0000],
        [10885379.0000,        0.0000],
        [ 3129749.5000,   108216.8438],
        [ 2733893.0000,  1062856.7500],
        [ 3688961.0000,  1979726.2500],
        [ 1488002.3750,  1670396.8750],
        [ 1889785.2500,   970334.3750],
        [ 1445394.7500,   780284.5000],
        [ 1270053.2500,   990673.6250],
        [ 8050204.0000,        0.0000],
        [ 2762326.0000,   263462.7812],
        [ 4028226.5000,        0.0000],
        [ 3669834.5000,        0.0000],
        [ 2966627.0000,        0.0000],
        [ 1496482.5000,  1292808.2500],
        [  349996.9375,   422528.9375],
        [ 4328043.5000,   236175.3438],
        [  710324.2500,   423383.8750],
        [  356671.5312,   327269.4375],
        [ 2175416.5000,  1193521.2500],
        [ 1238566.0000,   360372.1250],
        [ 2571771.0000,   983163.5000],
        [ 2740048.5000,  1946803.8750],
        [ 3984131.7500,   177825.3594],
        [ 6735908.0000,   358676.9375],
        [ 4141082.7500,   210237.4688],
        [ 3274799.7500,  1285993.0000],
        [ 3662408.2500,  1077017.2500],
        [ 2032560.7500,  1069943.7500],
        [ 1084571.8750,   974067.5625],
        [ 3306887.7500,   646112.3750],
        [  837864.1250,   595413.2500],
        [ 1538065.6250,   921660.3750],
        [  999432.2500,   724563.5625]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 366/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:29, 56.89s/it]  7%|▋         | 2/30 [00:57<11:12, 24.03s/it] 10%|█         | 3/30 [00:59<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.56s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.63s/it] 20%|██        | 6/30 [01:01<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.695290033022563
Epoch 367/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:41, 57.29s/it]  7%|▋         | 2/30 [01:01<12:03, 25.85s/it] 10%|█         | 3/30 [01:01<06:24, 14.25s/it] 13%|█▎        | 4/30 [01:02<03:48,  8.80s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.78s/it] 20%|██        | 6/30 [01:02<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:04<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.663793198267619
Epoch 368/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:16, 56.43s/it]  7%|▋         | 2/30 [01:00<11:58, 25.67s/it] 10%|█         | 3/30 [01:01<06:22, 14.15s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.74s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.75s/it] 20%|██        | 6/30 [01:02<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.6797561089197797
Epoch 369/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:06, 56.08s/it]  7%|▋         | 2/30 [01:01<12:20, 26.45s/it] 10%|█         | 3/30 [01:02<06:33, 14.57s/it] 13%|█▎        | 4/30 [01:02<03:53,  8.99s/it] 17%|█▋        | 5/30 [01:03<02:27,  5.91s/it] 20%|██        | 6/30 [01:03<01:37,  4.05s/it] 23%|██▎       | 7/30 [01:03<01:06,  2.87s/it] 27%|██▋       | 8/30 [01:04<00:46,  2.10s/it] 30%|███       | 9/30 [01:04<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.01it/s] 40%|████      | 12/30 [01:06<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:06<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:07<00:10,  1.59it/s] 50%|█████     | 15/30 [01:07<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 2.687161167462667
Epoch 370/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.08s/it]  7%|▋         | 2/30 [00:59<11:34, 24.79s/it] 10%|█         | 3/30 [00:59<06:09, 13.67s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.45s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.56s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.668860157330831
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0603, -0.0930,  0.0791,  ..., -0.0535,  0.0968,  0.0616],
        [ 0.0305, -0.0243,  0.0826,  ..., -0.0131,  0.0957,  0.1011],
        [-0.0018, -0.0104,  0.0078,  ..., -0.0538,  0.0604,  0.1213],
        ...,
        [-0.0150, -0.0019,  0.0728,  ..., -0.0456,  0.0279,  0.0184],
        [-0.0622, -0.1049,  0.0289,  ..., -0.0345,  0.0899,  0.0153],
        [-0.0239, -0.0175,  0.0589,  ..., -0.0073,  0.0908,  0.0993]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8516, 0.8488, 0.8276,  ..., 0.7554, 0.7549, 0.7548],
        [0.9339, 0.9243, 0.9234,  ..., 0.8995, 0.8978, 0.8949],
        [0.9088, 0.8744, 0.8688,  ..., 0.8004, 0.8001, 0.7998],
        ...,
        [0.8438, 0.8245, 0.8175,  ..., 0.7452, 0.7398, 0.7380],
        [0.9111, 0.8786, 0.8308,  ..., 0.7812, 0.7801, 0.7769],
        [0.8537, 0.8369, 0.8332,  ..., 0.7649, 0.7639, 0.7637]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[191956.0781, 184501.5156, 136268.2969,  ...,  48601.8633,
          48248.1602,  48221.2969],
        [622534.6875, 542975.6250, 535891.3125,  ..., 380682.5000,
         371782.7812, 356368.2812],
        [434887.4375, 266100.5625, 245520.4844,  ...,  92480.3516,
          92000.2344,  91638.0625],
        ...,
        [171909.5469, 130358.5156, 118052.3594,  ...,  42024.2383,
          38916.3984,  37928.7891],
        [449102.3438, 282363.0938, 142696.5938,  ...,  70284.3281,
          69144.0703,  66114.6016],
        [197812.7188, 155600.5781, 147632.0312,  ...,  55639.6875,
          54852.0312,  54725.8516]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[191956.0781,      0.0000],
         [184501.5156,      0.0000],
         [136268.2969,      0.0000],
         ...,
         [ 48601.8633,      0.0000],
         [ 48248.1602,      0.0000],
         [ 48221.2969,      0.0000]],

        [[622534.6875,      0.0000],
         [542975.6250,      0.0000],
         [535891.3125,      0.0000],
         ...,
         [380682.5000,      0.0000],
         [371782.7812,      0.0000],
         [356368.2812,      0.0000]],

        [[434887.4375,      0.0000],
         [     0.0000, 266100.5625],
         [245520.4844,      0.0000],
         ...,
         [ 92480.3516,      0.0000],
         [ 92000.2344,      0.0000],
         [ 91638.0625,      0.0000]],

        ...,

        [[     0.0000, 171909.5469],
         [     0.0000, 130358.5156],
         [     0.0000, 118052.3594],
         ...,
         [     0.0000,  42024.2383],
         [ 38916.3984,      0.0000],
         [ 37928.7891,      0.0000]],

        [[449102.3438,      0.0000],
         [     0.0000, 282363.0938],
         [     0.0000, 142696.5938],
         ...,
         [ 70284.3281,      0.0000],
         [ 69144.0703,      0.0000],
         [     0.0000,  66114.6016]],

        [[     0.0000, 197812.7188],
         [     0.0000, 155600.5781],
         [147632.0312,      0.0000],
         ...,
         [ 55639.6875,      0.0000],
         [ 54852.0312,      0.0000],
         [ 54725.8516,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1559073.5000,    62557.9766],
        [ 9223608.0000,        0.0000],
        [ 2510607.5000,   574013.3750],
        [ 3506189.5000,        0.0000],
        [  802454.2500,   598152.1875],
        [ 1285935.5000,   233370.5625],
        [ 2546672.2500,  1179395.7500],
        [ 3432451.5000,   119305.9531],
        [ 4115797.5000,   167250.2500],
        [ 3937337.2500,        0.0000],
        [ 6639794.0000,        0.0000],
        [ 1814882.1250,        0.0000],
        [ 3231737.0000,        0.0000],
        [11160531.0000,        0.0000],
        [12060776.0000,        0.0000],
        [ 9608024.0000,        0.0000],
        [ 7184678.0000,        0.0000],
        [ 9122617.0000,        0.0000],
        [ 4258452.0000,        0.0000],
        [ 5696428.0000,   259769.3438],
        [ 6833208.0000,        0.0000],
        [ 4837249.0000,        0.0000],
        [11932070.0000,        0.0000],
        [11673329.0000,        0.0000],
        [ 3518700.0000,        0.0000],
        [10494997.0000,        0.0000],
        [ 9446922.0000,        0.0000],
        [12805021.0000,        0.0000],
        [11261352.0000,        0.0000],
        [10827180.0000,        0.0000],
        [13840508.0000,        0.0000],
        [10827382.0000,        0.0000],
        [ 3093210.5000,   106992.4922],
        [ 2688811.5000,  1054009.7500],
        [ 3650110.5000,  1965293.1250],
        [ 1464593.0000,  1655200.6250],
        [ 1867319.3750,   967374.6875],
        [ 1423803.3750,   771801.8750],
        [ 1255434.2500,   981035.5000],
        [ 7971592.5000,        0.0000],
        [ 2736891.7500,   259877.7031],
        [ 3993472.7500,        0.0000],
        [ 3634173.0000,        0.0000],
        [ 2940712.0000,        0.0000],
        [ 1476005.8750,  1280737.8750],
        [  329182.3438,   436474.8438],
        [ 4273031.5000,   234064.9062],
        [  702908.2500,   421520.0938],
        [  353127.8125,   324404.6250],
        [ 2138412.0000,  1177636.3750],
        [ 1222666.1250,   359770.0938],
        [ 2533231.5000,   978788.1250],
        [ 2711050.5000,  1929403.5000],
        [ 3950670.0000,   176047.7031],
        [ 6676963.5000,   354799.5625],
        [ 4094707.0000,   207398.8906],
        [ 3232509.5000,  1270620.8750],
        [ 3631922.0000,  1069863.3750],
        [ 2009153.0000,  1058145.5000],
        [ 1073263.8750,   965448.6250],
        [ 3263933.5000,   639387.5000],
        [  827086.0000,   590937.3125],
        [ 1521290.2500,   911792.1250],
        [  978176.1875,   717552.5000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 371/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:40, 61.38s/it]  7%|▋         | 2/30 [01:01<11:54, 25.53s/it] 10%|█         | 3/30 [01:02<06:20, 14.08s/it] 13%|█▎        | 4/30 [01:02<03:46,  8.69s/it] 17%|█▋        | 5/30 [01:03<02:22,  5.72s/it] 20%|██        | 6/30 [01:03<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.04s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 2.6881170511245727
Epoch 372/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:11, 56.27s/it]  7%|▋         | 2/30 [00:56<10:56, 23.43s/it] 10%|█         | 3/30 [00:57<05:49, 12.93s/it] 13%|█▎        | 4/30 [00:59<03:51,  8.91s/it] 17%|█▋        | 5/30 [01:01<02:32,  6.11s/it] 20%|██        | 6/30 [01:01<01:40,  4.18s/it] 23%|██▎       | 7/30 [01:01<01:08,  2.96s/it] 27%|██▋       | 8/30 [01:02<00:47,  2.16s/it] 30%|███       | 9/30 [01:02<00:34,  1.62s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.01s/it] 40%|████      | 12/30 [01:04<00:15,  1.20it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.58it/s] 50%|█████     | 15/30 [01:05<00:08,  1.73it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.86it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.97it/s] 60%|██████    | 18/30 [01:06<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.6586071491241454
Epoch 373/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:55, 55.70s/it]  7%|▋         | 2/30 [01:01<12:10, 26.07s/it] 10%|█         | 3/30 [01:01<06:27, 14.37s/it] 13%|█▎        | 4/30 [01:01<03:50,  8.87s/it] 17%|█▋        | 5/30 [01:02<02:25,  5.83s/it] 20%|██        | 6/30 [01:02<01:35,  4.00s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.07s/it] 30%|███       | 9/30 [01:04<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.6591224670410156
Epoch 374/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:02, 55.94s/it]  7%|▋         | 2/30 [00:59<11:50, 25.39s/it] 10%|█         | 3/30 [01:00<06:17, 14.00s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.65s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.69s/it] 20%|██        | 6/30 [01:01<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.6791080474853515
Epoch 375/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:44, 59.45s/it]  7%|▋         | 2/30 [00:59<11:32, 24.74s/it] 10%|█         | 3/30 [01:00<06:08, 13.64s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.43s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.55s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.662473726272583
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0603, -0.0935,  0.0789,  ..., -0.0532,  0.0965,  0.0617],
        [ 0.0307, -0.0240,  0.0825,  ..., -0.0129,  0.0957,  0.1011],
        [-0.0016, -0.0103,  0.0077,  ..., -0.0536,  0.0605,  0.1211],
        ...,
        [-0.0146, -0.0017,  0.0727,  ..., -0.0459,  0.0278,  0.0184],
        [-0.0619, -0.1053,  0.0287,  ..., -0.0346,  0.0901,  0.0155],
        [-0.0239, -0.0175,  0.0585,  ..., -0.0069,  0.0911,  0.0994]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8507, 0.8480, 0.8266,  ..., 0.7548, 0.7547, 0.7543],
        [0.9335, 0.9237, 0.9227,  ..., 0.8987, 0.8970, 0.8939],
        [0.9080, 0.8735, 0.8677,  ..., 0.7994, 0.7988, 0.7986],
        ...,
        [0.8436, 0.8239, 0.8171,  ..., 0.7436, 0.7384, 0.7365],
        [0.9107, 0.8782, 0.8297,  ..., 0.7802, 0.7792, 0.7759],
        [0.8529, 0.8362, 0.8321,  ..., 0.7634, 0.7626, 0.7622]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[189713.5781, 182350.2500, 134438.3281,  ...,  48153.1875,
          48134.4570,  47837.4102],
        [618779.0625, 538196.0625, 530766.9375,  ..., 376708.4375,
         367598.5938, 351627.8125],
        [430234.2188, 262511.7812, 241671.1562,  ...,  91090.0859,
          90371.3984,  90105.3906],
        ...,
        [171417.7656, 129232.8438, 117413.9453,  ...,  41059.8320,
          38147.2734,  37115.6992],
        [446759.6562, 281029.2500, 140452.9375,  ...,  69241.7969,
          68257.9531,  65173.8828],
        [195576.3750, 154234.4375, 145354.1719,  ...,  54456.3789,
          53899.1445,  53580.7227]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[189713.5781,      0.0000],
         [182350.2500,      0.0000],
         [134438.3281,      0.0000],
         ...,
         [ 48153.1875,      0.0000],
         [ 48134.4570,      0.0000],
         [ 47837.4102,      0.0000]],

        [[618779.0625,      0.0000],
         [538196.0625,      0.0000],
         [530766.9375,      0.0000],
         ...,
         [376708.4375,      0.0000],
         [367598.5938,      0.0000],
         [351627.8125,      0.0000]],

        [[430234.2188,      0.0000],
         [     0.0000, 262511.7812],
         [241671.1562,      0.0000],
         ...,
         [ 91090.0859,      0.0000],
         [ 90371.3984,      0.0000],
         [ 90105.3906,      0.0000]],

        ...,

        [[     0.0000, 171417.7656],
         [     0.0000, 129232.8438],
         [     0.0000, 117413.9453],
         ...,
         [     0.0000,  41059.8320],
         [ 38147.2734,      0.0000],
         [ 37115.6992,      0.0000]],

        [[446759.6562,      0.0000],
         [     0.0000, 281029.2500],
         [     0.0000, 140452.9375],
         ...,
         [ 69241.7969,      0.0000],
         [ 68257.9531,      0.0000],
         [     0.0000,  65173.8828]],

        [[     0.0000, 195576.3750],
         [     0.0000, 154234.4375],
         [145354.1719,      0.0000],
         ...,
         [ 54456.3789,      0.0000],
         [ 53899.1445,      0.0000],
         [ 53580.7227,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1541514.8750,    61664.1562],
        [ 9140474.0000,        0.0000],
        [ 2471302.7500,   564655.8750],
        [ 3477951.2500,        0.0000],
        [  792082.2500,   592256.8125],
        [ 1260978.5000,   229451.9844],
        [ 2500071.2500,  1163165.3750],
        [ 3370501.5000,   117477.3438],
        [ 4056718.5000,   164048.0312],
        [ 3903981.5000,        0.0000],
        [ 6580423.0000,        0.0000],
        [ 1781997.5000,        0.0000],
        [ 3194447.2500,        0.0000],
        [11080334.0000,        0.0000],
        [12006143.0000,        0.0000],
        [ 9563132.0000,        0.0000],
        [ 7103228.0000,        0.0000],
        [ 9057842.0000,        0.0000],
        [ 4203550.5000,        0.0000],
        [ 5648206.5000,   257503.0781],
        [ 6756534.5000,        0.0000],
        [ 4773580.0000,        0.0000],
        [11881198.0000,        0.0000],
        [11627086.0000,        0.0000],
        [ 3469378.0000,        0.0000],
        [10457186.0000,        0.0000],
        [ 9400374.0000,        0.0000],
        [12768813.0000,        0.0000],
        [11192344.0000,        0.0000],
        [10779222.0000,        0.0000],
        [13769598.0000,        0.0000],
        [10772541.0000,        0.0000],
        [ 3059331.2500,   105910.2969],
        [ 2648438.7500,  1045477.6250],
        [ 3614136.2500,  1952511.2500],
        [ 1443219.7500,  1640705.6250],
        [ 1846064.3750,   964236.9375],
        [ 1403755.0000,   763858.3125],
        [ 1241795.3750,   971855.5625],
        [ 7893766.0000,        0.0000],
        [ 2712629.7500,   256565.7969],
        [ 3963414.5000,        0.0000],
        [ 3603023.2500,        0.0000],
        [ 2917715.7500,        0.0000],
        [ 1457137.1250,  1269841.7500],
        [  326633.6875,   431976.5000],
        [ 4224686.5000,   232124.2812],
        [  696257.1250,   419845.5000],
        [  349980.3750,   321677.0000],
        [ 2101315.7500,  1161700.1250],
        [ 1207905.6250,   359078.4375],
        [ 2496869.7500,   974667.7500],
        [ 2686134.7500,  1914341.2500],
        [ 3920645.5000,   174589.5938],
        [ 6622858.0000,   351250.7812],
        [ 4052051.0000,   204801.2812],
        [ 3194331.0000,  1256795.0000],
        [ 3605297.5000,  1063727.3750],
        [ 1988298.5000,  1048068.3125],
        [ 1062958.8750,   957874.0000],
        [ 3225033.5000,   633353.5625],
        [  816589.5625,   586337.1875],
        [ 1505524.1250,   902652.9375],
        [  959698.0000,   711766.4375]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 376/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:12, 60.44s/it]  7%|▋         | 2/30 [01:00<11:44, 25.16s/it] 10%|█         | 3/30 [01:01<06:14, 13.87s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.6644126176834106
Epoch 377/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.08s/it]  7%|▋         | 2/30 [01:00<11:59, 25.69s/it] 10%|█         | 3/30 [01:01<06:22, 14.16s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.75s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.75s/it] 20%|██        | 6/30 [01:02<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.6823550780614216
Epoch 378/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:45, 55.36s/it]  7%|▋         | 2/30 [00:56<10:57, 23.49s/it] 10%|█         | 3/30 [00:57<05:51, 13.00s/it] 13%|█▎        | 4/30 [00:57<03:29,  8.04s/it] 17%|█▋        | 5/30 [00:59<02:22,  5.71s/it] 20%|██        | 6/30 [01:00<01:40,  4.20s/it] 23%|██▎       | 7/30 [01:00<01:09,  3.03s/it] 27%|██▋       | 8/30 [01:01<00:48,  2.21s/it] 30%|███       | 9/30 [01:01<00:34,  1.66s/it] 33%|███▎      | 10/30 [01:02<00:25,  1.28s/it] 37%|███▋      | 11/30 [01:02<00:19,  1.02s/it] 40%|████      | 12/30 [01:03<00:15,  1.18it/s] 43%|████▎     | 13/30 [01:03<00:12,  1.38it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.57it/s] 50%|█████     | 15/30 [01:04<00:08,  1.73it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.86it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.97it/s] 60%|██████    | 18/30 [01:05<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.15it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 2.6494928359985352
Epoch 379/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:39, 57.23s/it]  7%|▋         | 2/30 [00:57<11:07, 23.83s/it] 10%|█         | 3/30 [00:58<05:55, 13.15s/it] 13%|█▎        | 4/30 [00:59<03:45,  8.66s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.70s/it] 20%|██        | 6/30 [01:00<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.6405628363291425
Epoch 380/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:01, 60.06s/it]  7%|▋         | 2/30 [01:00<11:39, 24.99s/it] 10%|█         | 3/30 [01:00<06:12, 13.78s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.60s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.43s/it]
Epoch loss is 2.6804092089335123
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0604, -0.0940,  0.0787,  ..., -0.0529,  0.0961,  0.0615],
        [ 0.0309, -0.0237,  0.0824,  ..., -0.0126,  0.0957,  0.1010],
        [-0.0014, -0.0103,  0.0076,  ..., -0.0535,  0.0607,  0.1208],
        ...,
        [-0.0142, -0.0015,  0.0725,  ..., -0.0463,  0.0277,  0.0183],
        [-0.0616, -0.1056,  0.0285,  ..., -0.0348,  0.0902,  0.0155],
        [-0.0240, -0.0176,  0.0581,  ..., -0.0066,  0.0914,  0.0994]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8499, 0.8472, 0.8258,  ..., 0.7543, 0.7541, 0.7538],
        [0.9331, 0.9231, 0.9221,  ..., 0.8981, 0.8962, 0.8932],
        [0.9074, 0.8727, 0.8667,  ..., 0.7983, 0.7976, 0.7976],
        ...,
        [0.8435, 0.8233, 0.8167,  ..., 0.7421, 0.7372, 0.7352],
        [0.9103, 0.8779, 0.8286,  ..., 0.7792, 0.7785, 0.7750],
        [0.8521, 0.8356, 0.8311,  ..., 0.7620, 0.7617, 0.7608]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[187566.3125, 180261.4062, 132823.1562,  ...,  47835.1289,
          47703.1094,  47530.1367],
        [615183.3750, 533598.0000, 525793.4375,  ..., 373038.6562,
         363504.1250, 347956.0312],
        [426078.3438, 259626.4219, 238294.5469,  ...,  89718.3281,
          88830.0000,  88765.8125],
        ...,
        [171149.0625, 128177.7500, 116702.6094,  ...,  40213.2422,
          37465.3164,  36395.4180],
        [444574.2500, 279819.6562, 138361.9531,  ...,  68295.6484,
          67576.1172,  64328.2695],
        [193514.3906, 152902.7188, 143350.3438,  ...,  53414.7539,
          53148.1445,  52475.1719]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[187566.3125,      0.0000],
         [180261.4062,      0.0000],
         [132823.1562,      0.0000],
         ...,
         [ 47835.1289,      0.0000],
         [ 47703.1094,      0.0000],
         [ 47530.1367,      0.0000]],

        [[615183.3750,      0.0000],
         [533598.0000,      0.0000],
         [525793.4375,      0.0000],
         ...,
         [373038.6562,      0.0000],
         [363504.1250,      0.0000],
         [347956.0312,      0.0000]],

        [[426078.3438,      0.0000],
         [     0.0000, 259626.4219],
         [238294.5469,      0.0000],
         ...,
         [ 89718.3281,      0.0000],
         [ 88830.0000,      0.0000],
         [ 88765.8125,      0.0000]],

        ...,

        [[     0.0000, 171149.0625],
         [     0.0000, 128177.7500],
         [     0.0000, 116702.6094],
         ...,
         [     0.0000,  40213.2422],
         [ 37465.3164,      0.0000],
         [ 36395.4180,      0.0000]],

        [[444574.2500,      0.0000],
         [     0.0000, 279819.6562],
         [     0.0000, 138361.9531],
         ...,
         [ 68295.6484,      0.0000],
         [ 67576.1172,      0.0000],
         [     0.0000,  64328.2695]],

        [[     0.0000, 193514.3906],
         [     0.0000, 152902.7188],
         [143350.3438,      0.0000],
         ...,
         [ 53414.7539,      0.0000],
         [ 53148.1445,      0.0000],
         [ 52475.1719,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1525840.0000,    60805.0781],
        [ 9063678.0000,        0.0000],
        [ 2436306.0000,   556820.8750],
        [ 3452575.7500,        0.0000],
        [  782910.4375,   587083.0000],
        [ 1239372.7500,   226082.1250],
        [ 2459877.0000,  1148813.7500],
        [ 3318386.2500,   115870.6406],
        [ 4005210.0000,   161101.5156],
        [ 3873298.2500,        0.0000],
        [ 6524137.0000,        0.0000],
        [ 1753783.2500,        0.0000],
        [ 3161968.5000,        0.0000],
        [11007920.0000,        0.0000],
        [11952004.0000,        0.0000],
        [ 9521518.0000,        0.0000],
        [ 7025654.5000,        0.0000],
        [ 8999661.0000,        0.0000],
        [ 4155773.5000,        0.0000],
        [ 5601953.0000,   255201.0938],
        [ 6686929.0000,        0.0000],
        [ 4716873.0000,        0.0000],
        [11833199.0000,        0.0000],
        [11580465.0000,        0.0000],
        [ 3425923.7500,        0.0000],
        [10423166.0000,        0.0000],
        [ 9356034.0000,        0.0000],
        [12734417.0000,        0.0000],
        [11124979.0000,        0.0000],
        [10730278.0000,        0.0000],
        [13703626.0000,        0.0000],
        [10720722.0000,        0.0000],
        [ 3026130.0000,   104843.1562],
        [ 2612519.5000,  1037913.0000],
        [ 3580768.5000,  1940805.7500],
        [ 1424035.5000,  1627983.5000],
        [ 1826229.5000,   961237.8125],
        [ 1385050.0000,   756563.0625],
        [ 1229452.7500,   963851.3750],
        [ 7826922.5000,        0.0000],
        [ 2689557.5000,   253625.1719],
        [ 3936018.7500,        0.0000],
        [ 3573498.0000,        0.0000],
        [ 2896589.0000,        0.0000],
        [ 1441646.6250,  1260513.7500],
        [  342489.4688,   410161.6250],
        [ 4181272.5000,   230364.0000],
        [  690524.4375,   418598.1875],
        [  347413.9688,   319654.6250],
        [ 2068620.8750,  1147961.7500],
        [ 1194847.1250,   358604.8438],
        [ 2465272.0000,   970954.2500],
        [ 2663069.5000,  1900638.5000],
        [ 3891877.0000,   173143.0625],
        [ 6572434.5000,   347915.8750],
        [ 4012395.7500,   202404.8594],
        [ 3159253.7500,  1244425.5000],
        [ 3577781.5000,  1057709.5000],
        [ 1969404.5000,  1039251.1250],
        [ 1052978.1250,   950685.8750],
        [ 3189739.5000,   627515.3750],
        [  807352.7500,   582205.4375],
        [ 1491552.3750,   894519.5000],
        [  943531.4375,   706429.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 381/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:48, 59.61s/it]  7%|▋         | 2/30 [01:00<11:34, 24.80s/it] 10%|█         | 3/30 [01:00<06:14, 13.87s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.43s/it]
Epoch loss is 2.7054136753082276
Epoch 382/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:37, 57.16s/it]  7%|▋         | 2/30 [00:59<11:39, 24.99s/it] 10%|█         | 3/30 [01:00<06:12, 13.78s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.52s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.60s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.6530333518981934
Epoch 383/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:21, 56.59s/it]  7%|▋         | 2/30 [01:01<12:07, 25.99s/it] 10%|█         | 3/30 [01:01<06:26, 14.33s/it] 13%|█▎        | 4/30 [01:02<03:49,  8.84s/it] 17%|█▋        | 5/30 [01:02<02:25,  5.81s/it] 20%|██        | 6/30 [01:02<01:35,  3.99s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.83s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.07s/it] 30%|███       | 9/30 [01:04<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.693363579114278
Epoch 384/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:07, 58.20s/it]  7%|▋         | 2/30 [00:59<11:29, 24.62s/it] 10%|█         | 3/30 [00:59<06:06, 13.58s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.40s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.53s/it] 20%|██        | 6/30 [01:02<01:41,  4.22s/it] 23%|██▎       | 7/30 [01:02<01:08,  2.98s/it] 27%|██▋       | 8/30 [01:03<00:47,  2.17s/it] 30%|███       | 9/30 [01:03<00:34,  1.63s/it] 33%|███▎      | 10/30 [01:04<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:04<00:19,  1.01s/it] 40%|████      | 12/30 [01:04<00:15,  1.19it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.39it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.57it/s] 50%|█████     | 15/30 [01:06<00:08,  1.73it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.86it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.97it/s] 60%|██████    | 18/30 [01:07<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.25it/s]100%|██████████| 30/30 [01:12<00:00,  2.25it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.655898110071818
Epoch 385/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:58, 57.88s/it]  7%|▋         | 2/30 [00:58<11:25, 24.49s/it] 10%|█         | 3/30 [01:00<06:15, 13.89s/it] 13%|█▎        | 4/30 [01:00<03:43,  8.58s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.65s/it] 20%|██        | 6/30 [01:01<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.590384864807129
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0605, -0.0944,  0.0786,  ..., -0.0527,  0.0957,  0.0615],
        [ 0.0311, -0.0234,  0.0824,  ..., -0.0124,  0.0956,  0.1010],
        [-0.0012, -0.0102,  0.0075,  ..., -0.0534,  0.0608,  0.1207],
        ...,
        [-0.0138, -0.0012,  0.0724,  ..., -0.0466,  0.0275,  0.0183],
        [-0.0614, -0.1059,  0.0284,  ..., -0.0349,  0.0904,  0.0156],
        [-0.0240, -0.0176,  0.0577,  ..., -0.0063,  0.0916,  0.0995]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8492, 0.8464, 0.8250,  ..., 0.7535, 0.7535, 0.7535],
        [0.9327, 0.9225, 0.9214,  ..., 0.8974, 0.8955, 0.8925],
        [0.9067, 0.8719, 0.8658,  ..., 0.7973, 0.7966, 0.7965],
        ...,
        [0.8434, 0.8227, 0.8163,  ..., 0.7406, 0.7359, 0.7338],
        [0.9100, 0.8776, 0.8276,  ..., 0.7783, 0.7778, 0.7742],
        [0.8514, 0.8351, 0.8302,  ..., 0.7607, 0.7607, 0.7593]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[185608.9375, 178413.4375, 131318.5469,  ...,  47333.6367,
          47331.1094,  47289.9180],
        [611520.5000, 529234.5000, 521013.0312,  ..., 369643.5312,
         359670.5938, 344396.8125],
        [422301.1875, 256787.9844, 235167.7656,  ...,  88467.1562,
          87503.1250,  87433.5547],
        ...,
        [170749.4688, 127039.1641, 116026.1172,  ...,  39357.6367,
          36793.5820,  35711.0430],
        [442704.5938, 278650.0938, 136347.9844,  ...,  67375.6641,
          66907.5938,  63535.7891],
        [191659.7500, 151698.7969, 141525.9062,  ...,  52450.0586,
          52449.2031,  51418.9023]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[185608.9375,      0.0000],
         [178413.4375,      0.0000],
         [131318.5469,      0.0000],
         ...,
         [ 47333.6367,      0.0000],
         [ 47331.1094,      0.0000],
         [ 47289.9180,      0.0000]],

        [[611520.5000,      0.0000],
         [529234.5000,      0.0000],
         [521013.0312,      0.0000],
         ...,
         [369643.5312,      0.0000],
         [359670.5938,      0.0000],
         [344396.8125,      0.0000]],

        [[422301.1875,      0.0000],
         [     0.0000, 256787.9844],
         [235167.7656,      0.0000],
         ...,
         [ 88467.1562,      0.0000],
         [ 87503.1250,      0.0000],
         [ 87433.5547,      0.0000]],

        ...,

        [[     0.0000, 170749.4688],
         [     0.0000, 127039.1641],
         [     0.0000, 116026.1172],
         ...,
         [     0.0000,  39357.6367],
         [ 36793.5820,      0.0000],
         [ 35711.0430,      0.0000]],

        [[442704.5938,      0.0000],
         [     0.0000, 278650.0938],
         [     0.0000, 136347.9844],
         ...,
         [ 67375.6641,      0.0000],
         [ 66907.5938,      0.0000],
         [     0.0000,  63535.7891]],

        [[     0.0000, 191659.7500],
         [     0.0000, 151698.7969],
         [141525.9062,      0.0000],
         ...,
         [ 52450.0586,      0.0000],
         [ 52449.2031,      0.0000],
         [ 51418.9023,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1511182.7500,    59985.1328],
        [ 8989999.0000,        0.0000],
        [ 2404100.2500,   549378.8125],
        [ 3427033.0000,        0.0000],
        [  773652.3125,   582159.4375],
        [ 1219782.6250,   223023.3594],
        [ 2422052.5000,  1135646.1250],
        [ 3267560.7500,   114319.3906],
        [ 3956427.0000,   158438.7812],
        [ 3843819.0000,        0.0000],
        [ 6469926.0000,        0.0000],
        [ 1727108.2500,        0.0000],
        [ 3130963.5000,        0.0000],
        [10940824.0000,        0.0000],
        [11897932.0000,        0.0000],
        [ 9477381.0000,        0.0000],
        [ 6953071.0000,        0.0000],
        [ 8942521.0000,        0.0000],
        [ 4111623.2500,        0.0000],
        [ 5558274.5000,   252888.1250],
        [ 6622387.0000,        0.0000],
        [ 4662288.0000,        0.0000],
        [11785382.0000,        0.0000],
        [11534560.0000,        0.0000],
        [ 3386425.5000,        0.0000],
        [10388421.0000,        0.0000],
        [ 9312802.0000,        0.0000],
        [12700111.0000,        0.0000],
        [11062233.0000,        0.0000],
        [10681510.0000,        0.0000],
        [13639180.0000,        0.0000],
        [10670716.0000,        0.0000],
        [ 2996479.0000,   103805.9609],
        [ 2577591.5000,  1030333.6875],
        [ 3549280.7500,  1928997.6250],
        [ 1405506.7500,  1615683.3750],
        [ 1807738.6250,   958465.3125],
        [ 1368369.1250,   749990.0625],
        [ 1217480.2500,   956405.2500],
        [ 7762396.0000,        0.0000],
        [ 2669466.0000,   250863.8438],
        [ 3907783.7500,        0.0000],
        [ 3545167.5000,        0.0000],
        [ 2875855.2500,        0.0000],
        [ 1426223.7500,  1251748.0000],
        [  340530.9375,   406546.1250],
        [ 4136892.0000,   228715.6406],
        [  684929.5000,   417404.7812],
        [  344704.8125,   317534.0312],
        [ 2038001.0000,  1134868.7500],
        [ 1182155.0000,   358286.6250],
        [ 2434807.0000,   967349.5000],
        [ 2640810.7500,  1887334.0000],
        [ 3864353.0000,   171814.9844],
        [ 6523867.5000,   344627.1562],
        [ 3975164.7500,   200074.8125],
        [ 3122914.0000,  1231606.6250],
        [ 3550380.0000,  1051691.1250],
        [ 1951724.3750,  1031217.2500],
        [ 1044080.7500,   943649.6250],
        [ 3155861.7500,   621975.5000],
        [  798079.5000,   577821.5000],
        [ 1478158.8750,   886649.3125],
        [  928535.5625,   701596.9375]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 386/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:41, 59.37s/it]  7%|▋         | 2/30 [00:59<11:31, 24.71s/it] 10%|█         | 3/30 [01:00<06:07, 13.63s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.42s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.54s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.6164605538050334
Epoch 387/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:20, 56.57s/it]  7%|▋         | 2/30 [00:57<11:08, 23.89s/it] 10%|█         | 3/30 [00:58<06:07, 13.59s/it] 13%|█▎        | 4/30 [00:59<03:43,  8.61s/it] 17%|█▋        | 5/30 [01:00<02:21,  5.66s/it] 20%|██        | 6/30 [01:00<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.02s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 2.6341512838999432
Epoch 388/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:28, 56.86s/it]  7%|▋         | 2/30 [00:59<11:43, 25.11s/it] 10%|█         | 3/30 [01:00<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.63s/it] 20%|██        | 6/30 [01:01<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.643019183476766
Epoch 389/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:49, 55.49s/it]  7%|▋         | 2/30 [00:59<11:47, 25.26s/it] 10%|█         | 3/30 [01:00<06:16, 13.93s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.63s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.68s/it] 20%|██        | 6/30 [01:01<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.638129719098409
Epoch 390/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:33, 57.00s/it]  7%|▋         | 2/30 [00:57<11:04, 23.73s/it] 10%|█         | 3/30 [00:58<06:02, 13.42s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.30s/it] 17%|█▋        | 5/30 [00:59<02:16,  5.46s/it] 20%|██        | 6/30 [00:59<01:30,  3.76s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.67s/it] 27%|██▋       | 8/30 [01:00<00:43,  1.96s/it] 30%|███       | 9/30 [01:01<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:03<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 2.633925731976827
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0606, -0.0947,  0.0785,  ..., -0.0525,  0.0953,  0.0615],
        [ 0.0314, -0.0231,  0.0823,  ..., -0.0122,  0.0956,  0.1010],
        [-0.0009, -0.0102,  0.0074,  ..., -0.0533,  0.0610,  0.1205],
        ...,
        [-0.0134, -0.0011,  0.0723,  ..., -0.0469,  0.0274,  0.0183],
        [-0.0611, -0.1063,  0.0282,  ..., -0.0350,  0.0905,  0.0157],
        [-0.0240, -0.0177,  0.0573,  ..., -0.0061,  0.0918,  0.0996]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8486, 0.8458, 0.8242,  ..., 0.7532, 0.7531, 0.7530],
        [0.9323, 0.9220, 0.9208,  ..., 0.8968, 0.8948, 0.8918],
        [0.9062, 0.8712, 0.8649,  ..., 0.7964, 0.7957, 0.7955],
        ...,
        [0.8432, 0.8221, 0.8159,  ..., 0.7393, 0.7348, 0.7326],
        [0.9098, 0.8774, 0.8267,  ..., 0.7774, 0.7771, 0.7734],
        [0.8508, 0.8346, 0.8294,  ..., 0.7599, 0.7596, 0.7580]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[183903.1875, 176894.9062, 129938.8672,  ...,  47107.3047,
          47015.9258,  46947.3320],
        [608282.5000, 525089.8750, 516568.1562,  ..., 366548.3750,
         356221.1562, 341222.6875],
        [418958.4688, 254267.9844, 232389.1719,  ...,  87365.2969,
          86394.5781,  86197.5469],
        ...,
        [170356.1719, 126036.4688, 115355.1953,  ...,  38624.9648,
          36218.4180,  35104.9648],
        [440988.3750, 277678.9062, 134590.8438,  ...,  66574.9609,
          66247.0234,  62841.0469],
        [189971.2188, 150618.6406, 139873.8750,  ...,  51830.3438,
          51583.7383,  50443.9023]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[183903.1875,      0.0000],
         [176894.9062,      0.0000],
         [129938.8672,      0.0000],
         ...,
         [ 47107.3047,      0.0000],
         [ 47015.9258,      0.0000],
         [ 46947.3320,      0.0000]],

        [[608282.5000,      0.0000],
         [525089.8750,      0.0000],
         [516568.1562,      0.0000],
         ...,
         [366548.3750,      0.0000],
         [356221.1562,      0.0000],
         [341222.6875,      0.0000]],

        [[418958.4688,      0.0000],
         [     0.0000, 254267.9844],
         [232389.1719,      0.0000],
         ...,
         [ 87365.2969,      0.0000],
         [ 86394.5781,      0.0000],
         [ 86197.5469,      0.0000]],

        ...,

        [[     0.0000, 170356.1719],
         [     0.0000, 126036.4688],
         [     0.0000, 115355.1953],
         ...,
         [     0.0000,  38624.9648],
         [ 36218.4180,      0.0000],
         [ 35104.9648,      0.0000]],

        [[440988.3750,      0.0000],
         [     0.0000, 277678.9062],
         [     0.0000, 134590.8438],
         ...,
         [ 66574.9609,      0.0000],
         [ 66247.0234,      0.0000],
         [     0.0000,  62841.0469]],

        [[     0.0000, 189971.2188],
         [     0.0000, 150618.6406],
         [139873.8750,      0.0000],
         ...,
         [ 51830.3438,      0.0000],
         [ 51583.7383,      0.0000],
         [ 50443.9023,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1498719.8750,    59339.2891],
        [ 8922569.0000,        0.0000],
        [ 2375533.7500,   542778.0000],
        [ 3402674.2500,        0.0000],
        [  765267.5000,   577648.2500],
        [ 1201000.2500,   219996.5156],
        [ 2387487.0000,  1123424.6250],
        [ 3223989.5000,   112961.4531],
        [ 3913529.0000,   156273.5000],
        [ 3817825.5000,        0.0000],
        [ 6419253.5000,        0.0000],
        [ 1703143.0000,        0.0000],
        [ 3103084.5000,        0.0000],
        [10878346.0000,        0.0000],
        [11850515.0000,        0.0000],
        [ 9440054.0000,        0.0000],
        [ 6890209.0000,        0.0000],
        [ 8892670.0000,        0.0000],
        [ 4072177.5000,        0.0000],
        [ 5518053.5000,   251002.9375],
        [ 6563177.5000,        0.0000],
        [ 4613724.0000,        0.0000],
        [11742791.0000,        0.0000],
        [11493937.0000,        0.0000],
        [ 3351008.5000,        0.0000],
        [10359846.0000,        0.0000],
        [ 9273324.0000,        0.0000],
        [12667571.0000,        0.0000],
        [11005332.0000,        0.0000],
        [10639010.0000,        0.0000],
        [13582457.0000,        0.0000],
        [10627723.0000,        0.0000],
        [ 2970703.0000,   102872.5859],
        [ 2546549.7500,  1023771.6250],
        [ 3521546.0000,  1918364.1250],
        [ 1389063.0000,  1604943.3750],
        [ 1791401.5000,   956149.3750],
        [ 1353644.7500,   744182.3125],
        [ 1207459.0000,   949880.9375],
        [ 7706780.0000,        0.0000],
        [ 2650338.7500,   248396.0000],
        [ 3883236.0000,        0.0000],
        [ 3519630.0000,        0.0000],
        [ 2857844.2500,        0.0000],
        [ 1412657.3750,  1244405.1250],
        [  338679.3750,   403463.0938],
        [ 4098372.0000,   227303.3281],
        [  679816.5000,   416440.9062],
        [  342368.7188,   315700.1562],
        [ 2011055.0000,  1123459.5000],
        [ 1170836.7500,   357800.6562],
        [ 2407849.5000,   964363.1250],
        [ 2620400.7500,  1874947.2500],
        [ 3839317.2500,   170619.5625],
        [ 6479665.0000,   341689.0312],
        [ 3941889.5000,   197974.8281],
        [ 3090791.5000,  1220156.3750],
        [ 3526791.0000,  1046205.1250],
        [ 1935106.5000,  1023204.5000],
        [ 1036169.3750,   937208.2500],
        [ 3125053.0000,   616946.5625],
        [  789675.6875,   573809.6875],
        [ 1466269.2500,   879895.6250],
        [  914943.3125,   697328.8125]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 391/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:17, 60.62s/it]  7%|▋         | 2/30 [01:01<11:46, 25.22s/it] 10%|█         | 3/30 [01:01<06:15, 13.91s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.59s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.65s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.6757569154103598
Epoch 392/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:33, 57.00s/it]  7%|▋         | 2/30 [00:57<11:04, 23.74s/it] 10%|█         | 3/30 [00:57<05:53, 13.10s/it] 13%|█▎        | 4/30 [00:58<03:30,  8.11s/it] 17%|█▋        | 5/30 [00:59<02:21,  5.66s/it] 20%|██        | 6/30 [01:00<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:00<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:00<00:44,  2.02s/it] 30%|███       | 9/30 [01:01<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:02<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:04<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 2.6563648223876952
Epoch 393/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:26, 58.85s/it]  7%|▋         | 2/30 [00:59<11:25, 24.49s/it] 10%|█         | 3/30 [00:59<06:06, 13.56s/it] 13%|█▎        | 4/30 [01:00<03:37,  8.38s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.52s/it] 20%|██        | 6/30 [01:01<01:30,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.70s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.64it/s] 50%|█████     | 15/30 [01:05<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.6897199312845865
Epoch 394/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:45, 55.36s/it]  7%|▋         | 2/30 [00:59<11:48, 25.31s/it] 10%|█         | 3/30 [01:00<06:16, 13.96s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:00<02:21,  5.67s/it] 20%|██        | 6/30 [01:01<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.17it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.6363451639811197
Epoch 395/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:54, 55.67s/it]  7%|▋         | 2/30 [01:00<11:54, 25.50s/it] 10%|█         | 3/30 [01:00<06:19, 14.06s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.68s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.71s/it] 20%|██        | 6/30 [01:01<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.6376524289449055
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0607, -0.0949,  0.0784,  ..., -0.0523,  0.0951,  0.0614],
        [ 0.0317, -0.0229,  0.0823,  ..., -0.0121,  0.0955,  0.1010],
        [-0.0006, -0.0102,  0.0073,  ..., -0.0532,  0.0611,  0.1203],
        ...,
        [-0.0131, -0.0010,  0.0722,  ..., -0.0472,  0.0273,  0.0183],
        [-0.0608, -0.1065,  0.0281,  ..., -0.0351,  0.0906,  0.0158],
        [-0.0240, -0.0178,  0.0570,  ..., -0.0058,  0.0920,  0.0997]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8479, 0.8453, 0.8236,  ..., 0.7530, 0.7527, 0.7526],
        [0.9320, 0.9215, 0.9203,  ..., 0.8963, 0.8942, 0.8912],
        [0.9057, 0.8706, 0.8642,  ..., 0.7957, 0.7948, 0.7946],
        ...,
        [0.8432, 0.8215, 0.8155,  ..., 0.7382, 0.7339, 0.7320],
        [0.9095, 0.8772, 0.8259,  ..., 0.7767, 0.7764, 0.7727],
        [0.8502, 0.8341, 0.8286,  ..., 0.7592, 0.7585, 0.7568]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[182277.4062, 175471.0938, 128776.6484,  ...,  46948.0000,
          46750.3828,  46703.1484],
        [605425.2500, 521434.5312, 512561.4062,  ..., 363785.3750,
         353158.2812, 338357.1562],
        [415849.1875, 251822.4531, 229840.6250,  ...,  86495.0703,
          85384.3828,  85146.2891],
        ...,
        [170254.8281, 124996.1562, 114715.6094,  ...,  37988.3359,
          35739.2891,  34805.5117],
        [439311.8438, 276741.4375, 132967.5156,  ...,  65910.3828,
          65630.5078,  62231.1172],
        [188411.0781, 149651.1719, 138343.6250,  ...,  51308.6367,
          50798.3398,  49618.6133]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[182277.4062,      0.0000],
         [175471.0938,      0.0000],
         [128776.6484,      0.0000],
         ...,
         [ 46948.0000,      0.0000],
         [ 46750.3828,      0.0000],
         [ 46703.1484,      0.0000]],

        [[605425.2500,      0.0000],
         [521434.5312,      0.0000],
         [512561.4062,      0.0000],
         ...,
         [363785.3750,      0.0000],
         [353158.2812,      0.0000],
         [338357.1562,      0.0000]],

        [[415849.1875,      0.0000],
         [     0.0000, 251822.4531],
         [229840.6250,      0.0000],
         ...,
         [ 86495.0703,      0.0000],
         [ 85384.3828,      0.0000],
         [ 85146.2891,      0.0000]],

        ...,

        [[     0.0000, 170254.8281],
         [     0.0000, 124996.1562],
         [     0.0000, 114715.6094],
         ...,
         [     0.0000,  37988.3359],
         [ 35739.2891,      0.0000],
         [ 34805.5117,      0.0000]],

        [[439311.8438,      0.0000],
         [     0.0000, 276741.4375],
         [     0.0000, 132967.5156],
         ...,
         [ 65910.3828,      0.0000],
         [ 65630.5078,      0.0000],
         [     0.0000,  62231.1172]],

        [[     0.0000, 188411.0781],
         [     0.0000, 149651.1719],
         [138343.6250,      0.0000],
         ...,
         [ 51308.6367,      0.0000],
         [ 50798.3398,      0.0000],
         [ 49618.6133,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1487523.2500,    58684.2773],
        [ 8862814.0000,        0.0000],
        [ 2349695.7500,   536515.5625],
        [ 3381614.5000,        0.0000],
        [  757630.8125,   573529.5625],
        [ 1184218.0000,   217250.1875],
        [ 2356744.7500,  1112583.1250],
        [ 3184131.5000,   111676.3984],
        [ 3873722.7500,   154105.7812],
        [ 3793518.0000,        0.0000],
        [ 6373499.0000,        0.0000],
        [ 1681813.5000,        0.0000],
        [ 3078378.5000,        0.0000],
        [10824910.0000,        0.0000],
        [11805998.0000,        0.0000],
        [ 9406676.0000,        0.0000],
        [ 6835324.0000,        0.0000],
        [ 8847949.0000,        0.0000],
        [ 4036388.0000,        0.0000],
        [ 5482791.0000,   249347.3906],
        [ 6509559.5000,        0.0000],
        [ 4570218.0000,        0.0000],
        [11706016.0000,        0.0000],
        [11456465.0000,        0.0000],
        [ 3319763.2500,        0.0000],
        [10332487.0000,        0.0000],
        [ 9235444.0000,        0.0000],
        [12638548.0000,        0.0000],
        [10951859.0000,        0.0000],
        [10600308.0000,        0.0000],
        [13530256.0000,        0.0000],
        [10588377.0000,        0.0000],
        [ 2947170.5000,   102051.6797],
        [ 2404214.0000,  1131309.1250],
        [ 3308181.2500,  2096895.5000],
        [ 1373681.1250,  1595062.1250],
        [ 1776348.5000,   953830.5000],
        [ 1339738.5000,   738637.4375],
        [ 1197850.7500,   943904.3125],
        [ 7657201.5000,        0.0000],
        [ 2632583.7500,   246138.5000],
        [ 3860066.0000,        0.0000],
        [ 3496663.7500,        0.0000],
        [ 2840368.5000,        0.0000],
        [ 1400230.2500,  1237321.3750],
        [  336987.0000,   400605.4375],
        [ 4065434.7500,   226222.6875],
        [  675280.6250,   415182.5000],
        [  340246.8125,   314026.3750],
        [ 1986408.8750,  1113175.7500],
        [ 1160614.8750,   357581.9688],
        [ 2382667.5000,   961636.1250],
        [ 2602225.0000,  1863814.5000],
        [ 3815767.5000,   169517.3438],
        [ 6439499.0000,   339104.0312],
        [ 3911060.7500,   196135.9844],
        [ 3061938.0000,  1210006.0000],
        [ 3505334.5000,  1041424.5000],
        [ 1920317.2500,  1016464.0000],
        [ 1028625.2500,   931500.6250],
        [ 3096312.5000,   612516.9375],
        [  782749.5000,   570241.1250],
        [ 1455902.6250,   873823.3750],
        [  902617.5000,   693483.3125]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 396/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:30, 56.90s/it]  7%|▋         | 2/30 [00:59<11:39, 24.99s/it] 10%|█         | 3/30 [00:59<06:12, 13.78s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.52s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.60s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.63353439172109
Epoch 397/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:15, 56.41s/it]  7%|▋         | 2/30 [00:58<11:17, 24.21s/it] 10%|█         | 3/30 [01:00<06:29, 14.42s/it] 13%|█▎        | 4/30 [01:01<03:51,  8.90s/it] 17%|█▋        | 5/30 [01:01<02:26,  5.85s/it] 20%|██        | 6/30 [01:02<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.85s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.08s/it] 30%|███       | 9/30 [01:03<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.6236238956451414
Epoch 398/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:03, 55.97s/it]  7%|▋         | 2/30 [00:56<10:58, 23.52s/it] 10%|█         | 3/30 [00:59<06:15, 13.90s/it] 13%|█▎        | 4/30 [00:59<03:43,  8.59s/it] 17%|█▋        | 5/30 [01:00<02:21,  5.65s/it] 20%|██        | 6/30 [01:00<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:00<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.02s/it] 30%|███       | 9/30 [01:01<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 2.6411081075668337
Epoch 399/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:28, 56.84s/it]  7%|▋         | 2/30 [00:59<11:38, 24.94s/it] 10%|█         | 3/30 [00:59<06:11, 13.75s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.50s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.60s/it] 20%|██        | 6/30 [01:01<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.24it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.25it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.6146862665812174
Epoch 400/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:36, 57.11s/it]  7%|▋         | 2/30 [00:57<11:12, 24.01s/it] 10%|█         | 3/30 [00:58<05:57, 13.25s/it] 13%|█▎        | 4/30 [00:58<03:32,  8.19s/it] 17%|█▋        | 5/30 [00:59<02:14,  5.40s/it] 20%|██        | 6/30 [01:01<01:39,  4.16s/it] 23%|██▎       | 7/30 [01:01<01:07,  2.94s/it] 27%|██▋       | 8/30 [01:01<00:47,  2.15s/it] 30%|███       | 9/30 [01:02<00:33,  1.61s/it] 33%|███▎      | 10/30 [01:02<00:25,  1.25s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.00s/it] 40%|████      | 12/30 [01:03<00:14,  1.20it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.58it/s] 50%|█████     | 15/30 [01:04<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.25it/s]100%|██████████| 30/30 [01:11<00:00,  2.25it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.650484299659729
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0608, -0.0952,  0.0783,  ..., -0.0522,  0.0948,  0.0614],
        [ 0.0320, -0.0227,  0.0823,  ..., -0.0119,  0.0955,  0.1010],
        [-0.0004, -0.0102,  0.0072,  ..., -0.0531,  0.0612,  0.1202],
        ...,
        [-0.0128, -0.0009,  0.0721,  ..., -0.0475,  0.0272,  0.0183],
        [-0.0605, -0.1067,  0.0280,  ..., -0.0352,  0.0907,  0.0158],
        [-0.0239, -0.0178,  0.0568,  ..., -0.0056,  0.0922,  0.0997]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8473, 0.8448, 0.8230,  ..., 0.7527, 0.7523, 0.7522],
        [0.9317, 0.9211, 0.9198,  ..., 0.8958, 0.8937, 0.8907],
        [0.9051, 0.8699, 0.8634,  ..., 0.7951, 0.7940, 0.7939],
        ...,
        [0.8431, 0.8210, 0.8152,  ..., 0.7371, 0.7330, 0.7317],
        [0.9093, 0.8770, 0.8251,  ..., 0.7761, 0.7758, 0.7721],
        [0.8498, 0.8337, 0.8280,  ..., 0.7586, 0.7575, 0.7559]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[180744.9531, 174188.9375, 127672.7891,  ...,  46744.2773,
          46480.7617,  46421.5742],
        [602942.4375, 518240.9062, 508997.6562,  ..., 361327.3750,
         350461.7812, 335836.7500],
        [412792.0938, 249566.7344, 227467.4844,  ...,  85738.7578,
          84420.3750,  84195.4844],
        ...,
        [170031.5625, 124081.0391, 114198.2109,  ...,  37406.8008,
          35286.3477,  34625.7031],
        [437785.2812, 275932.9375, 131482.8438,  ...,  65289.6562,
          65073.1406,  61693.2148],
        [187081.1094, 148737.5781, 137033.2812,  ...,  50855.7812,
          50114.0078,  48925.5820]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[180744.9531,      0.0000],
         [174188.9375,      0.0000],
         [127672.7891,      0.0000],
         ...,
         [ 46744.2773,      0.0000],
         [ 46480.7617,      0.0000],
         [ 46421.5742,      0.0000]],

        [[602942.4375,      0.0000],
         [518240.9062,      0.0000],
         [508997.6562,      0.0000],
         ...,
         [361327.3750,      0.0000],
         [350461.7812,      0.0000],
         [335836.7500,      0.0000]],

        [[412792.0938,      0.0000],
         [     0.0000, 249566.7344],
         [227467.4844,      0.0000],
         ...,
         [ 85738.7578,      0.0000],
         [ 84420.3750,      0.0000],
         [ 84195.4844,      0.0000]],

        ...,

        [[     0.0000, 170031.5625],
         [     0.0000, 124081.0391],
         [     0.0000, 114198.2109],
         ...,
         [     0.0000,  37406.8008],
         [ 35286.3477,      0.0000],
         [ 34625.7031,      0.0000]],

        [[437785.2812,      0.0000],
         [     0.0000, 275932.9375],
         [     0.0000, 131482.8438],
         ...,
         [ 65289.6562,      0.0000],
         [ 65073.1406,      0.0000],
         [     0.0000,  61693.2148]],

        [[     0.0000, 187081.1094],
         [     0.0000, 148737.5781],
         [137033.2812,      0.0000],
         ...,
         [ 50855.7812,      0.0000],
         [ 50114.0078,      0.0000],
         [ 48925.5820,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1476596.7500,    58085.7734],
        [ 8809920.0000,        0.0000],
        [ 2326656.7500,   530738.3125],
        [ 3363449.5000,        0.0000],
        [  750491.6875,   569744.0000],
        [ 1169361.1250,   214878.4062],
        [ 2329406.0000,  1102730.2500],
        [ 3144176.5000,   110390.2734],
        [ 3838160.7500,   152133.4375],
        [ 3771296.7500,        0.0000],
        [ 6334864.0000,        0.0000],
        [ 1661042.1250,        0.0000],
        [ 3056031.5000,        0.0000],
        [10776594.0000,        0.0000],
        [11766251.0000,        0.0000],
        [ 9378494.0000,        0.0000],
        [ 6786084.0000,        0.0000],
        [ 8807590.0000,        0.0000],
        [ 4004408.2500,        0.0000],
        [ 5451935.0000,   247708.2188],
        [ 6464488.5000,        0.0000],
        [ 4530944.5000,        0.0000],
        [11672869.0000,        0.0000],
        [11422277.0000,        0.0000],
        [ 3290944.0000,        0.0000],
        [10306984.0000,        0.0000],
        [ 9201367.0000,        0.0000],
        [12612743.0000,        0.0000],
        [10904456.0000,        0.0000],
        [10565682.0000,        0.0000],
        [13482002.0000,        0.0000],
        [10553280.0000,        0.0000],
        [ 2926484.5000,   101294.7891],
        [ 2380298.0000,  1125294.8750],
        [ 3287230.7500,  2087664.3750],
        [ 1360093.6250,  1585974.6250],
        [ 1763161.0000,   951972.9375],
        [ 1327299.7500,   733670.0000],
        [ 1189418.0000,   938794.3750],
        [ 7612566.0000,        0.0000],
        [ 2617157.5000,   244156.4688],
        [ 3837770.5000,        0.0000],
        [ 3475842.5000,        0.0000],
        [ 2824777.7500,        0.0000],
        [ 1389115.5000,  1230904.2500],
        [  335587.6562,   398136.7188],
        [ 4034779.5000,   225213.9688],
        [  671126.8125,   414131.3438],
        [  338153.6562,   312295.1875],
        [ 1963784.3750,  1103849.0000],
        [ 1151087.3750,   357357.9375],
        [ 2359852.5000,   959228.2500],
        [ 2585747.5000,  1853881.0000],
        [ 3795187.0000,   168440.0312],
        [ 6402455.5000,   336874.4375],
        [ 3882920.2500,   194444.5469],
        [ 3036415.7500,  1201208.0000],
        [ 3486087.2500,  1037229.8125],
        [ 1907176.0000,  1010514.2500],
        [ 1021924.7500,   926391.8750],
        [ 3070274.5000,   608475.1875],
        [  776314.7500,   566993.0625],
        [ 1446359.6250,   868322.0000],
        [  891957.8750,   690036.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 401/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:08, 56.17s/it]  7%|▋         | 2/30 [00:59<11:43, 25.11s/it] 10%|█         | 3/30 [00:59<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.63s/it] 20%|██        | 6/30 [01:01<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.6704120715459188
Epoch 402/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:45, 57.42s/it]  7%|▋         | 2/30 [00:59<11:36, 24.88s/it] 10%|█         | 3/30 [00:59<06:10, 13.72s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.48s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.58s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.6285637696584065
Epoch 403/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:58, 57.89s/it]  7%|▋         | 2/30 [00:58<11:14, 24.10s/it] 10%|█         | 3/30 [00:58<05:59, 13.30s/it] 13%|█▎        | 4/30 [00:59<03:33,  8.22s/it] 17%|█▋        | 5/30 [00:59<02:15,  5.42s/it] 20%|██        | 6/30 [01:00<01:29,  3.73s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.65s/it] 27%|██▋       | 8/30 [01:00<00:42,  1.95s/it] 30%|███       | 9/30 [01:01<00:31,  1.48s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.16s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.07it/s] 40%|████      | 12/30 [01:02<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.47it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 2.670938261349996
Epoch 404/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:19, 56.52s/it]  7%|▋         | 2/30 [01:00<11:57, 25.62s/it] 10%|█         | 3/30 [01:00<06:21, 14.12s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.72s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.74s/it] 20%|██        | 6/30 [01:02<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.633293636639913
Epoch 405/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:33, 57.00s/it]  7%|▋         | 2/30 [00:59<11:32, 24.75s/it] 10%|█         | 3/30 [00:59<06:08, 13.65s/it] 13%|█▎        | 4/30 [01:00<03:45,  8.69s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.71s/it] 20%|██        | 6/30 [01:01<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.6352688312530517
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 6.0876e-02, -9.5446e-02,  7.8197e-02,  ..., -5.1999e-02,
          9.4513e-02,  6.1357e-02],
        [ 3.2175e-02, -2.2502e-02,  8.2235e-02,  ..., -1.1777e-02,
          9.5422e-02,  1.0093e-01],
        [-1.1018e-04, -1.0148e-02,  7.1665e-03,  ..., -5.3045e-02,
          6.1368e-02,  1.2009e-01],
        ...,
        [-1.2597e-02, -8.7934e-04,  7.1982e-02,  ..., -4.7707e-02,
          2.7071e-02,  1.8347e-02],
        [-6.0243e-02, -1.0692e-01,  2.7913e-02,  ..., -3.5261e-02,
          9.0782e-02,  1.5851e-02],
        [-2.3905e-02, -1.7872e-02,  5.6508e-02,  ..., -5.4220e-03,
          9.2329e-02,  9.9715e-02]], device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8468, 0.8443, 0.8224,  ..., 0.7524, 0.7519, 0.7518],
        [0.9314, 0.9207, 0.9193,  ..., 0.8954, 0.8932, 0.8903],
        [0.9047, 0.8693, 0.8628,  ..., 0.7946, 0.7933, 0.7932],
        ...,
        [0.8430, 0.8206, 0.8149,  ..., 0.7361, 0.7322, 0.7314],
        [0.9090, 0.8767, 0.8244,  ..., 0.7755, 0.7753, 0.7716],
        [0.8493, 0.8333, 0.8274,  ..., 0.7580, 0.7567, 0.7550]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[179355.1562, 173128.6875, 126642.6406,  ...,  46559.1523,
          46225.6523,  46165.1602],
        [600550.5625, 515186.2188, 505564.7812,  ..., 359105.7812,
         347882.3750, 333997.6562],
        [410003.7188, 247520.7188, 225385.6406,  ...,  85049.9531,
          83569.8359,  83369.2344],
        ...,
        [169870.6094, 123277.6797, 113685.8672,  ...,  36902.9766,
          34886.7305,  34477.9492],
        [436381.8125, 275097.9062, 130163.8438,  ...,  64770.4492,
          64611.9531,  61232.8438],
        [185859.0469, 147933.3594, 135854.8906,  ...,  50448.4688,
          49490.4023,  48304.5117]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[179355.1562,      0.0000],
         [173128.6875,      0.0000],
         [126642.6406,      0.0000],
         ...,
         [ 46559.1523,      0.0000],
         [ 46225.6523,      0.0000],
         [ 46165.1602,      0.0000]],

        [[600550.5625,      0.0000],
         [515186.2188,      0.0000],
         [505564.7812,      0.0000],
         ...,
         [359105.7812,      0.0000],
         [347882.3750,      0.0000],
         [333997.6562,      0.0000]],

        [[410003.7188,      0.0000],
         [     0.0000, 247520.7188],
         [225385.6406,      0.0000],
         ...,
         [ 85049.9531,      0.0000],
         [ 83569.8359,      0.0000],
         [ 83369.2344,      0.0000]],

        ...,

        [[     0.0000, 169870.6094],
         [     0.0000, 123277.6797],
         [     0.0000, 113685.8672],
         ...,
         [     0.0000,  36902.9766],
         [ 34886.7305,      0.0000],
         [ 34477.9492,      0.0000]],

        [[436381.8125,      0.0000],
         [     0.0000, 275097.9062],
         [     0.0000, 130163.8438],
         ...,
         [ 64770.4492,      0.0000],
         [ 64611.9531,      0.0000],
         [     0.0000,  61232.8438]],

        [[     0.0000, 185859.0469],
         [     0.0000, 147933.3594],
         [135854.8906,      0.0000],
         ...,
         [ 50448.4688,      0.0000],
         [ 49490.4023,      0.0000],
         [ 48304.5117,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1466750.1250,    57521.9492],
        [ 8760701.0000,        0.0000],
        [ 2305904.2500,   525633.0625],
        [ 3346714.7500,        0.0000],
        [  743979.3125,   566302.2500],
        [ 1156179.5000,   212721.9688],
        [ 2305428.0000,  1093948.1250],
        [ 3110903.2500,   109342.7188],
        [ 3806202.7500,   150480.7969],
        [ 3750334.0000,        0.0000],
        [ 6299061.0000,        0.0000],
        [ 1642450.0000,        0.0000],
        [ 3035571.0000,        0.0000],
        [10731160.0000,        0.0000],
        [11730002.0000,        0.0000],
        [ 9351984.0000,        0.0000],
        [ 6739925.0000,        0.0000],
        [ 8770247.0000,        0.0000],
        [ 3975641.0000,        0.0000],
        [ 5422029.0000,   246134.7188],
        [ 6423028.0000,        0.0000],
        [ 4495160.5000,        0.0000],
        [11642290.0000,        0.0000],
        [11390729.0000,        0.0000],
        [ 3265083.7500,        0.0000],
        [10283151.0000,        0.0000],
        [ 9169875.0000,        0.0000],
        [12590000.0000,        0.0000],
        [10862482.0000,        0.0000],
        [10535511.0000,        0.0000],
        [13439248.0000,        0.0000],
        [10524230.0000,        0.0000],
        [ 2907617.2500,   100609.5938],
        [ 2357879.0000,  1119478.2500],
        [ 3267827.0000,  2078817.3750],
        [ 1347243.7500,  1577357.5000],
        [ 1751372.2500,   950312.1875],
        [ 1315873.1250,   729013.5000],
        [ 1182315.8750,   934596.6875],
        [ 7571542.0000,        0.0000],
        [ 2603319.5000,   242418.8125],
        [ 3818052.5000,        0.0000],
        [ 3456986.2500,        0.0000],
        [ 2810845.0000,        0.0000],
        [ 1378973.7500,  1225013.2500],
        [  334173.1250,   395692.8750],
        [ 4008289.2500,   224248.6719],
        [  667410.3750,   413408.8125],
        [  336243.2812,   310730.1875],
        [ 1944856.2500,  1095659.6250],
        [ 1142363.7500,   357140.5625],
        [ 2339591.0000,   957033.6250],
        [ 2570781.0000,  1844976.2500],
        [ 3776899.5000,   167451.0312],
        [ 6369537.5000,   334784.3750],
        [ 3857654.0000,   192810.7031],
        [ 3013960.0000,  1193109.7500],
        [ 3468866.7500,  1033269.6250],
        [ 1895600.5000,  1005093.0000],
        [ 1016042.6250,   921945.7500],
        [ 3048318.0000,   604983.4375],
        [  770846.4375,   564143.9375],
        [ 1438113.3750,   863411.6250],
        [  882388.0000,   686783.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 406/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:45, 57.42s/it]  7%|▋         | 2/30 [00:58<11:28, 24.57s/it] 10%|█         | 3/30 [00:59<06:05, 13.55s/it] 13%|█▎        | 4/30 [00:59<03:37,  8.38s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.52s/it] 20%|██        | 6/30 [01:00<01:30,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.70s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.64067010084788
Epoch 407/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:08, 58.23s/it]  7%|▋         | 2/30 [00:58<11:18, 24.24s/it] 10%|█         | 3/30 [00:59<06:01, 13.37s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.64s/it] 17%|█▋        | 5/30 [01:01<02:27,  5.91s/it] 20%|██        | 6/30 [01:02<01:37,  4.05s/it] 23%|██▎       | 7/30 [01:02<01:06,  2.87s/it] 27%|██▋       | 8/30 [01:02<00:46,  2.10s/it] 30%|███       | 9/30 [01:03<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.01it/s] 40%|████      | 12/30 [01:04<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.42it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.60it/s] 50%|█████     | 15/30 [01:05<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.644089603424072
Epoch 408/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:36, 57.11s/it]  7%|▋         | 2/30 [00:58<11:28, 24.59s/it] 10%|█         | 3/30 [00:59<06:09, 13.67s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.45s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.56s/it] 20%|██        | 6/30 [01:00<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.613095593452454
Epoch 409/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:24, 58.76s/it]  7%|▋         | 2/30 [00:59<11:24, 24.46s/it] 10%|█         | 3/30 [00:59<06:04, 13.49s/it] 13%|█▎        | 4/30 [01:00<03:36,  8.34s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.49s/it] 20%|██        | 6/30 [01:00<01:30,  3.77s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.68s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.97s/it] 30%|███       | 9/30 [01:02<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.6347303946812946
Epoch 410/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:55, 57.78s/it]  7%|▋         | 2/30 [01:00<11:55, 25.54s/it] 10%|█         | 3/30 [01:01<06:20, 14.08s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.69s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.72s/it] 20%|██        | 6/30 [01:02<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.78s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.644308265050252
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 6.0939e-02, -9.5667e-02,  7.8103e-02,  ..., -5.1871e-02,
          9.4277e-02,  6.1314e-02],
        [ 3.2338e-02, -2.2360e-02,  8.2220e-02,  ..., -1.1644e-02,
          9.5357e-02,  1.0091e-01],
        [ 9.8240e-05, -1.0126e-02,  7.1239e-03,  ..., -5.2974e-02,
          6.1436e-02,  1.1996e-01],
        ...,
        [-1.2394e-02, -8.1320e-04,  7.1904e-02,  ..., -4.7923e-02,
          2.7001e-02,  1.8337e-02],
        [-6.0032e-02, -1.0709e-01,  2.7838e-02,  ..., -3.5320e-02,
          9.0820e-02,  1.5884e-02],
        [-2.3892e-02, -1.7964e-02,  5.6303e-02,  ..., -5.2294e-03,
          9.2447e-02,  9.9720e-02]], device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8463, 0.8439, 0.8219,  ..., 0.7522, 0.7516, 0.7515],
        [0.9311, 0.9203, 0.9189,  ..., 0.8950, 0.8927, 0.8901],
        [0.9043, 0.8688, 0.8622,  ..., 0.7940, 0.7927, 0.7925],
        ...,
        [0.8430, 0.8201, 0.8146,  ..., 0.7353, 0.7316, 0.7311],
        [0.9089, 0.8766, 0.8237,  ..., 0.7750, 0.7749, 0.7711],
        [0.8489, 0.8330, 0.8268,  ..., 0.7575, 0.7559, 0.7542]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[178139.7031, 172151.7031, 125756.3672,  ...,  46408.0312,
          46011.8516,  45940.1172],
        [598406.0625, 512466.5625, 502498.5000,  ..., 357168.2188,
         345646.5312, 333000.2500],
        [407578.0938, 245711.6250, 223503.1094,  ...,  84392.9219,
          82833.5000,  82615.8359],
        ...,
        [169773.9375, 122550.4453, 113196.4375,  ...,  36473.0430,
          34569.2500,  34356.5742],
        [435204.3750, 274371.8750, 128979.2109,  ...,  64282.6445,
          64177.1602,  60814.6445],
        [184804.4062, 147187.2500, 134746.0000,  ...,  50085.4336,
          48960.7734,  47757.5469]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[178139.7031,      0.0000],
         [172151.7031,      0.0000],
         [125756.3672,      0.0000],
         ...,
         [ 46408.0312,      0.0000],
         [ 46011.8516,      0.0000],
         [ 45940.1172,      0.0000]],

        [[598406.0625,      0.0000],
         [512466.5625,      0.0000],
         [502498.5000,      0.0000],
         ...,
         [357168.2188,      0.0000],
         [345646.5312,      0.0000],
         [333000.2500,      0.0000]],

        [[407578.0938,      0.0000],
         [     0.0000, 245711.6250],
         [223503.1094,      0.0000],
         ...,
         [ 84392.9219,      0.0000],
         [ 82833.5000,      0.0000],
         [ 82615.8359,      0.0000]],

        ...,

        [[     0.0000, 169773.9375],
         [     0.0000, 122550.4453],
         [     0.0000, 113196.4375],
         ...,
         [     0.0000,  36473.0430],
         [ 34569.2500,      0.0000],
         [ 34356.5742,      0.0000]],

        [[435204.3750,      0.0000],
         [     0.0000, 274371.8750],
         [     0.0000, 128979.2109],
         ...,
         [ 64282.6445,      0.0000],
         [ 64177.1602,      0.0000],
         [     0.0000,  60814.6445]],

        [[     0.0000, 184804.4062],
         [     0.0000, 147187.2500],
         [134746.0000,      0.0000],
         ...,
         [ 50085.4336,      0.0000],
         [ 48960.7734,      0.0000],
         [ 47757.5469,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1458184.7500,    57022.2422],
        [ 8717652.0000,        0.0000],
        [ 2287290.7500,   521103.7812],
        [ 3331776.5000,        0.0000],
        [  738220.0625,   563258.3125],
        [ 1144168.3750,   210726.9688],
        [ 2283267.0000,  1085713.6250],
        [ 3081284.5000,   108453.8438],
        [ 3778298.2500,   149078.8281],
        [ 3731732.2500,        0.0000],
        [ 6267255.0000,        0.0000],
        [ 1626591.5000,        0.0000],
        [ 3017642.0000,        0.0000],
        [10690741.0000,        0.0000],
        [11697268.0000,        0.0000],
        [ 9327313.0000,        0.0000],
        [ 6700451.0000,        0.0000],
        [ 8737998.0000,        0.0000],
        [ 3950689.0000,        0.0000],
        [ 5396269.0000,   244714.0156],
        [ 6387004.0000,        0.0000],
        [ 4464465.0000,        0.0000],
        [11615364.0000,        0.0000],
        [11362204.0000,        0.0000],
        [ 3241858.5000,        0.0000],
        [10262147.0000,        0.0000],
        [ 9142866.0000,        0.0000],
        [12568643.0000,        0.0000],
        [10824866.0000,        0.0000],
        [10507675.0000,        0.0000],
        [13400879.0000,        0.0000],
        [10498036.0000,        0.0000],
        [ 2890247.0000,    99985.3750],
        [ 2338136.0000,  1114615.6250],
        [ 3250317.2500,  2071171.1250],
        [ 1336114.0000,  1570146.5000],
        [ 1740615.1250,   948831.5625],
        [ 1306063.6250,   725088.9375],
        [ 1175795.3750,   931120.2500],
        [ 7534685.0000,        0.0000],
        [ 2590428.5000,   240737.7344],
        [ 3800674.5000,        0.0000],
        [ 3439692.2500,        0.0000],
        [ 2798042.5000,        0.0000],
        [ 1370141.1250,  1219722.7500],
        [  332924.8125,   393510.8125],
        [ 3984145.2500,   223344.7969],
        [  663673.3750,   412789.5000],
        [  334534.2500,   309393.9375],
        [ 1927954.3750,  1088398.7500],
        [ 1134615.0000,   356918.5938],
        [ 2321034.7500,   955077.6250],
        [ 2557625.0000,  1837042.2500],
        [ 3759947.5000,   166570.0781],
        [ 6339601.5000,   332982.7812],
        [ 3834855.7500,   191423.3750],
        [ 2994576.2500,  1186077.3750],
        [ 3453003.5000,  1029899.0625],
        [ 1884938.0000,  1000083.8750],
        [ 1010720.3750,   918172.3125],
        [ 3028612.7500,   601897.2500],
        [  766217.6875,   561573.4375],
        [ 1430542.0000,   858903.5000],
        [  873860.0000,   683899.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 53.125
Top1 accuracy for validation set is 53.125 size is torch.Size([64, 1])
Epoch 411/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:35, 55.01s/it]  7%|▋         | 2/30 [00:56<11:05, 23.76s/it] 10%|█         | 3/30 [00:59<06:21, 14.14s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.73s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.74s/it] 20%|██        | 6/30 [01:00<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.6720678091049193
Epoch 412/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:06, 58.15s/it]  7%|▋         | 2/30 [00:59<11:31, 24.71s/it] 10%|█         | 3/30 [00:59<06:08, 13.63s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.42s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.54s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.6115046898523966
Epoch 413/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:48, 61.68s/it]  7%|▋         | 2/30 [01:02<11:58, 25.66s/it] 10%|█         | 3/30 [01:02<06:21, 14.14s/it] 13%|█▎        | 4/30 [01:03<03:47,  8.73s/it] 17%|█▋        | 5/30 [01:03<02:23,  5.74s/it] 20%|██        | 6/30 [01:03<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:04<00:45,  2.05s/it] 30%|███       | 9/30 [01:05<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:06<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:09<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:10<00:04,  2.16it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.49s/it]
Epoch loss is 2.621997872988383
Epoch 414/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:45, 59.51s/it]  7%|▋         | 2/30 [00:59<11:33, 24.76s/it] 10%|█         | 3/30 [01:00<06:08, 13.66s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.44s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.56s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.584576869010925
Epoch 415/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:17, 56.46s/it]  7%|▋         | 2/30 [00:56<10:58, 23.51s/it] 10%|█         | 3/30 [00:57<05:50, 12.97s/it] 13%|█▎        | 4/30 [00:57<03:28,  8.03s/it] 17%|█▋        | 5/30 [00:59<02:20,  5.63s/it] 20%|██        | 6/30 [00:59<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:00<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:00<00:44,  2.01s/it] 30%|███       | 9/30 [01:00<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:01<00:18,  1.04it/s] 40%|████      | 12/30 [01:02<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:03<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:03<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:04<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:08<00:01,  2.24it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.25it/s]100%|██████████| 30/30 [01:10<00:00,  2.25it/s]100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch loss is 2.579358633359273
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0610, -0.0958,  0.0780,  ..., -0.0517,  0.0940,  0.0613],
        [ 0.0325, -0.0222,  0.0822,  ..., -0.0115,  0.0953,  0.1009],
        [ 0.0003, -0.0101,  0.0071,  ..., -0.0529,  0.0615,  0.1199],
        ...,
        [-0.0122, -0.0008,  0.0719,  ..., -0.0481,  0.0270,  0.0183],
        [-0.0598, -0.1072,  0.0278,  ..., -0.0354,  0.0909,  0.0159],
        [-0.0239, -0.0180,  0.0561,  ..., -0.0050,  0.0926,  0.0997]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8459, 0.8436, 0.8215,  ..., 0.7519, 0.7513, 0.7511],
        [0.9309, 0.9200, 0.9185,  ..., 0.8947, 0.8923, 0.8899],
        [0.9039, 0.8684, 0.8617,  ..., 0.7936, 0.7922, 0.7920],
        ...,
        [0.8429, 0.8198, 0.8143,  ..., 0.7345, 0.7310, 0.7309],
        [0.9087, 0.8764, 0.8231,  ..., 0.7745, 0.7744, 0.7706],
        [0.8485, 0.8327, 0.8263,  ..., 0.7566, 0.7552, 0.7534]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[176990.0938, 171278.0469, 124967.7891,  ...,  46252.9883,
          45813.3281,  45712.0742],
        [596448.9375, 510062.3438, 499705.7500,  ..., 355490.5000,
         343712.4062, 332180.0000],
        [405440.8125, 244033.4844, 221879.5156,  ...,  83845.3281,
          82201.5781,  82012.0859],
        ...,
        [169637.9844, 121947.2344, 112812.9922,  ...,  36059.3633,
          34290.3203,  34262.2070],
        [434091.8438, 273656.1250, 127907.1562,  ...,  63868.2734,
          63778.0078,  60416.4141],
        [183831.2969, 146540.0156, 133749.5469,  ...,  49449.2656,
          48478.7227,  47241.5078]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[176990.0938,      0.0000],
         [171278.0469,      0.0000],
         [124967.7891,      0.0000],
         ...,
         [ 46252.9883,      0.0000],
         [ 45813.3281,      0.0000],
         [ 45712.0742,      0.0000]],

        [[596448.9375,      0.0000],
         [510062.3438,      0.0000],
         [499705.7500,      0.0000],
         ...,
         [355490.5000,      0.0000],
         [343712.4062,      0.0000],
         [332180.0000,      0.0000]],

        [[405440.8125,      0.0000],
         [     0.0000, 244033.4844],
         [221879.5156,      0.0000],
         ...,
         [ 83845.3281,      0.0000],
         [ 82201.5781,      0.0000],
         [ 82012.0859,      0.0000]],

        ...,

        [[     0.0000, 169637.9844],
         [     0.0000, 121947.2344],
         [     0.0000, 112812.9922],
         ...,
         [     0.0000,  36059.3633],
         [ 34290.3203,      0.0000],
         [ 34262.2070,      0.0000]],

        [[434091.8438,      0.0000],
         [     0.0000, 273656.1250],
         [     0.0000, 127907.1562],
         ...,
         [ 63868.2734,      0.0000],
         [ 63778.0078,      0.0000],
         [     0.0000,  60416.4141]],

        [[     0.0000, 183831.2969],
         [     0.0000, 146540.0156],
         [133749.5469,      0.0000],
         ...,
         [ 49449.2656,      0.0000],
         [ 48478.7227,      0.0000],
         [ 47241.5078,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1450229.8750,    56535.6133],
        [ 8678987.0000,        0.0000],
        [ 2271225.2500,   516990.7500],
        [ 3318355.2500,        0.0000],
        [  733015.3750,   560456.0000],
        [ 1133438.0000,   208944.7188],
        [ 2263302.7500,  1078513.6250],
        [ 3056202.0000,   107652.9609],
        [ 3752533.5000,   147885.6875],
        [ 3714922.7500,        0.0000],
        [ 6239383.0000,        0.0000],
        [ 1611931.7500,        0.0000],
        [ 3001134.2500,        0.0000],
        [10655776.0000,        0.0000],
        [11667550.0000,        0.0000],
        [ 9307041.0000,        0.0000],
        [ 6665155.0000,        0.0000],
        [ 8708792.0000,        0.0000],
        [ 3928692.0000,        0.0000],
        [ 5373635.5000,   243497.8750],
        [ 6353542.0000,        0.0000],
        [ 4436764.0000,        0.0000],
        [11591120.0000,        0.0000],
        [11337190.0000,        0.0000],
        [ 3220772.2500,        0.0000],
        [10243562.0000,        0.0000],
        [ 9119006.0000,        0.0000],
        [12548708.0000,        0.0000],
        [10790748.0000,        0.0000],
        [10483102.0000,        0.0000],
        [13366618.0000,        0.0000],
        [10474568.0000,        0.0000],
        [ 2875591.2500,    99423.6172],
        [ 2319969.7500,  1110107.7500],
        [ 3234335.0000,  2063903.0000],
        [ 1325817.6250,  1563455.3750],
        [ 1731087.2500,   947535.5000],
        [ 1296899.7500,   721543.3750],
        [ 1169426.6250,   927491.9375],
        [ 7502456.0000,        0.0000],
        [ 2578793.2500,   239207.6562],
        [ 3785417.7500,        0.0000],
        [ 3423895.2500,        0.0000],
        [ 2786463.5000,        0.0000],
        [ 1361880.7500,  1214676.2500],
        [  331787.7812,   391458.1562],
        [ 3961663.5000,   222498.6719],
        [  660428.0000,   412160.3750],
        [  316303.6250,   324868.7500],
        [ 1913061.5000,  1082120.7500],
        [ 1127731.0000,   356611.6250],
        [ 2304501.5000,   953288.1250],
        [ 2545810.2500,  1829853.8750],
        [ 3744567.5000,   165849.1875],
        [ 6312028.0000,   331324.8125],
        [ 3814555.0000,   190195.0938],
        [ 2975596.7500,  1179214.0000],
        [ 3438424.0000,  1026605.3750],
        [ 1875255.5000,   995834.5000],
        [ 1005824.1875,   914697.0000],
        [ 3010437.7500,   599028.1250],
        [  761920.7500,   559366.2500],
        [ 1423632.8750,   854804.3125],
        [  865940.3750,   681317.3750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 416/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:49, 57.56s/it]  7%|▋         | 2/30 [00:58<11:10, 23.96s/it] 10%|█         | 3/30 [00:59<06:08, 13.67s/it] 13%|█▎        | 4/30 [00:59<03:39,  8.44s/it] 17%|█▋        | 5/30 [01:00<02:24,  5.76s/it] 20%|██        | 6/30 [01:01<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.06s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.6424972931543986
Epoch 417/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:04, 56.02s/it]  7%|▋         | 2/30 [00:57<11:02, 23.65s/it] 10%|█         | 3/30 [00:57<05:52, 13.05s/it] 13%|█▎        | 4/30 [00:57<03:29,  8.07s/it] 17%|█▋        | 5/30 [01:00<02:28,  5.94s/it] 20%|██        | 6/30 [01:01<01:45,  4.39s/it] 23%|██▎       | 7/30 [01:01<01:11,  3.10s/it] 27%|██▋       | 8/30 [01:02<00:49,  2.25s/it] 30%|███       | 9/30 [01:02<00:35,  1.68s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.30s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.04s/it] 40%|████      | 12/30 [01:04<00:15,  1.17it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.37it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.56it/s] 50%|█████     | 15/30 [01:05<00:08,  1.72it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.86it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.97it/s] 60%|██████    | 18/30 [01:06<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.5882618983586627
Epoch 418/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:13, 60.46s/it]  7%|▋         | 2/30 [01:01<11:48, 25.30s/it] 10%|█         | 3/30 [01:01<06:16, 13.95s/it] 13%|█▎        | 4/30 [01:02<03:43,  8.61s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.67s/it] 20%|██        | 6/30 [01:02<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.6508344252904257
Epoch 419/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:47, 55.43s/it]  7%|▋         | 2/30 [00:58<11:37, 24.92s/it] 10%|█         | 3/30 [01:00<06:20, 14.09s/it] 13%|█▎        | 4/30 [01:00<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.72s/it] 20%|██        | 6/30 [01:01<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:08<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.21it/s] 80%|████████  | 24/30 [01:09<00:02,  2.22it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.6227771520614622
Epoch 420/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:04, 56.03s/it]  7%|▋         | 2/30 [01:00<11:57, 25.62s/it] 10%|█         | 3/30 [01:00<06:21, 14.12s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.72s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.74s/it] 20%|██        | 6/30 [01:02<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.6068260351816814
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0611, -0.0960,  0.0779,  ..., -0.0516,  0.0938,  0.0613],
        [ 0.0326, -0.0221,  0.0822,  ..., -0.0114,  0.0952,  0.1009],
        [ 0.0005, -0.0101,  0.0070,  ..., -0.0528,  0.0616,  0.1198],
        ...,
        [-0.0120, -0.0007,  0.0718,  ..., -0.0483,  0.0269,  0.0182],
        [-0.0597, -0.1074,  0.0277,  ..., -0.0354,  0.0909,  0.0160],
        [-0.0239, -0.0181,  0.0559,  ..., -0.0049,  0.0927,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8455, 0.8432, 0.8211,  ..., 0.7517, 0.7510, 0.7508],
        [0.9307, 0.9197, 0.9182,  ..., 0.8944, 0.8920, 0.8898],
        [0.9036, 0.8680, 0.8613,  ..., 0.7932, 0.7917, 0.7916],
        ...,
        [0.8429, 0.8194, 0.8141,  ..., 0.7338, 0.7309, 0.7309],
        [0.9085, 0.8762, 0.8226,  ..., 0.7741, 0.7740, 0.7702],
        [0.8482, 0.8324, 0.8258,  ..., 0.7558, 0.7546, 0.7528]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[175940.1250, 170478.3906, 124209.3750,  ...,  46096.1797,
          45630.0586,  45512.3711],
        [594786.9375, 507999.1562, 497340.4688,  ..., 353980.6875,
         342073.0938, 331418.0625],
        [403537.1562, 242636.4844, 220502.2656,  ...,  83359.3750,
          81660.9609,  81484.0625],
        ...,
        [169549.5156, 121339.4766, 112418.3047,  ...,  35705.2539,
          34255.7070,  34241.4961],
        [433011.8438, 273027.3750, 126895.9141,  ...,  63466.1484,
          63421.2500,  60063.9023],
        [182979.6562, 145926.6875, 132880.0469,  ...,  48904.3516,
          48038.8398,  46803.2930]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[175940.1250,      0.0000],
         [170478.3906,      0.0000],
         [124209.3750,      0.0000],
         ...,
         [ 46096.1797,      0.0000],
         [ 45630.0586,      0.0000],
         [ 45512.3711,      0.0000]],

        [[594786.9375,      0.0000],
         [507999.1562,      0.0000],
         [497340.4688,      0.0000],
         ...,
         [353980.6875,      0.0000],
         [342073.0938,      0.0000],
         [331418.0625,      0.0000]],

        [[403537.1562,      0.0000],
         [     0.0000, 242636.4844],
         [220502.2656,      0.0000],
         ...,
         [ 83359.3750,      0.0000],
         [ 81660.9609,      0.0000],
         [ 81484.0625,      0.0000]],

        ...,

        [[     0.0000, 169549.5156],
         [     0.0000, 121339.4766],
         [     0.0000, 112418.3047],
         ...,
         [     0.0000,  35705.2539],
         [ 34255.7070,      0.0000],
         [ 34241.4961,      0.0000]],

        [[433011.8438,      0.0000],
         [     0.0000, 273027.3750],
         [     0.0000, 126895.9141],
         ...,
         [ 63466.1484,      0.0000],
         [ 63421.2500,      0.0000],
         [     0.0000,  60063.9023]],

        [[     0.0000, 182979.6562],
         [     0.0000, 145926.6875],
         [132880.0469,      0.0000],
         ...,
         [ 48904.3516,      0.0000],
         [ 48038.8398,      0.0000],
         [ 46803.2930,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1442886.8750,    56101.5898],
        [ 8645562.0000,        0.0000],
        [ 2257262.2500,   513507.7500],
        [ 3306105.0000,        0.0000],
        [  728712.6250,   557900.6875],
        [ 1124167.2500,   207409.3125],
        [ 2245592.2500,  1072068.5000],
        [ 3035044.2500,   106935.4688],
        [ 3729881.5000,   146811.8125],
        [ 3700136.2500,        0.0000],
        [ 6214887.5000,        0.0000],
        [ 1598841.7500,        0.0000],
        [ 2986755.7500,        0.0000],
        [10624652.0000,        0.0000],
        [11641655.0000,        0.0000],
        [ 9288848.0000,        0.0000],
        [ 6633300.5000,        0.0000],
        [ 8682350.0000,        0.0000],
        [ 3909640.7500,        0.0000],
        [ 5354270.0000,   242509.2500],
        [ 6324500.5000,        0.0000],
        [ 4412977.5000,        0.0000],
        [11568970.0000,        0.0000],
        [11315242.0000,        0.0000],
        [ 3201972.2500,        0.0000],
        [10226933.0000,        0.0000],
        [ 9097292.0000,        0.0000],
        [12531035.0000,        0.0000],
        [10759231.0000,        0.0000],
        [10460604.0000,        0.0000],
        [13335246.0000,        0.0000],
        [10452871.0000,        0.0000],
        [ 2863113.7500,    98949.8047],
        [ 2304533.2500,  1106430.3750],
        [ 3220842.5000,  2057784.0000],
        [ 1316935.7500,  1557763.8750],
        [ 1722669.0000,   946618.6250],
        [ 1289201.2500,   718525.0000],
        [ 1163834.8750,   924318.1250],
        [ 7473888.0000,        0.0000],
        [ 2568509.5000,   237928.5938],
        [ 3771458.7500,        0.0000],
        [ 3410104.5000,        0.0000],
        [ 2776212.0000,        0.0000],
        [ 1354360.5000,  1210256.1250],
        [  330847.5625,   389760.3125],
        [ 3941500.2500,   221782.6250],
        [  657804.2500,   411833.3750],
        [  315191.7500,   323752.0312],
        [ 1900320.0000,  1076748.7500],
        [ 1121769.5000,   356300.5938],
        [ 2289554.0000,   951705.6875],
        [ 2535484.0000,  1823509.5000],
        [ 3731219.5000,   165226.7188],
        [ 6287250.5000,   329823.5625],
        [ 3796796.2500,   189126.8438],
        [ 2958431.0000,  1173164.7500],
        [ 3426048.5000,  1023787.6875],
        [ 1866679.5000,   991992.3125],
        [ 1001688.6250,   911629.0000],
        [ 2995366.5000,   596537.6250],
        [  758515.6250,   557246.1250],
        [ 1417401.7500,   851063.3125],
        [  859011.8125,   679060.5625]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 421/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:06, 60.24s/it]  7%|▋         | 2/30 [01:00<11:41, 25.06s/it] 10%|█         | 3/30 [01:01<06:13, 13.82s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.54s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.62s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.5966858784357707
Epoch 422/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:29, 56.88s/it]  7%|▋         | 2/30 [00:58<11:30, 24.64s/it] 10%|█         | 3/30 [00:59<06:07, 13.59s/it] 13%|█▎        | 4/30 [00:59<03:38,  8.40s/it] 17%|█▋        | 5/30 [01:00<02:18,  5.53s/it] 20%|██        | 6/30 [01:00<01:31,  3.80s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 2.6259045600891113
Epoch 423/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:40, 59.33s/it]  7%|▋         | 2/30 [01:00<11:40, 25.01s/it] 10%|█         | 3/30 [01:00<06:12, 13.79s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.52s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.635803246498108
Epoch 424/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:54<26:28, 54.78s/it]  7%|▋         | 2/30 [01:00<12:07, 25.99s/it] 10%|█         | 3/30 [01:01<06:26, 14.32s/it] 13%|█▎        | 4/30 [01:01<03:49,  8.84s/it] 17%|█▋        | 5/30 [01:01<02:25,  5.81s/it] 20%|██        | 6/30 [01:02<01:35,  3.99s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.83s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.07s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.612092471122742
Epoch 425/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:13, 56.33s/it]  7%|▋         | 2/30 [01:00<12:01, 25.76s/it] 10%|█         | 3/30 [01:01<06:23, 14.20s/it] 13%|█▎        | 4/30 [01:01<03:47,  8.77s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.77s/it] 20%|██        | 6/30 [01:02<01:34,  3.96s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.6063318649927774
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0611, -0.0962,  0.0779,  ..., -0.0515,  0.0936,  0.0612],
        [ 0.0328, -0.0221,  0.0822,  ..., -0.0113,  0.0952,  0.1008],
        [ 0.0006, -0.0101,  0.0069,  ..., -0.0528,  0.0616,  0.1197],
        ...,
        [-0.0119, -0.0007,  0.0717,  ..., -0.0484,  0.0269,  0.0182],
        [-0.0595, -0.1075,  0.0276,  ..., -0.0354,  0.0910,  0.0160],
        [-0.0239, -0.0181,  0.0558,  ..., -0.0048,  0.0927,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8451, 0.8430, 0.8207,  ..., 0.7515, 0.7508, 0.7505],
        [0.9305, 0.9194, 0.9179,  ..., 0.8941, 0.8917, 0.8896],
        [0.9033, 0.8676, 0.8609,  ..., 0.7928, 0.7913, 0.7911],
        ...,
        [0.8428, 0.8191, 0.8139,  ..., 0.7332, 0.7309, 0.7308],
        [0.9083, 0.8761, 0.8221,  ..., 0.7737, 0.7737, 0.7699],
        [0.8479, 0.8321, 0.8254,  ..., 0.7552, 0.7540, 0.7522]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[175088.1406, 169808.4219, 123583.1562,  ...,  45975.8828,
          45488.9805,  45344.0156],
        [593273.7500, 506155.2812, 495226.2812,  ..., 352588.1875,
         340535.1562, 330685.2812],
        [401828.2500, 241351.7031, 219285.7656,  ...,  82885.8125,
          81177.1484,  80986.3047],
        ...,
        [169381.7500, 120808.7969, 112083.5469,  ...,  35372.5703,
          34241.4023,  34182.5742],
        [432098.9688, 272475.6562, 126025.5391,  ...,  63115.5234,
          63112.3945,  59780.9688],
        [182241.7656, 145329.4844, 132140.0312,  ...,  48443.6445,
          47661.6797,  46440.4805]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[175088.1406,      0.0000],
         [169808.4219,      0.0000],
         [123583.1562,      0.0000],
         ...,
         [ 45975.8828,      0.0000],
         [ 45488.9805,      0.0000],
         [ 45344.0156,      0.0000]],

        [[593273.7500,      0.0000],
         [506155.2812,      0.0000],
         [495226.2812,      0.0000],
         ...,
         [352588.1875,      0.0000],
         [340535.1562,      0.0000],
         [330685.2812,      0.0000]],

        [[401828.2500,      0.0000],
         [     0.0000, 241351.7031],
         [219285.7656,      0.0000],
         ...,
         [ 82885.8125,      0.0000],
         [ 81177.1484,      0.0000],
         [ 80986.3047,      0.0000]],

        ...,

        [[     0.0000, 169381.7500],
         [     0.0000, 120808.7969],
         [     0.0000, 112083.5469],
         ...,
         [     0.0000,  35372.5703],
         [ 34241.4023,      0.0000],
         [ 34182.5742,      0.0000]],

        [[432098.9688,      0.0000],
         [     0.0000, 272475.6562],
         [     0.0000, 126025.5391],
         ...,
         [ 63115.5234,      0.0000],
         [ 63112.3945,      0.0000],
         [     0.0000,  59780.9688]],

        [[     0.0000, 182241.7656],
         [     0.0000, 145329.4844],
         [132140.0312,      0.0000],
         ...,
         [ 48443.6445,      0.0000],
         [ 47661.6797,      0.0000],
         [ 46440.4805,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1436785.6250,    55722.5742],
        [ 8614899.0000,        0.0000],
        [ 2244675.0000,   510394.6250],
        [ 3294817.5000,        0.0000],
        [  724790.7500,   555710.5000],
        [ 1115780.6250,   206008.3125],
        [ 2230218.0000,  1066308.0000],
        [ 3015736.2500,   106291.8750],
        [ 3709973.2500,   145829.0156],
        [ 3686931.7500,        0.0000],
        [ 6192363.0000,        0.0000],
        [ 1587899.8750,        0.0000],
        [ 2973943.5000,        0.0000],
        [10596152.0000,        0.0000],
        [11619137.0000,        0.0000],
        [ 9272218.0000,        0.0000],
        [ 6604503.5000,        0.0000],
        [ 8658525.0000,        0.0000],
        [ 3892365.0000,        0.0000],
        [ 5336503.0000,   241598.3438],
        [ 6298012.0000,        0.0000],
        [ 4392273.5000,        0.0000],
        [11548740.0000,        0.0000],
        [11294434.0000,        0.0000],
        [ 3185368.7500,        0.0000],
        [10212140.0000,        0.0000],
        [ 9077818.0000,        0.0000],
        [12515227.0000,        0.0000],
        [10732324.0000,        0.0000],
        [10440452.0000,        0.0000],
        [13307553.0000,        0.0000],
        [10434762.0000,        0.0000],
        [ 2851456.7500,    98527.2891],
        [ 2290632.2500,  1102885.6250],
        [ 3208378.5000,  2052130.5000],
        [ 1309034.0000,  1552482.0000],
        [ 1715192.1250,   945632.3750],
        [ 1281988.6250,   715721.3750],
        [ 1158774.2500,   921301.3125],
        [ 7447755.0000,        0.0000],
        [ 2559183.0000,   236755.0312],
        [ 3759026.0000,        0.0000],
        [ 3398171.0000,        0.0000],
        [ 2767075.0000,        0.0000],
        [ 1347792.5000,  1206392.7500],
        [  330110.1250,   388266.9062],
        [ 3923772.5000,   221148.5781],
        [  655366.0000,   411448.8125],
        [  314112.3750,   322746.6250],
        [ 1888853.2500,  1071844.2500],
        [ 1116197.0000,   355931.8438],
        [ 2276568.5000,   950261.2500],
        [ 2525772.0000,  1817619.3750],
        [ 3718715.7500,   164671.4219],
        [ 6266272.0000,   328598.8125],
        [ 3781031.0000,   188189.6562],
        [ 2943272.7500,  1167739.5000],
        [ 3414511.7500,  1021196.8750],
        [ 1859002.8750,   988574.7500],
        [  998092.2500,   908821.4375],
        [ 2981546.5000,   594331.5625],
        [  755250.7500,   555303.2500],
        [ 1412036.6250,   847836.7500],
        [  853140.2500,   676967.5625]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 426/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:20, 60.71s/it]  7%|▋         | 2/30 [01:01<11:47, 25.26s/it] 10%|█         | 3/30 [01:01<06:16, 13.93s/it] 13%|█▎        | 4/30 [01:02<03:43,  8.60s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.66s/it] 20%|██        | 6/30 [01:02<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.588023074467977
Epoch 427/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:35, 57.09s/it]  7%|▋         | 2/30 [00:59<11:32, 24.72s/it] 10%|█         | 3/30 [00:59<06:08, 13.64s/it] 13%|█▎        | 4/30 [01:00<03:46,  8.73s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.74s/it] 20%|██        | 6/30 [01:01<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.606993397076925
Epoch 428/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:37, 59.21s/it]  7%|▋         | 2/30 [00:59<11:29, 24.64s/it] 10%|█         | 3/30 [01:00<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.56s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.63s/it] 20%|██        | 6/30 [01:01<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.605593212445577
Epoch 429/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:42, 59.40s/it]  7%|▋         | 2/30 [00:59<11:32, 24.72s/it] 10%|█         | 3/30 [01:00<06:08, 13.63s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.43s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.62s/it] 20%|██        | 6/30 [01:01<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.589275614420573
Epoch 430/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:09, 56.19s/it]  7%|▋         | 2/30 [00:56<10:55, 23.40s/it] 10%|█         | 3/30 [00:57<05:50, 12.97s/it] 13%|█▎        | 4/30 [00:57<03:28,  8.02s/it] 17%|█▋        | 5/30 [00:59<02:27,  5.88s/it] 20%|██        | 6/30 [01:00<01:42,  4.28s/it] 23%|██▎       | 7/30 [01:01<01:09,  3.03s/it] 27%|██▋       | 8/30 [01:01<00:48,  2.20s/it] 30%|███       | 9/30 [01:02<00:34,  1.65s/it] 33%|███▎      | 10/30 [01:02<00:25,  1.28s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.02s/it] 40%|████      | 12/30 [01:03<00:15,  1.18it/s] 43%|████▎     | 13/30 [01:03<00:12,  1.38it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.57it/s] 50%|█████     | 15/30 [01:04<00:08,  1.73it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.86it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.97it/s] 60%|██████    | 18/30 [01:06<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.6091344594955443
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0612, -0.0963,  0.0778,  ..., -0.0514,  0.0934,  0.0612],
        [ 0.0329, -0.0220,  0.0822,  ..., -0.0112,  0.0951,  0.1008],
        [ 0.0008, -0.0101,  0.0069,  ..., -0.0527,  0.0616,  0.1196],
        ...,
        [-0.0117, -0.0007,  0.0717,  ..., -0.0486,  0.0268,  0.0182],
        [-0.0594, -0.1076,  0.0275,  ..., -0.0354,  0.0910,  0.0160],
        [-0.0238, -0.0182,  0.0556,  ..., -0.0046,  0.0928,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8448, 0.8427, 0.8204,  ..., 0.7513, 0.7505, 0.7503],
        [0.9304, 0.9192, 0.9176,  ..., 0.8939, 0.8914, 0.8895],
        [0.9030, 0.8672, 0.8605,  ..., 0.7924, 0.7909, 0.7908],
        ...,
        [0.8427, 0.8189, 0.8137,  ..., 0.7326, 0.7308, 0.7306],
        [0.9082, 0.8760, 0.8217,  ..., 0.7734, 0.7733, 0.7696],
        [0.8477, 0.8318, 0.8251,  ..., 0.7546, 0.7536, 0.7517]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[174291.6406, 169163.6719, 123018.0234,  ...,  45863.4688,
          45341.6406,  45194.3398],
        [591883.0000, 504488.8125, 493320.0625,  ..., 351293.9688,
         339145.0938, 329999.4375],
        [400358.2188, 240178.8594, 218190.1562,  ...,  82463.9141,
          80713.7422,  80542.7266],
        ...,
        [169203.3594, 120381.3125, 111819.7344,  ...,  35078.1211,
          34217.4062,  34123.6523],
        [431316.3125, 272018.9375, 125243.8672,  ...,  62852.1953,
          62805.9961,  59529.2852],
        [181654.9375, 144857.6406, 131511.8125,  ...,  48036.0469,
          47335.9414,  46125.2031]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[174291.6406,      0.0000],
         [169163.6719,      0.0000],
         [123018.0234,      0.0000],
         ...,
         [ 45863.4688,      0.0000],
         [ 45341.6406,      0.0000],
         [ 45194.3398,      0.0000]],

        [[591883.0000,      0.0000],
         [504488.8125,      0.0000],
         [493320.0625,      0.0000],
         ...,
         [351293.9688,      0.0000],
         [339145.0938,      0.0000],
         [329999.4375,      0.0000]],

        [[400358.2188,      0.0000],
         [     0.0000, 240178.8594],
         [218190.1562,      0.0000],
         ...,
         [ 82463.9141,      0.0000],
         [ 80713.7422,      0.0000],
         [ 80542.7266,      0.0000]],

        ...,

        [[     0.0000, 169203.3594],
         [     0.0000, 120381.3125],
         [     0.0000, 111819.7344],
         ...,
         [     0.0000,  35078.1211],
         [ 34217.4062,      0.0000],
         [ 34123.6523,      0.0000]],

        [[431316.3125,      0.0000],
         [     0.0000, 272018.9375],
         [     0.0000, 125243.8672],
         ...,
         [ 62852.1953,      0.0000],
         [ 62805.9961,      0.0000],
         [     0.0000,  59529.2852]],

        [[     0.0000, 181654.9375],
         [     0.0000, 144857.6406],
         [131511.8125,      0.0000],
         ...,
         [ 48036.0469,      0.0000],
         [ 47335.9414,      0.0000],
         [ 46125.2031,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1431162.0000,    55367.2969],
        [ 8587319.0000,        0.0000],
        [ 2233433.5000,   507582.6250],
        [ 3285152.0000,        0.0000],
        [  721401.6250,   553717.7500],
        [ 1108577.5000,   204818.6562],
        [ 2217091.2500,  1061624.7500],
        [ 2998959.0000,   105731.1719],
        [ 3692266.5000,   144969.2969],
        [ 3675380.7500,        0.0000],
        [ 6173137.5000,        0.0000],
        [ 1577706.1250,        0.0000],
        [ 2962498.7500,        0.0000],
        [10570591.0000,        0.0000],
        [11599001.0000,        0.0000],
        [ 9256449.0000,        0.0000],
        [ 6578651.0000,        0.0000],
        [ 8637472.0000,        0.0000],
        [ 3876681.7500,        0.0000],
        [ 5321676.0000,   240852.5312],
        [ 6274776.0000,        0.0000],
        [ 4373268.0000,        0.0000],
        [11531112.0000,        0.0000],
        [11275586.0000,        0.0000],
        [ 3170615.2500,        0.0000],
        [10198474.0000,        0.0000],
        [ 9060622.0000,        0.0000],
        [12501030.0000,        0.0000],
        [10708215.0000,        0.0000],
        [10422640.0000,        0.0000],
        [13282774.0000,        0.0000],
        [10418495.0000,        0.0000],
        [ 2840856.7500,    98126.2344],
        [ 2278266.7500,  1099700.7500],
        [ 3197587.5000,  2047109.2500],
        [ 1213243.8750,  1636316.6250],
        [ 1708188.3750,   944645.6250],
        [ 1275629.0000,   713313.8125],
        [ 1154257.0000,   918802.4375],
        [ 7424869.0000,        0.0000],
        [ 2550884.0000,   235733.1094],
        [ 3747882.2500,        0.0000],
        [ 3387744.0000,        0.0000],
        [ 2758868.2500,        0.0000],
        [ 1342071.0000,  1202895.0000],
        [  329472.3750,   386978.0312],
        [ 3908238.5000,   220574.8281],
        [  653338.0625,   411168.8750],
        [  313193.2812,   321886.0000],
        [ 1878786.8750,  1067584.2500],
        [ 1111372.7500,   355705.5000],
        [ 2264743.0000,   948893.6250],
        [ 2517460.7500,  1812570.2500],
        [ 3707844.7500,   164190.3125],
        [ 6247224.5000,   327449.1562],
        [ 3767374.0000,   187360.3438],
        [ 2930126.0000,  1163167.3750],
        [ 3404028.0000,  1018886.4375],
        [ 1852367.1250,   985623.7500],
        [  994813.7500,   906372.7500],
        [ 2969391.5000,   592347.5000],
        [  752394.5000,   553657.8125],
        [ 1407207.7500,   844937.0000],
        [  848087.9375,   675270.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 431/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:25, 58.81s/it]  7%|▋         | 2/30 [00:59<11:25, 24.48s/it] 10%|█         | 3/30 [00:59<06:04, 13.50s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.53s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.61s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.595574990908305
Epoch 432/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:09, 58.26s/it]  7%|▋         | 2/30 [00:58<11:18, 24.25s/it] 10%|█         | 3/30 [00:59<06:01, 13.38s/it] 13%|█▎        | 4/30 [00:59<03:35,  8.27s/it] 17%|█▋        | 5/30 [01:00<02:16,  5.45s/it] 20%|██        | 6/30 [01:00<01:29,  3.74s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.66s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.96s/it] 30%|███       | 9/30 [01:01<00:31,  1.48s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.16s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.47it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.01it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.14it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.18it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 2.601108765602112
Epoch 433/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:15, 60.54s/it]  7%|▋         | 2/30 [01:01<12:01, 25.78s/it] 10%|█         | 3/30 [01:02<06:23, 14.21s/it] 13%|█▎        | 4/30 [01:02<03:48,  8.77s/it] 17%|█▋        | 5/30 [01:03<02:24,  5.77s/it] 20%|██        | 6/30 [01:03<01:34,  3.96s/it] 23%|██▎       | 7/30 [01:04<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:04<00:45,  2.05s/it] 30%|███       | 9/30 [01:05<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:09<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.48s/it]
Epoch loss is 2.6179162661234536
Epoch 434/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:27, 56.80s/it]  7%|▋         | 2/30 [00:57<11:02, 23.65s/it] 10%|█         | 3/30 [01:01<06:36, 14.68s/it] 13%|█▎        | 4/30 [01:01<03:55,  9.06s/it] 17%|█▋        | 5/30 [01:02<02:28,  5.95s/it] 20%|██        | 6/30 [01:02<01:37,  4.08s/it] 23%|██▎       | 7/30 [01:03<01:06,  2.89s/it] 27%|██▋       | 8/30 [01:03<00:46,  2.11s/it] 30%|███       | 9/30 [01:03<00:33,  1.59s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.01it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:05<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:06<00:10,  1.60it/s] 50%|█████     | 15/30 [01:06<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.6512882630030314
Epoch 435/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:56, 59.88s/it]  7%|▋         | 2/30 [01:02<12:18, 26.39s/it] 10%|█         | 3/30 [01:03<06:32, 14.54s/it] 13%|█▎        | 4/30 [01:03<03:53,  8.98s/it] 17%|█▋        | 5/30 [01:04<02:27,  5.90s/it] 20%|██        | 6/30 [01:04<01:37,  4.04s/it] 23%|██▎       | 7/30 [01:05<01:05,  2.86s/it] 27%|██▋       | 8/30 [01:05<00:46,  2.09s/it] 30%|███       | 9/30 [01:05<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:06<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:06<00:18,  1.02it/s] 40%|████      | 12/30 [01:07<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:07<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:08<00:09,  1.60it/s] 50%|█████     | 15/30 [01:08<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:09<00:06,  1.99it/s] 60%|██████    | 18/30 [01:09<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:10<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:10<00:04,  2.16it/s] 70%|███████   | 21/30 [01:11<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:11<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:12<00:03,  2.24it/s] 80%|████████  | 24/30 [01:12<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:13<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:14<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:15<00:00,  2.27it/s]100%|██████████| 30/30 [01:15<00:00,  2.51s/it]
Epoch loss is 2.6142728090286256
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0612, -0.0965,  0.0778,  ..., -0.0513,  0.0933,  0.0612],
        [ 0.0329, -0.0219,  0.0822,  ..., -0.0112,  0.0951,  0.1008],
        [ 0.0009, -0.0102,  0.0069,  ..., -0.0527,  0.0617,  0.1196],
        ...,
        [-0.0116, -0.0007,  0.0716,  ..., -0.0487,  0.0267,  0.0182],
        [-0.0592, -0.1077,  0.0275,  ..., -0.0354,  0.0910,  0.0160],
        [-0.0238, -0.0182,  0.0555,  ..., -0.0045,  0.0928,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8445, 0.8425, 0.8201,  ..., 0.7512, 0.7504, 0.7502],
        [0.9302, 0.9190, 0.9174,  ..., 0.8936, 0.8911, 0.8894],
        [0.9028, 0.8669, 0.8602,  ..., 0.7921, 0.7906, 0.7904],
        ...,
        [0.8426, 0.8187, 0.8136,  ..., 0.7321, 0.7308, 0.7305],
        [0.9081, 0.8758, 0.8213,  ..., 0.7731, 0.7731, 0.7693],
        [0.8475, 0.8317, 0.8248,  ..., 0.7541, 0.7531, 0.7513]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[173638.4688, 168638.0781, 122524.9766,  ...,  45780.3945,
          45230.3867,  45096.5625],
        [590707.2500, 503022.0938, 491619.4062,  ..., 350217.8438,
         337967.2500, 329398.2812],
        [399063.3438, 239172.6875, 217258.5000,  ...,  82114.1406,
          80335.5312,  80186.5000],
        ...,
        [169019.9688, 119980.9688, 111582.6094,  ...,  34817.9609,
          34185.3789,  34065.8711],
        [430579.4062, 271600.3125, 124609.6875,  ...,  62626.5039,
          62549.5039,  59305.4023],
        [181111.0938, 144473.0000, 130970.8516,  ...,  47678.6367,
          47050.0156,  45842.3477]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[173638.4688,      0.0000],
         [168638.0781,      0.0000],
         [122524.9766,      0.0000],
         ...,
         [ 45780.3945,      0.0000],
         [ 45230.3867,      0.0000],
         [ 45096.5625,      0.0000]],

        [[590707.2500,      0.0000],
         [503022.0938,      0.0000],
         [491619.4062,      0.0000],
         ...,
         [350217.8438,      0.0000],
         [337967.2500,      0.0000],
         [329398.2812,      0.0000]],

        [[399063.3438,      0.0000],
         [     0.0000, 239172.6875],
         [217258.5000,      0.0000],
         ...,
         [ 82114.1406,      0.0000],
         [ 80335.5312,      0.0000],
         [ 80186.5000,      0.0000]],

        ...,

        [[     0.0000, 169019.9688],
         [     0.0000, 119980.9688],
         [     0.0000, 111582.6094],
         ...,
         [     0.0000,  34817.9609],
         [ 34185.3789,      0.0000],
         [ 34065.8711,      0.0000]],

        [[430579.4062,      0.0000],
         [     0.0000, 271600.3125],
         [     0.0000, 124609.6875],
         ...,
         [ 62626.5039,      0.0000],
         [ 62549.5039,      0.0000],
         [     0.0000,  59305.4023]],

        [[     0.0000, 181111.0938],
         [     0.0000, 144473.0000],
         [130970.8516,      0.0000],
         ...,
         [ 47678.6367,      0.0000],
         [ 47050.0156,      0.0000],
         [ 45842.3477,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1426480.0000,    55081.7930],
        [ 8563625.0000,        0.0000],
        [ 2223965.2500,   505186.6562],
        [ 3277166.5000,        0.0000],
        [  718680.7500,   552086.9375],
        [ 1102620.5000,   203780.3438],
        [ 2205829.7500,  1057449.0000],
        [ 2985071.0000,   105235.2344],
        [ 3677388.2500,   144179.6875],
        [ 3665751.7500,        0.0000],
        [ 6156845.5000,        0.0000],
        [ 1569291.7500,        0.0000],
        [ 2952876.7500,        0.0000],
        [10548980.0000,        0.0000],
        [11581190.0000,        0.0000],
        [ 9243373.0000,        0.0000],
        [ 6557534.5000,        0.0000],
        [ 8620167.0000,        0.0000],
        [ 3864260.0000,        0.0000],
        [ 5308933.5000,   240165.7969],
        [ 6255324.0000,        0.0000],
        [ 4357410.0000,        0.0000],
        [11514995.0000,        0.0000],
        [11259868.0000,        0.0000],
        [ 3157871.2500,        0.0000],
        [10186634.0000,        0.0000],
        [ 9045484.0000,        0.0000],
        [12488445.0000,        0.0000],
        [10687394.0000,        0.0000],
        [10406971.0000,        0.0000],
        [13261340.0000,        0.0000],
        [10403981.0000,        0.0000],
        [ 2831788.7500,    97802.2344],
        [ 2267924.2500,  1097130.3750],
        [ 3188116.0000,  2042958.7500],
        [ 1208052.0000,  1632253.7500],
        [ 1702323.5000,   943832.4375],
        [ 1270433.8750,   711406.1875],
        [ 1150623.5000,   916955.2500],
        [ 7406190.5000,        0.0000],
        [ 2543627.5000,   234860.8750],
        [ 3738176.5000,        0.0000],
        [ 3378405.5000,        0.0000],
        [ 2752199.5000,        0.0000],
        [ 1337265.6250,  1200011.7500],
        [  328971.1875,   385890.5312],
        [ 3895212.7500,   220098.0469],
        [  651581.1250,   410904.4375],
        [  312490.7500,   321215.3750],
        [ 1870301.1250,  1064135.2500],
        [ 1107280.7500,   355508.6250],
        [ 2255070.0000,   947762.2500],
        [ 2510149.0000,  1808156.0000],
        [ 3698256.0000,   163763.8438],
        [ 6231764.0000,   326530.1562],
        [ 3755585.2500,   186666.9375],
        [ 2918094.7500,  1159010.7500],
        [ 3394628.5000,  1016840.6250],
        [ 1846689.0000,   983023.9375],
        [  991972.0000,   904339.8750],
        [ 2958688.5000,   590692.5000],
        [  749781.6250,   552129.1250],
        [ 1403032.2500,   842517.5625],
        [  843579.6875,   673721.4375]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 436/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:14, 56.35s/it]  7%|▋         | 2/30 [00:57<11:14, 24.07s/it] 10%|█         | 3/30 [00:58<05:58, 13.28s/it] 13%|█▎        | 4/30 [00:58<03:33,  8.21s/it] 17%|█▋        | 5/30 [00:59<02:19,  5.58s/it] 20%|██        | 6/30 [01:00<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:00<00:43,  2.00s/it] 30%|███       | 9/30 [01:01<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:07<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.27it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 2.622299806276957
Epoch 437/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:58, 59.93s/it]  7%|▋         | 2/30 [01:00<11:38, 24.94s/it] 10%|█         | 3/30 [01:01<06:14, 13.87s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.57s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.5359394947687783
Epoch 438/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:30, 61.06s/it]  7%|▋         | 2/30 [01:01<11:51, 25.40s/it] 10%|█         | 3/30 [01:01<06:18, 14.00s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.65s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.69s/it] 20%|██        | 6/30 [01:03<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 2.5838228861490884
Epoch 439/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:27, 60.95s/it]  7%|▋         | 2/30 [01:01<11:49, 25.36s/it] 10%|█         | 3/30 [01:01<06:17, 13.98s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.63s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.68s/it] 20%|██        | 6/30 [01:03<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.6100608905156455
Epoch 440/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:11, 58.34s/it]  7%|▋         | 2/30 [00:58<11:19, 24.28s/it] 10%|█         | 3/30 [01:00<06:20, 14.09s/it] 13%|█▎        | 4/30 [01:01<03:46,  8.70s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.72s/it] 20%|██        | 6/30 [01:02<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.6057188272476197
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0612, -0.0966,  0.0778,  ..., -0.0512,  0.0932,  0.0612],
        [ 0.0330, -0.0219,  0.0822,  ..., -0.0111,  0.0950,  0.1008],
        [ 0.0010, -0.0102,  0.0069,  ..., -0.0527,  0.0617,  0.1195],
        ...,
        [-0.0115, -0.0007,  0.0716,  ..., -0.0488,  0.0267,  0.0182],
        [-0.0591, -0.1078,  0.0274,  ..., -0.0354,  0.0910,  0.0161],
        [-0.0238, -0.0182,  0.0554,  ..., -0.0044,  0.0929,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8443, 0.8423, 0.8199,  ..., 0.7511, 0.7502, 0.7500],
        [0.9301, 0.9188, 0.9172,  ..., 0.8935, 0.8909, 0.8892],
        [0.9026, 0.8667, 0.8600,  ..., 0.7919, 0.7903, 0.7902],
        ...,
        [0.8426, 0.8185, 0.8134,  ..., 0.7316, 0.7307, 0.7305],
        [0.9080, 0.8758, 0.8210,  ..., 0.7729, 0.7728, 0.7691],
        [0.8473, 0.8315, 0.8245,  ..., 0.7536, 0.7528, 0.7510]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[173099.3125, 168184.6719, 122115.2812,  ...,  45709.1094,
          45130.8945,  45016.7695],
        [589749.8125, 501748.5938, 490218.6562,  ..., 349314.9062,
         336967.9688, 328915.1562],
        [397952.0625, 238336.8281, 216503.1406,  ...,  81825.1406,
          80021.4844,  79893.4609],
        ...,
        [168917.1719, 119651.5391, 111368.5000,  ...,  34614.5469,
          34173.8398,  34032.6523],
        [429907.3125, 271238.1875, 124053.2344,  ...,  62433.1133,
          62334.3555,  59116.2344],
        [180648.4531, 144135.4062, 130510.6406,  ...,  47385.6211,
          46805.5703,  45616.3086]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[173099.3125,      0.0000],
         [168184.6719,      0.0000],
         [122115.2812,      0.0000],
         ...,
         [ 45709.1094,      0.0000],
         [ 45130.8945,      0.0000],
         [ 45016.7695,      0.0000]],

        [[589749.8125,      0.0000],
         [501748.5938,      0.0000],
         [490218.6562,      0.0000],
         ...,
         [349314.9062,      0.0000],
         [336967.9688,      0.0000],
         [328915.1562,      0.0000]],

        [[397952.0625,      0.0000],
         [     0.0000, 238336.8281],
         [216503.1406,      0.0000],
         ...,
         [ 81825.1406,      0.0000],
         [ 80021.4844,      0.0000],
         [ 79893.4609,      0.0000]],

        ...,

        [[     0.0000, 168917.1719],
         [     0.0000, 119651.5391],
         [     0.0000, 111368.5000],
         ...,
         [     0.0000,  34614.5469],
         [ 34173.8398,      0.0000],
         [ 34032.6523,      0.0000]],

        [[429907.3125,      0.0000],
         [     0.0000, 271238.1875],
         [     0.0000, 124053.2344],
         ...,
         [ 62433.1133,      0.0000],
         [ 62334.3555,      0.0000],
         [     0.0000,  59116.2344]],

        [[     0.0000, 180648.4531],
         [     0.0000, 144135.4062],
         [130510.6406,      0.0000],
         ...,
         [ 47385.6211,      0.0000],
         [ 46805.5703,      0.0000],
         [ 45616.3086,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1422575.2500,    54857.7891],
        [ 8543848.0000,        0.0000],
        [ 2216131.2500,   503205.4375],
        [ 3270211.0000,        0.0000],
        [  716408.3750,   550666.3125],
        [ 1097642.0000,   202930.2500],
        [ 2196323.0000,  1054012.7500],
        [ 2973350.2500,   104825.0625],
        [ 3664668.0000,   143514.3438],
        [ 3657380.2500,        0.0000],
        [ 6142999.5000,        0.0000],
        [ 1562349.7500,        0.0000],
        [ 2944864.0000,        0.0000],
        [10531116.0000,        0.0000],
        [11565799.0000,        0.0000],
        [ 9233039.0000,        0.0000],
        [ 6539529.0000,        0.0000],
        [ 8605203.0000,        0.0000],
        [ 3853577.5000,        0.0000],
        [ 5298274.0000,   239648.0625],
        [ 6238586.5000,        0.0000],
        [ 4344234.5000,        0.0000],
        [11502526.0000,        0.0000],
        [11246713.0000,        0.0000],
        [ 3147244.0000,        0.0000],
        [10176870.0000,        0.0000],
        [ 9032938.0000,        0.0000],
        [12477744.0000,        0.0000],
        [10669636.0000,        0.0000],
        [10394531.0000,        0.0000],
        [13243187.0000,        0.0000],
        [10392128.0000,        0.0000],
        [ 2824280.2500,    97528.8594],
        [ 2259241.5000,  1094880.0000],
        [ 3180434.5000,  2039554.8750],
        [ 1203743.3750,  1628759.0000],
        [ 1697469.0000,   943138.3125],
        [ 1266090.5000,   709784.8750],
        [ 1147477.6250,   915212.3750],
        [ 7390573.0000,        0.0000],
        [ 2537373.5000,   234117.2812],
        [ 3730261.0000,        0.0000],
        [ 3370937.5000,        0.0000],
        [ 2653386.7500,    93573.7891],
        [ 1333409.3750,  1197591.2500],
        [  328483.2812,   384887.7500],
        [ 3884128.2500,   219735.8438],
        [  650166.5000,   410740.7188],
        [  311915.1250,   320646.9375],
        [ 1863145.0000,  1061224.2500],
        [ 1103926.3750,   355310.8438],
        [ 2246830.0000,   946841.6250],
        [ 2504139.7500,  1804489.1250],
        [ 3690227.2500,   163419.8438],
        [ 6218579.5000,   325728.6562],
        [ 3745521.2500,   186077.5469],
        [ 2907962.7500,  1155550.6250],
        [ 3387055.0000,  1015160.3750],
        [ 1841905.7500,   980787.8125],
        [  989474.5000,   902667.2500],
        [ 2949756.7500,   589243.3750],
        [  747794.2500,   550911.2500],
        [ 1399423.3750,   840446.6875],
        [  839937.0625,   672403.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 441/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:14, 56.35s/it]  7%|▋         | 2/30 [01:01<12:07, 25.97s/it] 10%|█         | 3/30 [01:01<06:26, 14.31s/it] 13%|█▎        | 4/30 [01:01<03:49,  8.84s/it] 17%|█▋        | 5/30 [01:02<02:25,  5.81s/it] 20%|██        | 6/30 [01:02<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.82s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.07s/it] 30%|███       | 9/30 [01:04<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.6033967971801757
Epoch 442/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:10, 60.37s/it]  7%|▋         | 2/30 [01:00<11:43, 25.12s/it] 10%|█         | 3/30 [01:01<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.56s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.63s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.5929444392522174
Epoch 443/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:32, 59.07s/it]  7%|▋         | 2/30 [01:02<12:12, 26.17s/it] 10%|█         | 3/30 [01:02<06:29, 14.42s/it] 13%|█▎        | 4/30 [01:03<03:51,  8.90s/it] 17%|█▋        | 5/30 [01:03<02:26,  5.85s/it] 20%|██        | 6/30 [01:03<01:36,  4.01s/it] 23%|██▎       | 7/30 [01:04<01:05,  2.84s/it] 27%|██▋       | 8/30 [01:04<00:45,  2.08s/it] 30%|███       | 9/30 [01:05<00:32,  1.57s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:06<00:18,  1.02it/s] 40%|████      | 12/30 [01:06<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:07<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:07<00:09,  1.61it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:08<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:09<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:10<00:04,  2.17it/s] 70%|███████   | 21/30 [01:10<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:11<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:11<00:03,  2.24it/s] 80%|████████  | 24/30 [01:11<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:12<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:13<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.49s/it]
Epoch loss is 2.603758374849955
Epoch 444/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:57, 59.92s/it]  7%|▋         | 2/30 [01:00<11:38, 24.93s/it] 10%|█         | 3/30 [01:00<06:11, 13.75s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.49s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.59s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:03<00:43,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.605198287963867
Epoch 445/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:52, 59.74s/it]  7%|▋         | 2/30 [01:00<11:35, 24.86s/it] 10%|█         | 3/30 [01:00<06:10, 13.71s/it] 13%|█▎        | 4/30 [01:01<03:40,  8.47s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.57s/it] 20%|██        | 6/30 [01:01<01:31,  3.83s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.554797148704529
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0612, -0.0967,  0.0777,  ..., -0.0511,  0.0931,  0.0612],
        [ 0.0331, -0.0218,  0.0822,  ..., -0.0110,  0.0950,  0.1008],
        [ 0.0010, -0.0102,  0.0069,  ..., -0.0526,  0.0617,  0.1195],
        ...,
        [-0.0114, -0.0006,  0.0716,  ..., -0.0489,  0.0267,  0.0182],
        [-0.0591, -0.1079,  0.0274,  ..., -0.0354,  0.0910,  0.0161],
        [-0.0238, -0.0182,  0.0554,  ..., -0.0043,  0.0929,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8441, 0.8422, 0.8197,  ..., 0.7510, 0.7501, 0.7499],
        [0.9300, 0.9187, 0.9170,  ..., 0.8933, 0.8908, 0.8892],
        [0.9024, 0.8665, 0.8598,  ..., 0.7916, 0.7901, 0.7900],
        ...,
        [0.8426, 0.8183, 0.8133,  ..., 0.7313, 0.7307, 0.7304],
        [0.9079, 0.8757, 0.8207,  ..., 0.7727, 0.7726, 0.7689],
        [0.8471, 0.8314, 0.8243,  ..., 0.7533, 0.7524, 0.7507]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[172661.4062, 167835.5312, 121798.4688,  ...,  45645.2070,
          45047.3867,  44952.1172],
        [588932.0000, 500672.6250, 489085.2812,  ..., 348554.8438,
         336157.8438, 328536.4375],
        [397072.1562, 237632.0938, 215851.6719,  ...,  81575.5000,
          79750.8047,  79643.2578],
        ...,
        [168829.5625, 119339.1797, 111177.6953,  ...,  34432.9023,
          34142.7930,  33990.4844],
        [429366.8750, 270937.2812, 123570.0703,  ...,  62272.2031,
          62149.2109,  58958.4180],
        [180250.5781, 143837.3125, 130111.8516,  ...,  47132.4258,
          46591.6250,  45422.3984]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[172661.4062,      0.0000],
         [167835.5312,      0.0000],
         [121798.4688,      0.0000],
         ...,
         [ 45645.2070,      0.0000],
         [ 45047.3867,      0.0000],
         [ 44952.1172,      0.0000]],

        [[588932.0000,      0.0000],
         [500672.6250,      0.0000],
         [489085.2812,      0.0000],
         ...,
         [348554.8438,      0.0000],
         [336157.8438,      0.0000],
         [328536.4375,      0.0000]],

        [[397072.1562,      0.0000],
         [     0.0000, 237632.0938],
         [215851.6719,      0.0000],
         ...,
         [ 81575.5000,      0.0000],
         [ 79750.8047,      0.0000],
         [ 79643.2578,      0.0000]],

        ...,

        [[     0.0000, 168829.5625],
         [     0.0000, 119339.1797],
         [     0.0000, 111177.6953],
         ...,
         [     0.0000,  34432.9023],
         [ 34142.7930,      0.0000],
         [ 33990.4844,      0.0000]],

        [[429366.8750,      0.0000],
         [     0.0000, 270937.2812],
         [     0.0000, 123570.0703],
         ...,
         [ 62272.2031,      0.0000],
         [ 62149.2109,      0.0000],
         [     0.0000,  58958.4180]],

        [[     0.0000, 180250.5781],
         [     0.0000, 143837.3125],
         [130111.8516,      0.0000],
         ...,
         [ 47132.4258,      0.0000],
         [ 46591.6250,      0.0000],
         [ 45422.3984,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1419441.5000,    54651.4219],
        [ 8527240.0000,        0.0000],
        [ 2209573.5000,   501521.1875],
        [ 3264528.2500,        0.0000],
        [  714438.3125,   549447.6875],
        [ 1093395.2500,   202206.1406],
        [ 2188101.5000,  1051117.7500],
        [ 2963385.0000,   104485.5156],
        [ 3654143.2500,   142958.9375],
        [ 3650433.7500,        0.0000],
        [ 6131349.5000,        0.0000],
        [ 1556512.1250,        0.0000],
        [ 2938149.5000,        0.0000],
        [10515613.0000,        0.0000],
        [11553182.0000,        0.0000],
        [ 9224327.0000,        0.0000],
        [ 6524568.0000,        0.0000],
        [ 8592965.0000,        0.0000],
        [ 3844703.0000,        0.0000],
        [ 5289017.0000,   239182.9531],
        [ 6224541.0000,        0.0000],
        [ 4333587.0000,        0.0000],
        [11491901.0000,        0.0000],
        [11235666.0000,        0.0000],
        [ 3138430.5000,        0.0000],
        [10168806.0000,        0.0000],
        [ 9022042.0000,        0.0000],
        [12468479.0000,        0.0000],
        [10654906.0000,        0.0000],
        [10383970.0000,        0.0000],
        [13227366.0000,        0.0000],
        [10381910.0000,        0.0000],
        [ 2817970.5000,    97301.5312],
        [ 2251652.5000,  1092975.7500],
        [ 3173858.7500,  2036701.2500],
        [ 1199991.5000,  1625794.8750],
        [ 1693483.5000,   942630.5625],
        [ 1262319.2500,   708407.1250],
        [ 1144795.2500,   913666.1250],
        [ 7377620.0000,        0.0000],
        [ 2532177.2500,   233507.0938],
        [ 3723573.0000,        0.0000],
        [ 3364373.2500,        0.0000],
        [ 2648910.2500,    93531.6797],
        [ 1329930.0000,  1195456.6250],
        [  328067.1250,   384028.6562],
        [ 3874882.2500,   219412.5312],
        [  649056.0000,   410625.8125],
        [  311393.0625,   320162.7812],
        [ 1857076.7500,  1058815.0000],
        [ 1101156.0000,   355133.6875],
        [ 2239886.0000,   946077.0000],
        [ 2499131.5000,  1801470.0000],
        [ 3683650.2500,   163110.7656],
        [ 6207138.0000,   325018.0938],
        [ 3737010.7500,   185560.9688],
        [ 2899490.5000,  1152684.7500],
        [ 3380660.7500,  1013811.3750],
        [ 1837820.2500,   978961.2500],
        [  987309.6875,   901153.3750],
        [ 2942354.0000,   588042.2500],
        [  745919.7500,   549804.5625],
        [ 1396383.1250,   838656.8125],
        [  836779.3125,   671311.7500]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 446/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:00, 60.02s/it]  7%|▋         | 2/30 [01:00<11:39, 24.97s/it] 10%|█         | 3/30 [01:00<06:11, 13.77s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.60s/it] 20%|██        | 6/30 [01:02<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.5872631867726645
Epoch 447/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:49, 55.52s/it]  7%|▋         | 2/30 [00:59<11:46, 25.23s/it] 10%|█         | 3/30 [00:59<06:15, 13.91s/it] 13%|█▎        | 4/30 [01:00<03:43,  8.60s/it] 17%|█▋        | 5/30 [01:00<02:21,  5.65s/it] 20%|██        | 6/30 [01:01<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.40s/it]
Epoch loss is 2.598669449488322
Epoch 448/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:36, 57.11s/it]  7%|▋         | 2/30 [00:59<11:32, 24.72s/it] 10%|█         | 3/30 [01:00<06:16, 13.95s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.62s/it] 17%|█▋        | 5/30 [01:01<02:21,  5.67s/it] 20%|██        | 6/30 [01:01<01:33,  3.89s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.02s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.22it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.23it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.24it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.621072848637899
Epoch 449/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:44, 55.34s/it]  7%|▋         | 2/30 [01:01<12:19, 26.42s/it] 10%|█         | 3/30 [01:01<06:33, 14.56s/it] 13%|█▎        | 4/30 [01:02<03:53,  8.98s/it] 17%|█▋        | 5/30 [01:02<02:27,  5.90s/it] 20%|██        | 6/30 [01:03<01:37,  4.05s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.87s/it] 27%|██▋       | 8/30 [01:04<00:46,  2.10s/it] 30%|███       | 9/30 [01:04<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.01it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:10,  1.60it/s] 50%|█████     | 15/30 [01:07<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.97it/s] 60%|██████    | 18/30 [01:08<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.15it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 2.5980737368265787
Epoch 450/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:43, 59.42s/it]  7%|▋         | 2/30 [00:59<11:32, 24.73s/it] 10%|█         | 3/30 [01:00<06:08, 13.64s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.43s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.55s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.22it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.23it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.24it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.5888715982437134
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0968,  0.0777,  ..., -0.0511,  0.0930,  0.0611],
        [ 0.0331, -0.0218,  0.0822,  ..., -0.0110,  0.0950,  0.1008],
        [ 0.0011, -0.0103,  0.0069,  ..., -0.0526,  0.0617,  0.1194],
        ...,
        [-0.0113, -0.0006,  0.0715,  ..., -0.0490,  0.0266,  0.0182],
        [-0.0590, -0.1079,  0.0274,  ..., -0.0354,  0.0911,  0.0161],
        [-0.0238, -0.0183,  0.0553,  ..., -0.0043,  0.0929,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8440, 0.8420, 0.8195,  ..., 0.7509, 0.7500, 0.7498],
        [0.9299, 0.9185, 0.9169,  ..., 0.8932, 0.8906, 0.8891],
        [0.9023, 0.8663, 0.8596,  ..., 0.7915, 0.7899, 0.7898],
        ...,
        [0.8426, 0.8181, 0.8132,  ..., 0.7310, 0.7306, 0.7303],
        [0.9078, 0.8756, 0.8205,  ..., 0.7726, 0.7724, 0.7688],
        [0.8470, 0.8312, 0.8242,  ..., 0.7529, 0.7522, 0.7504]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[172304.4531, 167520.6719, 121512.7109,  ...,  45586.9570,
          44976.9453,  44888.2852],
        [588186.0625, 499738.1250, 488360.0938,  ..., 347929.1562,
         335478.5625, 328167.9062],
        [396264.5312, 237033.8906, 215306.2344,  ...,  81364.1719,
          79522.0469,  79440.9453],
        ...,
        [168813.2969, 119074.2969, 111002.6719,  ...,  34291.8906,
          34125.4766,  33962.7500],
        [428936.3125, 270670.5000, 123161.9375,  ...,  62135.7617,
          61999.3828,  58824.0742],
        [179934.2031, 143593.0781, 129790.6250,  ...,  46926.8242,
          46417.5469,  45264.3477]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[172304.4531,      0.0000],
         [167520.6719,      0.0000],
         [121512.7109,      0.0000],
         ...,
         [ 45586.9570,      0.0000],
         [ 44976.9453,      0.0000],
         [ 44888.2852,      0.0000]],

        [[588186.0625,      0.0000],
         [499738.1250,      0.0000],
         [488360.0938,      0.0000],
         ...,
         [347929.1562,      0.0000],
         [335478.5625,      0.0000],
         [328167.9062,      0.0000]],

        [[396264.5312,      0.0000],
         [     0.0000, 237033.8906],
         [215306.2344,      0.0000],
         ...,
         [ 81364.1719,      0.0000],
         [ 79522.0469,      0.0000],
         [ 79440.9453,      0.0000]],

        ...,

        [[     0.0000, 168813.2969],
         [     0.0000, 119074.2969],
         [     0.0000, 111002.6719],
         ...,
         [     0.0000,  34291.8906],
         [ 34125.4766,      0.0000],
         [ 33962.7500,      0.0000]],

        [[428936.3125,      0.0000],
         [     0.0000, 270670.5000],
         [     0.0000, 123161.9375],
         ...,
         [ 62135.7617,      0.0000],
         [ 61999.3828,      0.0000],
         [     0.0000,  58824.0742]],

        [[     0.0000, 179934.2031],
         [     0.0000, 143593.0781],
         [129790.6250,      0.0000],
         ...,
         [ 46926.8242,      0.0000],
         [ 46417.5469,      0.0000],
         [ 45264.3477,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1416785.0000,    54472.2188],
        [ 8513049.0000,        0.0000],
        [ 2204037.2500,   500115.4062],
        [ 3260054.7500,        0.0000],
        [  712751.5000,   548487.6250],
        [ 1089992.7500,   201631.2188],
        [ 2181007.5000,  1048625.8750],
        [ 2955372.5000,   104180.6484],
        [ 3645292.0000,   142505.3906],
        [ 3644592.5000,        0.0000],
        [ 6121365.0000,        0.0000],
        [ 1551406.8750,        0.0000],
        [ 2932549.0000,        0.0000],
        [10502915.0000,        0.0000],
        [11542523.0000,        0.0000],
        [ 9217148.0000,        0.0000],
        [ 6511900.0000,        0.0000],
        [ 8583118.0000,        0.0000],
        [ 3837656.2500,        0.0000],
        [ 5281436.0000,   238769.3125],
        [ 6213143.0000,        0.0000],
        [ 4324752.0000,        0.0000],
        [11483286.0000,        0.0000],
        [11226757.0000,        0.0000],
        [ 3131120.2500,        0.0000],
        [10162024.0000,        0.0000],
        [ 9013753.0000,        0.0000],
        [12460724.0000,        0.0000],
        [10642052.0000,        0.0000],
        [10375350.0000,        0.0000],
        [13214284.0000,        0.0000],
        [10373484.0000,        0.0000],
        [ 2812714.7500,    97102.4141],
        [ 2245045.7500,  1091369.2500],
        [ 3168080.2500,  2034274.5000],
        [ 1196788.5000,  1623525.0000],
        [ 1690217.7500,   942229.9375],
        [ 1259251.8750,   707335.2500],
        [ 1142572.2500,   912522.7500],
        [ 7366957.5000,        0.0000],
        [ 2527978.7500,   232978.7969],
        [ 3717715.5000,        0.0000],
        [ 3358689.7500,        0.0000],
        [ 2644948.0000,    93490.6562],
        [ 1327047.0000,  1193648.5000],
        [  327742.7500,   383311.7500],
        [ 3867753.5000,   219170.7812],
        [  648159.3750,   410541.6875],
        [  311007.7812,   319780.5625],
        [ 1851930.5000,  1056788.6250],
        [ 1098804.3750,   355051.9375],
        [ 2234352.5000,   945456.7500],
        [ 2495067.5000,  1798985.0000],
        [ 3678270.0000,   162875.5938],
        [ 6197510.5000,   324436.5000],
        [ 3730000.0000,   185127.7500],
        [ 2892660.5000,  1150375.7500],
        [ 3375387.0000,  1012723.9375],
        [ 1834455.0000,   977418.7500],
        [  985611.1875,   900007.5000],
        [ 2936093.7500,   587053.5625],
        [  744514.8750,   548913.3750],
        [ 1393942.3750,   837139.2500],
        [  834240.9375,   670427.7500]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 451/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:22, 56.65s/it]  7%|▋         | 2/30 [00:57<11:01, 23.63s/it] 10%|█         | 3/30 [00:57<05:52, 13.04s/it] 13%|█▎        | 4/30 [00:58<03:29,  8.07s/it] 17%|█▋        | 5/30 [00:58<02:14,  5.39s/it] 20%|██        | 6/30 [00:59<01:29,  3.71s/it] 23%|██▎       | 7/30 [00:59<01:00,  2.64s/it] 27%|██▋       | 8/30 [01:00<00:42,  1.94s/it] 30%|███       | 9/30 [01:00<00:30,  1.47s/it] 33%|███▎      | 10/30 [01:00<00:23,  1.15s/it] 37%|███▋      | 11/30 [01:01<00:17,  1.07it/s] 40%|████      | 12/30 [01:01<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.47it/s] 47%|████▋     | 14/30 [01:02<00:09,  1.64it/s] 50%|█████     | 15/30 [01:03<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:03<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:04<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:04<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:05<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.20it/s] 77%|███████▋  | 23/30 [01:06<00:03,  2.22it/s] 80%|████████  | 24/30 [01:07<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:07<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:08<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:08<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch loss is 2.6207077503204346
Epoch 452/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:09, 56.19s/it]  7%|▋         | 2/30 [00:58<11:22, 24.38s/it] 10%|█         | 3/30 [00:58<06:03, 13.45s/it] 13%|█▎        | 4/30 [00:59<03:36,  8.31s/it] 17%|█▋        | 5/30 [00:59<02:16,  5.48s/it] 20%|██        | 6/30 [01:00<01:30,  3.76s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.68s/it] 27%|██▋       | 8/30 [01:00<00:43,  1.97s/it] 30%|███       | 9/30 [01:01<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 2.5397716045379637
Epoch 453/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:41, 59.35s/it]  7%|▋         | 2/30 [00:59<11:31, 24.70s/it] 10%|█         | 3/30 [01:00<06:07, 13.62s/it] 13%|█▎        | 4/30 [01:00<03:38,  8.42s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.54s/it] 20%|██        | 6/30 [01:01<01:31,  3.81s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.54280366897583
Epoch 454/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:10, 56.22s/it]  7%|▋         | 2/30 [00:56<10:55, 23.41s/it] 10%|█         | 3/30 [00:57<05:48, 12.92s/it] 13%|█▎        | 4/30 [00:57<03:27,  8.00s/it] 17%|█▋        | 5/30 [00:57<02:11,  5.27s/it] 20%|██        | 6/30 [01:00<01:40,  4.17s/it] 23%|██▎       | 7/30 [01:00<01:07,  2.95s/it] 27%|██▋       | 8/30 [01:00<00:47,  2.15s/it] 30%|███       | 9/30 [01:01<00:34,  1.62s/it] 33%|███▎      | 10/30 [01:01<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:02<00:19,  1.01s/it] 40%|████      | 12/30 [01:02<00:15,  1.20it/s] 43%|████▎     | 13/30 [01:03<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:03<00:10,  1.58it/s] 50%|█████     | 15/30 [01:04<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:04<00:06,  1.97it/s] 60%|██████    | 18/30 [01:05<00:05,  2.05it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.11it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:06<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.36s/it]
Epoch loss is 2.556916046142578
Epoch 455/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:32, 56.99s/it]  7%|▋         | 2/30 [00:57<11:05, 23.77s/it] 10%|█         | 3/30 [01:00<06:26, 14.31s/it] 13%|█▎        | 4/30 [01:01<03:49,  8.84s/it] 17%|█▋        | 5/30 [01:01<02:25,  5.81s/it] 20%|██        | 6/30 [01:01<01:35,  3.98s/it] 23%|██▎       | 7/30 [01:02<01:05,  2.83s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.07s/it] 30%|███       | 9/30 [01:03<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.02it/s] 40%|████      | 12/30 [01:04<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.6106547514597573
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0969,  0.0777,  ..., -0.0510,  0.0929,  0.0611],
        [ 0.0332, -0.0218,  0.0822,  ..., -0.0109,  0.0949,  0.1008],
        [ 0.0012, -0.0103,  0.0068,  ..., -0.0526,  0.0617,  0.1194],
        ...,
        [-0.0113, -0.0006,  0.0715,  ..., -0.0490,  0.0266,  0.0182],
        [-0.0590, -0.1080,  0.0273,  ..., -0.0354,  0.0911,  0.0161],
        [-0.0238, -0.0183,  0.0552,  ..., -0.0042,  0.0930,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8439, 0.8419, 0.8194,  ..., 0.7508, 0.7499, 0.7498],
        [0.9299, 0.9184, 0.9168,  ..., 0.8931, 0.8905, 0.8890],
        [0.9022, 0.8662, 0.8595,  ..., 0.7913, 0.7897, 0.7897],
        ...,
        [0.8426, 0.8180, 0.8131,  ..., 0.7308, 0.7306, 0.7303],
        [0.9078, 0.8756, 0.8203,  ..., 0.7725, 0.7723, 0.7686],
        [0.8469, 0.8311, 0.8240,  ..., 0.7527, 0.7520, 0.7502]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 1, 0, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[172018.9375, 167274.9844, 121277.0078,  ...,  45542.8945,
          44925.8906,  44848.2344],
        [587587.3125, 498988.0625, 487773.5938,  ..., 347424.1562,
         334920.4375, 327851.6250],
        [395636.1875, 236552.4531, 214895.7656,  ...,  81203.2344,
          79346.6016,  79293.8047],
        ...,
        [168817.3281, 118868.9297, 110874.2344,  ...,  34186.5820,
          34122.3867,  33947.0117],
        [428579.7500, 270487.8125, 122844.6250,  ...,  62038.1211,
          61876.3438,  58711.1992],
        [179682.3125, 143411.4688, 129538.6094,  ...,  46761.9375,
          46280.6094,  45141.0547]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[172018.9375,      0.0000],
         [167274.9844,      0.0000],
         [121277.0078,      0.0000],
         ...,
         [ 45542.8945,      0.0000],
         [ 44925.8906,      0.0000],
         [ 44848.2344,      0.0000]],

        [[587587.3125,      0.0000],
         [498988.0625,      0.0000],
         [487773.5938,      0.0000],
         ...,
         [347424.1562,      0.0000],
         [334920.4375,      0.0000],
         [327851.6250,      0.0000]],

        [[395636.1875,      0.0000],
         [     0.0000, 236552.4531],
         [214895.7656,      0.0000],
         ...,
         [ 81203.2344,      0.0000],
         [ 79346.6016,      0.0000],
         [ 79293.8047,      0.0000]],

        ...,

        [[     0.0000, 168817.3281],
         [     0.0000, 118868.9297],
         [     0.0000, 110874.2344],
         ...,
         [     0.0000,  34186.5820],
         [ 34122.3867,      0.0000],
         [ 33947.0117,      0.0000]],

        [[428579.7500,      0.0000],
         [     0.0000, 270487.8125],
         [     0.0000, 122844.6250],
         ...,
         [ 62038.1211,      0.0000],
         [ 61876.3438,      0.0000],
         [     0.0000,  58711.1992]],

        [[     0.0000, 179682.3125],
         [     0.0000, 143411.4688],
         [129538.6094,      0.0000],
         ...,
         [ 46761.9375,      0.0000],
         [ 46280.6094,      0.0000],
         [ 45141.0547,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1414653.7500,    54336.4883],
        [ 8501544.0000,        0.0000],
        [ 2199732.2500,   498969.8125],
        [ 3256167.0000,        0.0000],
        [  711445.5625,   547703.3750],
        [ 1087144.7500,   201141.4531],
        [ 2175584.5000,  1046598.5000],
        [ 2948696.5000,   103941.4844],
        [ 3638204.5000,   142134.0312],
        [ 3639747.2500,        0.0000],
        [ 6113370.5000,        0.0000],
        [ 1547261.7500,        0.0000],
        [ 2927757.7500,        0.0000],
        [10493136.0000,        0.0000],
        [11533938.0000,        0.0000],
        [ 9211332.0000,        0.0000],
        [ 6501546.0000,        0.0000],
        [ 8574984.0000,        0.0000],
        [ 3831822.2500,        0.0000],
        [ 5275535.5000,   238434.5781],
        [ 6204079.5000,        0.0000],
        [ 4317599.5000,        0.0000],
        [11476333.0000,        0.0000],
        [11219182.0000,        0.0000],
        [ 3125165.5000,        0.0000],
        [10156813.0000,        0.0000],
        [ 9006789.0000,        0.0000],
        [12454671.0000,        0.0000],
        [10632154.0000,        0.0000],
        [10368596.0000,        0.0000],
        [13203632.0000,        0.0000],
        [10367026.0000,        0.0000],
        [ 2808605.5000,    96956.3906],
        [ 2239790.0000,  1090074.0000],
        [ 3163357.2500,  2032136.0000],
        [ 1194257.2500,  1621659.1250],
        [ 1687655.7500,   941927.1875],
        [ 1256818.5000,   706461.3750],
        [ 1140711.1250,   911536.4375],
        [ 7358364.0000,        0.0000],
        [ 2524701.2500,   232584.0000],
        [ 3713261.2500,        0.0000],
        [ 3354347.5000,        0.0000],
        [ 2641780.0000,    93455.0000],
        [ 1324807.7500,  1192362.6250],
        [  327473.1250,   382745.1250],
        [ 3862241.5000,   218970.4062],
        [  647432.3750,   410473.0312],
        [  310668.5000,   319472.1875],
        [ 1847701.8750,  1055064.3750],
        [ 1096914.2500,   354972.6875],
        [ 2229927.0000,   945004.6250],
        [ 2491721.0000,  1797054.0000],
        [ 3674038.0000,   162685.4375],
        [ 6190116.0000,   323971.7812],
        [ 3724390.5000,   184774.9844],
        [ 2887222.2500,  1148585.6250],
        [ 3371415.0000,  1011958.0000],
        [ 1831742.5000,   976187.6250],
        [  984305.9375,   899120.5000],
        [ 2930917.5000,   586280.1875],
        [  743469.6250,   548261.1250],
        [ 1391967.0000,   835967.8750],
        [  832220.6250,   669767.3750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 456/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:00, 60.01s/it]  7%|▋         | 2/30 [01:00<11:39, 24.97s/it] 10%|█         | 3/30 [01:00<06:11, 13.78s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.60s/it] 20%|██        | 6/30 [01:02<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.43s/it]
Epoch loss is 2.5987498998641967
Epoch 457/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:16, 56.45s/it]  7%|▋         | 2/30 [00:59<11:39, 24.98s/it] 10%|█         | 3/30 [00:59<06:11, 13.78s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.60s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.6201145092646283
Epoch 458/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:21, 56.59s/it]  7%|▋         | 2/30 [00:57<10:59, 23.56s/it] 10%|█         | 3/30 [00:59<06:21, 14.12s/it] 13%|█▎        | 4/30 [01:00<03:46,  8.72s/it] 17%|█▋        | 5/30 [01:00<02:23,  5.73s/it] 20%|██        | 6/30 [01:01<01:34,  3.93s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.79s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:02<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.57779966990153
Epoch 459/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:54<26:26, 54.72s/it]  7%|▋         | 2/30 [00:56<11:01, 23.62s/it] 10%|█         | 3/30 [00:57<05:52, 13.04s/it] 13%|█▎        | 4/30 [00:57<03:29,  8.06s/it] 17%|█▋        | 5/30 [01:00<02:36,  6.27s/it] 20%|██        | 6/30 [01:00<01:42,  4.29s/it] 23%|██▎       | 7/30 [01:01<01:09,  3.03s/it] 27%|██▋       | 8/30 [01:01<00:48,  2.21s/it] 30%|███       | 9/30 [01:02<00:34,  1.66s/it] 33%|███▎      | 10/30 [01:02<00:25,  1.28s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.03s/it] 40%|████      | 12/30 [01:03<00:15,  1.18it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.38it/s] 47%|████▋     | 14/30 [01:04<00:10,  1.56it/s] 50%|█████     | 15/30 [01:04<00:08,  1.72it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.85it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.96it/s] 60%|██████    | 18/30 [01:06<00:05,  2.04it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.10it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.15it/s] 70%|███████   | 21/30 [01:07<00:04,  2.18it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.22it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.5984718799591064
Epoch 460/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:03, 60.11s/it]  7%|▋         | 2/30 [01:01<11:51, 25.40s/it] 10%|█         | 3/30 [01:01<06:18, 14.01s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.65s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.69s/it] 20%|██        | 6/30 [01:02<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.22it/s] 80%|████████  | 24/30 [01:10<00:02,  2.23it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.6302561283111574
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0970,  0.0777,  ..., -0.0510,  0.0928,  0.0611],
        [ 0.0332, -0.0218,  0.0822,  ..., -0.0109,  0.0949,  0.1008],
        [ 0.0012, -0.0103,  0.0068,  ..., -0.0526,  0.0617,  0.1194],
        ...,
        [-0.0112, -0.0006,  0.0715,  ..., -0.0491,  0.0266,  0.0182],
        [-0.0589, -0.1080,  0.0273,  ..., -0.0354,  0.0911,  0.0161],
        [-0.0238, -0.0183,  0.0552,  ..., -0.0041,  0.0930,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8438, 0.8418, 0.8193,  ..., 0.7508, 0.7498, 0.7497],
        [0.9298, 0.9183, 0.9168,  ..., 0.8930, 0.8904, 0.8890],
        [0.9021, 0.8661, 0.8593,  ..., 0.7912, 0.7896, 0.7895],
        ...,
        [0.8426, 0.8179, 0.8131,  ..., 0.7306, 0.7306, 0.7303],
        [0.9077, 0.8755, 0.8202,  ..., 0.7724, 0.7722, 0.7685],
        [0.8469, 0.8311, 0.8239,  ..., 0.7525, 0.7518, 0.7501]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 1, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[171754.5312, 167055.6094, 121086.8984,  ...,  45506.5977,
          44874.3359,  44813.0938],
        [587129.6875, 498427.3438, 487301.1875,  ..., 347036.0625,
         334484.0938, 327646.5938],
        [395116.9688, 236149.4219, 214517.3594,  ...,  81060.9453,
          79191.9297,  79157.5000],
        ...,
        [168802.1875, 118683.8438, 110751.9609,  ...,  34119.9453,
          34093.8867,  33933.7109],
        [428266.7812, 270330.7500, 122581.8906,  ...,  61962.0273,
          61773.2812,  58621.6836],
        [179488.4375, 143270.3906, 129352.8125,  ...,  46633.5859,
          46174.7617,  45046.3555]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[171754.5312,      0.0000],
         [167055.6094,      0.0000],
         [121086.8984,      0.0000],
         ...,
         [ 45506.5977,      0.0000],
         [ 44874.3359,      0.0000],
         [ 44813.0938,      0.0000]],

        [[587129.6875,      0.0000],
         [498427.3438,      0.0000],
         [487301.1875,      0.0000],
         ...,
         [347036.0625,      0.0000],
         [334484.0938,      0.0000],
         [327646.5938,      0.0000]],

        [[395116.9688,      0.0000],
         [     0.0000, 236149.4219],
         [214517.3594,      0.0000],
         ...,
         [ 81060.9453,      0.0000],
         [ 79191.9297,      0.0000],
         [ 79157.5000,      0.0000]],

        ...,

        [[     0.0000, 168802.1875],
         [     0.0000, 118683.8438],
         [     0.0000, 110751.9609],
         ...,
         [ 34119.9453,      0.0000],
         [     0.0000,  34093.8867],
         [ 33933.7109,      0.0000]],

        [[428266.7812,      0.0000],
         [     0.0000, 270330.7500],
         [     0.0000, 122581.8906],
         ...,
         [ 61962.0273,      0.0000],
         [ 61773.2812,      0.0000],
         [     0.0000,  58621.6836]],

        [[     0.0000, 179488.4375],
         [     0.0000, 143270.3906],
         [129352.8125,      0.0000],
         ...,
         [ 46633.5859,      0.0000],
         [ 46174.7617,      0.0000],
         [ 45046.3555,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1412800.3750,    54218.0039],
        [ 8492721.0000,        0.0000],
        [ 2196005.0000,   498007.6562],
        [ 3253216.5000,        0.0000],
        [  710366.7500,   547008.0000],
        [ 1084973.0000,   200784.2500],
        [ 2171563.7500,  1045220.6875],
        [ 2942252.2500,   103727.8906],
        [ 3632528.0000,   141865.0938],
        [ 3635874.0000,        0.0000],
        [ 6107043.5000,        0.0000],
        [ 1543645.3750,        0.0000],
        [ 2923914.2500,        0.0000],
        [10484896.0000,        0.0000],
        [11527047.0000,        0.0000],
        [ 9206934.0000,        0.0000],
        [ 6492867.0000,        0.0000],
        [ 8568190.0000,        0.0000],
        [ 3826783.5000,        0.0000],
        [ 5270741.5000,   238178.2188],
        [ 6196459.0000,        0.0000],
        [ 4311134.0000,        0.0000],
        [11471055.0000,        0.0000],
        [11212982.0000,        0.0000],
        [ 3120035.7500,        0.0000],
        [10152808.0000,        0.0000],
        [ 9001364.0000,        0.0000],
        [12450079.0000,        0.0000],
        [10624134.0000,        0.0000],
        [10362962.0000,        0.0000],
        [13195380.0000,        0.0000],
        [10361661.0000,        0.0000],
        [ 2805190.5000,    96822.0469],
        [ 2235595.0000,  1089028.2500],
        [ 3159875.7500,  2030589.3750],
        [ 1192155.5000,  1620075.0000],
        [ 1685356.5000,   941615.8125],
        [ 1254821.2500,   705702.8750],
        [ 1139126.7500,   910657.8750],
        [ 7351469.5000,        0.0000],
        [ 2521928.0000,   232254.8594],
        [ 3709670.2500,        0.0000],
        [ 3351084.0000,        0.0000],
        [ 2639538.0000,    93441.8125],
        [ 1323030.6250,  1191297.7500],
        [  327267.5938,   382303.3438],
        [ 3857365.0000,   218762.5156],
        [  646921.6250,   410424.6250],
        [  310442.7188,   319258.5625],
        [ 1843910.5000,  1053499.0000],
        [ 1095464.8750,   354933.4375],
        [ 2226404.0000,   944646.3750],
        [ 2488995.0000,  1795454.2500],
        [ 3670558.7500,   162506.7969],
        [ 6184041.0000,   323579.9688],
        [ 3719937.7500,   184477.0625],
        [ 2882586.2500,  1147024.8750],
        [ 3367810.5000,  1011226.1875],
        [ 1829620.0000,   975182.8125],
        [  983249.7500,   898402.4375],
        [ 2926395.0000,   585553.0000],
        [  742538.6250,   547653.1250],
        [ 1390356.1250,   835010.0625],
        [  830679.4375,   669238.1250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 461/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:37, 59.22s/it]  7%|▋         | 2/30 [00:59<11:33, 24.76s/it] 10%|█         | 3/30 [01:00<06:08, 13.66s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.44s/it] 17%|█▋        | 5/30 [01:01<02:18,  5.56s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.25it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.580160657564799
Epoch 462/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:18, 56.51s/it]  7%|▋         | 2/30 [00:59<11:36, 24.89s/it] 10%|█         | 3/30 [00:59<06:10, 13.73s/it] 13%|█▎        | 4/30 [01:00<03:40,  8.48s/it] 17%|█▋        | 5/30 [01:00<02:19,  5.58s/it] 20%|██        | 6/30 [01:01<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:01<00:43,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.594401796658834
Epoch 463/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:26, 58.84s/it]  7%|▋         | 2/30 [01:00<11:38, 24.96s/it] 10%|█         | 3/30 [01:00<06:11, 13.76s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.50s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.60s/it] 20%|██        | 6/30 [01:01<01:32,  3.84s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.00s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.22it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.25it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.584256927172343
Epoch 464/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:43, 57.37s/it]  7%|▋         | 2/30 [00:59<11:42, 25.10s/it] 10%|█         | 3/30 [01:00<06:13, 13.84s/it] 13%|█▎        | 4/30 [01:00<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.63s/it] 20%|██        | 6/30 [01:01<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.24it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.6024157921473186
Epoch 465/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:17, 56.48s/it]  7%|▋         | 2/30 [01:00<11:54, 25.52s/it] 10%|█         | 3/30 [01:00<06:19, 14.07s/it] 13%|█▎        | 4/30 [01:01<03:45,  8.69s/it] 17%|█▋        | 5/30 [01:01<02:22,  5.72s/it] 20%|██        | 6/30 [01:02<01:34,  3.92s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.78s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.04s/it] 30%|███       | 9/30 [01:03<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.5529617706934613
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0970,  0.0777,  ..., -0.0510,  0.0928,  0.0611],
        [ 0.0333, -0.0218,  0.0822,  ..., -0.0109,  0.0949,  0.1007],
        [ 0.0012, -0.0103,  0.0068,  ..., -0.0525,  0.0618,  0.1194],
        ...,
        [-0.0112, -0.0006,  0.0715,  ..., -0.0491,  0.0266,  0.0182],
        [-0.0589, -0.1081,  0.0273,  ..., -0.0354,  0.0911,  0.0162],
        [-0.0238, -0.0183,  0.0552,  ..., -0.0041,  0.0930,  0.0998]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8437, 0.8418, 0.8192,  ..., 0.7508, 0.7498, 0.7497],
        [0.9298, 0.9183, 0.9167,  ..., 0.8929, 0.8903, 0.8889],
        [0.9020, 0.8660, 0.8592,  ..., 0.7911, 0.7895, 0.7895],
        ...,
        [0.8426, 0.8178, 0.8130,  ..., 0.7306, 0.7305, 0.7302],
        [0.9077, 0.8755, 0.8200,  ..., 0.7723, 0.7721, 0.7684],
        [0.8468, 0.8310, 0.8238,  ..., 0.7523, 0.7517, 0.7500]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 1, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[171565.9375, 166897.3125, 120941.8203,  ...,  45481.8672,
          44843.0195,  44787.7578],
        [586728.8750, 497947.9688, 486901.6875,  ..., 346718.1875,
         334127.9688, 327456.3438],
        [394728.6875, 235868.7500, 214259.3281,  ...,  80957.9688,
          79085.5156,  79060.7031],
        ...,
        [168804.2812, 118554.8750, 110657.3672,  ...,  34118.2188,
          34030.2500,  33925.7148],
        [428054.4375, 270216.5625, 122377.7109,  ...,  61910.2266,
          61697.3906,  58557.6484],
        [179309.8125, 143142.1562, 129184.2969,  ...,  46529.1016,
          46084.9727,  44963.1367]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[171565.9375,      0.0000],
         [166897.3125,      0.0000],
         [120941.8203,      0.0000],
         ...,
         [ 45481.8672,      0.0000],
         [ 44843.0195,      0.0000],
         [ 44787.7578,      0.0000]],

        [[586728.8750,      0.0000],
         [497947.9688,      0.0000],
         [486901.6875,      0.0000],
         ...,
         [346718.1875,      0.0000],
         [334127.9688,      0.0000],
         [327456.3438,      0.0000]],

        [[394728.6875,      0.0000],
         [     0.0000, 235868.7500],
         [214259.3281,      0.0000],
         ...,
         [ 80957.9688,      0.0000],
         [ 79085.5156,      0.0000],
         [ 79060.7031,      0.0000]],

        ...,

        [[     0.0000, 168804.2812],
         [     0.0000, 118554.8750],
         [     0.0000, 110657.3672],
         ...,
         [ 34118.2188,      0.0000],
         [     0.0000,  34030.2500],
         [ 33925.7148,      0.0000]],

        [[428054.4375,      0.0000],
         [     0.0000, 270216.5625],
         [     0.0000, 122377.7109],
         ...,
         [ 61910.2266,      0.0000],
         [ 61697.3906,      0.0000],
         [     0.0000,  58557.6484]],

        [[     0.0000, 179309.8125],
         [     0.0000, 143142.1562],
         [129184.2969,      0.0000],
         ...,
         [ 46529.1016,      0.0000],
         [ 46084.9727,      0.0000],
         [ 44963.1367,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1411455.1250,    54127.2812],
        [ 8485362.0000,        0.0000],
        [ 2193289.0000,   497318.1875],
        [ 3250737.0000,        0.0000],
        [  709561.3750,   546517.5000],
        [ 1083091.8750,   200476.1562],
        [ 2167935.0000,  1043943.2500],
        [ 2938249.7500,   103574.2734],
        [ 3628134.0000,   141660.5312],
        [ 3632880.0000,        0.0000],
        [ 6101961.0000,        0.0000],
        [ 1541091.8750,        0.0000],
        [ 2921063.5000,        0.0000],
        [10478799.0000,        0.0000],
        [11521724.0000,        0.0000],
        [ 9203530.0000,        0.0000],
        [ 6486264.5000,        0.0000],
        [ 8563144.0000,        0.0000],
        [ 3823235.7500,        0.0000],
        [ 5266937.0000,   237961.4062],
        [ 6190585.5000,        0.0000],
        [ 4306661.0000,        0.0000],
        [11466711.0000,        0.0000],
        [11208573.0000,        0.0000],
        [ 3116177.5000,        0.0000],
        [10149894.0000,        0.0000],
        [ 8997262.0000,        0.0000],
        [12446404.0000,        0.0000],
        [10617650.0000,        0.0000],
        [10358643.0000,        0.0000],
        [13188908.0000,        0.0000],
        [10357878.0000,        0.0000],
        [ 2802599.2500,    96718.0312],
        [ 2232314.5000,  1088198.2500],
        [ 3156993.0000,  2029299.5000],
        [ 1190537.2500,  1618915.2500],
        [ 1683688.0000,   941372.0000],
        [ 1253248.3750,   705147.6250],
        [ 1137979.8750,   910059.3750],
        [ 7346293.0000,        0.0000],
        [ 2519733.5000,   231989.6719],
        [ 3707038.7500,        0.0000],
        [ 3348290.0000,        0.0000],
        [ 2637656.7500,    93422.7422],
        [ 1321708.1250,  1190490.1250],
        [  327073.9062,   381950.0938],
        [ 3853902.5000,   218641.9688],
        [  646447.0000,   410360.4375],
        [  310231.0938,   319072.4062],
        [ 1841315.0000,  1052436.5000],
        [ 1094332.3750,   354901.6875],
        [ 2223633.7500,   944367.6250],
        [ 2486851.7500,  1794174.7500],
        [ 3667667.5000,   162366.6094],
        [ 6179448.5000,   323303.2500],
        [ 3716233.7500,   184275.3750],
        [ 2879142.0000,  1145881.2500],
        [ 3365123.2500,  1010714.0000],
        [ 1827829.6250,   974354.7500],
        [  982448.2500,   897876.1250],
        [ 2923164.0000,   585034.6250],
        [  741925.1250,   547230.6250],
        [ 1389192.1250,   834290.1250],
        [  829340.6250,   668755.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 466/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:15, 56.39s/it]  7%|▋         | 2/30 [00:57<11:07, 23.83s/it] 10%|█         | 3/30 [00:57<05:55, 13.15s/it] 13%|█▎        | 4/30 [00:58<03:31,  8.13s/it] 17%|█▋        | 5/30 [00:58<02:14,  5.36s/it] 20%|██        | 6/30 [00:59<01:28,  3.69s/it] 23%|██▎       | 7/30 [00:59<01:00,  2.63s/it] 27%|██▋       | 8/30 [01:00<00:42,  1.93s/it] 30%|███       | 9/30 [01:00<00:30,  1.47s/it] 33%|███▎      | 10/30 [01:00<00:22,  1.15s/it] 37%|███▋      | 11/30 [01:01<00:17,  1.07it/s] 40%|████      | 12/30 [01:01<00:14,  1.28it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.47it/s] 47%|████▋     | 14/30 [01:02<00:09,  1.65it/s] 50%|█████     | 15/30 [01:03<00:08,  1.80it/s] 53%|█████▎    | 16/30 [01:03<00:07,  1.92it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.01it/s] 60%|██████    | 18/30 [01:04<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:04<00:05,  2.14it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.18it/s] 70%|███████   | 21/30 [01:05<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:06<00:03,  2.24it/s] 80%|████████  | 24/30 [01:07<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:08<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:08<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.27it/s]100%|██████████| 30/30 [01:09<00:00,  2.27it/s]100%|██████████| 30/30 [01:09<00:00,  2.33s/it]
Epoch loss is 2.5771161794662474
Epoch 467/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:46, 59.54s/it]  7%|▋         | 2/30 [00:59<11:33, 24.78s/it] 10%|█         | 3/30 [01:00<06:09, 13.67s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.45s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.56s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.25it/s]100%|██████████| 30/30 [01:12<00:00,  2.25it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.5816659609476726
Epoch 468/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:29, 56.88s/it]  7%|▋         | 2/30 [01:01<12:08, 26.01s/it] 10%|█         | 3/30 [01:01<06:27, 14.34s/it] 13%|█▎        | 4/30 [01:02<03:50,  8.85s/it] 17%|█▋        | 5/30 [01:02<02:25,  5.82s/it] 20%|██        | 6/30 [01:03<01:35,  3.99s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.83s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.07s/it] 30%|███       | 9/30 [01:04<00:32,  1.56s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.60it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.98it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.5715726534525554
Epoch 469/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:24, 58.79s/it]  7%|▋         | 2/30 [00:59<11:25, 24.47s/it] 10%|█         | 3/30 [00:59<06:04, 13.50s/it] 13%|█▎        | 4/30 [01:00<03:36,  8.34s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.49s/it] 20%|██        | 6/30 [01:01<01:30,  3.78s/it] 23%|██▎       | 7/30 [01:01<01:01,  2.69s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.97s/it] 30%|███       | 9/30 [01:02<00:31,  1.49s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.5668686946233112
Epoch 470/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:24, 56.71s/it]  7%|▋         | 2/30 [00:58<11:30, 24.65s/it] 10%|█         | 3/30 [00:59<06:07, 13.60s/it] 13%|█▎        | 4/30 [00:59<03:38,  8.40s/it] 17%|█▋        | 5/30 [01:00<02:22,  5.69s/it] 20%|██        | 6/30 [01:01<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.03s/it] 30%|███       | 9/30 [01:02<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.6087786118189493
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0971,  0.0776,  ..., -0.0509,  0.0927,  0.0611],
        [ 0.0333, -0.0218,  0.0822,  ..., -0.0109,  0.0949,  0.1007],
        [ 0.0013, -0.0103,  0.0068,  ..., -0.0525,  0.0618,  0.1193],
        ...,
        [-0.0112, -0.0006,  0.0715,  ..., -0.0491,  0.0265,  0.0182],
        [-0.0589, -0.1081,  0.0273,  ..., -0.0354,  0.0911,  0.0162],
        [-0.0238, -0.0183,  0.0552,  ..., -0.0041,  0.0930,  0.0999]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8436, 0.8417, 0.8192,  ..., 0.7507, 0.7497, 0.7496],
        [0.9297, 0.9182, 0.9167,  ..., 0.8929, 0.8903, 0.8889],
        [0.9020, 0.8659, 0.8592,  ..., 0.7910, 0.7894, 0.7894],
        ...,
        [0.8426, 0.8178, 0.8129,  ..., 0.7306, 0.7303, 0.7302],
        [0.9077, 0.8755, 0.8200,  ..., 0.7723, 0.7720, 0.7684],
        [0.8467, 0.8310, 0.8238,  ..., 0.7522, 0.7516, 0.7499]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 1, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[171418.5781, 166788.9688, 120830.3359,  ...,  45455.5898,
          44813.2617,  44763.4609],
        [586432.9375, 497593.3438, 486625.9688,  ..., 346492.7500,
         333855.6250, 327317.0938],
        [394411.8438, 235630.8906, 214055.9062,  ...,  80876.9375,
          79000.9375,  78986.6250],
        ...,
        [168807.9844, 118442.6641, 110583.7266,  ...,  34120.2031,
          33977.0039,  33918.0820],
        [427883.8438, 270109.3750, 122226.4375,  ...,  61860.2930,
          61637.0508,  58512.6602],
        [179175.1094, 143049.5000, 129069.8906,  ...,  46445.8867,
          46022.2500,  44901.0469]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[171418.5781,      0.0000],
         [166788.9688,      0.0000],
         [120830.3359,      0.0000],
         ...,
         [ 45455.5898,      0.0000],
         [ 44813.2617,      0.0000],
         [ 44763.4609,      0.0000]],

        [[586432.9375,      0.0000],
         [497593.3438,      0.0000],
         [486625.9688,      0.0000],
         ...,
         [346492.7500,      0.0000],
         [333855.6250,      0.0000],
         [327317.0938,      0.0000]],

        [[394411.8438,      0.0000],
         [     0.0000, 235630.8906],
         [214055.9062,      0.0000],
         ...,
         [ 80876.9375,      0.0000],
         [ 79000.9375,      0.0000],
         [ 78986.6250,      0.0000]],

        ...,

        [[     0.0000, 168807.9844],
         [     0.0000, 118442.6641],
         [     0.0000, 110583.7266],
         ...,
         [ 34120.2031,      0.0000],
         [     0.0000,  33977.0039],
         [ 33918.0820,      0.0000]],

        [[427883.8438,      0.0000],
         [     0.0000, 270109.3750],
         [     0.0000, 122226.4375],
         ...,
         [ 61860.2930,      0.0000],
         [ 61637.0508,      0.0000],
         [     0.0000,  58512.6602]],

        [[     0.0000, 179175.1094],
         [     0.0000, 143049.5000],
         [129069.8906,      0.0000],
         ...,
         [ 46445.8867,      0.0000],
         [ 46022.2500,      0.0000],
         [ 44901.0469,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1410382.7500,    54065.7891],
        [ 8480002.0000,        0.0000],
        [ 2191226.7500,   496751.9375],
        [ 3249076.5000,        0.0000],
        [  708976.7500,   546149.9375],
        [ 1081950.1250,   200287.7344],
        [ 2165801.5000,  1043195.6875],
        [ 2934440.0000,   103443.9688],
        [ 3624810.2500,   141495.5469],
        [ 3630455.7500,        0.0000],
        [ 6098426.5000,        0.0000],
        [ 1538925.5000,        0.0000],
        [ 2918689.5000,        0.0000],
        [10474008.0000,        0.0000],
        [11517554.0000,        0.0000],
        [ 9200800.0000,        0.0000],
        [ 6481540.0000,        0.0000],
        [ 8559148.0000,        0.0000],
        [ 3820428.0000,        0.0000],
        [ 5264495.0000,   237802.3594],
        [ 6186497.5000,        0.0000],
        [ 4303107.0000,        0.0000],
        [11463374.0000,        0.0000],
        [11204982.0000,        0.0000],
        [ 3113358.0000,        0.0000],
        [10147289.0000,        0.0000],
        [ 8994166.0000,        0.0000],
        [12443707.0000,        0.0000],
        [10612774.0000,        0.0000],
        [10355442.0000,        0.0000],
        [13183966.0000,        0.0000],
        [10354463.0000,        0.0000],
        [ 2800762.5000,    96649.1562],
        [ 2229929.0000,  1087586.2500],
        [ 3154968.7500,  2028450.0000],
        [ 1189341.6250,  1617986.8750],
        [ 1682428.2500,   941262.6250],
        [ 1252162.3750,   704733.5625],
        [ 1137158.2500,   909632.5000],
        [ 7342496.5000,        0.0000],
        [ 2518118.5000,   231787.8750],
        [ 3705022.0000,        0.0000],
        [ 3346311.5000,        0.0000],
        [ 2636289.0000,    93415.3438],
        [ 1320695.2500,  1189866.7500],
        [  326937.2500,   381684.9062],
        [ 3850907.5000,   218527.5312],
        [  646193.5000,   410373.2500],
        [  310113.4688,   318963.6875],
        [ 1839166.5000,  1051588.0000],
        [ 1093572.5000,   354903.0000],
        [ 2221458.5000,   944086.7500],
        [ 2485244.7500,  1793309.5000],
        [ 3665673.0000,   162272.6406],
        [ 6175868.0000,   323086.5625],
        [ 3713649.0000,   184110.2500],
        [ 2876365.5000,  1144936.2500],
        [ 3362918.2500,  1010247.6875],
        [ 1826644.5000,   973794.4375],
        [  981771.2500,   897419.9375],
        [ 2920546.7500,   584638.9375],
        [  741419.1250,   546872.1875],
        [ 1388234.7500,   833723.8750],
        [  828355.3750,   668407.3125]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 471/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:28, 60.97s/it]  7%|▋         | 2/30 [01:01<11:50, 25.37s/it] 10%|█         | 3/30 [01:01<06:17, 13.99s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.64s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.68s/it] 20%|██        | 6/30 [01:03<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.47s/it]
Epoch loss is 2.605114531517029
Epoch 472/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:34, 61.19s/it]  7%|▋         | 2/30 [01:01<11:52, 25.46s/it] 10%|█         | 3/30 [01:02<06:18, 14.03s/it] 13%|█▎        | 4/30 [01:02<03:45,  8.67s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.70s/it] 20%|██        | 6/30 [01:03<01:33,  3.91s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.78s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.54s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:06<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:10<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:13<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 2.553219191233317
Epoch 473/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:01<29:30, 61.05s/it]  7%|▋         | 2/30 [01:01<11:51, 25.40s/it] 10%|█         | 3/30 [01:01<06:18, 14.00s/it] 13%|█▎        | 4/30 [01:02<03:44,  8.65s/it] 17%|█▋        | 5/30 [01:02<02:22,  5.69s/it] 20%|██        | 6/30 [01:03<01:33,  3.90s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.77s/it] 27%|██▋       | 8/30 [01:04<00:44,  2.03s/it] 30%|███       | 9/30 [01:04<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:05<00:23,  1.20s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:07<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 2.6060924847920734
Epoch 474/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:43, 57.37s/it]  7%|▋         | 2/30 [00:57<11:08, 23.89s/it] 10%|█         | 3/30 [00:58<05:55, 13.18s/it] 13%|█▎        | 4/30 [00:58<03:31,  8.15s/it] 17%|█▋        | 5/30 [00:59<02:14,  5.37s/it] 20%|██        | 6/30 [00:59<01:28,  3.70s/it] 23%|██▎       | 7/30 [01:00<01:00,  2.63s/it] 27%|██▋       | 8/30 [01:00<00:42,  1.94s/it] 30%|███       | 9/30 [01:00<00:30,  1.47s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.15s/it] 37%|███▋      | 11/30 [01:01<00:17,  1.07it/s] 40%|████      | 12/30 [01:02<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:02<00:11,  1.47it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:03<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:04<00:06,  2.01it/s] 60%|██████    | 18/30 [01:04<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:05<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:06<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:07<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:07<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:08<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:08<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:09<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.35s/it]
Epoch loss is 2.610218334197998
Epoch 475/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:10, 60.36s/it]  7%|▋         | 2/30 [01:00<11:43, 25.11s/it] 10%|█         | 3/30 [01:01<06:13, 13.85s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.56s/it] 17%|█▋        | 5/30 [01:02<02:20,  5.63s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.578428109486898
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0971,  0.0776,  ..., -0.0509,  0.0927,  0.0611],
        [ 0.0333, -0.0218,  0.0822,  ..., -0.0108,  0.0949,  0.1007],
        [ 0.0013, -0.0103,  0.0068,  ..., -0.0525,  0.0618,  0.1193],
        ...,
        [-0.0112, -0.0006,  0.0715,  ..., -0.0492,  0.0265,  0.0182],
        [-0.0588, -0.1081,  0.0273,  ..., -0.0354,  0.0911,  0.0162],
        [-0.0238, -0.0184,  0.0551,  ..., -0.0041,  0.0930,  0.0999]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8436, 0.8417, 0.8191,  ..., 0.7507, 0.7497, 0.7496],
        [0.9297, 0.9182, 0.9166,  ..., 0.8929, 0.8903, 0.8889],
        [0.9019, 0.8659, 0.8591,  ..., 0.7910, 0.7893, 0.7893],
        ...,
        [0.8426, 0.8177, 0.8129,  ..., 0.7306, 0.7303, 0.7302],
        [0.9076, 0.8754, 0.8199,  ..., 0.7723, 0.7720, 0.7683],
        [0.8467, 0.8309, 0.8237,  ..., 0.7522, 0.7515, 0.7498]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 1, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[171299.1094, 166698.9688, 120746.6016,  ...,  45438.9492,
          44793.8242,  44748.9062],
        [586226.6250, 497335.7500, 486414.8438,  ..., 346333.8438,
         333654.4375, 327222.5312],
        [394202.0312, 235484.4219, 213895.9219,  ...,  80818.4922,
          78938.6562,  78929.0156],
        ...,
        [168806.8594, 118364.4062, 110525.1094,  ...,  34120.6914,
          33940.6680,  33915.6562],
        [427768.7812, 270043.7188, 122116.7969,  ...,  61830.0977,
          61596.5625,  58476.9531],
        [179085.9531, 142974.0625, 128989.5391,  ...,  46397.7188,
          45979.3906,  44862.3086]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[171299.1094,      0.0000],
         [166698.9688,      0.0000],
         [120746.6016,      0.0000],
         ...,
         [ 45438.9492,      0.0000],
         [ 44793.8242,      0.0000],
         [ 44748.9062,      0.0000]],

        [[586226.6250,      0.0000],
         [497335.7500,      0.0000],
         [486414.8438,      0.0000],
         ...,
         [346333.8438,      0.0000],
         [333654.4375,      0.0000],
         [327222.5312,      0.0000]],

        [[394202.0312,      0.0000],
         [     0.0000, 235484.4219],
         [213895.9219,      0.0000],
         ...,
         [ 80818.4922,      0.0000],
         [ 78938.6562,      0.0000],
         [ 78929.0156,      0.0000]],

        ...,

        [[     0.0000, 168806.8594],
         [     0.0000, 118364.4062],
         [     0.0000, 110525.1094],
         ...,
         [ 34120.6914,      0.0000],
         [     0.0000,  33940.6680],
         [ 33915.6562,      0.0000]],

        [[427768.7812,      0.0000],
         [     0.0000, 270043.7188],
         [     0.0000, 122116.7969],
         ...,
         [ 61830.0977,      0.0000],
         [ 61596.5625,      0.0000],
         [     0.0000,  58476.9531]],

        [[     0.0000, 179085.9531],
         [     0.0000, 142974.0625],
         [128989.5391,      0.0000],
         ...,
         [ 46397.7188,      0.0000],
         [ 45979.3906,      0.0000],
         [ 44862.3086,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1409582.5000,    54021.9766],
        [ 8476100.0000,        0.0000],
        [ 2189676.7500,   496380.4688],
        [ 3247696.2500,        0.0000],
        [  708478.3750,   545870.8750],
        [ 1080936.7500,   200121.0625],
        [ 2163732.0000,  1042437.7500],
        [ 2932246.5000,   103362.2188],
        [ 3622408.2500,   141385.8750],
        [ 3628731.5000,        0.0000],
        [ 6095405.5000,        0.0000],
        [ 1537452.3750,        0.0000],
        [ 2917006.7500,        0.0000],
        [10470722.0000,        0.0000],
        [11514854.0000,        0.0000],
        [ 9199216.0000,        0.0000],
        [ 6477708.0000,        0.0000],
        [ 8556286.0000,        0.0000],
        [ 3818492.5000,        0.0000],
        [ 5262350.5000,   237687.4219],
        [ 6183199.0000,        0.0000],
        [ 4300532.5000,        0.0000],
        [11461210.0000,        0.0000],
        [11202591.0000,        0.0000],
        [ 3111220.2500,        0.0000],
        [10145765.0000,        0.0000],
        [ 8992077.0000,        0.0000],
        [12441822.0000,        0.0000],
        [10609341.0000,        0.0000],
        [10353392.0000,        0.0000],
        [13180710.0000,        0.0000],
        [10352316.0000,        0.0000],
        [ 2799255.0000,    96596.3516],
        [ 2228005.5000,  1087125.5000],
        [ 3153365.7500,  2027749.7500],
        [ 1188459.1250,  1617325.0000],
        [ 1681511.0000,   941125.8125],
        [ 1251309.7500,   704420.3750],
        [ 1136507.7500,   909311.0625],
        [ 7339534.0000,        0.0000],
        [ 2516950.5000,   231647.8750],
        [ 3703569.0000,        0.0000],
        [ 3344931.5000,        0.0000],
        [ 2635282.0000,    93403.5859],
        [ 1319945.7500,  1189377.0000],
        [  326854.9062,   381486.5938],
        [ 3848954.7500,   218447.0938],
        [  645889.6250,   410329.9375],
        [  310004.0938,   318860.2812],
        [ 1837739.8750,  1051009.6250],
        [ 1092867.0000,   354878.8750],
        [ 2219997.7500,   943962.7500],
        [ 2484094.7500,  1792627.7500],
        [ 3664080.2500,   162201.9219],
        [ 6173314.5000,   322935.6250],
        [ 3711834.5000,   183998.7969],
        [ 2874469.5000,  1144320.0000],
        [ 3361314.0000,  1009977.3750],
        [ 1825676.2500,   973356.2500],
        [  981350.9375,   897125.1250],
        [ 2918742.5000,   584367.2500],
        [  741073.5625,   546619.6250],
        [ 1387603.5000,   833334.1250],
        [  827740.3125,   668170.3750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 476/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:39, 57.21s/it]  7%|▋         | 2/30 [00:57<11:06, 23.82s/it] 10%|█         | 3/30 [01:00<06:22, 14.16s/it] 13%|█▎        | 4/30 [01:00<03:47,  8.75s/it] 17%|█▋        | 5/30 [01:01<02:23,  5.75s/it] 20%|██        | 6/30 [01:01<01:34,  3.95s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:02<00:45,  2.05s/it] 30%|███       | 9/30 [01:02<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.20s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.03it/s] 40%|████      | 12/30 [01:04<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.61it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.5751604636510215
Epoch 477/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:51, 57.64s/it]  7%|▋         | 2/30 [00:58<11:11, 24.00s/it] 10%|█         | 3/30 [00:58<05:57, 13.24s/it] 13%|█▎        | 4/30 [00:58<03:32,  8.19s/it] 17%|█▋        | 5/30 [00:59<02:14,  5.40s/it] 20%|██        | 6/30 [01:00<01:35,  3.97s/it] 23%|██▎       | 7/30 [01:01<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:01<00:45,  2.06s/it] 30%|███       | 9/30 [01:01<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:02<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.02it/s] 40%|████      | 12/30 [01:03<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.61it/s] 50%|█████     | 15/30 [01:04<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:05<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.38s/it]
Epoch loss is 2.5444934129714967
Epoch 478/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:01, 55.90s/it]  7%|▋         | 2/30 [00:57<11:12, 24.03s/it] 10%|█         | 3/30 [00:58<05:58, 13.26s/it] 13%|█▎        | 4/30 [01:00<03:55,  9.06s/it] 17%|█▋        | 5/30 [01:01<02:28,  5.95s/it] 20%|██        | 6/30 [01:01<01:37,  4.08s/it] 23%|██▎       | 7/30 [01:02<01:06,  2.89s/it] 27%|██▋       | 8/30 [01:02<00:46,  2.11s/it] 30%|███       | 9/30 [01:02<00:33,  1.59s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.01it/s] 40%|████      | 12/30 [01:04<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.59it/s] 50%|█████     | 15/30 [01:05<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.596089498202006
Epoch 479/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:29, 58.93s/it]  7%|▋         | 2/30 [01:00<11:42, 25.09s/it] 10%|█         | 3/30 [01:00<06:13, 13.83s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.55s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.62s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.587174646059672
Epoch 480/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:16, 60.57s/it]  7%|▋         | 2/30 [01:01<11:45, 25.20s/it] 10%|█         | 3/30 [01:01<06:15, 13.89s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.58s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.65s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.5277642965316773
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0971,  0.0776,  ..., -0.0509,  0.0927,  0.0611],
        [ 0.0333, -0.0217,  0.0822,  ..., -0.0108,  0.0949,  0.1007],
        [ 0.0013, -0.0103,  0.0068,  ..., -0.0525,  0.0618,  0.1193],
        ...,
        [-0.0112, -0.0006,  0.0715,  ..., -0.0492,  0.0265,  0.0182],
        [-0.0588, -0.1081,  0.0273,  ..., -0.0354,  0.0911,  0.0162],
        [-0.0238, -0.0184,  0.0551,  ..., -0.0041,  0.0930,  0.0999]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8436, 0.8417, 0.8191,  ..., 0.7507, 0.7497, 0.7496],
        [0.9297, 0.9182, 0.9166,  ..., 0.8928, 0.8902, 0.8889],
        [0.9019, 0.8658, 0.8591,  ..., 0.7910, 0.7893, 0.7893],
        ...,
        [0.8426, 0.8177, 0.8129,  ..., 0.7306, 0.7302, 0.7302],
        [0.9076, 0.8754, 0.8199,  ..., 0.7722, 0.7720, 0.7683],
        [0.8467, 0.8309, 0.8237,  ..., 0.7521, 0.7515, 0.7497]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 1, 0],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[171228.0781, 166640.6250, 120686.6250,  ...,  45426.5547,
          44779.7266,  44738.8789],
        [586074.5625, 497173.0625, 486265.5312,  ..., 346215.9375,
         333513.5000, 327138.8750],
        [394064.4375, 235368.5625, 213810.0625,  ...,  80779.7344,
          78895.2266,  78893.9531],
        ...,
        [168799.7812, 118312.8359, 110489.0703,  ...,  34118.1523,
          33915.2031,  33911.7734],
        [427688.0312, 270004.0312, 122045.0859,  ...,  61809.5820,
          61570.6602,  58448.8516],
        [179026.7031, 142927.9844, 128929.0312,  ...,  46359.8594,
          45949.2344,  44832.9258]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[171228.0781,      0.0000],
         [166640.6250,      0.0000],
         [120686.6250,      0.0000],
         ...,
         [ 45426.5547,      0.0000],
         [ 44779.7266,      0.0000],
         [ 44738.8789,      0.0000]],

        [[586074.5625,      0.0000],
         [497173.0625,      0.0000],
         [486265.5312,      0.0000],
         ...,
         [346215.9375,      0.0000],
         [333513.5000,      0.0000],
         [327138.8750,      0.0000]],

        [[394064.4375,      0.0000],
         [     0.0000, 235368.5625],
         [213810.0625,      0.0000],
         ...,
         [ 80779.7344,      0.0000],
         [ 78895.2266,      0.0000],
         [ 78893.9531,      0.0000]],

        ...,

        [[     0.0000, 168799.7812],
         [     0.0000, 118312.8359],
         [     0.0000, 110489.0703],
         ...,
         [ 34118.1523,      0.0000],
         [     0.0000,  33915.2031],
         [ 33911.7734,      0.0000]],

        [[427688.0312,      0.0000],
         [     0.0000, 270004.0312],
         [     0.0000, 122045.0859],
         ...,
         [ 61809.5820,      0.0000],
         [ 61570.6602,      0.0000],
         [     0.0000,  58448.8516]],

        [[     0.0000, 179026.7031],
         [     0.0000, 142927.9844],
         [128929.0312,      0.0000],
         ...,
         [ 46359.8594,      0.0000],
         [ 45949.2344,      0.0000],
         [ 44832.9258,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1409044.7500,    53989.2734],
        [ 8473329.0000,        0.0000],
        [ 2188678.2500,   496111.0000],
        [ 3246611.7500,        0.0000],
        [  708158.0000,   545658.8125],
        [ 1080210.2500,   199993.9531],
        [ 2162511.0000,  1041987.1250],
        [ 2930870.2500,   103313.7344],
        [ 3620898.0000,   141311.4688],
        [ 3627592.5000,        0.0000],
        [ 6093418.0000,        0.0000],
        [ 1536536.2500,        0.0000],
        [ 2915862.5000,        0.0000],
        [10468284.0000,        0.0000],
        [11512741.0000,        0.0000],
        [ 9197866.0000,        0.0000],
        [ 6475244.0000,        0.0000],
        [ 8554202.0000,        0.0000],
        [ 3817037.5000,        0.0000],
        [ 5260821.5000,   237608.0938],
        [ 6180994.0000,        0.0000],
        [ 4298752.5000,        0.0000],
        [11459742.0000,        0.0000],
        [11200710.0000,        0.0000],
        [ 3109808.7500,        0.0000],
        [10144618.0000,        0.0000],
        [ 8990556.0000,        0.0000],
        [12440511.0000,        0.0000],
        [10606934.0000,        0.0000],
        [10351741.0000,        0.0000],
        [13178370.0000,        0.0000],
        [10350816.0000,        0.0000],
        [ 2798308.5000,    96559.0547],
        [ 2226806.7500,  1086851.2500],
        [ 3152338.2500,  2027247.8750],
        [ 1187874.5000,  1616917.0000],
        [ 1680887.1250,   941050.6250],
        [ 1250741.3750,   704201.3750],
        [ 1136060.6250,   909064.8750],
        [ 7337531.0000,        0.0000],
        [ 2516196.5000,   231551.4531],
        [ 3702494.0000,        0.0000],
        [ 3343848.7500,        0.0000],
        [ 2634644.0000,    93395.9219],
        [ 1319375.7500,  1189075.8750],
        [  326785.4688,   381355.5312],
        [ 3847488.2500,   218381.6719],
        [  645686.2500,   410289.4375],
        [  309897.7812,   318775.2812],
        [ 1836834.7500,  1050644.8750],
        [ 1092388.3750,   354839.6875],
        [ 2218977.0000,   943850.8750],
        [ 2483300.0000,  1792199.5000],
        [ 3663029.2500,   162158.6250],
        [ 6171399.5000,   322830.0000],
        [ 3710464.2500,   183911.7656],
        [ 2873105.2500,  1143877.2500],
        [ 3360383.0000,  1009792.1250],
        [ 1825019.2500,   973101.7500],
        [  981045.0000,   896963.6875],
        [ 2917663.2500,   584174.1250],
        [  740833.5000,   546446.2500],
        [ 1387143.2500,   833061.3125],
        [  827251.6250,   668011.0000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 481/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:03<30:39, 63.41s/it]  7%|▋         | 2/30 [01:03<12:18, 26.37s/it] 10%|█         | 3/30 [01:04<06:32, 14.53s/it] 13%|█▎        | 4/30 [01:04<03:53,  8.97s/it] 17%|█▋        | 5/30 [01:05<02:27,  5.89s/it] 20%|██        | 6/30 [01:05<01:36,  4.04s/it] 23%|██▎       | 7/30 [01:06<01:05,  2.86s/it] 27%|██▋       | 8/30 [01:06<00:46,  2.09s/it] 30%|███       | 9/30 [01:06<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:07<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:07<00:18,  1.02it/s] 40%|████      | 12/30 [01:08<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:08<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:09<00:09,  1.60it/s] 50%|█████     | 15/30 [01:09<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:10<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:10<00:06,  1.99it/s] 60%|██████    | 18/30 [01:10<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:11<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:11<00:04,  2.17it/s] 70%|███████   | 21/30 [01:12<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:12<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:13<00:03,  2.24it/s] 80%|████████  | 24/30 [01:13<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:13<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:14<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:14<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:15<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:15<00:00,  2.27it/s]100%|██████████| 30/30 [01:16<00:00,  2.27it/s]100%|██████████| 30/30 [01:16<00:00,  2.55s/it]
Epoch loss is 2.5871321757634482
Epoch 482/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<26:59, 55.85s/it]  7%|▋         | 2/30 [01:01<12:17, 26.34s/it] 10%|█         | 3/30 [01:01<06:31, 14.51s/it] 13%|█▎        | 4/30 [01:02<03:52,  8.96s/it] 17%|█▋        | 5/30 [01:02<02:27,  5.89s/it] 20%|██        | 6/30 [01:03<01:36,  4.03s/it] 23%|██▎       | 7/30 [01:03<01:05,  2.86s/it] 27%|██▋       | 8/30 [01:04<00:45,  2.09s/it] 30%|███       | 9/30 [01:04<00:33,  1.57s/it] 33%|███▎      | 10/30 [01:05<00:24,  1.22s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.02it/s] 40%|████      | 12/30 [01:05<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.42it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.60it/s] 50%|█████     | 15/30 [01:07<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:08<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:09<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:11<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:12<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:14<00:00,  2.47s/it]
Epoch loss is 2.581080261866252
Epoch 483/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:02<30:12, 62.52s/it]  7%|▋         | 2/30 [01:02<12:08, 26.00s/it] 10%|█         | 3/30 [01:03<06:32, 14.55s/it] 13%|█▎        | 4/30 [01:04<03:53,  8.98s/it] 17%|█▋        | 5/30 [01:04<02:27,  5.90s/it] 20%|██        | 6/30 [01:05<01:37,  4.05s/it] 23%|██▎       | 7/30 [01:05<01:05,  2.87s/it] 27%|██▋       | 8/30 [01:06<00:46,  2.10s/it] 30%|███       | 9/30 [01:06<00:33,  1.58s/it] 33%|███▎      | 10/30 [01:06<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:07<00:18,  1.01it/s] 40%|████      | 12/30 [01:07<00:14,  1.22it/s] 43%|████▎     | 13/30 [01:08<00:12,  1.42it/s] 47%|████▋     | 14/30 [01:08<00:10,  1.60it/s] 50%|█████     | 15/30 [01:09<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:09<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:10<00:06,  1.98it/s] 60%|██████    | 18/30 [01:10<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:10<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:11<00:04,  2.16it/s] 70%|███████   | 21/30 [01:11<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:12<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:12<00:03,  2.22it/s] 80%|████████  | 24/30 [01:13<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:13<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:14<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:14<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:14<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:15<00:00,  2.24it/s]100%|██████████| 30/30 [01:15<00:00,  2.25it/s]100%|██████████| 30/30 [01:16<00:00,  2.53s/it]
Epoch loss is 2.564483817418416
Epoch 484/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:06, 58.15s/it]  7%|▋         | 2/30 [00:58<11:17, 24.20s/it] 10%|█         | 3/30 [00:59<06:00, 13.35s/it] 13%|█▎        | 4/30 [00:59<03:34,  8.26s/it] 17%|█▋        | 5/30 [00:59<02:15,  5.44s/it] 20%|██        | 6/30 [01:00<01:29,  3.74s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.66s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.95s/it] 30%|███       | 9/30 [01:01<00:31,  1.48s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.16s/it] 37%|███▋      | 11/30 [01:02<00:17,  1.06it/s] 40%|████      | 12/30 [01:03<00:14,  1.27it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.64it/s] 50%|█████     | 15/30 [01:04<00:08,  1.79it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.91it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 2.569731879234314
Epoch 485/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:40, 57.27s/it]  7%|▋         | 2/30 [00:57<11:07, 23.84s/it] 10%|█         | 3/30 [00:58<05:55, 13.16s/it] 13%|█▎        | 4/30 [01:00<03:56,  9.08s/it] 17%|█▋        | 5/30 [01:01<02:29,  5.96s/it] 20%|██        | 6/30 [01:01<01:38,  4.09s/it] 23%|██▎       | 7/30 [01:02<01:06,  2.90s/it] 27%|██▋       | 8/30 [01:02<00:46,  2.11s/it] 30%|███       | 9/30 [01:03<00:33,  1.59s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.24s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.01it/s] 40%|████      | 12/30 [01:04<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.59it/s] 50%|█████     | 15/30 [01:05<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:07<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.6010911385218303
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0971,  0.0776,  ..., -0.0509,  0.0927,  0.0611],
        [ 0.0333, -0.0217,  0.0822,  ..., -0.0108,  0.0949,  0.1007],
        [ 0.0013, -0.0103,  0.0068,  ..., -0.0525,  0.0618,  0.1193],
        ...,
        [-0.0112, -0.0006,  0.0715,  ..., -0.0492,  0.0265,  0.0182],
        [-0.0588, -0.1081,  0.0273,  ..., -0.0354,  0.0911,  0.0162],
        [-0.0238, -0.0184,  0.0551,  ..., -0.0041,  0.0930,  0.0999]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8435, 0.8416, 0.8190,  ..., 0.7507, 0.7496, 0.7496],
        [0.9297, 0.9182, 0.9166,  ..., 0.8928, 0.8902, 0.8889],
        [0.9019, 0.8658, 0.8591,  ..., 0.7909, 0.7893, 0.7893],
        ...,
        [0.8426, 0.8177, 0.8129,  ..., 0.7306, 0.7302, 0.7302],
        [0.9076, 0.8754, 0.8198,  ..., 0.7722, 0.7719, 0.7683],
        [0.8467, 0.8309, 0.8237,  ..., 0.7521, 0.7514, 0.7497]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 0, 1],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[171179.0781, 166600.9062, 120655.0859,  ...,  45418.8867,
          44767.3906,  44729.6172],
        [585992.4375, 497080.1562, 486195.5000,  ..., 346138.3750,
         333441.0000, 327104.2500],
        [393986.2812, 235299.8906, 213758.4688,  ...,  80757.4688,
          78877.3984,  78867.5469],
        ...,
        [168794.9531, 118287.7891, 110470.9453,  ...,  34117.0469,
          33908.7344,  33902.1055],
        [427630.5312, 269983.7188, 121994.6953,  ...,  61800.0312,
          61553.6367,  58432.8594],
        [178985.8906, 142907.8125, 128894.3594,  ...,  46339.2617,
          45932.4961,  44818.2227]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[171179.0781,      0.0000],
         [166600.9062,      0.0000],
         [120655.0859,      0.0000],
         ...,
         [ 45418.8867,      0.0000],
         [ 44767.3906,      0.0000],
         [ 44729.6172,      0.0000]],

        [[585992.4375,      0.0000],
         [497080.1562,      0.0000],
         [486195.5000,      0.0000],
         ...,
         [346138.3750,      0.0000],
         [333441.0000,      0.0000],
         [327104.2500,      0.0000]],

        [[393986.2812,      0.0000],
         [     0.0000, 235299.8906],
         [213758.4688,      0.0000],
         ...,
         [ 80757.4688,      0.0000],
         [ 78877.3984,      0.0000],
         [ 78867.5469,      0.0000]],

        ...,

        [[     0.0000, 168794.9531],
         [     0.0000, 118287.7891],
         [     0.0000, 110470.9453],
         ...,
         [ 34117.0469,      0.0000],
         [ 33908.7344,      0.0000],
         [     0.0000,  33902.1055]],

        [[427630.5312,      0.0000],
         [     0.0000, 269983.7188],
         [     0.0000, 121994.6953],
         ...,
         [ 61800.0312,      0.0000],
         [ 61553.6367,      0.0000],
         [     0.0000,  58432.8594]],

        [[     0.0000, 178985.8906],
         [     0.0000, 142907.8125],
         [128894.3594,      0.0000],
         ...,
         [ 46339.2617,      0.0000],
         [ 45932.4961,      0.0000],
         [ 44818.2227,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1408683.7500,    53967.5508],
        [ 8471846.0000,        0.0000],
        [ 2188112.5000,   495958.7500],
        [ 3246177.7500,        0.0000],
        [  707981.8750,   545574.0000],
        [ 1079844.6250,   199931.7344],
        [ 2161602.0000,  1041688.9375],
        [ 2930122.2500,   103286.4453],
        [ 3619993.5000,   141248.4219],
        [ 3626942.0000,        0.0000],
        [ 6092397.5000,        0.0000],
        [ 1536044.5000,        0.0000],
        [ 2915271.5000,        0.0000],
        [10466966.0000,        0.0000],
        [11511518.0000,        0.0000],
        [ 9197171.0000,        0.0000],
        [ 6473926.5000,        0.0000],
        [ 8553051.0000,        0.0000],
        [ 3816370.5000,        0.0000],
        [ 5260072.5000,   237572.2969],
        [ 6179886.5000,        0.0000],
        [ 4297845.0000,        0.0000],
        [11458956.0000,        0.0000],
        [11200014.0000,        0.0000],
        [ 3109010.7500,        0.0000],
        [10143858.0000,        0.0000],
        [ 8989578.0000,        0.0000],
        [12439634.0000,        0.0000],
        [10605544.0000,        0.0000],
        [10350947.0000,        0.0000],
        [13176946.0000,        0.0000],
        [10349984.0000,        0.0000],
        [ 2797734.0000,    96540.2734],
        [ 2226216.2500,  1086689.7500],
        [ 3151716.0000,  2027011.5000],
        [ 1187524.2500,  1616673.8750],
        [ 1680559.0000,   941002.4375],
        [ 1250444.6250,   704114.1875],
        [ 1135820.7500,   908951.1250],
        [ 7336529.0000,        0.0000],
        [ 2515804.0000,   231501.9375],
        [ 3702044.2500,        0.0000],
        [ 3343269.2500,        0.0000],
        [ 2634227.5000,    93388.4453],
        [ 1319092.3750,  1188884.6250],
        [  326743.5625,   381281.1250],
        [ 3846784.2500,   218368.5625],
        [  645588.3750,   410283.8438],
        [  309861.4375,   318733.2500],
        [ 1836351.0000,  1050468.6250],
        [ 1092140.0000,   354825.3750],
        [ 2218382.7500,   943770.2500],
        [ 2482776.0000,  1791852.5000],
        [ 3662498.0000,   162121.6562],
        [ 6170588.0000,   322769.0625],
        [ 3709699.0000,   183867.9375],
        [ 2872389.7500,  1143636.0000],
        [ 3359942.7500,  1009687.4375],
        [ 1824689.5000,   972932.3750],
        [  980860.7500,   896848.0625],
        [ 2917020.5000,   584077.5625],
        [  740681.3750,   546358.1250],
        [ 1386880.3750,   832906.6875],
        [  826970.6250,   667904.8750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 486/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:01, 60.05s/it]  7%|▋         | 2/30 [01:00<11:45, 25.21s/it] 10%|█         | 3/30 [01:01<06:15, 13.90s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.59s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.65s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:03<00:32,  1.53s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.24it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.577339212099711
Epoch 487/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:55<27:03, 55.97s/it]  7%|▋         | 2/30 [00:59<11:39, 24.99s/it] 10%|█         | 3/30 [00:59<06:12, 13.78s/it] 13%|█▎        | 4/30 [01:00<03:41,  8.51s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.60s/it] 20%|██        | 6/30 [01:01<01:32,  3.85s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.73s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.00s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.590560229619344
Epoch 488/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:36, 59.18s/it]  7%|▋         | 2/30 [01:00<11:41, 25.06s/it] 10%|█         | 3/30 [01:00<06:13, 13.82s/it] 13%|█▎        | 4/30 [01:01<03:41,  8.54s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.62s/it] 20%|██        | 6/30 [01:02<01:32,  3.86s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.74s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.43s/it]
Epoch loss is 2.566782792409261
Epoch 489/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:54, 59.80s/it]  7%|▋         | 2/30 [01:00<11:36, 24.88s/it] 10%|█         | 3/30 [01:00<06:14, 13.86s/it] 13%|█▎        | 4/30 [01:01<03:42,  8.56s/it] 17%|█▋        | 5/30 [01:01<02:20,  5.64s/it] 20%|██        | 6/30 [01:02<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:02<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.01s/it] 30%|███       | 9/30 [01:03<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.04it/s] 40%|████      | 12/30 [01:04<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.534163149197896
Epoch 490/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:16, 58.51s/it]  7%|▋         | 2/30 [01:01<11:58, 25.68s/it] 10%|█         | 3/30 [01:01<06:22, 14.15s/it] 13%|█▎        | 4/30 [01:02<03:47,  8.74s/it] 17%|█▋        | 5/30 [01:02<02:23,  5.75s/it] 20%|██        | 6/30 [01:02<01:34,  3.94s/it] 23%|██▎       | 7/30 [01:03<01:04,  2.80s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.05s/it] 30%|███       | 9/30 [01:04<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:06<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.76it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:08<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:09<00:04,  2.16it/s] 70%|███████   | 21/30 [01:09<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:10<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.23it/s] 80%|████████  | 24/30 [01:10<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.26it/s]100%|██████████| 30/30 [01:13<00:00,  2.46s/it]
Epoch loss is 2.574469232559204
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0971,  0.0776,  ..., -0.0509,  0.0927,  0.0611],
        [ 0.0333, -0.0217,  0.0822,  ..., -0.0108,  0.0949,  0.1007],
        [ 0.0013, -0.0103,  0.0068,  ..., -0.0525,  0.0618,  0.1193],
        ...,
        [-0.0112, -0.0006,  0.0715,  ..., -0.0492,  0.0265,  0.0182],
        [-0.0588, -0.1082,  0.0273,  ..., -0.0355,  0.0911,  0.0162],
        [-0.0238, -0.0184,  0.0551,  ..., -0.0040,  0.0930,  0.0999]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8435, 0.8416, 0.8190,  ..., 0.7507, 0.7496, 0.7496],
        [0.9297, 0.9181, 0.9166,  ..., 0.8928, 0.8902, 0.8889],
        [0.9019, 0.8658, 0.8591,  ..., 0.7909, 0.7893, 0.7893],
        ...,
        [0.8426, 0.8177, 0.8129,  ..., 0.7306, 0.7302, 0.7302],
        [0.9076, 0.8754, 0.8198,  ..., 0.7722, 0.7719, 0.7683],
        [0.8466, 0.8309, 0.8237,  ..., 0.7520, 0.7514, 0.7497]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 0, 1],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[171159.5000, 166575.7969, 120636.7891,  ...,  45415.5117,
          44762.7773,  44726.6328],
        [585933.1875, 497008.1250, 486136.5938,  ..., 346101.0625,
         333392.3438, 327074.0312],
        [393929.9062, 235266.4531, 213723.2188,  ...,  80746.0000,
          78862.2812,  78858.2969],
        ...,
        [168797.3594, 118274.7031, 110462.2031,  ...,  34117.1445,
          33908.4766,  33895.8359],
        [427606.4688, 269971.5938, 121971.0781,  ...,  61794.6094,
          61544.1875,  58426.5625],
        [178970.0156, 142891.7344, 128878.7500,  ...,  46327.3750,
          45922.9492,  44808.0508]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[171159.5000,      0.0000],
         [166575.7969,      0.0000],
         [120636.7891,      0.0000],
         ...,
         [ 45415.5117,      0.0000],
         [ 44762.7773,      0.0000],
         [ 44726.6328,      0.0000]],

        [[585933.1875,      0.0000],
         [497008.1250,      0.0000],
         [486136.5938,      0.0000],
         ...,
         [346101.0625,      0.0000],
         [333392.3438,      0.0000],
         [327074.0312,      0.0000]],

        [[393929.9062,      0.0000],
         [     0.0000, 235266.4531],
         [213723.2188,      0.0000],
         ...,
         [ 80746.0000,      0.0000],
         [ 78862.2812,      0.0000],
         [ 78858.2969,      0.0000]],

        ...,

        [[     0.0000, 168797.3594],
         [     0.0000, 118274.7031],
         [     0.0000, 110462.2031],
         ...,
         [ 34117.1445,      0.0000],
         [ 33908.4766,      0.0000],
         [     0.0000,  33895.8359]],

        [[427606.4688,      0.0000],
         [     0.0000, 269971.5938],
         [     0.0000, 121971.0781],
         ...,
         [ 61794.6094,      0.0000],
         [ 61544.1875,      0.0000],
         [     0.0000,  58426.5625]],

        [[     0.0000, 178970.0156],
         [     0.0000, 142891.7344],
         [128878.7500,      0.0000],
         ...,
         [ 46327.3750,      0.0000],
         [ 45922.9492,      0.0000],
         [ 44808.0508,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1408525.6250,    53955.1484],
        [ 8470842.0000,        0.0000],
        [ 2187778.2500,   495873.6875],
        [ 3245918.0000,        0.0000],
        [  707884.0625,   545513.0000],
        [ 1079631.2500,   199891.9688],
        [ 2161210.2500,  1041537.0000],
        [ 2929707.5000,   103266.9375],
        [ 3619479.5000,   141231.3125],
        [ 3626603.7500,        0.0000],
        [ 6091751.0000,        0.0000],
        [ 1535767.7500,        0.0000],
        [ 2914964.5000,        0.0000],
        [10466209.0000,        0.0000],
        [11510923.0000,        0.0000],
        [ 9196776.0000,        0.0000],
        [ 6473108.0000,        0.0000],
        [ 8552553.0000,        0.0000],
        [ 3816018.7500,        0.0000],
        [ 5259683.0000,   237549.8594],
        [ 6179253.5000,        0.0000],
        [ 4297377.0000,        0.0000],
        [11458421.0000,        0.0000],
        [11199562.0000,        0.0000],
        [ 3108566.0000,        0.0000],
        [10143445.0000,        0.0000],
        [ 8989128.0000,        0.0000],
        [12439177.0000,        0.0000],
        [10604740.0000,        0.0000],
        [10350492.0000,        0.0000],
        [13176268.0000,        0.0000],
        [10349486.0000,        0.0000],
        [ 2797420.2500,    96526.7422],
        [ 2225781.7500,  1086578.2500],
        [ 3151329.0000,  2026824.0000],
        [ 1187342.7500,  1616533.1250],
        [ 1680360.7500,   940995.8750],
        [ 1250232.6250,   704033.0625],
        [ 1135655.2500,   908866.2500],
        [ 7335893.5000,        0.0000],
        [ 2515542.2500,   231469.8750],
        [ 3701741.0000,        0.0000],
        [ 3342955.5000,        0.0000],
        [ 2633935.7500,    93383.4531],
        [ 1318922.7500,  1188766.2500],
        [  326716.5625,   381233.2500],
        [ 3846406.7500,   218351.2812],
        [  645530.6875,   410281.9688],
        [  309844.0000,   318716.0625],
        [ 1836055.7500,  1050349.3750],
        [ 1091997.3750,   354828.5625],
        [ 2218074.0000,   943739.5000],
        [ 2482528.5000,  1791695.3750],
        [ 3662142.5000,   162107.4375],
        [ 6170046.0000,   322742.2812],
        [ 3709209.5000,   183837.4375],
        [ 2871919.0000,  1143479.0000],
        [ 3359579.0000,  1009627.5000],
        [ 1824505.8750,   972862.3125],
        [  980778.3125,   896794.3750],
        [ 2916651.0000,   584026.5625],
        [  740622.6875,   546317.6875],
        [ 1386748.3750,   832834.1250],
        [  826828.5000,   667856.3750]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 491/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:20, 56.57s/it]  7%|▋         | 2/30 [00:57<10:59, 23.55s/it] 10%|█         | 3/30 [00:58<06:08, 13.65s/it] 13%|█▎        | 4/30 [00:59<03:39,  8.44s/it] 17%|█▋        | 5/30 [00:59<02:18,  5.55s/it] 20%|██        | 6/30 [01:00<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:00<01:02,  2.71s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.99s/it] 30%|███       | 9/30 [01:01<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:01<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.05it/s] 40%|████      | 12/30 [01:02<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:05<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.24it/s] 80%|████████  | 24/30 [01:08<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.24it/s] 93%|█████████▎| 28/30 [01:09<00:00,  2.25it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 2.585481603940328
Epoch 492/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:39, 57.24s/it]  7%|▋         | 2/30 [01:00<11:46, 25.25s/it] 10%|█         | 3/30 [01:01<06:24, 14.23s/it] 13%|█▎        | 4/30 [01:01<03:48,  8.79s/it] 17%|█▋        | 5/30 [01:02<02:24,  5.78s/it] 20%|██        | 6/30 [01:02<01:35,  3.96s/it] 23%|██▎       | 7/30 [01:02<01:04,  2.81s/it] 27%|██▋       | 8/30 [01:03<00:45,  2.06s/it] 30%|███       | 9/30 [01:03<00:32,  1.55s/it] 33%|███▎      | 10/30 [01:04<00:24,  1.21s/it] 37%|███▋      | 11/30 [01:04<00:18,  1.03it/s] 40%|████      | 12/30 [01:05<00:14,  1.23it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.43it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.61it/s] 50%|█████     | 15/30 [01:06<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.89it/s] 57%|█████▋    | 17/30 [01:07<00:06,  1.99it/s] 60%|██████    | 18/30 [01:07<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.44s/it]
Epoch loss is 2.591177733739217
Epoch 493/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:31, 56.95s/it]  7%|▋         | 2/30 [00:57<11:08, 23.86s/it] 10%|█         | 3/30 [00:58<05:55, 13.17s/it] 13%|█▎        | 4/30 [00:59<03:39,  8.44s/it] 17%|█▋        | 5/30 [01:01<02:32,  6.11s/it] 20%|██        | 6/30 [01:01<01:40,  4.18s/it] 23%|██▎       | 7/30 [01:02<01:08,  2.96s/it] 27%|██▋       | 8/30 [01:02<00:47,  2.16s/it] 30%|███       | 9/30 [01:03<00:34,  1.62s/it] 33%|███▎      | 10/30 [01:03<00:25,  1.26s/it] 37%|███▋      | 11/30 [01:03<00:19,  1.01s/it] 40%|████      | 12/30 [01:04<00:15,  1.20it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.40it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.58it/s] 50%|█████     | 15/30 [01:05<00:08,  1.74it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.87it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.524000358581543
Epoch 494/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [01:00<29:18, 60.64s/it]  7%|▋         | 2/30 [01:01<11:46, 25.23s/it] 10%|█         | 3/30 [01:01<06:15, 13.91s/it] 13%|█▎        | 4/30 [01:01<03:43,  8.59s/it] 17%|█▋        | 5/30 [01:02<02:21,  5.65s/it] 20%|██        | 6/30 [01:02<01:33,  3.88s/it] 23%|██▎       | 7/30 [01:03<01:03,  2.76s/it] 27%|██▋       | 8/30 [01:03<00:44,  2.02s/it] 30%|███       | 9/30 [01:04<00:32,  1.52s/it] 33%|███▎      | 10/30 [01:04<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:05<00:18,  1.04it/s] 40%|████      | 12/30 [01:05<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:05<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:06<00:09,  1.62it/s] 50%|█████     | 15/30 [01:06<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:07<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:07<00:06,  2.00it/s] 60%|██████    | 18/30 [01:08<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:08<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:08<00:04,  2.17it/s] 70%|███████   | 21/30 [01:09<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:09<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:10<00:03,  2.24it/s] 80%|████████  | 24/30 [01:10<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:11<00:02,  2.26it/s] 87%|████████▋ | 26/30 [01:11<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:12<00:01,  2.27it/s] 93%|█████████▎| 28/30 [01:12<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:12<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.27it/s]100%|██████████| 30/30 [01:13<00:00,  2.45s/it]
Epoch loss is 2.548085618019104
Epoch 495/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:32, 56.98s/it]  7%|▋         | 2/30 [00:59<11:33, 24.75s/it] 10%|█         | 3/30 [00:59<06:08, 13.65s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.44s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.64s/it] 20%|██        | 6/30 [01:01<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:02<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:05<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.27it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.27it/s]100%|██████████| 30/30 [01:11<00:00,  2.40s/it]
Epoch loss is 2.541578690210978
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0971,  0.0776,  ..., -0.0509,  0.0927,  0.0611],
        [ 0.0333, -0.0217,  0.0822,  ..., -0.0108,  0.0949,  0.1007],
        [ 0.0013, -0.0104,  0.0068,  ..., -0.0525,  0.0618,  0.1193],
        ...,
        [-0.0112, -0.0006,  0.0715,  ..., -0.0492,  0.0265,  0.0182],
        [-0.0588, -0.1082,  0.0273,  ..., -0.0355,  0.0911,  0.0162],
        [-0.0238, -0.0184,  0.0551,  ..., -0.0040,  0.0930,  0.0999]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8435, 0.8416, 0.8190,  ..., 0.7506, 0.7496, 0.7496],
        [0.9297, 0.9181, 0.9166,  ..., 0.8928, 0.8902, 0.8889],
        [0.9019, 0.8658, 0.8591,  ..., 0.7909, 0.7893, 0.7893],
        ...,
        [0.8426, 0.8176, 0.8129,  ..., 0.7306, 0.7302, 0.7302],
        [0.9076, 0.8754, 0.8198,  ..., 0.7722, 0.7719, 0.7683],
        [0.8466, 0.8309, 0.8237,  ..., 0.7520, 0.7514, 0.7497]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 0, 1],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[171146.9375, 166565.4688, 120627.7031,  ...,  45412.4375,
          44760.4727,  44723.8203],
        [585918.1250, 496982.5000, 486119.0000,  ..., 346088.8438,
         333373.9375, 327068.7188],
        [393904.3750, 235257.7188, 213709.1406,  ...,  80739.9922,
          78854.9922,  78852.0547],
        ...,
        [168795.9062, 118267.4844, 110457.0391,  ...,  34117.1445,
          33907.9883,  33892.3125],
        [427599.1250, 269963.6250, 121963.0547,  ...,  61791.3672,
          61540.7227,  58424.1133],
        [178962.3438, 142886.4062, 128872.7344,  ...,  46323.6211,
          45918.6562,  44805.1445]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[171146.9375,      0.0000],
         [166565.4688,      0.0000],
         [120627.7031,      0.0000],
         ...,
         [ 45412.4375,      0.0000],
         [ 44760.4727,      0.0000],
         [ 44723.8203,      0.0000]],

        [[585918.1250,      0.0000],
         [496982.5000,      0.0000],
         [486119.0000,      0.0000],
         ...,
         [346088.8438,      0.0000],
         [333373.9375,      0.0000],
         [327068.7188,      0.0000]],

        [[393904.3750,      0.0000],
         [     0.0000, 235257.7188],
         [213709.1406,      0.0000],
         ...,
         [ 80739.9922,      0.0000],
         [ 78854.9922,      0.0000],
         [ 78852.0547,      0.0000]],

        ...,

        [[     0.0000, 168795.9062],
         [     0.0000, 118267.4844],
         [     0.0000, 110457.0391],
         ...,
         [ 34117.1445,      0.0000],
         [ 33907.9883,      0.0000],
         [     0.0000,  33892.3125]],

        [[427599.1250,      0.0000],
         [     0.0000, 269963.6250],
         [     0.0000, 121963.0547],
         ...,
         [ 61791.3672,      0.0000],
         [ 61540.7227,      0.0000],
         [     0.0000,  58424.1133]],

        [[     0.0000, 178962.3438],
         [     0.0000, 142886.4062],
         [128872.7344,      0.0000],
         ...,
         [ 46323.6211,      0.0000],
         [ 45918.6562,      0.0000],
         [ 44805.1445,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1408437.2500,    53950.8242],
        [ 8470527.0000,        0.0000],
        [ 2187634.2500,   495839.5625],
        [ 3245790.7500,        0.0000],
        [  707856.1250,   545493.0000],
        [ 1079571.2500,   199884.0938],
        [ 2161119.0000,  1041503.5000],
        [ 2929390.5000,   103257.9766],
        [ 3619226.0000,   141226.7344],
        [ 3626451.2500,        0.0000],
        [ 6091473.0000,        0.0000],
        [ 1535598.0000,        0.0000],
        [ 2914772.5000,        0.0000],
        [10465891.0000,        0.0000],
        [11510666.0000,        0.0000],
        [ 9196600.0000,        0.0000],
        [ 6472741.0000,        0.0000],
        [ 8552252.0000,        0.0000],
        [ 3815813.0000,        0.0000],
        [ 5259485.5000,   237539.6719],
        [ 6178895.5000,        0.0000],
        [ 4297082.0000,        0.0000],
        [11458213.0000,        0.0000],
        [11199300.0000,        0.0000],
        [ 3108334.5000,        0.0000],
        [10143298.0000,        0.0000],
        [ 8988957.0000,        0.0000],
        [12439047.0000,        0.0000],
        [10604446.0000,        0.0000],
        [10350262.0000,        0.0000],
        [13175980.0000,        0.0000],
        [10349335.0000,        0.0000],
        [ 2797300.0000,    96522.9688],
        [ 2225596.7500,  1086534.5000],
        [ 3151167.5000,  2026751.1250],
        [ 1187253.3750,  1616462.5000],
        [ 1680272.7500,   940975.5625],
        [ 1250153.0000,   703995.6875],
        [ 1135600.7500,   908833.5000],
        [ 7335551.0000,        0.0000],
        [ 2515415.5000,   231451.8438],
        [ 3701621.0000,        0.0000],
        [ 3342867.7500,        0.0000],
        [ 2633850.5000,    93383.3672],
        [ 1318844.5000,  1188716.8750],
        [  326712.7812,   381220.2188],
        [ 3846194.5000,   218340.2500],
        [  645510.1250,   410287.8750],
        [  309830.4062,   318703.2188],
        [ 1835908.1250,  1050278.0000],
        [ 1091942.8750,   354828.6562],
        [ 2217940.0000,   943722.5000],
        [ 2482449.2500,  1791650.6250],
        [ 3661988.2500,   162101.2656],
        [ 6169816.0000,   322727.8125],
        [ 3709017.5000,   183826.7344],
        [ 2871718.5000,  1143415.3750],
        [ 3359436.0000,  1009602.0000],
        [ 1824429.0000,   972836.7500],
        [  980734.0625,   896763.9375],
        [ 2916458.5000,   583990.1250],
        [  740589.6250,   546291.8750],
        [ 1386692.7500,   832799.2500],
        [  826774.9375,   667832.5000]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
Epoch 496/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:59<28:46, 59.53s/it]  7%|▋         | 2/30 [00:59<11:33, 24.77s/it] 10%|█         | 3/30 [01:00<06:08, 13.66s/it] 13%|█▎        | 4/30 [01:00<03:39,  8.45s/it] 17%|█▋        | 5/30 [01:01<02:19,  5.56s/it] 20%|██        | 6/30 [01:01<01:31,  3.82s/it] 23%|██▎       | 7/30 [01:02<01:02,  2.72s/it] 27%|██▋       | 8/30 [01:02<00:43,  1.99s/it] 30%|███       | 9/30 [01:03<00:31,  1.51s/it] 33%|███▎      | 10/30 [01:03<00:23,  1.18s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:04<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:05<00:09,  1.63it/s] 50%|█████     | 15/30 [01:05<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:06<00:06,  2.00it/s] 60%|██████    | 18/30 [01:07<00:05,  2.08it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:08<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.24it/s] 80%|████████  | 24/30 [01:09<00:02,  2.25it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.26it/s] 90%|█████████ | 27/30 [01:11<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.42s/it]
Epoch loss is 2.596270283063253
Epoch 497/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:58<28:10, 58.29s/it]  7%|▋         | 2/30 [00:58<11:19, 24.26s/it] 10%|█         | 3/30 [00:59<06:06, 13.56s/it] 13%|█▎        | 4/30 [00:59<03:37,  8.38s/it] 17%|█▋        | 5/30 [01:00<02:17,  5.52s/it] 20%|██        | 6/30 [01:00<01:31,  3.79s/it] 23%|██▎       | 7/30 [01:01<01:02,  2.70s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:02<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.05it/s] 40%|████      | 12/30 [01:03<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.45it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.17it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.5943246682484946
Epoch 498/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:42, 57.31s/it]  7%|▋         | 2/30 [00:57<11:08, 23.86s/it] 10%|█         | 3/30 [00:59<06:05, 13.54s/it] 13%|█▎        | 4/30 [00:59<03:37,  8.37s/it] 17%|█▋        | 5/30 [00:59<02:17,  5.51s/it] 20%|██        | 6/30 [01:00<01:30,  3.79s/it] 23%|██▎       | 7/30 [01:00<01:01,  2.69s/it] 27%|██▋       | 8/30 [01:01<00:43,  1.98s/it] 30%|███       | 9/30 [01:01<00:31,  1.50s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.17s/it] 37%|███▋      | 11/30 [01:02<00:18,  1.06it/s] 40%|████      | 12/30 [01:02<00:14,  1.26it/s] 43%|████▎     | 13/30 [01:03<00:11,  1.46it/s] 47%|████▋     | 14/30 [01:03<00:09,  1.63it/s] 50%|█████     | 15/30 [01:04<00:08,  1.78it/s] 53%|█████▎    | 16/30 [01:04<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  2.00it/s] 60%|██████    | 18/30 [01:05<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.13it/s] 67%|██████▋   | 20/30 [01:06<00:04,  2.17it/s] 70%|███████   | 21/30 [01:06<00:04,  2.20it/s] 73%|███████▎  | 22/30 [01:07<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:07<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:08<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:09<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:10<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.37s/it]
Epoch loss is 2.586865949630737
Epoch 499/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:56<27:27, 56.80s/it]  7%|▋         | 2/30 [00:58<11:28, 24.60s/it] 10%|█         | 3/30 [00:59<06:06, 13.57s/it] 13%|█▎        | 4/30 [00:59<03:38,  8.39s/it] 17%|█▋        | 5/30 [01:00<02:20,  5.63s/it] 20%|██        | 6/30 [01:00<01:32,  3.87s/it] 23%|██▎       | 7/30 [01:01<01:03,  2.75s/it] 27%|██▋       | 8/30 [01:01<00:44,  2.01s/it] 30%|███       | 9/30 [01:02<00:31,  1.52s/it] 33%|███▎      | 10/30 [01:02<00:23,  1.19s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.04it/s] 40%|████      | 12/30 [01:03<00:14,  1.25it/s] 43%|████▎     | 13/30 [01:04<00:11,  1.44it/s] 47%|████▋     | 14/30 [01:04<00:09,  1.62it/s] 50%|█████     | 15/30 [01:04<00:08,  1.77it/s] 53%|█████▎    | 16/30 [01:05<00:07,  1.90it/s] 57%|█████▋    | 17/30 [01:05<00:06,  1.99it/s] 60%|██████    | 18/30 [01:06<00:05,  2.07it/s] 63%|██████▎   | 19/30 [01:06<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:07<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.22it/s] 77%|███████▋  | 23/30 [01:08<00:03,  2.23it/s] 80%|████████  | 24/30 [01:08<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:09<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:09<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.25it/s] 93%|█████████▎| 28/30 [01:10<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:11<00:00,  2.39s/it]
Epoch loss is 2.567831015586853
Epoch 500/501
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:57<27:47, 57.50s/it]  7%|▋         | 2/30 [00:57<11:10, 23.94s/it] 10%|█         | 3/30 [00:58<05:56, 13.21s/it] 13%|█▎        | 4/30 [01:00<03:44,  8.65s/it] 17%|█▋        | 5/30 [01:01<02:28,  5.95s/it] 20%|██        | 6/30 [01:01<01:37,  4.08s/it] 23%|██▎       | 7/30 [01:02<01:06,  2.89s/it] 27%|██▋       | 8/30 [01:02<00:46,  2.11s/it] 30%|███       | 9/30 [01:02<00:33,  1.59s/it] 33%|███▎      | 10/30 [01:03<00:24,  1.23s/it] 37%|███▋      | 11/30 [01:03<00:18,  1.01it/s] 40%|████      | 12/30 [01:04<00:14,  1.21it/s] 43%|████▎     | 13/30 [01:04<00:12,  1.41it/s] 47%|████▋     | 14/30 [01:05<00:10,  1.59it/s] 50%|█████     | 15/30 [01:05<00:08,  1.75it/s] 53%|█████▎    | 16/30 [01:06<00:07,  1.88it/s] 57%|█████▋    | 17/30 [01:06<00:06,  1.98it/s] 60%|██████    | 18/30 [01:06<00:05,  2.06it/s] 63%|██████▎   | 19/30 [01:07<00:05,  2.12it/s] 67%|██████▋   | 20/30 [01:07<00:04,  2.16it/s] 70%|███████   | 21/30 [01:08<00:04,  2.19it/s] 73%|███████▎  | 22/30 [01:08<00:03,  2.21it/s] 77%|███████▋  | 23/30 [01:09<00:03,  2.23it/s] 80%|████████  | 24/30 [01:09<00:02,  2.24it/s] 83%|████████▎ | 25/30 [01:10<00:02,  2.25it/s] 87%|████████▋ | 26/30 [01:10<00:01,  2.25it/s] 90%|█████████ | 27/30 [01:10<00:01,  2.26it/s] 93%|█████████▎| 28/30 [01:11<00:00,  2.26it/s] 97%|█████████▋| 29/30 [01:11<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.26it/s]100%|██████████| 30/30 [01:12<00:00,  2.41s/it]
Epoch loss is 2.5521422545115153
saving checkpoint
Extracting features for train set...
feature output is dim torch.Size([7530, 192])
label output is dim torch.Size([7530, 1])
Extracting features for val set...
feature output is dim torch.Size([64, 192])
label output is dim torch.Size([64, 1])
TRAIN FEATURES ARE SIZE
 torch.Size([192, 7530])
TEST FEATURES ARE
 torch.Size([64, 192])
tensor([[ 0.0613, -0.0971,  0.0776,  ..., -0.0509,  0.0927,  0.0611],
        [ 0.0333, -0.0217,  0.0822,  ..., -0.0108,  0.0949,  0.1007],
        [ 0.0013, -0.0104,  0.0068,  ..., -0.0525,  0.0618,  0.1193],
        ...,
        [-0.0112, -0.0006,  0.0715,  ..., -0.0492,  0.0265,  0.0182],
        [-0.0588, -0.1082,  0.0273,  ..., -0.0355,  0.0911,  0.0162],
        [-0.0238, -0.0184,  0.0551,  ..., -0.0040,  0.0930,  0.0999]],
       device='cuda:0')
TEST LABELS ARE
 torch.Size([64, 1])
tensor([[0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [0],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1],
        [1]], device='cuda:0')
DOT PROD OF TEST FEATURES x TRAIN FEATURES
 torch.Size([64, 7530])
TOP K DOT PROD VALS ARE
 torch.Size([64, 20])
tensor([[0.8435, 0.8416, 0.8190,  ..., 0.7506, 0.7496, 0.7496],
        [0.9297, 0.9181, 0.9166,  ..., 0.8928, 0.8902, 0.8889],
        [0.9019, 0.8658, 0.8591,  ..., 0.7909, 0.7893, 0.7893],
        ...,
        [0.8426, 0.8176, 0.8129,  ..., 0.7306, 0.7302, 0.7302],
        [0.9076, 0.8754, 0.8198,  ..., 0.7722, 0.7719, 0.7683],
        [0.8466, 0.8309, 0.8237,  ..., 0.7520, 0.7514, 0.7497]],
       device='cuda:0')
TRAIN LABEL CANDIDATES ARE
 torch.Size([64, 7530])
RETRIEVED CANDIDATES ARE
 torch.Size([64, 20])
tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 1, 0,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 0, 1],
        [0, 1, 1,  ..., 0, 0, 1],
        [1, 1, 0,  ..., 0, 0, 0]], device='cuda:0')
ONE HOT RETRIEVED CANDIATES ARE
 torch.Size([1280, 2])
tensor([[1., 0.],
        [1., 0.],
        [1., 0.],
        ...,
        [1., 0.],
        [1., 0.],
        [1., 0.]], device='cuda:0')
EXP(TOP K VALS / TEMP)
 torch.Size([64, 20])
tensor([[171144.4844, 166565.4688, 120625.9766,  ...,  45411.7852,
          44759.9570,  44723.5195],
        [585910.8125, 496980.1562, 486119.4375,  ..., 346087.8750,
         333373.9375, 327067.4375],
        [393904.0000, 235259.2812, 213711.6094,  ...,  80740.8359,
          78854.8359,  78854.1641],
        ...,
        [168796.2344, 118268.0469, 110454.2969,  ...,  34117.2773,
          33908.1211,  33892.4062],
        [427597.8750, 269962.5938, 121962.5938,  ...,  61791.6641,
          61540.9023,  58423.5508],
        [178962.3438, 142884.3750, 128871.2500,  ...,  46322.7812,
          45918.6992,  44804.4609]], device='cuda:0')
ONE HOT x EXP(TOP K VALS)
 torch.Size([64, 20, 2])
tensor([[[171144.4844,      0.0000],
         [166565.4688,      0.0000],
         [120625.9766,      0.0000],
         ...,
         [ 45411.7852,      0.0000],
         [ 44759.9570,      0.0000],
         [ 44723.5195,      0.0000]],

        [[585910.8125,      0.0000],
         [496980.1562,      0.0000],
         [486119.4375,      0.0000],
         ...,
         [346087.8750,      0.0000],
         [333373.9375,      0.0000],
         [327067.4375,      0.0000]],

        [[393904.0000,      0.0000],
         [     0.0000, 235259.2812],
         [213711.6094,      0.0000],
         ...,
         [ 80740.8359,      0.0000],
         [ 78854.8359,      0.0000],
         [ 78854.1641,      0.0000]],

        ...,

        [[     0.0000, 168796.2344],
         [     0.0000, 118268.0469],
         [     0.0000, 110454.2969],
         ...,
         [ 34117.2773,      0.0000],
         [ 33908.1211,      0.0000],
         [     0.0000,  33892.4062]],

        [[427597.8750,      0.0000],
         [     0.0000, 269962.5938],
         [     0.0000, 121962.5938],
         ...,
         [ 61791.6641,      0.0000],
         [ 61540.9023,      0.0000],
         [     0.0000,  58423.5508]],

        [[     0.0000, 178962.3438],
         [     0.0000, 142884.3750],
         [128871.2500,      0.0000],
         ...,
         [ 46322.7812,      0.0000],
         [ 45918.6992,      0.0000],
         [ 44804.4609,      0.0000]]], device='cuda:0')
PROBS ARE
 torch.Size([64, 2])
tensor([[ 1408420.2500,    53950.9258],
        [ 8470481.0000,        0.0000],
        [ 2187640.5000,   495840.5000],
        [ 3245786.0000,        0.0000],
        [  707862.8750,   545495.6875],
        [ 1079583.8750,   199886.3906],
        [ 2161116.5000,  1041499.1250],
        [ 2929401.5000,   103257.0000],
        [ 3619237.7500,   141226.7344],
        [ 3626401.7500,        0.0000],
        [ 6091482.0000,        0.0000],
        [ 1535581.0000,        0.0000],
        [ 2914760.5000,        0.0000],
        [10465936.0000,        0.0000],
        [11510673.0000,        0.0000],
        [ 9196602.0000,        0.0000],
        [ 6472719.0000,        0.0000],
        [ 8552263.0000,        0.0000],
        [ 3815840.0000,        0.0000],
        [ 5259509.5000,   237541.7031],
        [ 6178889.5000,        0.0000],
        [ 4297084.0000,        0.0000],
        [11458212.0000,        0.0000],
        [11199297.0000,        0.0000],
        [ 3108319.7500,        0.0000],
        [10143285.0000,        0.0000],
        [ 8988927.0000,        0.0000],
        [12439030.0000,        0.0000],
        [10604398.0000,        0.0000],
        [10350242.0000,        0.0000],
        [13175944.0000,        0.0000],
        [10349336.0000,        0.0000],
        [ 2797303.0000,    96521.6719],
        [ 2225585.0000,  1086530.0000],
        [ 3151154.7500,  2026740.6250],
        [ 1187236.2500,  1616451.0000],
        [ 1680270.1250,   940975.3750],
        [ 1250141.0000,   703994.3125],
        [ 1135585.6250,   908832.2500],
        [ 7335599.0000,        0.0000],
        [ 2515408.5000,   231448.7812],
        [ 3701619.5000,        0.0000],
        [ 3342866.7500,        0.0000],
        [ 2633841.5000,    93381.9453],
        [ 1318836.2500,  1188721.0000],
        [  326708.0312,   381215.5000],
        [ 3846210.0000,   218340.4531],
        [  645505.7500,   410286.6250],
        [  309831.5000,   318703.9375],
        [ 1835908.0000,  1050287.5000],
        [ 1091957.1250,   354829.4375],
        [ 2217941.2500,   943715.3750],
        [ 2482417.5000,  1791641.7500],
        [ 3661962.2500,   162099.5625],
        [ 6169776.0000,   322727.5312],
        [ 3709007.5000,   183825.8594],
        [ 2871706.2500,  1143417.6250],
        [ 3359400.7500,  1009600.1250],
        [ 1824414.0000,   972837.7500],
        [  980722.5000,   896762.1250],
        [ 2916446.0000,   583983.0000],
        [  740592.6875,   546290.0000],
        [ 1386693.6250,   832798.3125],
        [  826766.3125,   667825.6250]], device='cuda:0')
PREDICTION IDX/CLASS SORTED
tensor([[0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [1, 0],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1],
        [0, 1]], device='cuda:0')
CORRECT PREDS
tensor([[ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [ True],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [ True],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False],
        [False]], device='cuda:0')
Top 1 acc 54.6875
Top1 accuracy for validation set is 54.6875 size is torch.Size([64, 1])
