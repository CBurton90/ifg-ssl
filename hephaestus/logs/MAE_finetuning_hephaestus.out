/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Cuda available = True
Random seed set as 42
0it [00:00, ?it/s]8it [00:00, 74.95it/s]17it [00:00, 83.55it/s]35it [00:00, 115.78it/s]53it [00:00, 138.86it/s]69it [00:00, 144.07it/s]84it [00:00, 96.56it/s] 99it [00:00, 108.89it/s]113it [00:00, 114.94it/s]131it [00:01, 131.81it/s]146it [00:01, 129.61it/s]160it [00:01, 125.69it/s]174it [00:01, 126.30it/s]188it [00:01, 103.25it/s]202it [00:01, 110.55it/s]217it [00:01, 120.32it/s]231it [00:01, 125.28it/s]245it [00:02, 116.98it/s]265it [00:02, 135.89it/s]280it [00:02, 134.31it/s]297it [00:02, 142.06it/s]312it [00:02, 93.33it/s] 324it [00:02, 92.46it/s]335it [00:02, 93.00it/s]349it [00:03, 99.64it/s]362it [00:03, 106.83it/s]374it [00:03, 105.59it/s]386it [00:03, 99.91it/s] 399it [00:03, 106.64it/s]412it [00:03, 107.83it/s]424it [00:03, 93.66it/s] 443it [00:03, 111.86it/s]462it [00:04, 131.21it/s]482it [00:04, 148.98it/s]498it [00:04, 132.18it/s]513it [00:04, 128.36it/s]527it [00:04, 110.78it/s]539it [00:04, 100.53it/s]550it [00:04, 102.63it/s]562it [00:04, 102.96it/s]578it [00:05, 116.68it/s]591it [00:05, 114.62it/s]603it [00:05, 104.26it/s]623it [00:05, 127.51it/s]639it [00:05, 129.77it/s]659it [00:05, 147.45it/s]675it [00:05, 146.17it/s]690it [00:05, 140.66it/s]705it [00:06, 119.34it/s]718it [00:06, 110.98it/s]730it [00:06, 94.91it/s] 745it [00:06, 105.99it/s]757it [00:06, 105.64it/s]773it [00:06, 119.15it/s]789it [00:06, 129.46it/s]803it [00:06, 113.94it/s]816it [00:07, 117.55it/s]829it [00:07, 104.62it/s]847it [00:07, 123.08it/s]861it [00:07, 108.71it/s]873it [00:07, 103.07it/s]884it [00:07, 95.26it/s] 901it [00:07, 112.71it/s]917it [00:07, 122.16it/s]938it [00:08, 143.26it/s]954it [00:08, 147.29it/s]971it [00:08, 153.25it/s]987it [00:08, 114.21it/s]1005it [00:08, 124.47it/s]1019it [00:08, 124.06it/s]1033it [00:08, 120.00it/s]1059it [00:08, 153.32it/s]1076it [00:09, 150.52it/s]1094it [00:09, 151.51it/s]1110it [00:09, 148.30it/s]1126it [00:09, 125.84it/s]1146it [00:09, 142.45it/s]1162it [00:09, 132.44it/s]1177it [00:09, 135.23it/s]1193it [00:09, 140.84it/s]1210it [00:10, 139.72it/s]1225it [00:10, 136.14it/s]1239it [00:10, 123.78it/s]1252it [00:10, 111.81it/s]1268it [00:10, 122.80it/s]1281it [00:10, 113.70it/s]1293it [00:10, 114.78it/s]1312it [00:10, 127.97it/s]1330it [00:11, 135.96it/s]1344it [00:11, 120.22it/s]1357it [00:11, 119.11it/s]1370it [00:11, 110.46it/s]1385it [00:11, 120.26it/s]1398it [00:11, 120.60it/s]1417it [00:11, 138.63it/s]1436it [00:11, 150.20it/s]1462it [00:11, 179.71it/s]1481it [00:12, 169.62it/s]1502it [00:12, 180.02it/s]1521it [00:12, 148.78it/s]1537it [00:12, 138.81it/s]1552it [00:12, 113.16it/s]1565it [00:12, 105.91it/s]1579it [00:12, 110.57it/s]1593it [00:13, 116.01it/s]1606it [00:13, 105.08it/s]1618it [00:13, 99.55it/s] 1635it [00:13, 115.84it/s]1652it [00:13, 128.91it/s]1669it [00:13, 132.77it/s]1686it [00:13, 141.35it/s]1701it [00:13, 130.76it/s]1715it [00:14, 128.69it/s]1737it [00:14, 152.24it/s]1753it [00:14, 145.10it/s]1772it [00:14, 156.84it/s]1789it [00:14, 159.92it/s]1806it [00:14, 137.15it/s]1823it [00:14, 140.46it/s]1838it [00:14, 139.63it/s]1853it [00:14, 137.22it/s]1867it [00:15, 124.30it/s]1885it [00:15, 136.93it/s]1900it [00:15, 135.64it/s]1919it [00:15, 150.01it/s]1935it [00:15, 137.75it/s]1950it [00:15, 140.07it/s]1972it [00:15, 151.49it/s]1988it [00:15, 144.02it/s]2005it [00:16, 147.40it/s]2030it [00:16, 168.91it/s]2048it [00:16, 157.41it/s]2065it [00:16, 159.71it/s]2082it [00:16, 152.78it/s]2098it [00:16, 124.41it/s]2112it [00:16, 123.22it/s]2132it [00:16, 140.46it/s]2147it [00:17, 138.82it/s]2162it [00:17, 132.46it/s]2176it [00:17, 130.21it/s]2205it [00:17, 169.61it/s]2223it [00:17, 156.10it/s]2243it [00:17, 167.46it/s]2261it [00:17, 153.02it/s]2279it [00:17, 159.95it/s]2297it [00:17, 162.58it/s]2314it [00:18, 163.04it/s]2331it [00:18, 163.17it/s]2349it [00:18, 160.72it/s]2366it [00:18, 145.04it/s]2385it [00:18, 155.06it/s]2401it [00:18, 152.01it/s]2417it [00:18, 139.77it/s]2437it [00:18, 154.24it/s]2453it [00:19, 149.60it/s]2474it [00:19, 165.90it/s]2491it [00:19, 120.65it/s]2506it [00:19, 119.04it/s]2520it [00:19, 120.64it/s]2536it [00:19, 104.68it/s]2548it [00:19, 107.46it/s]2560it [00:20, 107.12it/s]2574it [00:20, 113.55it/s]2586it [00:20, 113.36it/s]2601it [00:20, 121.64it/s]2614it [00:20, 117.53it/s]2632it [00:20, 133.86it/s]2646it [00:20, 134.02it/s]2660it [00:20, 123.86it/s]2673it [00:20, 113.18it/s]2685it [00:21, 107.51it/s]2700it [00:21, 101.56it/s]2714it [00:21, 110.52it/s]2726it [00:21, 100.94it/s]2738it [00:21, 105.00it/s]2755it [00:21, 121.08it/s]2768it [00:21, 114.03it/s]2780it [00:21, 109.93it/s]2792it [00:22, 99.52it/s] 2810it [00:22, 118.39it/s]2827it [00:22, 131.74it/s]2843it [00:22, 134.93it/s]2857it [00:22, 120.23it/s]2870it [00:22, 101.25it/s]2882it [00:22, 101.00it/s]2894it [00:22, 104.46it/s]2912it [00:23, 122.47it/s]2926it [00:23, 125.82it/s]2943it [00:23, 137.79it/s]2961it [00:23, 140.07it/s]2976it [00:23, 141.11it/s]2993it [00:23, 146.25it/s]3008it [00:23, 137.56it/s]3030it [00:23, 159.86it/s]3047it [00:23, 153.49it/s]3063it [00:24, 133.70it/s]3077it [00:24, 128.33it/s]3091it [00:24, 128.43it/s]3105it [00:24, 112.66it/s]3124it [00:24, 131.29it/s]3143it [00:24, 144.90it/s]3159it [00:24, 147.22it/s]3181it [00:24, 159.43it/s]3198it [00:25, 151.42it/s]3214it [00:25, 137.52it/s]3229it [00:25, 120.17it/s]3242it [00:25, 86.10it/s] 3253it [00:25, 78.61it/s]3271it [00:25, 94.87it/s]3289it [00:26, 111.91it/s]3302it [00:26, 107.35it/s]3315it [00:26, 107.46it/s]3331it [00:26, 111.26it/s]3354it [00:26, 135.54it/s]3369it [00:26, 126.90it/s]3386it [00:26, 134.66it/s]3400it [00:26, 130.74it/s]3414it [00:27, 130.85it/s]3432it [00:27, 143.03it/s]3447it [00:27, 122.72it/s]3460it [00:27, 122.27it/s]3473it [00:27, 122.19it/s]3486it [00:27, 123.64it/s]3500it [00:27, 127.73it/s]3515it [00:27, 125.34it/s]3545it [00:27, 172.80it/s]3563it [00:28, 148.68it/s]3583it [00:28, 160.25it/s]3600it [00:28, 141.99it/s]3616it [00:28, 131.36it/s]3630it [00:28, 123.18it/s]3645it [00:28, 127.60it/s]3659it [00:28, 118.79it/s]3672it [00:28, 114.69it/s]3686it [00:29, 120.79it/s]3699it [00:29, 115.55it/s]3711it [00:29, 114.45it/s]3723it [00:29, 113.26it/s]3740it [00:29, 126.63it/s]3753it [00:29, 125.91it/s]3769it [00:29, 135.27it/s]3783it [00:29, 125.83it/s]3798it [00:29, 129.22it/s]3813it [00:30, 132.70it/s]3827it [00:30, 131.89it/s]3841it [00:30, 132.37it/s]3855it [00:30, 132.35it/s]3869it [00:30, 118.10it/s]3882it [00:30, 117.61it/s]3894it [00:30, 97.87it/s] 3906it [00:30, 102.53it/s]3925it [00:31, 123.42it/s]3939it [00:31, 116.90it/s]3952it [00:31, 119.70it/s]3966it [00:31, 125.11it/s]3980it [00:31, 123.45it/s]3995it [00:31, 129.38it/s]4015it [00:31, 143.84it/s]4031it [00:31, 146.80it/s]4046it [00:31, 137.79it/s]4060it [00:32, 116.35it/s]4073it [00:32, 111.49it/s]4085it [00:32, 83.18it/s] 4095it [00:32, 85.79it/s]4109it [00:32, 97.07it/s]4124it [00:32, 106.80it/s]4136it [00:32, 107.89it/s]4153it [00:33, 123.89it/s]4167it [00:33, 122.99it/s]4180it [00:33, 77.45it/s] 4205it [00:33, 106.39it/s]4219it [00:33, 103.96it/s]4232it [00:33, 109.28it/s]4245it [00:33, 107.46it/s]4266it [00:34, 132.05it/s]4283it [00:34, 139.52it/s]4298it [00:34, 133.51it/s]4316it [00:34, 140.41it/s]4331it [00:34, 127.72it/s]4354it [00:34, 153.32it/s]4371it [00:34, 135.96it/s]4387it [00:34, 141.63it/s]4403it [00:35, 146.14it/s]4423it [00:35, 159.63it/s]4440it [00:35, 157.61it/s]4457it [00:35, 143.21it/s]4472it [00:35, 136.94it/s]4487it [00:35, 122.90it/s]4505it [00:35, 133.28it/s]4519it [00:35, 125.81it/s]4533it [00:36, 98.96it/s] 4553it [00:36, 114.67it/s]4568it [00:36, 121.27it/s]4585it [00:36, 129.58it/s]4604it [00:36, 143.45it/s]4622it [00:36, 152.51it/s]4638it [00:36, 154.45it/s]4657it [00:36, 164.23it/s]4674it [00:37, 128.67it/s]4689it [00:37, 132.85it/s]4704it [00:37, 122.09it/s]4718it [00:37, 116.60it/s]4731it [00:37, 73.57it/s] 4752it [00:37, 96.28it/s]4772it [00:38, 116.20it/s]4787it [00:38, 117.79it/s]4802it [00:38, 124.14it/s]4818it [00:38, 126.83it/s]4837it [00:38, 141.54it/s]4853it [00:38, 136.98it/s]4869it [00:38, 142.89it/s]4884it [00:38, 139.74it/s]4902it [00:38, 149.01it/s]4918it [00:39, 124.42it/s]4934it [00:39, 132.93it/s]4949it [00:39, 108.54it/s]4969it [00:39, 126.24it/s]4983it [00:39, 123.24it/s]5000it [00:39, 133.40it/s]5015it [00:39, 131.18it/s]5032it [00:39, 140.91it/s]5050it [00:40, 149.64it/s]5066it [00:40, 147.84it/s]5082it [00:40, 133.60it/s]5107it [00:40, 163.03it/s]5130it [00:40, 180.60it/s]5149it [00:40, 160.79it/s]5166it [00:40, 144.44it/s]5182it [00:40, 146.68it/s]5198it [00:41, 136.53it/s]5213it [00:41, 138.79it/s]5237it [00:41, 156.37it/s]5261it [00:41, 171.87it/s]5279it [00:41, 151.24it/s]5296it [00:41, 154.65it/s]5312it [00:41, 155.65it/s]5328it [00:41, 143.06it/s]5348it [00:42, 157.53it/s]5365it [00:42, 144.59it/s]5384it [00:42, 155.27it/s]5401it [00:42, 147.90it/s]5417it [00:42, 134.61it/s]5431it [00:42, 127.70it/s]5445it [00:42, 110.42it/s]5457it [00:42, 96.38it/s] 5477it [00:43, 119.31it/s]5491it [00:43, 122.89it/s]5507it [00:43, 130.48it/s]5529it [00:43, 153.30it/s]5546it [00:43, 146.61it/s]5563it [00:43, 152.65it/s]5579it [00:43, 134.60it/s]5594it [00:43, 125.06it/s]5608it [00:44, 107.14it/s]5622it [00:44, 114.22it/s]5635it [00:44, 113.61it/s]5650it [00:44, 119.37it/s]5663it [00:44, 117.48it/s]5676it [00:44, 118.39it/s]5693it [00:44, 128.56it/s]5712it [00:44, 142.80it/s]5727it [00:45, 130.30it/s]5744it [00:45, 133.16it/s]5762it [00:45, 145.13it/s]5777it [00:45, 117.71it/s]5795it [00:45, 131.28it/s]5810it [00:45, 118.28it/s]5823it [00:45, 115.30it/s]5842it [00:45, 133.56it/s]5857it [00:46, 137.19it/s]5872it [00:46, 140.40it/s]5887it [00:46, 134.07it/s]5901it [00:46, 132.82it/s]5915it [00:46, 117.44it/s]5928it [00:46, 117.35it/s]5945it [00:46, 130.44it/s]5961it [00:46, 137.25it/s]5977it [00:46, 141.11it/s]5997it [00:47, 157.10it/s]6013it [00:47, 157.80it/s]6029it [00:47, 154.30it/s]6046it [00:47, 150.51it/s]6062it [00:47, 137.92it/s]6079it [00:47, 142.06it/s]6100it [00:47, 160.05it/s]6117it [00:47, 153.40it/s]6133it [00:47, 143.20it/s]6148it [00:48, 130.94it/s]6162it [00:48, 117.04it/s]6178it [00:48, 127.36it/s]6196it [00:48, 140.51it/s]6211it [00:48, 139.06it/s]6226it [00:48, 132.00it/s]6240it [00:48, 131.63it/s]6261it [00:48, 149.63it/s]6277it [00:49, 148.13it/s]6292it [00:49, 146.38it/s]6308it [00:49, 143.65it/s]6326it [00:49, 148.91it/s]6341it [00:49, 146.54it/s]6356it [00:49, 140.38it/s]6371it [00:49, 131.59it/s]6385it [00:49, 131.38it/s]6399it [00:49, 131.89it/s]6413it [00:50, 119.39it/s]6432it [00:50, 135.59it/s]6446it [00:50, 119.31it/s]6459it [00:50, 116.38it/s]6473it [00:50, 117.79it/s]6488it [00:50, 125.78it/s]6507it [00:50, 137.69it/s]6521it [00:51, 89.17it/s] 6533it [00:51, 78.47it/s]6548it [00:51, 91.92it/s]6560it [00:51, 97.47it/s]6575it [00:51, 107.89it/s]6593it [00:51, 117.44it/s]6606it [00:51, 107.50it/s]6618it [00:52, 87.57it/s] 6628it [00:52, 82.10it/s]6637it [00:52, 82.07it/s]6648it [00:52, 84.81it/s]6660it [00:52, 92.53it/s]6670it [00:52, 88.44it/s]6680it [00:52, 89.09it/s]6694it [00:52, 99.84it/s]6706it [00:53, 102.28it/s]6722it [00:53, 115.89it/s]6739it [00:53, 128.27it/s]6753it [00:53, 105.05it/s]6765it [00:53, 92.84it/s] 6778it [00:53, 99.42it/s]6789it [00:53, 98.02it/s]6801it [00:53, 103.20it/s]6819it [00:54, 122.49it/s]6832it [00:54, 123.20it/s]6845it [00:54, 119.19it/s]6858it [00:54, 109.17it/s]6870it [00:54, 109.23it/s]6885it [00:54, 118.09it/s]6900it [00:54, 120.57it/s]6922it [00:54, 142.75it/s]6940it [00:54, 149.31it/s]6956it [00:55, 140.09it/s]6981it [00:55, 158.59it/s]6997it [00:55, 148.77it/s]7012it [00:55, 122.82it/s]7025it [00:55, 123.08it/s]7038it [00:55, 120.82it/s]7051it [00:55, 115.39it/s]7077it [00:55, 150.81it/s]7093it [00:56, 150.99it/s]7109it [00:56, 147.38it/s]7125it [00:56, 137.91it/s]7140it [00:56, 137.13it/s]7154it [00:56, 135.85it/s]7168it [00:56, 131.74it/s]7185it [00:56, 142.17it/s]7200it [00:56, 126.11it/s]7222it [00:57, 150.31it/s]7238it [00:57, 151.15it/s]7254it [00:57, 143.05it/s]7269it [00:57, 130.31it/s]7283it [00:57, 110.17it/s]7296it [00:57, 114.14it/s]7309it [00:57, 105.55it/s]7321it [00:57, 106.40it/s]7333it [00:58, 93.30it/s] 7347it [00:58, 102.99it/s]7358it [00:58, 92.22it/s] 7368it [00:58, 92.96it/s]7383it [00:58, 101.94it/s]7397it [00:58, 107.70it/s]7411it [00:58, 77.89it/s] 7428it [00:59, 95.01it/s]7447it [00:59, 114.72it/s]7461it [00:59, 113.88it/s]7475it [00:59, 120.12it/s]7496it [00:59, 140.79it/s]7512it [00:59, 139.85it/s]7527it [00:59, 126.39it/s]7542it [00:59, 130.45it/s]7560it [00:59, 143.38it/s]7575it [01:00, 87.14it/s] 7591it [01:00, 99.06it/s]7608it [01:00, 110.82it/s]7622it [01:00, 98.41it/s] 7634it [01:00, 102.48it/s]7646it [01:00, 104.25it/s]7658it [01:01, 103.66it/s]7670it [01:01, 101.74it/s]7683it [01:01, 108.71it/s]7697it [01:01, 113.81it/s]7709it [01:01, 102.22it/s]7724it [01:01, 114.25it/s]7736it [01:01, 102.68it/s]7753it [01:01, 117.10it/s]7766it [01:02, 113.91it/s]7778it [01:02, 103.05it/s]7794it [01:02, 113.17it/s]7808it [01:02, 114.20it/s]7820it [01:02, 111.12it/s]7832it [01:02, 90.50it/s] 7849it [01:02, 107.88it/s]7868it [01:02, 127.84it/s]7882it [01:03, 101.75it/s]7895it [01:03, 107.35it/s]7907it [01:03, 108.69it/s]7920it [01:03, 104.72it/s]7937it [01:03, 115.54it/s]7951it [01:03, 116.25it/s]7964it [01:03, 119.40it/s]7979it [01:03, 126.13it/s]7992it [01:04, 123.86it/s]8008it [01:04, 128.46it/s]8027it [01:04, 144.46it/s]8042it [01:04, 124.23it/s]8056it [01:04, 125.83it/s]8070it [01:04, 106.81it/s]8082it [01:04, 106.07it/s]8097it [01:04, 116.66it/s]8110it [01:05, 117.81it/s]8124it [01:05, 122.84it/s]8137it [01:05, 116.21it/s]8159it [01:05, 142.45it/s]8174it [01:05, 139.19it/s]8189it [01:05, 128.18it/s]8203it [01:05, 126.67it/s]8218it [01:05, 126.27it/s]8231it [01:05, 116.00it/s]8243it [01:06, 108.95it/s]8255it [01:06, 104.85it/s]8269it [01:06, 112.16it/s]8281it [01:06, 108.82it/s]8298it [01:06, 123.85it/s]8311it [01:06, 84.90it/s] 8323it [01:06, 91.56it/s]8334it [01:07, 92.58it/s]8351it [01:07, 103.54it/s]8364it [01:07, 109.91it/s]8378it [01:07, 114.75it/s]8391it [01:07, 117.25it/s]8412it [01:07, 131.18it/s]8426it [01:07, 125.13it/s]8445it [01:07, 141.65it/s]8460it [01:08, 124.15it/s]8474it [01:08, 127.18it/s]8490it [01:08, 133.38it/s]8510it [01:08, 149.92it/s]8526it [01:08, 146.16it/s]8548it [01:08, 158.72it/s]8573it [01:08, 183.43it/s]8592it [01:08, 180.15it/s]8611it [01:08, 165.95it/s]8628it [01:09, 154.06it/s]8652it [01:09, 175.25it/s]8671it [01:09, 172.96it/s]8689it [01:09, 149.15it/s]8705it [01:09, 115.05it/s]8726it [01:09, 133.60it/s]8742it [01:09, 123.26it/s]8757it [01:10, 127.73it/s]8774it [01:10, 136.70it/s]8794it [01:10, 147.24it/s]8810it [01:10, 140.72it/s]8825it [01:10, 136.77it/s]8843it [01:10, 143.51it/s]8866it [01:10, 164.98it/s]8883it [01:10, 156.14it/s]8899it [01:10, 148.19it/s]8915it [01:11, 147.60it/s]8931it [01:11, 149.31it/s]8947it [01:11, 139.02it/s]8974it [01:11, 173.27it/s]8992it [01:11, 157.40it/s]9009it [01:11, 159.02it/s]9026it [01:11, 149.66it/s]9043it [01:11, 144.61it/s]9058it [01:12, 133.14it/s]9076it [01:12, 133.88it/s]9090it [01:12, 125.84it/s]9108it [01:12, 133.66it/s]9124it [01:12, 139.89it/s]9139it [01:12, 141.23it/s]9154it [01:12, 126.17it/s]9167it [01:12, 126.67it/s]9186it [01:12, 143.20it/s]9204it [01:13, 150.95it/s]9229it [01:13, 174.52it/s]9247it [01:13, 164.12it/s]9265it [01:13, 167.19it/s]9286it [01:13, 169.05it/s]9305it [01:13, 174.74it/s]9323it [01:13, 149.29it/s]9340it [01:13, 151.84it/s]9356it [01:14, 118.25it/s]9370it [01:14, 111.67it/s]9383it [01:14, 115.29it/s]9407it [01:14, 139.91it/s]9432it [01:14, 166.99it/s]9450it [01:14, 168.61it/s]9468it [01:14, 153.91it/s]9485it [01:14, 142.40it/s]9500it [01:15, 137.75it/s]9515it [01:15, 133.93it/s]9535it [01:15, 150.79it/s]9551it [01:15, 137.91it/s]9566it [01:15, 134.55it/s]9581it [01:15, 138.33it/s]9597it [01:15, 135.57it/s]9611it [01:16, 109.43it/s]9627it [01:16, 118.49it/s]9640it [01:16, 115.28it/s]9660it [01:16, 136.17it/s]9675it [01:16, 82.08it/s] 9697it [01:16, 106.88it/s]9712it [01:16, 108.40it/s]9726it [01:17, 110.92it/s]9740it [01:17, 116.19it/s]9756it [01:17, 119.23it/s]9774it [01:17, 133.14it/s]9795it [01:17, 152.09it/s]9812it [01:17, 140.84it/s]9827it [01:17, 134.99it/s]9842it [01:17, 136.63it/s]9859it [01:17, 144.97it/s]9874it [01:18, 137.47it/s]9889it [01:18, 135.51it/s]9903it [01:18, 120.61it/s]9916it [01:18, 111.49it/s]9928it [01:18, 101.31it/s]9939it [01:18, 102.65it/s]9950it [01:19, 72.61it/s] 9959it [01:19, 66.25it/s]9967it [01:19, 65.07it/s]9978it [01:19, 72.48it/s]9987it [01:19, 73.70it/s]10002it [01:19, 91.29it/s]10012it [01:19, 87.56it/s]10027it [01:19, 101.43it/s]10038it [01:20, 100.29it/s]10051it [01:20, 106.42it/s]10072it [01:20, 126.82it/s]10086it [01:20, 125.93it/s]10099it [01:20, 124.66it/s]10112it [01:20, 105.08it/s]10124it [01:20, 105.97it/s]10137it [01:20, 107.56it/s]10151it [01:20, 115.14it/s]10163it [01:21, 114.12it/s]10175it [01:21, 113.76it/s]10190it [01:21, 120.01it/s]10203it [01:21, 121.52it/s]10216it [01:21, 118.47it/s]10229it [01:21, 117.76it/s]10250it [01:21, 142.59it/s]10265it [01:21, 137.04it/s]10279it [01:21, 132.17it/s]10296it [01:22, 141.48it/s]10311it [01:22, 140.87it/s]10326it [01:22, 134.52it/s]10340it [01:22, 135.45it/s]10355it [01:22, 134.01it/s]10373it [01:22, 138.72it/s]10387it [01:22, 123.52it/s]10404it [01:22, 127.71it/s]10422it [01:22, 140.25it/s]10437it [01:23, 136.31it/s]10454it [01:23, 145.02it/s]10475it [01:23, 161.80it/s]10495it [01:23, 167.65it/s]10513it [01:23, 170.88it/s]10531it [01:23, 158.79it/s]10548it [01:23, 153.56it/s]10564it [01:24, 93.48it/s] 10581it [01:24, 107.22it/s]10596it [01:24, 112.92it/s]10613it [01:24, 125.31it/s]10630it [01:24, 134.52it/s]10645it [01:24, 113.29it/s]10658it [01:24, 98.30it/s] 10670it [01:25, 98.34it/s]10685it [01:25, 107.55it/s]10701it [01:25, 118.92it/s]10719it [01:25, 134.39it/s]10734it [01:25, 129.14it/s]10755it [01:25, 149.83it/s]10771it [01:25, 148.63it/s]10790it [01:25, 148.21it/s]10807it [01:25, 146.57it/s]10822it [01:26, 145.29it/s]10837it [01:26, 136.93it/s]10857it [01:26, 151.65it/s]10873it [01:26, 137.25it/s]10888it [01:26, 132.11it/s]10902it [01:26, 131.79it/s]10916it [01:26, 120.69it/s]10929it [01:26, 120.47it/s]10949it [01:27, 140.34it/s]10965it [01:27, 145.13it/s]10980it [01:27, 138.25it/s]10995it [01:27, 139.54it/s]11012it [01:27, 145.27it/s]11029it [01:27, 147.96it/s]11050it [01:27, 164.34it/s]11067it [01:27, 136.60it/s]11082it [01:27, 127.93it/s]11096it [01:28, 126.71it/s]11112it [01:28, 134.23it/s]11126it [01:28, 127.71it/s]11142it [01:28, 134.36it/s]11156it [01:28, 118.43it/s]11170it [01:28, 122.74it/s]11185it [01:28, 125.94it/s]11202it [01:28, 135.93it/s]11224it [01:28, 158.53it/s]11241it [01:29, 151.30it/s]11257it [01:29, 137.33it/s]11276it [01:29, 149.02it/s]11292it [01:29, 128.84it/s]11306it [01:29, 122.82it/s]11321it [01:29, 129.43it/s]11335it [01:29, 131.01it/s]11351it [01:29, 134.34it/s]11365it [01:30, 120.12it/s]11380it [01:30, 126.16it/s]11398it [01:30, 140.24it/s]11419it [01:30, 152.81it/s]11435it [01:30, 127.38it/s]11449it [01:30, 128.18it/s]11467it [01:30, 139.88it/s]11482it [01:30, 139.03it/s]11502it [01:31, 154.01it/s]11518it [01:31, 88.95it/s] 11533it [01:31, 97.42it/s]11549it [01:31, 108.96it/s]11563it [01:31, 103.93it/s]11579it [01:31, 113.40it/s]11594it [01:32, 118.32it/s]11607it [01:32, 99.10it/s] 11619it [01:32, 102.65it/s]11637it [01:32, 76.02it/s] 11651it [01:32, 86.96it/s]11665it [01:32, 97.47it/s]11678it [01:32, 102.24it/s]11691it [01:33, 107.98it/s]11709it [01:33, 124.93it/s]11725it [01:33, 131.49it/s]11743it [01:33, 144.16it/s]11759it [01:33, 144.91it/s]11777it [01:33, 138.87it/s]11799it [01:33, 158.55it/s]11816it [01:33, 157.56it/s]11833it [01:33, 154.20it/s]11849it [01:34, 153.23it/s]11867it [01:34, 152.57it/s]11888it [01:34, 167.51it/s]11908it [01:34, 170.87it/s]11926it [01:34, 166.08it/s]11943it [01:34, 135.35it/s]11958it [01:34, 132.71it/s]11973it [01:34, 136.21it/s]11995it [01:35, 157.79it/s]12013it [01:35, 161.67it/s]12030it [01:35, 153.37it/s]12046it [01:35, 141.49it/s]12061it [01:35, 139.86it/s]12076it [01:35, 137.00it/s]12090it [01:35, 120.27it/s]12103it [01:35, 120.12it/s]12123it [01:35, 140.72it/s]12138it [01:36, 131.89it/s]12158it [01:36, 146.93it/s]12174it [01:36, 140.56it/s]12189it [01:36, 132.70it/s]12208it [01:36, 146.88it/s]12226it [01:36, 152.36it/s]12242it [01:36, 143.89it/s]12265it [01:36, 165.68it/s]12282it [01:37, 164.57it/s]12299it [01:37, 151.52it/s]12317it [01:37, 157.81it/s]12336it [01:37, 162.52it/s]12353it [01:37, 130.97it/s]12375it [01:37, 152.16it/s]12399it [01:37, 170.89it/s]12418it [01:37, 169.60it/s]12440it [01:37, 181.50it/s]12459it [01:38, 163.33it/s]12479it [01:38, 168.27it/s]12497it [01:38, 169.26it/s]12515it [01:38, 169.50it/s]12536it [01:38, 170.15it/s]12554it [01:38, 151.91it/s]12570it [01:38, 138.97it/s]12588it [01:38, 148.77it/s]12607it [01:39, 157.15it/s]12624it [01:39, 147.93it/s]12640it [01:39, 106.86it/s]12658it [01:39, 121.21it/s]12672it [01:39, 124.28it/s]12691it [01:39, 139.31it/s]12707it [01:39, 144.11it/s]12723it [01:40, 141.34it/s]12738it [01:40, 86.93it/s] 12757it [01:40, 104.84it/s]12771it [01:40, 101.91it/s]12784it [01:40, 106.30it/s]12797it [01:40, 111.67it/s]12810it [01:40, 114.29it/s]12823it [01:41, 117.51it/s]12836it [01:41, 120.23it/s]12854it [01:41, 131.50it/s]12870it [01:41, 136.62it/s]12884it [01:41, 135.09it/s]12898it [01:41, 82.42it/s] 12913it [01:41, 92.53it/s]12925it [01:42, 97.65it/s]12941it [01:42, 86.51it/s]12959it [01:42, 103.04it/s]12973it [01:42, 108.87it/s]12988it [01:42, 117.12it/s]13001it [01:42, 98.32it/s] 13015it [01:42, 107.52it/s]13033it [01:42, 123.23it/s]13057it [01:43, 152.05it/s]13076it [01:43, 161.81it/s]13094it [01:43, 160.80it/s]13115it [01:43, 169.11it/s]13133it [01:43, 161.02it/s]13150it [01:43, 138.28it/s]13165it [01:43, 125.97it/s]13190it [01:43, 148.05it/s]13208it [01:44, 151.68it/s]13224it [01:44, 133.84it/s]13238it [01:44, 134.39it/s]13253it [01:44, 137.73it/s]13271it [01:44, 139.69it/s]13286it [01:44, 128.06it/s]13300it [01:44, 128.74it/s]13314it [01:44, 116.16it/s]13326it [01:45, 108.72it/s]13342it [01:45, 121.15it/s]13359it [01:45, 132.77it/s]13382it [01:45, 149.40it/s]13398it [01:45, 147.09it/s]13417it [01:45, 156.69it/s]13440it [01:45, 176.33it/s]13458it [01:45, 161.21it/s]13475it [01:45, 156.65it/s]13491it [01:46, 133.11it/s]13506it [01:46, 116.23it/s]13527it [01:46, 135.97it/s]13542it [01:46, 111.09it/s]13555it [01:46, 111.76it/s]13571it [01:46, 120.60it/s]13585it [01:46, 124.72it/s]13599it [01:47, 120.39it/s]13614it [01:47, 123.06it/s]13627it [01:47, 112.56it/s]13639it [01:47, 110.61it/s]13653it [01:47, 115.62it/s]13666it [01:47, 116.90it/s]13678it [01:47, 113.69it/s]13693it [01:47, 120.24it/s]13707it [01:47, 124.41it/s]13727it [01:48, 145.27it/s]13742it [01:48, 125.50it/s]13756it [01:48, 120.89it/s]13772it [01:48, 129.44it/s]13786it [01:48, 120.77it/s]13801it [01:48, 122.14it/s]13821it [01:48, 142.03it/s]13837it [01:48, 142.12it/s]13852it [01:49, 130.62it/s]13866it [01:49, 126.34it/s]13882it [01:49, 132.99it/s]13897it [01:49, 136.25it/s]13911it [01:49, 132.16it/s]13925it [01:49, 130.25it/s]13939it [01:49, 122.57it/s]13956it [01:49, 131.64it/s]13972it [01:49, 138.86it/s]13988it [01:50, 141.50it/s]14003it [01:50, 128.85it/s]14024it [01:50, 143.73it/s]14039it [01:50, 136.45it/s]14056it [01:50, 140.43it/s]14073it [01:50, 147.72it/s]14093it [01:50, 160.72it/s]14110it [01:50, 135.45it/s]14125it [01:51, 134.21it/s]14139it [01:51, 120.82it/s]14152it [01:51, 117.17it/s]14165it [01:51, 115.70it/s]14177it [01:51, 79.89it/s] 14187it [01:51, 81.95it/s]14200it [01:51, 92.02it/s]14221it [01:52, 115.30it/s]14234it [01:52, 69.60it/s] 14244it [01:52, 73.77it/s]14256it [01:52, 82.50it/s]14272it [01:52, 96.71it/s]14284it [01:52, 100.09it/s]14304it [01:53, 123.90it/s]14326it [01:53, 141.01it/s]14342it [01:53, 141.51it/s]14357it [01:53, 128.89it/s]14375it [01:53, 139.14it/s]14390it [01:53, 131.03it/s]14404it [01:53, 116.91it/s]14419it [01:53, 122.10it/s]14435it [01:54, 128.08it/s]14449it [01:54, 126.09it/s]14462it [01:54, 115.12it/s]14481it [01:54, 130.17it/s]14495it [01:54, 126.96it/s]14508it [01:54, 127.18it/s]14528it [01:54, 146.41it/s]14551it [01:54, 157.07it/s]14567it [01:54, 141.52it/s]14587it [01:55, 155.01it/s]14603it [01:55, 149.82it/s]14619it [01:55, 125.28it/s]14634it [01:55, 130.01it/s]14648it [01:55, 131.00it/s]14666it [01:55, 137.09it/s]14691it [01:55, 165.30it/s]14709it [01:55, 149.56it/s]14725it [01:56, 151.57it/s]14741it [01:56, 142.85it/s]14758it [01:56, 148.30it/s]14774it [01:56, 150.16it/s]14790it [01:56, 142.93it/s]14805it [01:56, 124.16it/s]14818it [01:56, 115.88it/s]14832it [01:56, 120.38it/s]14851it [01:57, 136.90it/s]14866it [01:57, 136.02it/s]14881it [01:57, 138.05it/s]14896it [01:57, 132.50it/s]14910it [01:57, 125.72it/s]14925it [01:57, 127.96it/s]14945it [01:57, 145.34it/s]14962it [01:57, 150.58it/s]14978it [01:57, 146.54it/s]14997it [01:58, 156.49it/s]15013it [01:58, 139.15it/s]15028it [01:58, 132.02it/s]15045it [01:58, 135.58it/s]15062it [01:58, 144.41it/s]15081it [01:58, 152.34it/s]15097it [01:58, 107.68it/s]15112it [01:58, 113.86it/s]15128it [01:59, 123.98it/s]15151it [01:59, 147.27it/s]15168it [01:59, 150.41it/s]15184it [01:59, 147.14it/s]15200it [01:59, 97.43it/s] 15214it [01:59, 105.58it/s]15232it [01:59, 117.67it/s]15247it [02:00, 124.98it/s]15264it [02:00, 130.66it/s]15280it [02:00, 134.08it/s]15295it [02:00, 133.57it/s]15309it [02:00, 125.77it/s]15322it [02:00, 125.76it/s]15335it [02:00, 117.83it/s]15350it [02:00, 126.30it/s]15364it [02:00, 121.83it/s]15377it [02:01, 120.16it/s]15394it [02:01, 127.29it/s]15408it [02:01, 128.39it/s]15424it [02:01, 133.55it/s]15440it [02:01, 118.66it/s]15453it [02:01, 117.95it/s]15468it [02:01, 124.36it/s]15482it [02:01, 127.86it/s]15496it [02:02, 128.70it/s]15510it [02:02, 122.94it/s]15529it [02:02, 140.74it/s]15544it [02:02, 133.52it/s]15558it [02:02, 129.65it/s]15578it [02:02, 148.05it/s]15596it [02:02, 151.66it/s]15612it [02:02, 140.29it/s]15627it [02:03, 121.45it/s]15645it [02:03, 135.48it/s]15660it [02:03, 129.53it/s]15674it [02:03, 128.34it/s]15689it [02:03, 132.52it/s]15706it [02:03, 138.36it/s]15721it [02:03, 139.20it/s]15736it [02:03, 140.71it/s]15756it [02:03, 156.48it/s]15772it [02:04, 138.83it/s]15791it [02:04, 149.12it/s]15813it [02:04, 164.70it/s]15830it [02:04, 165.62it/s]15847it [02:04, 165.24it/s]15864it [02:04, 164.08it/s]15886it [02:04, 178.41it/s]15904it [02:04, 158.60it/s]15925it [02:04, 171.23it/s]15943it [02:04, 172.73it/s]15961it [02:05, 135.77it/s]15976it [02:05, 137.71it/s]15998it [02:05, 154.05it/s]16026it [02:05, 181.83it/s]16046it [02:05, 174.76it/s]16065it [02:05, 153.29it/s]16082it [02:05, 134.33it/s]16100it [02:06, 144.62it/s]16116it [02:06, 136.48it/s]16136it [02:06, 150.45it/s]16152it [02:06, 142.67it/s]16171it [02:06, 144.84it/s]16193it [02:06, 157.44it/s]16210it [02:06, 151.16it/s]16226it [02:06, 140.10it/s]16241it [02:07, 128.77it/s]16255it [02:07, 126.20it/s]16276it [02:07, 147.04it/s]16292it [02:07, 143.14it/s]16308it [02:07, 147.37it/s]16329it [02:07, 159.05it/s]16349it [02:07, 166.75it/s]16369it [02:07, 173.55it/s]16389it [02:07, 180.72it/s]16408it [02:08, 169.11it/s]16426it [02:08, 149.19it/s]16442it [02:08, 150.44it/s]16458it [02:08, 138.60it/s]16474it [02:08, 141.85it/s]16489it [02:08, 139.06it/s]16509it [02:08, 155.20it/s]16525it [02:08, 153.42it/s]16541it [02:09, 151.62it/s]16560it [02:09, 160.43it/s]16577it [02:09, 123.20it/s]16591it [02:09, 102.75it/s]16603it [02:09, 95.50it/s] 16615it [02:09, 98.77it/s]16626it [02:09, 88.95it/s]16637it [02:10, 93.40it/s]16650it [02:10, 99.33it/s]16665it [02:10, 109.38it/s]16677it [02:10, 110.41it/s]16689it [02:10, 112.25it/s]16706it [02:10, 125.22it/s]16719it [02:10, 107.18it/s]16731it [02:10, 105.34it/s]16753it [02:10, 133.01it/s]16776it [02:11, 155.21it/s]16793it [02:11, 145.22it/s]16809it [02:11, 147.50it/s]16829it [02:11, 157.58it/s]16846it [02:11, 158.23it/s]16863it [02:11, 145.79it/s]16878it [02:11, 133.46it/s]16893it [02:11, 134.84it/s]16907it [02:12, 124.00it/s]16920it [02:12, 107.72it/s]16934it [02:12, 114.84it/s]16951it [02:12, 128.67it/s]16967it [02:12, 135.09it/s]16986it [02:12, 148.23it/s]17004it [02:12, 154.84it/s]17020it [02:12, 153.31it/s]17036it [02:13, 143.16it/s]17053it [02:13, 140.75it/s]17070it [02:13, 144.58it/s]17095it [02:13, 171.43it/s]17113it [02:13, 163.57it/s]17132it [02:13, 166.81it/s]17149it [02:13, 163.62it/s]17166it [02:13, 140.03it/s]17181it [02:13, 141.06it/s]17196it [02:14, 129.91it/s]17215it [02:14, 139.71it/s]17230it [02:14, 108.62it/s]17245it [02:14, 115.39it/s]17264it [02:14, 132.91it/s]17279it [02:14, 136.02it/s]17295it [02:14, 141.25it/s]17311it [02:14, 146.03it/s]17327it [02:15, 142.53it/s]17347it [02:15, 157.98it/s]17364it [02:15, 155.70it/s]17383it [02:15, 164.08it/s]17400it [02:15, 104.53it/s]17414it [02:15, 102.74it/s]17428it [02:15, 110.05it/s]17443it [02:16, 114.76it/s]17461it [02:16, 130.20it/s]17476it [02:16, 127.81it/s]17505it [02:16, 169.13it/s]17524it [02:16, 164.99it/s]17542it [02:16, 163.91it/s]17560it [02:16, 167.87it/s]17585it [02:16, 189.27it/s]17605it [02:16, 170.54it/s]17624it [02:17, 168.53it/s]17642it [02:17, 158.30it/s]17659it [02:17, 148.30it/s]17675it [02:17, 142.11it/s]17690it [02:17, 87.48it/s] 17702it [02:17, 91.37it/s]17714it [02:18, 95.96it/s]17729it [02:18, 107.77it/s]17747it [02:18, 119.04it/s]17761it [02:18, 123.56it/s]17779it [02:18, 134.30it/s]17797it [02:18, 144.22it/s]17813it [02:18, 130.62it/s]17827it [02:18, 106.41it/s]17839it [02:19, 94.88it/s] 17851it [02:19, 100.23it/s]17862it [02:19, 90.14it/s] 17872it [02:19, 85.76it/s]17887it [02:19, 96.28it/s]17898it [02:19, 96.47it/s]17914it [02:19, 109.78it/s]17926it [02:19, 112.35it/s]17938it [02:20, 110.47it/s]17958it [02:20, 133.68it/s]17972it [02:20, 130.07it/s]17991it [02:20, 143.78it/s]18006it [02:20, 144.40it/s]18025it [02:20, 155.59it/s]18041it [02:20, 149.92it/s]18058it [02:20, 139.93it/s]18073it [02:20, 135.54it/s]18087it [02:21, 135.82it/s]18101it [02:21, 134.44it/s]18125it [02:21, 161.73it/s]18142it [02:21, 149.81it/s]18162it [02:21, 159.28it/s]18179it [02:21, 159.37it/s]18196it [02:21, 161.19it/s]18213it [02:21, 160.47it/s]18230it [02:21, 151.28it/s]18246it [02:22, 148.45it/s]18261it [02:22, 129.98it/s]18275it [02:22, 126.25it/s]18288it [02:22, 111.47it/s]18301it [02:22, 114.67it/s]18313it [02:22, 106.73it/s]18324it [02:22, 104.97it/s]18336it [02:22, 105.74it/s]18347it [02:23, 95.14it/s] 18364it [02:23, 111.95it/s]18376it [02:23, 113.34it/s]18388it [02:23, 112.90it/s]18409it [02:23, 138.96it/s]18430it [02:23, 154.89it/s]18446it [02:23, 154.32it/s]18466it [02:23, 166.82it/s]18483it [02:24, 131.46it/s]18505it [02:24, 149.12it/s]18525it [02:24, 157.16it/s]18548it [02:24, 169.79it/s]18566it [02:24, 153.97it/s]18583it [02:24, 150.34it/s]18604it [02:24, 162.15it/s]18621it [02:24, 149.02it/s]18639it [02:24, 156.52it/s]18656it [02:25, 153.76it/s]18672it [02:25, 153.67it/s]18688it [02:25, 109.34it/s]18701it [02:25, 103.91it/s]18713it [02:25, 95.87it/s] 18728it [02:25, 106.42it/s]18740it [02:25, 106.75it/s]18755it [02:26, 116.60it/s]18773it [02:26, 125.24it/s]18789it [02:26, 133.85it/s]18809it [02:26, 151.44it/s]18825it [02:26, 126.13it/s]18844it [02:26, 140.70it/s]18861it [02:26, 147.02it/s]18877it [02:26, 144.45it/s]18898it [02:27, 157.39it/s]18922it [02:27, 178.71it/s]18942it [02:27, 184.21it/s]18970it [02:27, 202.79it/s]18993it [02:27, 209.12it/s]19015it [02:27, 207.43it/s]19036it [02:27, 180.25it/s]19055it [02:27, 164.79it/s]19073it [02:28, 143.37it/s]19089it [02:28, 105.03it/s]19102it [02:28, 107.91it/s]19115it [02:28, 107.48it/s]19132it [02:28, 120.62it/s]19148it [02:28, 129.11it/s]19162it [02:28, 125.13it/s]19176it [02:29, 96.55it/s] 19188it [02:29, 101.06it/s]19203it [02:29, 109.24it/s]19228it [02:29, 140.99it/s]19244it [02:29, 138.62it/s]19259it [02:29, 91.49it/s] 19275it [02:29, 103.75it/s]19288it [02:30, 108.64it/s]19306it [02:30, 124.38it/s]19326it [02:30, 138.23it/s]19342it [02:30, 135.20it/s]19357it [02:30, 134.44it/s]19372it [02:30, 131.39it/s]19386it [02:30, 131.63it/s]19400it [02:30, 122.43it/s]19415it [02:30, 129.59it/s]19429it [02:31, 125.49it/s]19443it [02:31, 128.10it/s]19457it [02:31, 121.13it/s]19473it [02:31, 130.96it/s]19494it [02:31, 151.85it/s]19510it [02:31, 147.49it/s]19526it [02:31, 141.53it/s]19541it [02:31, 142.12it/s]19556it [02:31, 133.49it/s]19570it [02:32, 129.08it/s]19586it [02:32, 136.46it/s]19606it [02:32, 148.10it/s]19621it [02:32, 137.88it/s]19635it [02:32, 137.64it/s]19649it [02:32, 116.02it/s]19665it [02:32, 118.16it/s]19683it [02:32, 133.00it/s]19698it [02:33, 137.08it/s]19713it [02:33, 114.09it/s]19726it [02:33, 114.07it/s]19740it [02:33, 119.06it/s]19754it [02:33, 123.87it/s]19767it [02:33, 123.69it/s]19780it [02:33, 124.47it/s]19794it [02:33, 128.80it/s]19808it [02:33, 129.79it/s]19824it [02:34, 137.93it/s]19840it [02:34, 136.90it/s]19854it [02:34, 124.38it/s]19870it [02:34, 133.79it/s]19884it [02:34, 131.12it/s]19898it [02:34, 127.13it/s]19913it [02:34, 131.68it/s]19919it [02:34, 128.69it/s]
Mode:  train  Number of examples:  10355
Number of positives:  1129
Number of negatives:  9226
0it [00:00, ?it/s]132it [00:00, 1303.96it/s]263it [00:00, 1246.64it/s]388it [00:00, 1239.79it/s]513it [00:00, 1237.37it/s]637it [00:00, 1208.35it/s]758it [00:00, 1105.10it/s]875it [00:00, 1122.93it/s]992it [00:00, 1134.97it/s]1110it [00:00, 1148.03it/s]1226it [00:01, 1150.99it/s]1346it [00:01, 1164.04it/s]1470it [00:01, 1186.01it/s]1589it [00:01, 1168.67it/s]1707it [00:01, 1132.46it/s]1828it [00:01, 1154.68it/s]1944it [00:01, 1113.38it/s]2056it [00:01, 1103.07it/s]2178it [00:01, 1136.49it/s]2307it [00:01, 1180.27it/s]2426it [00:02, 1168.93it/s]2547it [00:02, 1180.25it/s]2678it [00:02, 1214.88it/s]2800it [00:02, 1214.46it/s]2922it [00:02, 1191.11it/s]3042it [00:02, 1142.63it/s]3157it [00:02, 1105.79it/s]3269it [00:02, 1056.80it/s]3376it [00:02, 966.86it/s] 3475it [00:03, 859.33it/s]3564it [00:03, 799.86it/s]3647it [00:03, 774.84it/s]3749it [00:03, 835.05it/s]3863it [00:03, 913.91it/s]3969it [00:03, 953.35it/s]4075it [00:03, 980.58it/s]4185it [00:03, 1014.63it/s]4300it [00:03, 1049.77it/s]4426it [00:04, 1107.51it/s]4555it [00:04, 1158.04it/s]4690it [00:04, 1213.17it/s]4819it [00:04, 1235.45it/s]4943it [00:04, 1232.06it/s]5067it [00:04, 1171.52it/s]5185it [00:04, 1166.61it/s]5303it [00:04, 1126.67it/s]5417it [00:04, 1116.94it/s]5531it [00:05, 1123.23it/s]5644it [00:05, 1074.19it/s]5752it [00:05, 1047.97it/s]5862it [00:05, 1062.10it/s]5972it [00:05, 1072.40it/s]6080it [00:05, 1063.84it/s]6202it [00:05, 1109.17it/s]6333it [00:05, 1166.51it/s]6450it [00:05, 1136.63it/s]6565it [00:05, 1139.71it/s]6680it [00:06, 1134.95it/s]6795it [00:06, 1138.93it/s]6910it [00:06, 1094.66it/s]7040it [00:06, 1151.94it/s]7168it [00:06, 1188.14it/s]7299it [00:06, 1219.48it/s]7422it [00:06, 1182.63it/s]7541it [00:06, 1174.76it/s]7659it [00:06, 1154.79it/s]7775it [00:07, 1139.97it/s]7890it [00:07, 1130.44it/s]8005it [00:07, 1134.33it/s]8119it [00:07, 1116.02it/s]8235it [00:07, 1127.04it/s]8348it [00:07, 1105.67it/s]8459it [00:07, 1088.87it/s]8575it [00:07, 1108.12it/s]8693it [00:07, 1129.04it/s]8807it [00:07, 1130.74it/s]8924it [00:08, 1141.18it/s]9039it [00:08, 1124.14it/s]9157it [00:08, 1138.26it/s]9275it [00:08, 1146.51it/s]9395it [00:08, 1160.63it/s]9512it [00:08, 1119.08it/s]9625it [00:08, 1039.19it/s]9750it [00:08, 1095.22it/s]9889it [00:08, 1175.16it/s]10022it [00:08, 1219.42it/s]10151it [00:09, 1239.51it/s]10279it [00:09, 1248.64it/s]10405it [00:09, 1242.67it/s]10530it [00:09, 1209.00it/s]10652it [00:09, 1209.60it/s]10775it [00:09, 1212.77it/s]10897it [00:09, 1189.18it/s]11017it [00:09, 1145.78it/s]11136it [00:09, 1157.48it/s]11257it [00:10, 1171.66it/s]11375it [00:10, 1117.36it/s]11500it [00:10, 1154.20it/s]11633it [00:10, 1204.55it/s]11755it [00:10, 1147.22it/s]11871it [00:10, 1142.35it/s]11993it [00:10, 1161.51it/s]12110it [00:10, 1163.19it/s]12227it [00:10, 1157.75it/s]12344it [00:10, 1148.96it/s]12466it [00:11, 1169.35it/s]12592it [00:11, 1193.44it/s]12712it [00:11, 1153.19it/s]12841it [00:11, 1192.36it/s]12981it [00:11, 1250.84it/s]13121it [00:11, 1290.67it/s]13251it [00:11, 1282.28it/s]13383it [00:11, 1290.67it/s]13520it [00:11, 1312.13it/s]13729it [00:11, 1541.78it/s]13954it [00:12, 1752.05it/s]14157it [00:12, 1833.69it/s]14390it [00:12, 1980.90it/s]14620it [00:12, 2075.09it/s]14857it [00:12, 2162.82it/s]15106it [00:12, 2259.16it/s]15333it [00:12, 2248.60it/s]15573it [00:12, 2292.72it/s]15810it [00:12, 2315.16it/s]16059it [00:12, 2364.39it/s]16296it [00:13, 2325.26it/s]16530it [00:13, 2328.45it/s]16763it [00:13, 2292.58it/s]16993it [00:13, 2189.10it/s]17233it [00:13, 2246.70it/s]17459it [00:13, 2225.63it/s]17683it [00:13, 2127.69it/s]17911it [00:13, 2170.64it/s]18153it [00:13, 2242.24it/s]18414it [00:14, 2348.87it/s]18670it [00:14, 2409.40it/s]18926it [00:14, 2453.88it/s]19179it [00:14, 2474.34it/s]19427it [00:14, 2452.80it/s]19673it [00:14, 2388.83it/s]19913it [00:14, 2363.65it/s]19919it [00:14, 1358.67it/s]
Mode:  val  Number of examples:  1152
Number of positives:  126
Number of negatives:  1026
0it [00:00, ?it/s]31it [00:00, 291.38it/s]71it [00:00, 353.32it/s]121it [00:00, 415.94it/s]173it [00:00, 456.28it/s]240it [00:00, 519.14it/s]292it [00:00, 507.41it/s]345it [00:00, 512.14it/s]400it [00:00, 522.01it/s]453it [00:01, 418.65it/s]506it [00:01, 445.32it/s]574it [00:01, 506.35it/s]628it [00:01, 455.19it/s]686it [00:01, 486.38it/s]755it [00:01, 538.18it/s]811it [00:01, 532.61it/s]866it [00:01, 522.87it/s]920it [00:01, 396.94it/s]973it [00:02, 420.67it/s]1020it [00:02, 418.74it/s]1080it [00:02, 461.54it/s]1129it [00:02, 461.85it/s]1185it [00:02, 487.20it/s]1243it [00:02, 510.04it/s]1308it [00:02, 545.22it/s]1373it [00:02, 572.48it/s]1432it [00:02, 568.26it/s]1490it [00:03, 522.06it/s]1544it [00:03, 521.49it/s]1610it [00:03, 554.12it/s]1672it [00:03, 568.13it/s]1732it [00:03, 575.92it/s]1790it [00:03, 530.42it/s]1849it [00:03, 546.73it/s]1905it [00:03, 441.51it/s]1953it [00:04, 412.46it/s]2000it [00:04, 425.59it/s]2045it [00:04, 345.82it/s]2084it [00:04, 231.50it/s]2130it [00:04, 270.36it/s]2165it [00:04, 249.55it/s]2210it [00:05, 289.20it/s]2245it [00:05, 272.22it/s]2283it [00:05, 295.99it/s]2343it [00:05, 366.45it/s]2418it [00:05, 463.00it/s]2469it [00:05, 462.31it/s]2519it [00:05, 471.49it/s]2576it [00:05, 482.49it/s]2626it [00:05, 425.96it/s]2671it [00:06, 396.62it/s]2718it [00:06, 414.15it/s]2761it [00:06, 397.27it/s]2808it [00:06, 416.10it/s]2851it [00:06, 411.77it/s]2893it [00:06, 388.63it/s]2939it [00:06, 407.57it/s]2999it [00:06, 460.01it/s]3046it [00:06, 445.89it/s]3102it [00:07, 475.12it/s]3165it [00:07, 511.93it/s]3220it [00:07, 521.39it/s]3286it [00:07, 561.54it/s]3343it [00:07, 561.46it/s]3405it [00:07, 575.23it/s]3472it [00:07, 601.65it/s]3533it [00:07, 541.59it/s]3589it [00:07, 516.81it/s]3646it [00:08, 530.73it/s]3700it [00:08, 528.61it/s]3754it [00:08, 499.25it/s]3805it [00:08, 428.56it/s]3862it [00:08, 462.44it/s]3912it [00:08, 469.29it/s]3961it [00:08, 438.23it/s]4007it [00:08, 424.49it/s]4058it [00:08, 446.78it/s]4112it [00:09, 469.71it/s]4160it [00:09, 470.86it/s]4212it [00:09, 484.20it/s]4268it [00:09, 500.73it/s]4319it [00:09, 391.03it/s]4376it [00:09, 433.16it/s]4423it [00:09, 420.56it/s]4476it [00:09, 444.94it/s]4523it [00:10, 440.01it/s]4569it [00:10, 421.17it/s]4613it [00:10, 340.03it/s]4666it [00:10, 377.57it/s]4707it [00:10, 362.10it/s]4748it [00:10, 371.70it/s]4791it [00:10, 383.67it/s]4848it [00:10, 430.63it/s]4893it [00:10, 433.11it/s]4951it [00:11, 473.58it/s]5000it [00:11, 357.87it/s]5041it [00:11, 317.60it/s]5083it [00:11, 307.70it/s]5117it [00:11, 271.24it/s]5162it [00:11, 309.39it/s]5216it [00:12, 362.95it/s]5289it [00:12, 451.61it/s]5352it [00:12, 495.94it/s]5413it [00:12, 525.03it/s]5482it [00:12, 568.14it/s]5541it [00:12, 529.89it/s]5608it [00:12, 564.89it/s]5668it [00:12, 573.13it/s]5731it [00:12, 583.97it/s]5791it [00:13, 428.95it/s]5841it [00:13, 430.05it/s]5889it [00:13, 427.71it/s]5939it [00:13, 444.96it/s]5991it [00:13, 463.90it/s]6040it [00:13, 413.97it/s]6084it [00:13, 416.78it/s]6128it [00:13, 406.18it/s]6170it [00:13, 395.24it/s]6222it [00:14, 425.23it/s]6266it [00:14, 422.69it/s]6309it [00:14, 381.76it/s]6349it [00:14, 305.08it/s]6401it [00:14, 351.58it/s]6440it [00:14, 347.91it/s]6487it [00:14, 377.14it/s]6527it [00:15, 318.85it/s]6562it [00:15, 320.38it/s]6597it [00:15, 322.73it/s]6652it [00:15, 363.83it/s]6690it [00:15, 347.90it/s]6726it [00:15, 319.70it/s]6773it [00:15, 327.18it/s]6824it [00:15, 366.70it/s]6863it [00:15, 367.54it/s]6920it [00:16, 419.54it/s]6963it [00:16, 325.76it/s]7000it [00:16, 324.60it/s]7036it [00:16, 288.66it/s]7068it [00:16, 265.91it/s]7118it [00:16, 310.94it/s]7152it [00:17, 215.41it/s]7189it [00:17, 241.04it/s]7231it [00:17, 278.57it/s]7264it [00:17, 281.88it/s]7311it [00:17, 325.34it/s]7355it [00:17, 351.85it/s]7410it [00:17, 402.35it/s]7480it [00:17, 482.71it/s]7531it [00:17, 488.82it/s]7598it [00:18, 528.43it/s]7655it [00:18, 540.04it/s]7717it [00:18, 546.28it/s]7773it [00:18, 536.11it/s]7828it [00:18, 457.31it/s]7876it [00:18, 430.20it/s]7921it [00:18, 429.68it/s]7985it [00:18, 483.26it/s]8045it [00:18, 513.54it/s]8098it [00:19, 517.32it/s]8151it [00:19, 470.41it/s]8203it [00:19, 483.62it/s]8261it [00:19, 506.90it/s]8313it [00:19, 458.09it/s]8361it [00:19, 413.98it/s]8404it [00:19, 353.43it/s]8447it [00:19, 369.15it/s]8493it [00:20, 388.73it/s]8534it [00:20, 390.90it/s]8575it [00:20, 335.29it/s]8628it [00:20, 382.99it/s]8679it [00:20, 412.66it/s]8731it [00:20, 439.65it/s]8777it [00:20, 430.97it/s]8842it [00:20, 489.17it/s]8893it [00:21, 457.85it/s]8941it [00:21, 436.85it/s]9008it [00:21, 493.72it/s]9068it [00:21, 522.75it/s]9122it [00:21, 452.99it/s]9170it [00:21, 448.19it/s]9224it [00:21, 472.11it/s]9273it [00:21, 374.83it/s]9320it [00:22, 396.83it/s]9376it [00:22, 432.58it/s]9451it [00:22, 515.43it/s]9507it [00:22, 519.24it/s]9589it [00:22, 602.22it/s]9652it [00:22, 552.40it/s]9710it [00:22, 376.93it/s]9757it [00:22, 383.79it/s]9802it [00:23, 363.64it/s]9846it [00:23, 377.26it/s]9894it [00:23, 401.05it/s]9945it [00:23, 425.59it/s]9991it [00:23, 427.53it/s]10046it [00:23, 460.07it/s]10101it [00:23, 476.70it/s]10150it [00:23, 452.35it/s]10197it [00:23, 430.63it/s]10260it [00:24, 479.70it/s]10309it [00:24, 474.35it/s]10358it [00:24, 471.84it/s]10419it [00:24, 505.51it/s]10470it [00:24, 420.34it/s]10516it [00:24, 428.22it/s]10561it [00:24, 415.50it/s]10620it [00:24, 460.84it/s]10668it [00:24, 451.85it/s]10718it [00:25, 461.63it/s]10781it [00:25, 508.52it/s]10833it [00:25, 478.45it/s]10891it [00:25, 501.52it/s]10942it [00:25, 484.64it/s]10995it [00:25, 492.68it/s]11045it [00:25, 473.13it/s]11095it [00:25, 480.07it/s]11144it [00:25, 458.50it/s]11202it [00:26, 491.86it/s]11256it [00:26, 504.80it/s]11325it [00:26, 554.09it/s]11397it [00:26, 601.89it/s]11458it [00:26, 534.95it/s]11514it [00:26, 513.14it/s]11567it [00:26, 468.89it/s]11616it [00:26, 473.91it/s]11667it [00:26, 483.50it/s]11745it [00:27, 565.19it/s]11803it [00:27, 519.13it/s]11871it [00:27, 561.06it/s]11932it [00:27, 571.72it/s]11991it [00:27, 559.67it/s]12048it [00:27, 557.31it/s]12110it [00:27, 573.85it/s]12170it [00:27, 580.24it/s]12229it [00:27, 559.48it/s]12286it [00:28, 541.16it/s]12355it [00:28, 577.75it/s]12414it [00:28, 570.25it/s]12472it [00:28, 537.81it/s]12527it [00:28, 497.82it/s]12578it [00:28, 344.80it/s]12647it [00:28, 415.44it/s]12708it [00:28, 459.78it/s]12766it [00:29, 487.64it/s]12821it [00:29, 499.02it/s]12875it [00:29, 294.84it/s]12917it [00:29, 272.07it/s]12953it [00:29, 284.42it/s]12989it [00:30, 275.08it/s]13039it [00:30, 321.83it/s]13089it [00:30, 362.89it/s]13136it [00:30, 385.59it/s]13179it [00:30, 368.46it/s]13219it [00:30, 372.15it/s]13293it [00:30, 469.73it/s]13351it [00:30, 497.41it/s]13403it [00:30, 438.95it/s]13450it [00:31, 398.97it/s]13493it [00:31, 368.87it/s]13532it [00:31, 356.15it/s]13575it [00:31, 372.05it/s]13620it [00:31, 391.75it/s]13661it [00:31, 395.30it/s]13724it [00:31, 457.48it/s]13781it [00:31, 485.71it/s]13831it [00:31, 460.04it/s]13878it [00:32, 448.11it/s]13930it [00:32, 464.99it/s]13983it [00:32, 482.86it/s]14056it [00:32, 552.06it/s]14124it [00:32, 589.15it/s]14184it [00:32, 579.57it/s]14243it [00:32, 582.40it/s]14302it [00:32, 576.27it/s]14360it [00:32, 537.12it/s]14429it [00:33, 577.58it/s]14488it [00:33, 572.42it/s]14546it [00:33, 541.23it/s]14601it [00:33, 518.55it/s]14677it [00:33, 580.53it/s]14750it [00:33, 619.69it/s]14813it [00:33, 601.35it/s]14874it [00:33, 575.14it/s]14942it [00:33, 596.09it/s]15003it [00:34, 566.86it/s]15061it [00:34, 474.26it/s]15112it [00:34, 448.28it/s]15161it [00:34, 454.39it/s]15208it [00:34, 418.22it/s]15252it [00:34, 279.14it/s]15317it [00:34, 350.07it/s]15376it [00:35, 399.52it/s]15424it [00:35, 388.50it/s]15492it [00:35, 453.48it/s]15543it [00:35, 316.15it/s]15584it [00:35, 306.61it/s]15622it [00:35, 320.53it/s]15660it [00:35, 325.37it/s]15709it [00:36, 360.42it/s]15765it [00:36, 410.53it/s]15826it [00:36, 461.22it/s]15876it [00:36, 444.54it/s]15931it [00:36, 469.33it/s]15980it [00:36, 445.20it/s]16026it [00:36, 448.67it/s]16088it [00:36, 493.56it/s]16141it [00:36, 500.43it/s]16192it [00:37, 500.07it/s]16251it [00:37, 521.42it/s]16308it [00:37, 527.82it/s]16362it [00:37, 512.71it/s]16426it [00:37, 544.96it/s]16500it [00:37, 598.75it/s]16567it [00:37, 615.86it/s]16641it [00:37, 647.21it/s]16706it [00:37, 627.59it/s]16772it [00:37, 632.60it/s]16836it [00:38, 503.38it/s]16891it [00:38, 485.57it/s]16943it [00:38, 459.93it/s]16999it [00:38, 484.78it/s]17050it [00:38, 473.47it/s]17099it [00:38, 453.00it/s]17146it [00:38, 418.07it/s]17189it [00:38, 405.38it/s]17239it [00:39, 426.08it/s]17287it [00:39, 440.37it/s]17347it [00:39, 479.24it/s]17396it [00:39, 462.13it/s]17454it [00:39, 493.90it/s]17504it [00:39, 489.55it/s]17554it [00:39, 487.26it/s]17603it [00:39, 432.51it/s]17654it [00:39, 450.39it/s]17707it [00:40, 469.57it/s]17768it [00:40, 505.91it/s]17824it [00:40, 521.08it/s]17879it [00:40, 522.28it/s]17936it [00:40, 534.65it/s]17994it [00:40, 542.79it/s]18049it [00:40, 538.08it/s]18103it [00:40, 520.49it/s]18156it [00:40, 491.68it/s]18206it [00:41, 467.13it/s]18254it [00:41, 469.16it/s]18303it [00:41, 474.74it/s]18352it [00:41, 478.15it/s]18403it [00:41, 485.48it/s]18461it [00:41, 510.40it/s]18513it [00:41, 338.31it/s]18555it [00:41, 334.77it/s]18594it [00:42, 345.33it/s]18633it [00:42, 319.83it/s]18668it [00:42, 277.60it/s]18699it [00:42, 265.50it/s]18728it [00:42, 249.84it/s]18755it [00:42, 252.35it/s]18782it [00:42, 248.47it/s]18813it [00:42, 261.06it/s]18840it [00:43, 260.98it/s]18879it [00:43, 294.34it/s]18911it [00:43, 300.27it/s]18960it [00:43, 353.73it/s]19006it [00:43, 382.37it/s]19067it [00:43, 442.09it/s]19120it [00:43, 456.80it/s]19166it [00:43, 394.85it/s]19208it [00:43, 393.01it/s]19263it [00:44, 301.89it/s]19298it [00:44, 310.67it/s]19333it [00:44, 308.10it/s]19367it [00:44, 311.82it/s]19407it [00:44, 328.85it/s]19447it [00:44, 347.38it/s]19519it [00:44, 447.13it/s]19568it [00:44, 457.70it/s]19646it [00:45, 548.17it/s]19710it [00:45, 570.98it/s]19771it [00:45, 565.63it/s]19829it [00:45, 506.04it/s]19882it [00:45, 480.95it/s]19919it [00:45, 436.75it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:108: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(config.model.checkpoint_path, map_location='cpu')
/home/conradb/git/ifg-ssl/MAE/utils.py:11: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self._scaler = torch.cuda.amp.GradScaler()
Mode:  test  Number of examples:  8386
Number of positives:  560
Number of negatives:  7826
Load pre-trained checkpoint from: checkpoints/Hephaestus_MAE_VitB16_224_no_os_norm_1000e_60msk_1-5e4lr.pth
_IncompatibleKeys(missing_keys=['head.weight', 'head.bias'], unexpected_keys=['mask_token', 'decoder_pos_embed', 'decoder_embed.weight', 'decoder_embed.bias', 'decoder_blocks.0.norm1.weight', 'decoder_blocks.0.norm1.bias', 'decoder_blocks.0.attn.qkv.weight', 'decoder_blocks.0.attn.qkv.bias', 'decoder_blocks.0.attn.proj.weight', 'decoder_blocks.0.attn.proj.bias', 'decoder_blocks.0.norm2.weight', 'decoder_blocks.0.norm2.bias', 'decoder_blocks.0.mlp.fc1.weight', 'decoder_blocks.0.mlp.fc1.bias', 'decoder_blocks.0.mlp.fc2.weight', 'decoder_blocks.0.mlp.fc2.bias', 'decoder_blocks.1.norm1.weight', 'decoder_blocks.1.norm1.bias', 'decoder_blocks.1.attn.qkv.weight', 'decoder_blocks.1.attn.qkv.bias', 'decoder_blocks.1.attn.proj.weight', 'decoder_blocks.1.attn.proj.bias', 'decoder_blocks.1.norm2.weight', 'decoder_blocks.1.norm2.bias', 'decoder_blocks.1.mlp.fc1.weight', 'decoder_blocks.1.mlp.fc1.bias', 'decoder_blocks.1.mlp.fc2.weight', 'decoder_blocks.1.mlp.fc2.bias', 'decoder_blocks.2.norm1.weight', 'decoder_blocks.2.norm1.bias', 'decoder_blocks.2.attn.qkv.weight', 'decoder_blocks.2.attn.qkv.bias', 'decoder_blocks.2.attn.proj.weight', 'decoder_blocks.2.attn.proj.bias', 'decoder_blocks.2.norm2.weight', 'decoder_blocks.2.norm2.bias', 'decoder_blocks.2.mlp.fc1.weight', 'decoder_blocks.2.mlp.fc1.bias', 'decoder_blocks.2.mlp.fc2.weight', 'decoder_blocks.2.mlp.fc2.bias', 'decoder_blocks.3.norm1.weight', 'decoder_blocks.3.norm1.bias', 'decoder_blocks.3.attn.qkv.weight', 'decoder_blocks.3.attn.qkv.bias', 'decoder_blocks.3.attn.proj.weight', 'decoder_blocks.3.attn.proj.bias', 'decoder_blocks.3.norm2.weight', 'decoder_blocks.3.norm2.bias', 'decoder_blocks.3.mlp.fc1.weight', 'decoder_blocks.3.mlp.fc1.bias', 'decoder_blocks.3.mlp.fc2.weight', 'decoder_blocks.3.mlp.fc2.bias', 'decoder_blocks.4.norm1.weight', 'decoder_blocks.4.norm1.bias', 'decoder_blocks.4.attn.qkv.weight', 'decoder_blocks.4.attn.qkv.bias', 'decoder_blocks.4.attn.proj.weight', 'decoder_blocks.4.attn.proj.bias', 'decoder_blocks.4.norm2.weight', 'decoder_blocks.4.norm2.bias', 'decoder_blocks.4.mlp.fc1.weight', 'decoder_blocks.4.mlp.fc1.bias', 'decoder_blocks.4.mlp.fc2.weight', 'decoder_blocks.4.mlp.fc2.bias', 'decoder_blocks.5.norm1.weight', 'decoder_blocks.5.norm1.bias', 'decoder_blocks.5.attn.qkv.weight', 'decoder_blocks.5.attn.qkv.bias', 'decoder_blocks.5.attn.proj.weight', 'decoder_blocks.5.attn.proj.bias', 'decoder_blocks.5.norm2.weight', 'decoder_blocks.5.norm2.bias', 'decoder_blocks.5.mlp.fc1.weight', 'decoder_blocks.5.mlp.fc1.bias', 'decoder_blocks.5.mlp.fc2.weight', 'decoder_blocks.5.mlp.fc2.bias', 'decoder_blocks.6.norm1.weight', 'decoder_blocks.6.norm1.bias', 'decoder_blocks.6.attn.qkv.weight', 'decoder_blocks.6.attn.qkv.bias', 'decoder_blocks.6.attn.proj.weight', 'decoder_blocks.6.attn.proj.bias', 'decoder_blocks.6.norm2.weight', 'decoder_blocks.6.norm2.bias', 'decoder_blocks.6.mlp.fc1.weight', 'decoder_blocks.6.mlp.fc1.bias', 'decoder_blocks.6.mlp.fc2.weight', 'decoder_blocks.6.mlp.fc2.bias', 'decoder_blocks.7.norm1.weight', 'decoder_blocks.7.norm1.bias', 'decoder_blocks.7.attn.qkv.weight', 'decoder_blocks.7.attn.qkv.bias', 'decoder_blocks.7.attn.proj.weight', 'decoder_blocks.7.attn.proj.bias', 'decoder_blocks.7.norm2.weight', 'decoder_blocks.7.norm2.bias', 'decoder_blocks.7.mlp.fc1.weight', 'decoder_blocks.7.mlp.fc1.bias', 'decoder_blocks.7.mlp.fc2.weight', 'decoder_blocks.7.mlp.fc2.bias', 'decoder_norm.weight', 'decoder_norm.bias', 'decoder_pred.weight', 'decoder_pred.bias'])
Model = VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
    (norm): Identity()
  )
  (pos_drop): Dropout(p=0.0, inplace=False)
  (patch_drop): Identity()
  (norm_pre): Identity()
  (blocks): Sequential(
    (0): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): Identity()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): Identity()
    )
    (1): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.009)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.009)
    )
    (2): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.018)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.018)
    )
    (3): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.027)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.027)
    )
    (4): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.036)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.036)
    )
    (5): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.045)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.045)
    )
    (6): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.055)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.055)
    )
    (7): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.064)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.064)
    )
    (8): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.073)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.073)
    )
    (9): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.082)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.082)
    )
    (10): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.091)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.091)
    )
    (11): Block(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (q_norm): Identity()
        (k_norm): Identity()
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (ls1): Identity()
      (drop_path1): DropPath(drop_prob=0.100)
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.0, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.0, inplace=False)
      )
      (ls2): Identity()
      (drop_path2): DropPath(drop_prob=0.100)
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (fc_norm): Identity()
  (head_drop): Dropout(p=0.0, inplace=False)
  (head): Linear(in_features=768, out_features=2, bias=True)
)
number of params (M): 85.80
base lr: 1.00e-06
actual lr: 1.00e-06
Start training for 101 epochs
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:05<03:43,  5.74s/it]  5%|         | 2/40 [00:07<02:16,  3.58s/it]  8%|         | 3/40 [00:08<01:21,  2.21s/it] 10%|         | 4/40 [00:08<00:52,  1.45s/it] 12%|        | 5/40 [00:08<00:36,  1.03s/it] 15%|        | 6/40 [00:09<00:28,  1.21it/s] 18%|        | 7/40 [00:09<00:21,  1.54it/s] 20%|        | 8/40 [00:09<00:17,  1.87it/s] 22%|       | 9/40 [00:10<00:14,  2.19it/s] 25%|       | 10/40 [00:10<00:12,  2.47it/s] 28%|       | 11/40 [00:10<00:10,  2.71it/s] 30%|       | 12/40 [00:11<00:09,  2.91it/s] 32%|      | 13/40 [00:11<00:08,  3.06it/s] 35%|      | 14/40 [00:11<00:08,  3.18it/s] 38%|      | 15/40 [00:11<00:07,  3.27it/s] 40%|      | 16/40 [00:12<00:07,  3.33it/s] 42%|     | 17/40 [00:12<00:06,  3.38it/s] 45%|     | 18/40 [00:12<00:06,  3.41it/s] 48%|     | 19/40 [00:13<00:06,  3.43it/s] 50%|     | 20/40 [00:13<00:05,  3.45it/s] 52%|    | 21/40 [00:13<00:05,  3.43it/s] 55%|    | 22/40 [00:13<00:05,  3.44it/s] 57%|    | 23/40 [00:14<00:04,  3.46it/s] 60%|    | 24/40 [00:14<00:04,  3.47it/s] 62%|   | 25/40 [00:14<00:04,  3.47it/s] 65%|   | 26/40 [00:15<00:04,  3.48it/s] 68%|   | 27/40 [00:15<00:03,  3.48it/s] 70%|   | 28/40 [00:15<00:03,  3.48it/s] 72%|  | 29/40 [00:15<00:03,  3.49it/s] 75%|  | 30/40 [00:16<00:02,  3.49it/s] 78%|  | 31/40 [00:16<00:02,  3.48it/s] 80%|  | 32/40 [00:16<00:02,  3.49it/s] 82%| | 33/40 [00:17<00:02,  3.49it/s] 85%| | 34/40 [00:17<00:01,  3.49it/s] 88%| | 35/40 [00:17<00:01,  3.49it/s] 90%| | 36/40 [00:17<00:01,  3.49it/s] 92%|| 37/40 [00:18<00:00,  3.49it/s] 95%|| 38/40 [00:18<00:00,  3.49it/s] 98%|| 39/40 [00:18<00:00,  3.49it/s]100%|| 40/40 [00:19<00:00,  3.49it/s]100%|| 40/40 [00:19<00:00,  2.08it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:12,  1.59s/it] 22%|       | 2/9 [00:02<00:10,  1.44s/it] 44%|     | 4/9 [00:03<00:02,  1.67it/s] 78%|  | 7/9 [00:03<00:00,  3.54it/s]100%|| 9/9 [00:03<00:00,  2.63it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<05:07,  1.94it/s]  1%|         | 8/599 [00:00<00:37, 15.90it/s]  3%|         | 16/599 [00:00<00:19, 29.97it/s]  4%|         | 26/599 [00:00<00:12, 46.20it/s]  6%|         | 38/599 [00:00<00:08, 64.02it/s]  8%|         | 50/599 [00:01<00:06, 78.46it/s] 10%|         | 62/599 [00:01<00:06, 89.29it/s] 12%|        | 74/599 [00:01<00:05, 97.38it/s] 14%|        | 86/599 [00:01<00:04, 103.33it/s] 16%|        | 98/599 [00:01<00:04, 107.80it/s] 18%|        | 110/599 [00:01<00:04, 110.86it/s] 20%|        | 122/599 [00:01<00:04, 113.03it/s] 22%|       | 134/599 [00:01<00:04, 114.58it/s] 24%|       | 146/599 [00:01<00:03, 115.67it/s] 26%|       | 158/599 [00:01<00:03, 116.58it/s] 28%|       | 170/599 [00:02<00:03, 117.07it/s] 30%|       | 182/599 [00:02<00:03, 117.21it/s] 32%|      | 194/599 [00:02<00:03, 117.00it/s] 34%|      | 206/599 [00:02<00:03, 116.58it/s] 36%|      | 218/599 [00:02<00:03, 116.08it/s] 38%|      | 230/599 [00:02<00:03, 111.95it/s] 40%|      | 242/599 [00:02<00:03, 113.85it/s] 42%|     | 254/599 [00:02<00:02, 115.11it/s] 44%|     | 266/599 [00:02<00:03, 99.70it/s]  46%|     | 278/599 [00:03<00:03, 104.57it/s] 48%|     | 290/599 [00:03<00:02, 108.29it/s] 50%|     | 302/599 [00:03<00:02, 111.16it/s] 52%|    | 314/599 [00:03<00:02, 113.10it/s] 54%|    | 326/599 [00:03<00:02, 114.49it/s] 56%|    | 338/599 [00:03<00:02, 115.32it/s] 58%|    | 350/599 [00:03<00:02, 115.66it/s] 60%|    | 362/599 [00:03<00:02, 116.15it/s] 62%|   | 374/599 [00:03<00:01, 116.65it/s] 64%|   | 386/599 [00:04<00:02, 98.49it/s]  66%|   | 398/599 [00:04<00:01, 103.62it/s] 68%|   | 410/599 [00:04<00:01, 106.99it/s] 70%|   | 422/599 [00:04<00:01, 110.27it/s] 72%|  | 434/599 [00:04<00:01, 112.44it/s] 74%|  | 446/599 [00:04<00:01, 114.24it/s] 76%|  | 458/599 [00:04<00:01, 113.32it/s] 78%|  | 470/599 [00:04<00:01, 114.62it/s] 80%|  | 482/599 [00:04<00:01, 115.49it/s] 82%| | 494/599 [00:04<00:00, 116.37it/s] 84%| | 506/599 [00:05<00:00, 117.00it/s] 86%| | 518/599 [00:05<00:00, 117.10it/s] 88%| | 530/599 [00:05<00:00, 117.25it/s] 90%| | 542/599 [00:05<00:00, 117.47it/s] 92%|| 554/599 [00:05<00:00, 118.01it/s] 95%|| 567/599 [00:05<00:00, 118.73it/s] 97%|| 579/599 [00:05<00:00, 117.75it/s] 99%|| 592/599 [00:05<00:00, 119.10it/s]100%|| 599/599 [00:05<00:00, 100.76it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:228: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  ns_fpr, ns_tpr, _ = roc_curve(np.array(labels_list.cpu()), ns_probs)
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:229: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  lr_fpr, lr_tpr, _ = roc_curve(np.array(labels_list.cpu()), np.array(probs_list.detach().cpu()))
tensor([0.5000, 0.5000, 0.5000, 0.5000, 0.5000], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 0 of 101
train loss is 0.6931623220443726
val loss is 0.6929134792751737
test loss is 0.6929034611617584
validation accuracy is 89.40972222222223
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:04<02:48,  4.31s/it]  5%|         | 2/40 [00:05<01:42,  2.69s/it]  8%|         | 3/40 [00:06<00:58,  1.59s/it] 10%|         | 4/40 [00:06<00:38,  1.08s/it] 12%|        | 5/40 [00:06<00:27,  1.26it/s] 15%|        | 6/40 [00:07<00:21,  1.61it/s] 18%|        | 7/40 [00:07<00:16,  1.95it/s] 20%|        | 8/40 [00:07<00:14,  2.26it/s] 22%|       | 9/40 [00:07<00:12,  2.54it/s] 25%|       | 10/40 [00:08<00:10,  2.77it/s] 28%|       | 11/40 [00:08<00:09,  2.96it/s] 30%|       | 12/40 [00:08<00:09,  3.10it/s] 32%|      | 13/40 [00:09<00:08,  3.21it/s] 35%|      | 14/40 [00:09<00:07,  3.29it/s] 38%|      | 15/40 [00:09<00:07,  3.34it/s] 40%|      | 16/40 [00:09<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.46it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.48it/s] 78%|  | 31/40 [00:14<00:02,  3.48it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:15<00:01,  3.48it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.48it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.36it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:11,  1.41s/it] 22%|       | 2/9 [00:02<00:09,  1.38s/it] 44%|     | 4/9 [00:02<00:02,  1.82it/s] 78%|  | 7/9 [00:03<00:00,  3.82it/s]100%|| 9/9 [00:03<00:00,  2.82it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:35,  3.85it/s]  0%|          | 2/599 [00:00<01:56,  5.13it/s]  2%|         | 14/599 [00:00<00:14, 39.61it/s]  4%|         | 26/599 [00:00<00:09, 63.59it/s]  6%|         | 37/599 [00:00<00:07, 76.66it/s]  8%|         | 48/599 [00:00<00:06, 86.20it/s] 10%|         | 60/599 [00:00<00:05, 96.00it/s] 12%|        | 71/599 [00:01<00:05, 95.08it/s] 14%|        | 82/599 [00:01<00:05, 87.05it/s] 16%|        | 94/599 [00:01<00:05, 95.67it/s] 18%|        | 105/599 [00:01<00:05, 98.61it/s] 19%|        | 116/599 [00:01<00:05, 92.19it/s] 21%|       | 128/599 [00:01<00:04, 99.41it/s] 23%|       | 140/599 [00:01<00:04, 104.74it/s] 25%|       | 152/599 [00:01<00:04, 108.62it/s] 27%|       | 164/599 [00:01<00:03, 111.71it/s] 29%|       | 176/599 [00:02<00:03, 106.77it/s] 31%|      | 188/599 [00:02<00:03, 110.04it/s] 33%|      | 200/599 [00:02<00:03, 112.51it/s] 35%|      | 212/599 [00:02<00:03, 99.78it/s]  37%|      | 224/599 [00:02<00:03, 104.50it/s] 39%|      | 235/599 [00:02<00:03, 101.76it/s] 41%|      | 247/599 [00:02<00:03, 104.93it/s] 43%|     | 259/599 [00:02<00:03, 108.51it/s] 45%|     | 270/599 [00:03<00:03, 91.10it/s]  47%|     | 282/599 [00:03<00:03, 98.21it/s] 49%|     | 294/599 [00:03<00:02, 103.47it/s] 51%|     | 306/599 [00:03<00:02, 107.42it/s] 53%|    | 318/599 [00:03<00:02, 110.26it/s] 55%|    | 330/599 [00:03<00:02, 108.61it/s] 57%|    | 342/599 [00:03<00:02, 111.22it/s] 59%|    | 354/599 [00:03<00:02, 98.22it/s]  61%|    | 366/599 [00:03<00:02, 102.54it/s] 63%|   | 378/599 [00:03<00:02, 106.22it/s] 65%|   | 389/599 [00:04<00:02, 98.40it/s]  67%|   | 401/599 [00:04<00:01, 103.26it/s] 69%|   | 413/599 [00:04<00:01, 106.68it/s] 71%|   | 424/599 [00:04<00:01, 106.60it/s] 73%|  | 436/599 [00:04<00:01, 109.85it/s] 75%|  | 448/599 [00:04<00:01, 112.47it/s] 77%|  | 460/599 [00:04<00:01, 114.16it/s] 79%|  | 472/599 [00:04<00:01, 115.69it/s] 81%|  | 484/599 [00:04<00:00, 116.76it/s] 83%| | 496/599 [00:05<00:00, 116.96it/s] 85%| | 508/599 [00:05<00:00, 117.51it/s] 87%| | 520/599 [00:05<00:00, 117.95it/s] 89%| | 532/599 [00:05<00:00, 118.32it/s] 91%| | 544/599 [00:05<00:00, 118.49it/s] 93%|| 556/599 [00:05<00:00, 118.93it/s] 95%|| 569/599 [00:05<00:00, 119.55it/s] 97%|| 582/599 [00:05<00:00, 120.09it/s] 99%|| 595/599 [00:05<00:00, 120.54it/s]100%|| 599/599 [00:05<00:00, 100.12it/s]
tensor([0.4998, 0.5000, 0.4998, 0.5000, 0.4998], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 1 of 101
train loss is 0.6928404569625854
val loss is 0.6922654045952691
test loss is 0.6924758582361951
validation accuracy is 80.03472222222223
test accuracy is 92.96446962945649
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<02:57,  4.55s/it]  5%|         | 2/40 [00:05<01:41,  2.66s/it]  8%|         | 3/40 [00:06<00:58,  1.58s/it] 10%|         | 4/40 [00:06<00:38,  1.07s/it] 12%|        | 5/40 [00:06<00:27,  1.27it/s] 15%|        | 6/40 [00:07<00:20,  1.62it/s] 18%|        | 7/40 [00:07<00:16,  1.96it/s] 20%|        | 8/40 [00:07<00:14,  2.27it/s] 22%|       | 9/40 [00:07<00:12,  2.55it/s] 25%|       | 10/40 [00:08<00:10,  2.78it/s] 28%|       | 11/40 [00:08<00:09,  2.96it/s] 30%|       | 12/40 [00:08<00:09,  3.10it/s] 32%|      | 13/40 [00:09<00:08,  3.21it/s] 35%|      | 14/40 [00:09<00:07,  3.29it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:09<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.41it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.49it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.37it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.42s/it] 22%|       | 2/9 [00:02<00:09,  1.38s/it] 56%|    | 5/9 [00:02<00:01,  2.34it/s] 89%| | 8/9 [00:03<00:00,  4.26it/s]100%|| 9/9 [00:03<00:00,  2.83it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:44,  3.64it/s]  0%|          | 2/599 [00:00<01:44,  5.71it/s]  2%|         | 13/599 [00:00<00:14, 39.43it/s]  4%|         | 25/599 [00:00<00:08, 63.84it/s]  6%|         | 35/599 [00:00<00:08, 69.86it/s]  8%|         | 46/599 [00:00<00:06, 79.86it/s]  9%|         | 56/599 [00:00<00:06, 85.05it/s] 11%|        | 68/599 [00:01<00:05, 93.58it/s] 13%|        | 78/599 [00:01<00:05, 88.56it/s] 15%|        | 88/599 [00:01<00:05, 85.56it/s] 17%|        | 100/599 [00:01<00:05, 92.96it/s] 18%|        | 110/599 [00:01<00:05, 85.13it/s] 20%|        | 119/599 [00:01<00:05, 85.37it/s] 22%|       | 131/599 [00:01<00:04, 93.80it/s] 24%|       | 141/599 [00:01<00:06, 70.66it/s] 25%|       | 151/599 [00:02<00:06, 73.09it/s] 27%|       | 163/599 [00:02<00:05, 83.75it/s] 29%|       | 173/599 [00:02<00:06, 67.70it/s] 31%|       | 185/599 [00:02<00:05, 78.78it/s] 33%|      | 197/599 [00:02<00:04, 87.69it/s] 35%|      | 209/599 [00:02<00:04, 93.90it/s] 37%|      | 220/599 [00:02<00:04, 82.59it/s] 38%|      | 230/599 [00:03<00:04, 84.41it/s] 40%|      | 242/599 [00:03<00:03, 92.39it/s] 42%|     | 252/599 [00:03<00:04, 77.57it/s] 44%|     | 264/599 [00:03<00:03, 86.32it/s] 46%|     | 276/599 [00:03<00:03, 93.21it/s] 48%|     | 288/599 [00:03<00:03, 99.72it/s] 50%|     | 300/599 [00:03<00:02, 104.53it/s] 52%|    | 311/599 [00:03<00:03, 79.56it/s]  54%|    | 323/599 [00:04<00:03, 88.50it/s] 56%|    | 335/599 [00:04<00:02, 96.07it/s] 58%|    | 347/599 [00:04<00:02, 101.94it/s] 60%|    | 359/599 [00:04<00:02, 106.34it/s] 62%|   | 371/599 [00:04<00:02, 109.75it/s] 64%|   | 383/599 [00:04<00:01, 111.97it/s] 66%|   | 395/599 [00:04<00:01, 112.57it/s] 68%|   | 407/599 [00:04<00:01, 114.35it/s] 70%|   | 419/599 [00:04<00:01, 115.18it/s] 72%|  | 431/599 [00:04<00:01, 116.27it/s] 74%|  | 443/599 [00:05<00:01, 116.52it/s] 76%|  | 455/599 [00:05<00:01, 117.01it/s] 78%|  | 467/599 [00:05<00:01, 117.23it/s] 80%|  | 479/599 [00:05<00:01, 115.12it/s] 82%| | 491/599 [00:05<00:00, 115.72it/s] 84%| | 503/599 [00:05<00:00, 114.96it/s] 86%| | 515/599 [00:05<00:00, 115.83it/s] 88%| | 527/599 [00:05<00:00, 116.54it/s] 90%| | 539/599 [00:05<00:00, 117.23it/s] 92%|| 551/599 [00:05<00:00, 117.18it/s] 94%|| 564/599 [00:06<00:00, 118.48it/s] 96%|| 577/599 [00:06<00:00, 119.54it/s] 98%|| 590/599 [00:06<00:00, 120.39it/s]100%|| 599/599 [00:06<00:00, 92.71it/s] 
tensor([0.4995, 0.4998, 0.4995, 0.5000, 0.4998], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 2 of 101
train loss is 0.6922284960746765
val loss is 0.6911833021375868
test loss is 0.6915942615579086
validation accuracy is 80.03472222222223
test accuracy is 92.59480574771837
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:06<03:55,  6.03s/it]  5%|         | 2/40 [00:06<01:40,  2.65s/it]  8%|         | 3/40 [00:06<00:58,  1.57s/it] 10%|         | 4/40 [00:06<00:38,  1.06s/it] 12%|        | 5/40 [00:07<00:27,  1.28it/s] 15%|        | 6/40 [00:07<00:20,  1.62it/s] 18%|        | 7/40 [00:07<00:16,  1.97it/s] 20%|        | 8/40 [00:08<00:14,  2.28it/s] 22%|       | 9/40 [00:08<00:12,  2.56it/s] 25%|       | 10/40 [00:08<00:10,  2.78it/s] 28%|       | 11/40 [00:08<00:09,  2.97it/s] 30%|       | 12/40 [00:09<00:09,  3.11it/s] 32%|      | 13/40 [00:09<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.29it/s] 38%|      | 15/40 [00:10<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:11<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:12<00:05,  3.47it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:13<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:14<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:15<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:16<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.31it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.47s/it] 22%|       | 2/9 [00:02<00:09,  1.42s/it] 56%|    | 5/9 [00:02<00:01,  2.29it/s] 89%| | 8/9 [00:03<00:00,  4.17it/s]100%|| 9/9 [00:03<00:00,  2.77it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:53,  3.44it/s]  1%|          | 7/599 [00:00<00:27, 21.49it/s]  2%|         | 14/599 [00:00<00:16, 36.05it/s]  4%|         | 26/599 [00:00<00:09, 61.49it/s]  6%|         | 38/599 [00:00<00:07, 78.45it/s]  8%|         | 49/599 [00:01<00:10, 54.82it/s] 10%|         | 61/599 [00:01<00:07, 67.88it/s] 12%|        | 73/599 [00:01<00:08, 63.16it/s] 14%|        | 85/599 [00:01<00:06, 74.35it/s] 16%|        | 97/599 [00:01<00:05, 84.26it/s] 18%|        | 107/599 [00:01<00:05, 82.86it/s] 20%|        | 118/599 [00:01<00:05, 88.86it/s] 22%|       | 130/599 [00:01<00:04, 96.52it/s] 24%|       | 142/599 [00:01<00:04, 102.16it/s] 26%|       | 153/599 [00:02<00:04, 100.31it/s] 28%|       | 165/599 [00:02<00:04, 104.32it/s] 30%|       | 177/599 [00:02<00:04, 100.11it/s] 32%|      | 189/599 [00:02<00:03, 105.02it/s] 34%|      | 201/599 [00:02<00:03, 108.86it/s] 36%|      | 213/599 [00:02<00:03, 111.54it/s] 38%|      | 225/599 [00:02<00:03, 113.34it/s] 40%|      | 237/599 [00:02<00:03, 106.30it/s] 41%|     | 248/599 [00:02<00:03, 107.24it/s] 43%|     | 260/599 [00:03<00:03, 109.96it/s] 45%|     | 272/599 [00:03<00:03, 94.11it/s]  47%|     | 284/599 [00:03<00:03, 99.90it/s] 49%|     | 296/599 [00:03<00:02, 104.81it/s] 51%|    | 308/599 [00:03<00:02, 108.31it/s] 53%|    | 320/599 [00:03<00:02, 111.05it/s] 55%|    | 332/599 [00:03<00:02, 112.99it/s] 57%|    | 344/599 [00:03<00:02, 114.45it/s] 59%|    | 356/599 [00:03<00:02, 115.64it/s] 61%|   | 368/599 [00:04<00:01, 116.35it/s] 63%|   | 380/599 [00:04<00:01, 116.78it/s] 65%|   | 392/599 [00:04<00:01, 117.15it/s] 67%|   | 404/599 [00:04<00:01, 115.48it/s] 69%|   | 416/599 [00:04<00:01, 114.64it/s] 71%|  | 428/599 [00:04<00:01, 114.91it/s] 73%|  | 440/599 [00:04<00:01, 114.80it/s] 75%|  | 452/599 [00:04<00:01, 115.59it/s] 77%|  | 464/599 [00:04<00:01, 116.16it/s] 79%|  | 476/599 [00:04<00:01, 116.68it/s] 81%| | 488/599 [00:05<00:00, 117.00it/s] 83%| | 500/599 [00:05<00:00, 116.40it/s] 85%| | 512/599 [00:05<00:00, 116.66it/s] 87%| | 524/599 [00:05<00:00, 116.79it/s] 89%| | 536/599 [00:05<00:00, 117.18it/s] 91%|| 548/599 [00:05<00:00, 116.60it/s] 93%|| 560/599 [00:05<00:00, 116.81it/s] 96%|| 573/599 [00:05<00:00, 117.99it/s] 98%|| 586/599 [00:05<00:00, 118.95it/s]100%|| 599/599 [00:06<00:00, 119.65it/s]100%|| 599/599 [00:06<00:00, 98.21it/s] 
tensor([0.4993, 0.4998, 0.4993, 0.5000, 0.4995], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 3 of 101
train loss is 0.6911535859107971
val loss is 0.689812978108724
test loss is 0.6905923108624695
validation accuracy is 80.03472222222223
test accuracy is 90.19795334040622
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:33,  5.48s/it]  5%|         | 2/40 [00:05<01:32,  2.43s/it]  8%|         | 3/40 [00:06<00:53,  1.45s/it] 10%|         | 4/40 [00:06<00:35,  1.01it/s] 12%|        | 5/40 [00:06<00:25,  1.36it/s] 15%|        | 6/40 [00:06<00:19,  1.71it/s] 18%|        | 7/40 [00:07<00:16,  2.05it/s] 20%|        | 8/40 [00:07<00:13,  2.36it/s] 22%|       | 9/40 [00:07<00:11,  2.63it/s] 25%|       | 10/40 [00:08<00:10,  2.84it/s] 28%|       | 11/40 [00:08<00:09,  3.01it/s] 30%|       | 12/40 [00:08<00:08,  3.14it/s] 32%|      | 13/40 [00:08<00:08,  3.24it/s] 35%|      | 14/40 [00:09<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:10<00:06,  3.43it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.48it/s] 92%|| 37/40 [00:15<00:00,  3.48it/s] 95%|| 38/40 [00:16<00:00,  3.48it/s] 98%|| 39/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:16<00:00,  2.38it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.46s/it] 22%|       | 2/9 [00:02<00:09,  1.38s/it] 56%|    | 5/9 [00:02<00:01,  2.35it/s] 89%| | 8/9 [00:03<00:00,  4.27it/s]100%|| 9/9 [00:03<00:00,  2.82it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:59,  2.50it/s]  2%|         | 12/599 [00:00<00:22, 26.58it/s]  4%|         | 24/599 [00:00<00:11, 49.09it/s]  6%|         | 36/599 [00:00<00:08, 67.10it/s]  8%|         | 48/599 [00:00<00:06, 80.86it/s] 10%|         | 60/599 [00:00<00:05, 91.17it/s] 12%|        | 72/599 [00:01<00:05, 98.71it/s] 14%|        | 84/599 [00:01<00:04, 103.52it/s] 16%|        | 96/599 [00:01<00:04, 107.64it/s] 18%|        | 108/599 [00:01<00:04, 110.73it/s] 20%|        | 120/599 [00:01<00:04, 112.97it/s] 22%|       | 132/599 [00:01<00:04, 114.68it/s] 24%|       | 144/599 [00:01<00:03, 116.07it/s] 26%|       | 156/599 [00:01<00:03, 116.87it/s] 28%|       | 168/599 [00:01<00:03, 116.98it/s] 30%|       | 180/599 [00:02<00:04, 104.05it/s] 32%|      | 192/599 [00:02<00:03, 108.18it/s] 34%|      | 204/599 [00:02<00:03, 110.64it/s] 36%|      | 216/599 [00:02<00:04, 95.60it/s]  38%|      | 228/599 [00:02<00:03, 101.38it/s] 40%|      | 239/599 [00:02<00:04, 88.54it/s]  42%|     | 251/599 [00:02<00:03, 96.07it/s] 44%|     | 262/599 [00:02<00:04, 76.42it/s] 46%|     | 274/599 [00:03<00:03, 84.69it/s] 48%|     | 285/599 [00:03<00:03, 79.70it/s] 50%|     | 297/599 [00:03<00:03, 88.89it/s] 52%|    | 309/599 [00:03<00:03, 96.37it/s] 53%|    | 320/599 [00:03<00:02, 98.17it/s] 55%|    | 332/599 [00:03<00:02, 103.79it/s] 57%|    | 344/599 [00:03<00:02, 107.96it/s] 59%|    | 356/599 [00:03<00:02, 108.82it/s] 61%|   | 368/599 [00:03<00:02, 111.55it/s] 63%|   | 380/599 [00:04<00:01, 113.65it/s] 65%|   | 392/599 [00:04<00:02, 99.56it/s]  67%|   | 404/599 [00:04<00:01, 104.42it/s] 69%|   | 415/599 [00:04<00:01, 92.35it/s]  71%|  | 427/599 [00:04<00:01, 98.46it/s] 73%|  | 439/599 [00:04<00:01, 103.86it/s] 75%|  | 451/599 [00:04<00:01, 108.03it/s] 77%|  | 463/599 [00:04<00:01, 110.21it/s] 79%|  | 475/599 [00:04<00:01, 112.67it/s] 81%| | 487/599 [00:05<00:00, 113.60it/s] 83%| | 499/599 [00:05<00:00, 115.22it/s] 85%| | 511/599 [00:05<00:00, 115.67it/s] 87%| | 523/599 [00:05<00:00, 116.30it/s] 89%| | 535/599 [00:05<00:00, 116.23it/s] 91%|| 547/599 [00:05<00:00, 117.27it/s] 93%|| 559/599 [00:05<00:00, 117.28it/s] 95%|| 572/599 [00:05<00:00, 118.54it/s] 98%|| 585/599 [00:05<00:00, 119.58it/s]100%|| 598/599 [00:06<00:00, 120.25it/s]100%|| 599/599 [00:06<00:00, 97.94it/s] 
tensor([0.4985, 0.4998, 0.4988, 0.5000, 0.4990], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 4 of 101
train loss is 0.6896799802780151
val loss is 0.6878645155164931
test loss is 0.6890634789888768
validation accuracy is 80.03472222222223
test accuracy is 91.96279984921566
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:19,  5.12s/it]  5%|         | 2/40 [00:05<01:26,  2.28s/it]  8%|         | 3/40 [00:05<00:50,  1.37s/it] 10%|         | 4/40 [00:05<00:33,  1.06it/s] 12%|        | 5/40 [00:06<00:24,  1.42it/s] 15%|        | 6/40 [00:06<00:19,  1.77it/s] 18%|        | 7/40 [00:06<00:15,  2.10it/s] 20%|        | 8/40 [00:07<00:13,  2.41it/s] 22%|       | 9/40 [00:07<00:11,  2.66it/s] 25%|       | 10/40 [00:07<00:10,  2.87it/s] 28%|       | 11/40 [00:08<00:09,  3.03it/s] 30%|       | 12/40 [00:08<00:08,  3.15it/s] 32%|      | 13/40 [00:08<00:08,  3.24it/s] 35%|      | 14/40 [00:08<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:12<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.48it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:16<00:00,  2.43it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.48s/it] 22%|       | 2/9 [00:02<00:09,  1.38s/it] 56%|    | 5/9 [00:02<00:01,  2.34it/s] 89%| | 8/9 [00:03<00:00,  4.25it/s]100%|| 9/9 [00:03<00:00,  2.81it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:32,  2.20it/s]  1%|          | 7/599 [00:00<00:37, 15.81it/s]  3%|         | 19/599 [00:00<00:13, 41.79it/s]  5%|         | 31/599 [00:00<00:09, 62.09it/s]  7%|         | 43/599 [00:00<00:07, 76.81it/s]  9%|         | 55/599 [00:00<00:06, 88.03it/s] 11%|         | 67/599 [00:01<00:05, 96.46it/s] 13%|        | 79/599 [00:01<00:05, 102.71it/s] 15%|        | 91/599 [00:01<00:04, 106.52it/s] 17%|        | 103/599 [00:01<00:04, 109.71it/s] 19%|        | 115/599 [00:01<00:04, 112.01it/s] 21%|        | 127/599 [00:01<00:04, 113.67it/s] 23%|       | 139/599 [00:01<00:04, 114.63it/s] 25%|       | 151/599 [00:01<00:03, 115.53it/s] 27%|       | 163/599 [00:01<00:04, 105.01it/s] 29%|       | 175/599 [00:02<00:03, 108.79it/s] 31%|       | 187/599 [00:02<00:03, 108.83it/s] 33%|      | 199/599 [00:02<00:03, 110.34it/s] 35%|      | 211/599 [00:02<00:03, 112.53it/s] 37%|      | 223/599 [00:02<00:03, 114.28it/s] 39%|      | 235/599 [00:02<00:03, 97.53it/s]  41%|      | 247/599 [00:02<00:03, 102.84it/s] 43%|     | 259/599 [00:02<00:03, 106.92it/s] 45%|     | 271/599 [00:02<00:02, 109.90it/s] 47%|     | 283/599 [00:03<00:02, 112.25it/s] 49%|     | 295/599 [00:03<00:02, 113.95it/s] 51%|    | 307/599 [00:03<00:02, 115.27it/s] 53%|    | 319/599 [00:03<00:02, 116.13it/s] 55%|    | 331/599 [00:03<00:02, 116.67it/s] 57%|    | 343/599 [00:03<00:02, 116.98it/s] 59%|    | 355/599 [00:03<00:02, 116.91it/s] 61%|   | 367/599 [00:03<00:02, 104.64it/s] 63%|   | 379/599 [00:03<00:02, 108.35it/s] 65%|   | 391/599 [00:03<00:01, 111.00it/s] 67%|   | 403/599 [00:04<00:01, 113.00it/s] 69%|   | 415/599 [00:04<00:01, 114.55it/s] 71%|  | 427/599 [00:04<00:01, 115.69it/s] 73%|  | 439/599 [00:04<00:01, 112.41it/s] 75%|  | 451/599 [00:04<00:01, 114.10it/s] 77%|  | 463/599 [00:04<00:01, 105.07it/s] 79%|  | 475/599 [00:04<00:01, 108.82it/s] 81%| | 487/599 [00:04<00:01, 111.42it/s] 83%| | 499/599 [00:04<00:00, 113.08it/s] 85%| | 511/599 [00:05<00:00, 113.46it/s] 87%| | 523/599 [00:05<00:00, 114.60it/s] 89%| | 535/599 [00:05<00:00, 115.23it/s] 91%|| 547/599 [00:05<00:00, 116.41it/s] 93%|| 559/599 [00:05<00:00, 117.37it/s] 95%|| 572/599 [00:05<00:00, 118.64it/s] 98%|| 585/599 [00:05<00:00, 119.67it/s]100%|| 598/599 [00:05<00:00, 120.41it/s]100%|| 599/599 [00:05<00:00, 102.17it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:228: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  ns_fpr, ns_tpr, _ = roc_curve(np.array(labels_list.cpu()), ns_probs)
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:229: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  lr_fpr, lr_tpr, _ = roc_curve(np.array(labels_list.cpu()), np.array(probs_list.detach().cpu()))
tensor([0.4980, 0.4998, 0.4985, 0.5005, 0.4988], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 5 of 101
train loss is 0.6875482201576233
val loss is 0.6860444810655382
test loss is 0.6878865619931674
validation accuracy is 80.03472222222223
test accuracy is 87.94419676155002
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:06<03:56,  6.07s/it]  5%|         | 2/40 [00:06<01:41,  2.67s/it]  8%|         | 3/40 [00:06<00:58,  1.58s/it] 10%|         | 4/40 [00:06<00:38,  1.07s/it] 12%|        | 5/40 [00:07<00:27,  1.27it/s] 15%|        | 6/40 [00:07<00:21,  1.62it/s] 18%|        | 7/40 [00:07<00:16,  1.96it/s] 20%|        | 8/40 [00:08<00:14,  2.28it/s] 22%|       | 9/40 [00:08<00:12,  2.55it/s] 25%|       | 10/40 [00:08<00:10,  2.78it/s] 28%|       | 11/40 [00:08<00:09,  2.96it/s] 30%|       | 12/40 [00:09<00:09,  3.10it/s] 32%|      | 13/40 [00:09<00:08,  3.21it/s] 35%|      | 14/40 [00:09<00:07,  3.29it/s] 38%|      | 15/40 [00:10<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.43it/s] 48%|     | 19/40 [00:11<00:06,  3.44it/s] 50%|     | 20/40 [00:11<00:05,  3.44it/s] 52%|    | 21/40 [00:11<00:05,  3.46it/s] 55%|    | 22/40 [00:12<00:05,  3.47it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:13<00:04,  3.48it/s] 68%|   | 27/40 [00:13<00:03,  3.48it/s] 70%|   | 28/40 [00:13<00:03,  3.47it/s] 72%|  | 29/40 [00:14<00:03,  3.47it/s] 75%|  | 30/40 [00:14<00:02,  3.47it/s] 78%|  | 31/40 [00:14<00:02,  3.47it/s] 80%|  | 32/40 [00:14<00:02,  3.47it/s] 82%| | 33/40 [00:15<00:02,  3.47it/s] 85%| | 34/40 [00:15<00:01,  3.47it/s] 88%| | 35/40 [00:15<00:01,  3.47it/s] 90%| | 36/40 [00:16<00:01,  3.47it/s] 92%|| 37/40 [00:16<00:00,  3.47it/s] 95%|| 38/40 [00:16<00:00,  3.47it/s] 98%|| 39/40 [00:16<00:00,  3.47it/s]100%|| 40/40 [00:17<00:00,  3.48it/s]100%|| 40/40 [00:17<00:00,  2.30it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:11,  1.45s/it] 22%|       | 2/9 [00:02<00:09,  1.37s/it] 56%|    | 5/9 [00:02<00:01,  2.37it/s] 89%| | 8/9 [00:03<00:00,  4.30it/s]100%|| 9/9 [00:03<00:00,  2.85it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:00,  3.31it/s]  1%|          | 7/599 [00:00<00:27, 21.21it/s]  2%|         | 12/599 [00:00<00:21, 27.65it/s]  4%|         | 24/599 [00:00<00:10, 54.28it/s]  6%|         | 36/599 [00:00<00:07, 73.07it/s]  8%|         | 48/599 [00:00<00:06, 86.00it/s] 10%|         | 60/599 [00:00<00:05, 95.03it/s] 12%|        | 72/599 [00:01<00:05, 101.75it/s] 14%|        | 84/599 [00:01<00:04, 106.53it/s] 16%|        | 96/599 [00:01<00:04, 109.32it/s] 18%|        | 108/599 [00:01<00:04, 110.92it/s] 20%|        | 120/599 [00:01<00:04, 112.84it/s] 22%|       | 132/599 [00:01<00:04, 112.66it/s] 24%|       | 144/599 [00:01<00:03, 114.17it/s] 26%|       | 156/599 [00:01<00:03, 115.08it/s] 28%|       | 168/599 [00:01<00:03, 115.80it/s] 30%|       | 180/599 [00:01<00:03, 116.49it/s] 32%|      | 192/599 [00:02<00:03, 117.03it/s] 34%|      | 204/599 [00:02<00:03, 117.43it/s] 36%|      | 216/599 [00:02<00:03, 117.50it/s] 38%|      | 228/599 [00:02<00:03, 115.96it/s] 40%|      | 240/599 [00:02<00:03, 104.43it/s] 42%|     | 252/599 [00:02<00:03, 107.87it/s] 44%|     | 263/599 [00:02<00:03, 92.63it/s]  46%|     | 275/599 [00:02<00:03, 99.12it/s] 48%|     | 287/599 [00:02<00:02, 104.33it/s] 50%|     | 299/599 [00:03<00:02, 108.15it/s] 52%|    | 311/599 [00:03<00:02, 110.80it/s] 54%|    | 323/599 [00:03<00:02, 113.15it/s] 56%|    | 335/599 [00:03<00:02, 114.30it/s] 58%|    | 347/599 [00:03<00:02, 115.37it/s] 60%|    | 359/599 [00:03<00:02, 116.26it/s] 62%|   | 371/599 [00:03<00:01, 116.74it/s] 64%|   | 383/599 [00:03<00:01, 115.69it/s] 66%|   | 395/599 [00:03<00:01, 115.55it/s] 68%|   | 407/599 [00:04<00:01, 115.88it/s] 70%|   | 419/599 [00:04<00:01, 115.90it/s] 72%|  | 431/599 [00:04<00:01, 116.65it/s] 74%|  | 443/599 [00:04<00:01, 117.09it/s] 76%|  | 455/599 [00:04<00:01, 117.23it/s] 78%|  | 467/599 [00:04<00:01, 117.56it/s] 80%|  | 479/599 [00:04<00:01, 117.80it/s] 82%| | 491/599 [00:04<00:00, 117.86it/s] 84%| | 503/599 [00:04<00:00, 117.97it/s] 86%| | 515/599 [00:04<00:00, 118.00it/s] 88%| | 527/599 [00:05<00:00, 118.10it/s] 90%| | 539/599 [00:05<00:00, 118.23it/s] 92%|| 551/599 [00:05<00:00, 118.41it/s] 94%|| 563/599 [00:05<00:00, 118.36it/s] 96%|| 576/599 [00:05<00:00, 119.21it/s] 98%|| 589/599 [00:05<00:00, 119.86it/s]100%|| 599/599 [00:05<00:00, 104.85it/s]
tensor([0.4976, 0.5000, 0.4980, 0.5005, 0.4985], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 6 of 101
train loss is 0.6848697066307068
val loss is 0.683852301703559
test loss is 0.6864401168735677
validation accuracy is 80.03472222222223
test accuracy is 80.72979156799826
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:00,  4.64s/it]  5%|         | 2/40 [00:04<01:18,  2.08s/it]  8%|         | 3/40 [00:05<00:46,  1.26s/it] 10%|         | 4/40 [00:05<00:31,  1.13it/s] 12%|        | 5/40 [00:05<00:23,  1.49it/s] 15%|        | 6/40 [00:06<00:18,  1.85it/s] 18%|        | 7/40 [00:06<00:15,  2.18it/s] 20%|        | 8/40 [00:06<00:12,  2.48it/s] 22%|       | 9/40 [00:06<00:11,  2.72it/s] 25%|       | 10/40 [00:07<00:10,  2.92it/s] 28%|       | 11/40 [00:07<00:09,  3.07it/s] 30%|       | 12/40 [00:07<00:08,  3.18it/s] 32%|      | 13/40 [00:08<00:08,  3.27it/s] 35%|      | 14/40 [00:08<00:07,  3.33it/s] 38%|      | 15/40 [00:08<00:07,  3.37it/s] 40%|      | 16/40 [00:08<00:07,  3.41it/s] 42%|     | 17/40 [00:09<00:06,  3.43it/s] 45%|     | 18/40 [00:09<00:06,  3.45it/s] 48%|     | 19/40 [00:09<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:10<00:05,  3.48it/s] 57%|    | 23/40 [00:10<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:11<00:04,  3.48it/s] 65%|   | 26/40 [00:11<00:04,  3.47it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:12<00:03,  3.48it/s] 72%|  | 29/40 [00:12<00:03,  3.48it/s] 75%|  | 30/40 [00:13<00:02,  3.46it/s] 78%|  | 31/40 [00:13<00:02,  3.47it/s] 80%|  | 32/40 [00:13<00:02,  3.46it/s] 82%| | 33/40 [00:13<00:02,  3.46it/s] 85%| | 34/40 [00:14<00:01,  3.46it/s] 88%| | 35/40 [00:14<00:01,  3.47it/s] 90%| | 36/40 [00:14<00:01,  3.47it/s] 92%|| 37/40 [00:15<00:00,  3.47it/s] 95%|| 38/40 [00:15<00:00,  3.47it/s] 98%|| 39/40 [00:15<00:00,  3.47it/s]100%|| 40/40 [00:15<00:00,  3.47it/s]100%|| 40/40 [00:15<00:00,  2.50it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.46s/it] 22%|       | 2/9 [00:02<00:09,  1.38s/it] 56%|    | 5/9 [00:02<00:01,  2.35it/s] 89%| | 8/9 [00:03<00:00,  4.26it/s]100%|| 9/9 [00:03<00:00,  2.82it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:20,  2.30it/s]  1%|         | 8/599 [00:00<00:31, 18.68it/s]  3%|         | 20/599 [00:00<00:12, 44.60it/s]  5%|         | 32/599 [00:00<00:08, 63.80it/s]  7%|         | 44/599 [00:00<00:07, 77.92it/s]  9%|         | 56/599 [00:00<00:06, 89.08it/s] 11%|        | 68/599 [00:01<00:05, 97.24it/s] 13%|        | 79/599 [00:01<00:05, 94.80it/s] 15%|        | 91/599 [00:01<00:05, 101.35it/s] 17%|        | 103/599 [00:01<00:04, 106.03it/s] 19%|        | 115/599 [00:01<00:04, 104.79it/s] 21%|        | 127/599 [00:01<00:04, 108.55it/s] 23%|       | 139/599 [00:01<00:04, 110.66it/s] 25%|       | 151/599 [00:01<00:03, 112.14it/s] 27%|       | 163/599 [00:01<00:03, 113.51it/s] 29%|       | 175/599 [00:02<00:03, 114.46it/s] 31%|       | 187/599 [00:02<00:03, 115.23it/s] 33%|      | 199/599 [00:02<00:03, 114.77it/s] 35%|      | 211/599 [00:02<00:03, 115.71it/s] 37%|      | 223/599 [00:02<00:03, 115.80it/s] 39%|      | 235/599 [00:02<00:03, 116.15it/s] 41%|      | 247/599 [00:02<00:03, 116.47it/s] 43%|     | 259/599 [00:02<00:02, 116.49it/s] 45%|     | 271/599 [00:02<00:02, 116.44it/s] 47%|     | 283/599 [00:02<00:02, 115.42it/s] 49%|     | 295/599 [00:03<00:02, 115.93it/s] 51%|    | 307/599 [00:03<00:02, 116.25it/s] 53%|    | 319/599 [00:03<00:02, 116.42it/s] 55%|    | 331/599 [00:03<00:02, 108.67it/s] 57%|    | 343/599 [00:03<00:02, 110.73it/s] 59%|    | 355/599 [00:03<00:02, 108.91it/s] 61%|    | 366/599 [00:03<00:02, 105.68it/s] 63%|   | 377/599 [00:03<00:02, 106.50it/s] 65%|   | 388/599 [00:03<00:02, 103.76it/s] 67%|   | 400/599 [00:04<00:01, 107.02it/s] 69%|   | 412/599 [00:04<00:01, 110.26it/s] 71%|   | 424/599 [00:04<00:01, 112.19it/s] 73%|  | 436/599 [00:04<00:01, 113.65it/s] 75%|  | 448/599 [00:04<00:01, 114.82it/s] 77%|  | 460/599 [00:04<00:01, 115.82it/s] 79%|  | 472/599 [00:04<00:01, 116.23it/s] 81%|  | 484/599 [00:04<00:00, 116.60it/s] 83%| | 496/599 [00:04<00:00, 117.14it/s] 85%| | 508/599 [00:04<00:00, 117.52it/s] 87%| | 520/599 [00:05<00:00, 117.74it/s] 89%| | 532/599 [00:05<00:00, 117.73it/s] 91%| | 544/599 [00:05<00:00, 117.33it/s] 93%|| 556/599 [00:05<00:00, 117.78it/s] 95%|| 569/599 [00:05<00:00, 118.61it/s] 97%|| 582/599 [00:05<00:00, 119.51it/s] 99%|| 595/599 [00:05<00:00, 120.23it/s]100%|| 599/599 [00:05<00:00, 103.32it/s]
tensor([0.4968, 0.5005, 0.4973, 0.5010, 0.4980], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 7 of 101
train loss is 0.6815411448478699
val loss is 0.6812269422743056
test loss is 0.6847466774695306
validation accuracy is 79.94791666666667
test accuracy is 79.51347849723294
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:28,  5.35s/it]  5%|         | 2/40 [00:05<01:30,  2.37s/it]  8%|         | 3/40 [00:05<00:52,  1.42s/it] 10%|         | 4/40 [00:06<00:35,  1.03it/s] 12%|        | 5/40 [00:06<00:25,  1.37it/s] 15%|        | 6/40 [00:06<00:19,  1.73it/s] 18%|        | 7/40 [00:07<00:15,  2.07it/s] 20%|        | 8/40 [00:07<00:13,  2.38it/s] 22%|       | 9/40 [00:07<00:11,  2.64it/s] 25%|       | 10/40 [00:07<00:10,  2.85it/s] 28%|       | 11/40 [00:08<00:09,  3.02it/s] 30%|       | 12/40 [00:08<00:08,  3.14it/s] 32%|      | 13/40 [00:08<00:08,  3.24it/s] 35%|      | 14/40 [00:09<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.48it/s] 75%|  | 30/40 [00:13<00:02,  3.48it/s] 78%|  | 31/40 [00:13<00:02,  3.48it/s] 80%|  | 32/40 [00:14<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:14<00:01,  3.48it/s] 88%| | 35/40 [00:15<00:01,  3.48it/s] 90%| | 36/40 [00:15<00:01,  3.48it/s] 92%|| 37/40 [00:15<00:00,  3.48it/s] 95%|| 38/40 [00:15<00:00,  3.48it/s] 98%|| 39/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:16<00:00,  2.40it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:13,  1.69s/it] 22%|       | 2/9 [00:02<00:09,  1.43s/it] 56%|    | 5/9 [00:03<00:01,  2.28it/s] 89%| | 8/9 [00:03<00:00,  4.15it/s]100%|| 9/9 [00:03<00:00,  2.70it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:48,  2.62it/s]  0%|          | 2/599 [00:00<02:14,  4.44it/s]  2%|         | 14/599 [00:00<00:16, 35.53it/s]  4%|         | 26/599 [00:00<00:09, 58.72it/s]  6%|         | 38/599 [00:00<00:07, 75.52it/s]  8%|         | 50/599 [00:00<00:06, 87.69it/s] 10%|         | 62/599 [00:01<00:05, 96.30it/s] 12%|        | 74/599 [00:01<00:05, 102.57it/s] 14%|        | 86/599 [00:01<00:04, 106.97it/s] 16%|        | 98/599 [00:01<00:04, 110.06it/s] 18%|        | 110/599 [00:01<00:04, 111.79it/s] 20%|        | 122/599 [00:01<00:04, 113.56it/s] 22%|       | 134/599 [00:01<00:04, 113.19it/s] 24%|       | 146/599 [00:01<00:04, 112.56it/s] 26%|       | 158/599 [00:01<00:03, 113.66it/s] 28%|       | 170/599 [00:01<00:03, 114.27it/s] 30%|       | 182/599 [00:02<00:04, 100.40it/s] 32%|      | 193/599 [00:02<00:03, 102.09it/s] 34%|      | 205/599 [00:02<00:03, 103.96it/s] 36%|      | 217/599 [00:02<00:03, 107.58it/s] 38%|      | 229/599 [00:02<00:03, 110.71it/s] 40%|      | 241/599 [00:02<00:03, 104.14it/s] 42%|     | 253/599 [00:02<00:03, 107.93it/s] 44%|     | 265/599 [00:02<00:03, 110.84it/s] 46%|     | 277/599 [00:02<00:02, 113.04it/s] 48%|     | 289/599 [00:03<00:02, 113.92it/s] 50%|     | 301/599 [00:03<00:02, 115.04it/s] 52%|    | 313/599 [00:03<00:02, 116.04it/s] 54%|    | 325/599 [00:03<00:02, 97.07it/s]  56%|    | 337/599 [00:03<00:02, 102.14it/s] 58%|    | 349/599 [00:03<00:02, 105.92it/s] 60%|    | 360/599 [00:03<00:02, 99.18it/s]  62%|   | 372/599 [00:03<00:02, 104.53it/s] 64%|   | 384/599 [00:03<00:01, 107.60it/s] 66%|   | 395/599 [00:04<00:02, 91.72it/s]  68%|   | 407/599 [00:04<00:01, 98.44it/s] 70%|   | 419/599 [00:04<00:01, 103.82it/s] 72%|  | 431/599 [00:04<00:01, 107.90it/s] 74%|  | 443/599 [00:04<00:01, 110.96it/s] 76%|  | 455/599 [00:04<00:01, 111.00it/s] 78%|  | 467/599 [00:04<00:01, 113.06it/s] 80%|  | 479/599 [00:04<00:01, 114.69it/s] 82%| | 491/599 [00:04<00:00, 115.75it/s] 84%| | 503/599 [00:05<00:00, 116.53it/s] 86%| | 515/599 [00:05<00:00, 116.90it/s] 88%| | 527/599 [00:05<00:00, 116.70it/s] 90%| | 539/599 [00:05<00:00, 116.92it/s] 92%|| 551/599 [00:05<00:00, 117.60it/s] 94%|| 564/599 [00:05<00:00, 118.59it/s] 96%|| 577/599 [00:05<00:00, 119.41it/s] 98%|| 589/599 [00:05<00:00, 105.28it/s]100%|| 599/599 [00:05<00:00, 100.06it/s]
tensor([0.4956, 0.5005, 0.4963, 0.5010, 0.4973], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 8 of 101
train loss is 0.6762858033180237
val loss is 0.67780515882704
test loss is 0.6824982912592179
validation accuracy is 79.94791666666667
test accuracy is 79.70427266982243
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:48,  5.86s/it]  5%|         | 2/40 [00:06<01:38,  2.58s/it]  8%|         | 3/40 [00:06<00:56,  1.53s/it] 10%|         | 4/40 [00:06<00:37,  1.04s/it] 12%|        | 5/40 [00:07<00:26,  1.30it/s] 15%|        | 6/40 [00:07<00:20,  1.64it/s] 18%|        | 7/40 [00:07<00:16,  1.99it/s] 20%|        | 8/40 [00:07<00:13,  2.30it/s] 22%|       | 9/40 [00:08<00:12,  2.57it/s] 25%|       | 10/40 [00:08<00:10,  2.80it/s] 28%|       | 11/40 [00:08<00:09,  2.98it/s] 30%|       | 12/40 [00:09<00:08,  3.11it/s] 32%|      | 13/40 [00:09<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.41it/s] 45%|     | 18/40 [00:10<00:06,  3.43it/s] 48%|     | 19/40 [00:11<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.47it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:13<00:04,  3.48it/s] 68%|   | 27/40 [00:13<00:03,  3.48it/s] 70%|   | 28/40 [00:13<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.48it/s] 75%|  | 30/40 [00:14<00:02,  3.48it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:15<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.33it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.42s/it] 22%|       | 2/9 [00:02<00:09,  1.36s/it] 44%|     | 4/9 [00:02<00:02,  1.80it/s] 78%|  | 7/9 [00:03<00:00,  3.79it/s]100%|| 9/9 [00:03<00:00,  2.81it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:04,  2.45it/s]  1%|          | 4/599 [00:00<01:02,  9.50it/s]  2%|         | 10/599 [00:00<00:25, 23.02it/s]  4%|         | 22/599 [00:00<00:11, 49.64it/s]  6%|         | 34/599 [00:00<00:08, 69.14it/s]  8%|         | 45/599 [00:00<00:06, 80.66it/s] 10%|         | 57/599 [00:01<00:05, 91.53it/s] 12%|        | 69/599 [00:01<00:05, 99.31it/s] 14%|        | 81/599 [00:01<00:04, 104.86it/s] 16%|        | 93/599 [00:01<00:04, 108.73it/s] 18%|        | 105/599 [00:01<00:04, 111.26it/s] 20%|        | 117/599 [00:01<00:04, 113.30it/s] 22%|       | 129/599 [00:01<00:04, 114.72it/s] 24%|       | 141/599 [00:01<00:03, 115.50it/s] 26%|       | 153/599 [00:01<00:03, 115.54it/s] 28%|       | 165/599 [00:01<00:03, 115.61it/s] 30%|       | 177/599 [00:02<00:03, 110.81it/s] 32%|      | 189/599 [00:02<00:03, 112.72it/s] 34%|      | 201/599 [00:02<00:03, 114.13it/s] 36%|      | 213/599 [00:02<00:03, 115.14it/s] 38%|      | 225/599 [00:02<00:03, 109.36it/s] 40%|      | 237/599 [00:02<00:03, 111.67it/s] 42%|     | 249/599 [00:02<00:03, 113.45it/s] 44%|     | 261/599 [00:02<00:03, 101.91it/s] 46%|     | 273/599 [00:02<00:03, 106.17it/s] 48%|     | 285/599 [00:03<00:02, 109.40it/s] 50%|     | 297/599 [00:03<00:02, 111.82it/s] 52%|    | 309/599 [00:03<00:02, 113.60it/s] 54%|    | 321/599 [00:03<00:02, 114.89it/s] 56%|    | 333/599 [00:03<00:02, 115.73it/s] 58%|    | 345/599 [00:03<00:02, 116.54it/s] 60%|    | 357/599 [00:03<00:02, 116.28it/s] 62%|   | 369/599 [00:03<00:02, 114.93it/s] 64%|   | 381/599 [00:03<00:01, 115.81it/s] 66%|   | 393/599 [00:03<00:01, 110.10it/s] 68%|   | 405/599 [00:04<00:01, 112.23it/s] 70%|   | 417/599 [00:04<00:01, 113.81it/s] 72%|  | 429/599 [00:04<00:01, 114.86it/s] 74%|  | 441/599 [00:04<00:01, 115.48it/s] 76%|  | 453/599 [00:04<00:01, 116.24it/s] 78%|  | 465/599 [00:04<00:01, 111.75it/s] 80%|  | 477/599 [00:04<00:01, 113.43it/s] 82%| | 489/599 [00:04<00:00, 113.33it/s] 84%| | 501/599 [00:04<00:00, 114.47it/s] 86%| | 513/599 [00:05<00:00, 115.17it/s] 88%| | 525/599 [00:05<00:00, 115.96it/s] 90%| | 537/599 [00:05<00:00, 116.43it/s] 92%|| 549/599 [00:05<00:00, 117.20it/s] 94%|| 561/599 [00:05<00:00, 117.87it/s] 96%|| 574/599 [00:05<00:00, 118.72it/s] 98%|| 587/599 [00:05<00:00, 119.48it/s]100%|| 599/599 [00:05<00:00, 102.67it/s]
tensor([0.4937, 0.5005, 0.4944, 0.5005, 0.4958], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 9 of 101
train loss is 0.670541524887085
val loss is 0.6729015774197049
test loss is 0.6788972013183746
validation accuracy is 80.03472222222223
test accuracy is 84.39065495078671
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<02:51,  4.40s/it]  5%|         | 2/40 [00:05<01:33,  2.46s/it]  8%|         | 3/40 [00:05<00:54,  1.47s/it] 10%|         | 4/40 [00:06<00:36,  1.00s/it] 12%|        | 5/40 [00:06<00:26,  1.34it/s] 15%|        | 6/40 [00:06<00:20,  1.70it/s] 18%|        | 7/40 [00:06<00:16,  2.04it/s] 20%|        | 8/40 [00:07<00:13,  2.35it/s] 22%|       | 9/40 [00:07<00:11,  2.61it/s] 25%|       | 10/40 [00:07<00:10,  2.83it/s] 28%|       | 11/40 [00:08<00:09,  2.99it/s] 30%|       | 12/40 [00:08<00:09,  3.11it/s] 32%|      | 13/40 [00:08<00:08,  3.21it/s] 35%|      | 14/40 [00:08<00:07,  3.29it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:09<00:07,  3.39it/s] 42%|     | 17/40 [00:09<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.47it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:12<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.42it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.43s/it] 22%|       | 2/9 [00:02<00:09,  1.36s/it] 44%|     | 4/9 [00:02<00:02,  1.84it/s] 78%|  | 7/9 [00:02<00:00,  3.86it/s]100%|| 9/9 [00:03<00:00,  2.84it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:12,  2.37it/s]  0%|          | 2/599 [00:00<02:25,  4.10it/s]  2%|         | 13/599 [00:00<00:19, 30.72it/s]  4%|         | 25/599 [00:00<00:10, 53.98it/s]  6%|         | 37/599 [00:00<00:07, 71.73it/s]  8%|         | 47/599 [00:00<00:07, 75.54it/s] 10%|         | 59/599 [00:01<00:06, 87.53it/s] 12%|        | 71/599 [00:01<00:05, 96.35it/s] 14%|        | 83/599 [00:01<00:05, 102.68it/s] 16%|        | 95/599 [00:01<00:04, 107.37it/s] 18%|        | 107/599 [00:01<00:04, 110.79it/s] 20%|        | 119/599 [00:01<00:04, 113.08it/s] 22%|       | 131/599 [00:01<00:04, 114.20it/s] 24%|       | 143/599 [00:01<00:03, 115.00it/s] 26%|       | 155/599 [00:01<00:03, 115.69it/s] 28%|       | 167/599 [00:01<00:03, 116.18it/s] 30%|       | 179/599 [00:02<00:03, 116.44it/s] 32%|      | 191/599 [00:02<00:03, 116.16it/s] 34%|      | 203/599 [00:02<00:03, 116.25it/s] 36%|      | 215/599 [00:02<00:03, 116.18it/s] 38%|      | 227/599 [00:02<00:03, 113.19it/s] 40%|      | 239/599 [00:02<00:03, 114.44it/s] 42%|     | 251/599 [00:02<00:03, 115.40it/s] 44%|     | 263/599 [00:02<00:03, 101.49it/s] 46%|     | 275/599 [00:02<00:03, 105.92it/s] 48%|     | 287/599 [00:03<00:02, 109.24it/s] 50%|     | 299/599 [00:03<00:02, 111.77it/s] 52%|    | 311/599 [00:03<00:02, 113.34it/s] 54%|    | 323/599 [00:03<00:02, 114.09it/s] 56%|    | 335/599 [00:03<00:02, 115.10it/s] 58%|    | 347/599 [00:03<00:02, 115.35it/s] 60%|    | 359/599 [00:03<00:02, 106.13it/s] 62%|   | 371/599 [00:03<00:02, 109.32it/s] 64%|   | 383/599 [00:03<00:01, 111.55it/s] 66%|   | 395/599 [00:04<00:02, 94.87it/s]  68%|   | 407/599 [00:04<00:01, 100.83it/s] 70%|   | 419/599 [00:04<00:01, 105.44it/s] 72%|  | 431/599 [00:04<00:01, 108.92it/s] 74%|  | 443/599 [00:04<00:01, 111.56it/s] 76%|  | 455/599 [00:04<00:01, 110.97it/s] 78%|  | 467/599 [00:04<00:01, 112.86it/s] 80%|  | 479/599 [00:04<00:01, 114.00it/s] 82%| | 491/599 [00:04<00:00, 114.90it/s] 84%| | 503/599 [00:05<00:00, 115.69it/s] 86%| | 515/599 [00:05<00:00, 116.16it/s] 88%| | 527/599 [00:05<00:00, 116.53it/s] 90%| | 539/599 [00:05<00:00, 114.56it/s] 92%|| 551/599 [00:05<00:00, 114.90it/s] 94%|| 563/599 [00:05<00:00, 116.24it/s] 96%|| 576/599 [00:05<00:00, 117.80it/s] 98%|| 588/599 [00:05<00:00, 106.84it/s]100%|| 599/599 [00:05<00:00, 100.57it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:228: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  ns_fpr, ns_tpr, _ = roc_curve(np.array(labels_list.cpu()), ns_probs)
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:229: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  lr_fpr, lr_tpr, _ = roc_curve(np.array(labels_list.cpu()), np.array(probs_list.detach().cpu()))
tensor([0.4912, 0.4998, 0.4922, 0.4995, 0.4941], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 10 of 101
train loss is 0.663131594657898
val loss is 0.667221917046441
test loss is 0.6746902736479133
validation accuracy is 80.03472222222223
test accuracy is 91.86740267694692
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:04<02:47,  4.31s/it]  5%|         | 2/40 [00:05<01:32,  2.42s/it]  8%|         | 3/40 [00:05<00:53,  1.45s/it] 10%|         | 4/40 [00:05<00:35,  1.01it/s] 12%|        | 5/40 [00:06<00:25,  1.36it/s] 15%|        | 6/40 [00:06<00:19,  1.71it/s] 18%|        | 7/40 [00:06<00:16,  2.06it/s] 20%|        | 8/40 [00:07<00:13,  2.36it/s] 22%|       | 9/40 [00:07<00:11,  2.63it/s] 25%|       | 10/40 [00:07<00:10,  2.84it/s] 28%|       | 11/40 [00:07<00:09,  3.01it/s] 30%|       | 12/40 [00:08<00:08,  3.14it/s] 32%|      | 13/40 [00:08<00:08,  3.23it/s] 35%|      | 14/40 [00:08<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.49it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:12<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.48it/s] 75%|  | 30/40 [00:13<00:02,  3.48it/s] 78%|  | 31/40 [00:13<00:02,  3.48it/s] 80%|  | 32/40 [00:14<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:14<00:01,  3.48it/s] 88%| | 35/40 [00:14<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:16<00:00,  2.43it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:11,  1.41s/it] 22%|       | 2/9 [00:02<00:09,  1.33s/it] 44%|     | 4/9 [00:02<00:02,  1.83it/s] 78%|  | 7/9 [00:02<00:00,  3.85it/s]100%|| 9/9 [00:03<00:00,  2.86it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:28,  4.03it/s]  1%|          | 4/599 [00:00<00:44, 13.41it/s]  2%|         | 12/599 [00:00<00:21, 27.44it/s]  4%|         | 24/599 [00:00<00:10, 52.34it/s]  6%|         | 36/599 [00:00<00:07, 71.11it/s]  8%|         | 48/599 [00:00<00:06, 84.63it/s] 10%|         | 60/599 [00:00<00:05, 94.55it/s] 12%|        | 72/599 [00:01<00:05, 101.71it/s] 14%|        | 84/599 [00:01<00:04, 106.54it/s] 16%|        | 96/599 [00:01<00:04, 110.13it/s] 18%|        | 108/599 [00:01<00:05, 95.41it/s] 20%|        | 120/599 [00:01<00:04, 101.73it/s] 22%|       | 132/599 [00:01<00:04, 104.94it/s] 24%|       | 144/599 [00:01<00:04, 106.83it/s] 26%|       | 156/599 [00:01<00:04, 109.62it/s] 28%|       | 168/599 [00:01<00:03, 112.14it/s] 30%|       | 180/599 [00:02<00:03, 114.01it/s] 32%|      | 192/599 [00:02<00:03, 114.98it/s] 34%|      | 204/599 [00:02<00:03, 115.77it/s] 36%|      | 216/599 [00:02<00:03, 116.28it/s] 38%|      | 228/599 [00:02<00:03, 116.74it/s] 40%|      | 240/599 [00:02<00:03, 117.40it/s] 42%|     | 252/599 [00:02<00:02, 117.89it/s] 44%|     | 264/599 [00:02<00:03, 95.87it/s]  46%|     | 276/599 [00:02<00:03, 101.97it/s] 48%|     | 288/599 [00:03<00:02, 106.62it/s] 50%|     | 300/599 [00:03<00:02, 109.23it/s] 52%|    | 312/599 [00:03<00:02, 111.70it/s] 54%|    | 324/599 [00:03<00:02, 113.15it/s] 56%|    | 336/599 [00:03<00:02, 114.41it/s] 58%|    | 348/599 [00:03<00:02, 115.26it/s] 60%|    | 360/599 [00:03<00:02, 115.45it/s] 62%|   | 372/599 [00:03<00:01, 115.80it/s] 64%|   | 384/599 [00:03<00:01, 116.24it/s] 66%|   | 396/599 [00:03<00:01, 116.75it/s] 68%|   | 408/599 [00:04<00:01, 117.16it/s] 70%|   | 420/599 [00:04<00:01, 117.64it/s] 72%|  | 432/599 [00:04<00:01, 117.92it/s] 74%|  | 444/599 [00:04<00:01, 118.09it/s] 76%|  | 456/599 [00:04<00:01, 118.28it/s] 78%|  | 468/599 [00:04<00:01, 118.40it/s] 80%|  | 480/599 [00:04<00:01, 118.57it/s] 82%| | 492/599 [00:04<00:00, 118.62it/s] 84%| | 504/599 [00:04<00:00, 118.66it/s] 86%| | 516/599 [00:04<00:00, 118.60it/s] 88%| | 528/599 [00:05<00:00, 118.75it/s] 90%| | 540/599 [00:05<00:00, 118.76it/s] 92%|| 553/599 [00:05<00:00, 119.23it/s] 94%|| 566/599 [00:05<00:00, 119.83it/s] 97%|| 579/599 [00:05<00:00, 120.30it/s] 99%|| 592/599 [00:05<00:00, 120.78it/s]100%|| 599/599 [00:05<00:00, 104.71it/s]
tensor([0.4883, 0.4993, 0.4895, 0.4983, 0.4922], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 11 of 101
train loss is 0.654624879360199
val loss is 0.6609632703993056
test loss is 0.6699604210949104
validation accuracy is 80.03472222222223
test accuracy is 92.70212744711237
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<02:52,  4.43s/it]  5%|         | 2/40 [00:04<01:15,  1.99s/it]  8%|         | 3/40 [00:05<00:44,  1.21s/it] 10%|         | 4/40 [00:05<00:32,  1.10it/s] 12%|        | 5/40 [00:05<00:24,  1.46it/s] 15%|        | 6/40 [00:06<00:18,  1.81it/s] 18%|        | 7/40 [00:06<00:15,  2.15it/s] 20%|        | 8/40 [00:06<00:13,  2.45it/s] 22%|       | 9/40 [00:06<00:11,  2.69it/s] 25%|       | 10/40 [00:07<00:10,  2.90it/s] 28%|       | 11/40 [00:07<00:09,  3.05it/s] 30%|       | 12/40 [00:07<00:08,  3.17it/s] 32%|      | 13/40 [00:08<00:08,  3.26it/s] 35%|      | 14/40 [00:08<00:07,  3.31it/s] 38%|      | 15/40 [00:08<00:07,  3.36it/s] 40%|      | 16/40 [00:08<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.42it/s] 45%|     | 18/40 [00:09<00:06,  3.44it/s] 48%|     | 19/40 [00:09<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:10<00:05,  3.48it/s] 57%|    | 23/40 [00:10<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:11<00:04,  3.48it/s] 65%|   | 26/40 [00:11<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:12<00:03,  3.49it/s] 72%|  | 29/40 [00:12<00:03,  3.49it/s] 75%|  | 30/40 [00:12<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.49it/s] 80%|  | 32/40 [00:13<00:02,  3.49it/s] 82%| | 33/40 [00:13<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.48it/s] 90%| | 36/40 [00:14<00:01,  3.48it/s] 92%|| 37/40 [00:14<00:00,  3.48it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:15<00:00,  3.49it/s]100%|| 40/40 [00:15<00:00,  3.49it/s]100%|| 40/40 [00:15<00:00,  2.51it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.42s/it] 22%|       | 2/9 [00:02<00:09,  1.38s/it] 56%|    | 5/9 [00:02<00:01,  2.35it/s] 89%| | 8/9 [00:03<00:00,  4.27it/s]100%|| 9/9 [00:03<00:00,  2.84it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:14,  2.35it/s]  2%|         | 12/599 [00:00<00:20, 28.90it/s]  4%|         | 24/599 [00:00<00:10, 52.32it/s]  6%|         | 35/599 [00:00<00:08, 67.88it/s]  8%|         | 47/599 [00:00<00:06, 81.76it/s] 10%|         | 59/599 [00:00<00:05, 92.39it/s] 12%|        | 71/599 [00:01<00:05, 93.19it/s] 14%|        | 82/599 [00:01<00:05, 90.78it/s] 16%|        | 94/599 [00:01<00:05, 98.21it/s] 18%|        | 105/599 [00:01<00:04, 100.40it/s] 19%|        | 116/599 [00:01<00:04, 97.30it/s]  21%|       | 128/599 [00:01<00:04, 102.98it/s] 23%|       | 140/599 [00:01<00:04, 107.41it/s] 25%|       | 151/599 [00:01<00:04, 100.68it/s] 27%|       | 163/599 [00:01<00:04, 105.67it/s] 29%|       | 175/599 [00:02<00:03, 109.26it/s] 31%|       | 187/599 [00:02<00:03, 104.30it/s] 33%|      | 199/599 [00:02<00:03, 108.30it/s] 35%|      | 211/599 [00:02<00:03, 110.24it/s] 37%|      | 223/599 [00:02<00:03, 112.70it/s] 39%|      | 235/599 [00:02<00:03, 114.73it/s] 41%|      | 247/599 [00:02<00:03, 116.07it/s] 43%|     | 259/599 [00:02<00:02, 116.96it/s] 45%|     | 271/599 [00:02<00:02, 117.54it/s] 47%|     | 283/599 [00:02<00:02, 117.90it/s] 49%|     | 295/599 [00:03<00:02, 118.30it/s] 51%|    | 307/599 [00:03<00:02, 118.54it/s] 53%|    | 319/599 [00:03<00:02, 118.60it/s] 55%|    | 331/599 [00:03<00:02, 118.76it/s] 57%|    | 343/599 [00:03<00:02, 118.92it/s] 59%|    | 355/599 [00:03<00:02, 118.85it/s] 61%|   | 367/599 [00:03<00:01, 118.68it/s] 63%|   | 379/599 [00:03<00:01, 116.77it/s] 65%|   | 391/599 [00:03<00:01, 105.65it/s] 67%|   | 403/599 [00:04<00:01, 109.08it/s] 69%|   | 415/599 [00:04<00:01, 111.79it/s] 71%|  | 427/599 [00:04<00:01, 113.69it/s] 73%|  | 439/599 [00:04<00:01, 115.20it/s] 75%|  | 451/599 [00:04<00:01, 116.16it/s] 77%|  | 463/599 [00:04<00:01, 116.83it/s] 79%|  | 475/599 [00:04<00:01, 117.48it/s] 81%| | 487/599 [00:04<00:00, 117.87it/s] 83%| | 499/599 [00:04<00:00, 118.00it/s] 85%| | 511/599 [00:04<00:00, 118.24it/s] 87%| | 523/599 [00:05<00:00, 118.27it/s] 89%| | 535/599 [00:05<00:00, 118.51it/s] 91%|| 547/599 [00:05<00:00, 118.78it/s] 93%|| 560/599 [00:05<00:00, 119.54it/s] 96%|| 573/599 [00:05<00:00, 120.10it/s] 98%|| 586/599 [00:05<00:00, 108.80it/s]100%|| 599/599 [00:05<00:00, 112.56it/s]100%|| 599/599 [00:05<00:00, 103.27it/s]
tensor([0.4849, 0.4985, 0.4863, 0.4968, 0.4897], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 12 of 101
train loss is 0.6449366807937622
val loss is 0.65385988023546
test loss is 0.6644279821488216
validation accuracy is 80.03472222222223
test accuracy is 92.70212747258614
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:46,  5.81s/it]  5%|         | 2/40 [00:06<01:37,  2.56s/it]  8%|         | 3/40 [00:06<00:56,  1.52s/it] 10%|         | 4/40 [00:06<00:37,  1.03s/it] 12%|        | 5/40 [00:06<00:26,  1.31it/s] 15%|        | 6/40 [00:07<00:20,  1.66it/s] 18%|        | 7/40 [00:07<00:16,  2.00it/s] 20%|        | 8/40 [00:07<00:13,  2.32it/s] 22%|       | 9/40 [00:08<00:11,  2.59it/s] 25%|       | 10/40 [00:08<00:10,  2.81it/s] 28%|       | 11/40 [00:08<00:09,  2.99it/s] 30%|       | 12/40 [00:08<00:08,  3.12it/s] 32%|      | 13/40 [00:09<00:08,  3.23it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:11<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.49it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:17<00:00,  2.34it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.48s/it] 22%|       | 2/9 [00:02<00:09,  1.36s/it] 56%|    | 5/9 [00:02<00:01,  2.37it/s] 89%| | 8/9 [00:03<00:00,  4.30it/s]100%|| 9/9 [00:03<00:00,  2.85it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:03,  2.45it/s]  1%|          | 7/599 [00:00<00:34, 17.19it/s]  3%|         | 19/599 [00:00<00:12, 44.70it/s]  5%|         | 31/599 [00:00<00:08, 65.36it/s]  7%|         | 43/599 [00:00<00:06, 80.34it/s]  9%|         | 55/599 [00:00<00:05, 91.22it/s] 11%|         | 67/599 [00:01<00:05, 98.82it/s] 13%|        | 79/599 [00:01<00:04, 104.65it/s] 15%|        | 91/599 [00:01<00:04, 108.60it/s] 17%|        | 103/599 [00:01<00:04, 111.40it/s] 19%|        | 115/599 [00:01<00:04, 113.23it/s] 21%|        | 127/599 [00:01<00:04, 114.53it/s] 23%|       | 139/599 [00:01<00:04, 114.37it/s] 25%|       | 151/599 [00:01<00:03, 115.19it/s] 27%|       | 163/599 [00:01<00:03, 116.01it/s] 29%|       | 175/599 [00:01<00:03, 112.87it/s] 31%|       | 187/599 [00:02<00:03, 106.74it/s] 33%|      | 199/599 [00:02<00:03, 109.97it/s] 35%|      | 211/599 [00:02<00:03, 109.95it/s] 37%|      | 223/599 [00:02<00:03, 111.13it/s] 39%|      | 235/599 [00:02<00:03, 112.12it/s] 41%|      | 247/599 [00:02<00:03, 101.02it/s] 43%|     | 259/599 [00:02<00:03, 103.85it/s] 45%|     | 270/599 [00:02<00:03, 103.77it/s] 47%|     | 282/599 [00:02<00:02, 107.74it/s] 49%|     | 294/599 [00:03<00:02, 110.67it/s] 51%|     | 306/599 [00:03<00:02, 112.83it/s] 53%|    | 318/599 [00:03<00:02, 114.42it/s] 55%|    | 330/599 [00:03<00:02, 115.12it/s] 57%|    | 342/599 [00:03<00:02, 116.10it/s] 59%|    | 354/599 [00:03<00:02, 107.24it/s] 61%|    | 366/599 [00:03<00:02, 110.52it/s] 63%|   | 378/599 [00:03<00:01, 112.80it/s] 65%|   | 390/599 [00:03<00:02, 98.83it/s]  67%|   | 402/599 [00:04<00:01, 104.08it/s] 69%|   | 414/599 [00:04<00:01, 108.10it/s] 71%|   | 426/599 [00:04<00:01, 110.97it/s] 73%|  | 438/599 [00:04<00:01, 113.09it/s] 75%|  | 450/599 [00:04<00:01, 114.55it/s] 77%|  | 462/599 [00:04<00:01, 115.77it/s] 79%|  | 474/599 [00:04<00:01, 116.57it/s] 81%|  | 486/599 [00:04<00:00, 117.29it/s] 83%| | 498/599 [00:04<00:00, 117.57it/s] 85%| | 510/599 [00:04<00:00, 117.89it/s] 87%| | 522/599 [00:05<00:00, 118.08it/s] 89%| | 534/599 [00:05<00:00, 118.32it/s] 91%| | 546/599 [00:05<00:00, 117.66it/s] 93%|| 559/599 [00:05<00:00, 118.56it/s] 95%|| 572/599 [00:05<00:00, 119.41it/s] 97%|| 584/599 [00:05<00:00, 103.61it/s]100%|| 597/599 [00:05<00:00, 108.80it/s]100%|| 599/599 [00:05<00:00, 102.57it/s]
tensor([0.4802, 0.4971, 0.4819, 0.4946, 0.4863], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 13 of 101
train loss is 0.633700966835022
val loss is 0.645270029703776
test loss is 0.6574097412058427
validation accuracy is 80.03472222222223
test accuracy is 92.79752458117044
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:07,  4.80s/it]  5%|         | 2/40 [00:05<01:21,  2.15s/it]  8%|         | 3/40 [00:05<00:50,  1.37s/it] 10%|         | 4/40 [00:05<00:33,  1.06it/s] 12%|        | 5/40 [00:06<00:24,  1.42it/s] 15%|        | 6/40 [00:06<00:19,  1.78it/s] 18%|        | 7/40 [00:06<00:15,  2.12it/s] 20%|        | 8/40 [00:06<00:13,  2.42it/s] 22%|       | 9/40 [00:07<00:11,  2.66it/s] 25%|       | 10/40 [00:07<00:10,  2.87it/s] 28%|       | 11/40 [00:07<00:09,  3.03it/s] 30%|       | 12/40 [00:08<00:08,  3.15it/s] 32%|      | 13/40 [00:08<00:08,  3.25it/s] 35%|      | 14/40 [00:08<00:07,  3.31it/s] 38%|      | 15/40 [00:08<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.43it/s] 45%|     | 18/40 [00:09<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:10<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:11<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:12<00:03,  3.49it/s] 72%|  | 29/40 [00:12<00:03,  3.48it/s] 75%|  | 30/40 [00:13<00:02,  3.47it/s] 78%|  | 31/40 [00:13<00:02,  3.46it/s] 80%|  | 32/40 [00:13<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:14<00:01,  3.48it/s] 88%| | 35/40 [00:14<00:01,  3.48it/s] 90%| | 36/40 [00:15<00:01,  3.50it/s] 92%|| 37/40 [00:15<00:00,  3.50it/s] 95%|| 38/40 [00:15<00:00,  3.50it/s] 98%|| 39/40 [00:15<00:00,  3.50it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.46it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.43s/it] 22%|       | 2/9 [00:02<00:09,  1.37s/it] 56%|    | 5/9 [00:02<00:01,  2.37it/s] 89%| | 8/9 [00:03<00:00,  4.30it/s]100%|| 9/9 [00:03<00:00,  2.86it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:40,  2.71it/s]  1%|          | 5/599 [00:00<00:45, 13.10it/s]  3%|         | 17/599 [00:00<00:13, 43.41it/s]  5%|         | 29/599 [00:00<00:08, 64.72it/s]  7%|         | 41/599 [00:00<00:06, 80.41it/s]  9%|         | 53/599 [00:00<00:05, 91.69it/s] 11%|         | 65/599 [00:00<00:05, 99.90it/s] 13%|        | 77/599 [00:01<00:04, 105.72it/s] 15%|        | 90/599 [00:01<00:04, 110.41it/s] 17%|        | 102/599 [00:01<00:04, 113.15it/s] 19%|        | 114/599 [00:01<00:05, 85.55it/s]  21%|        | 126/599 [00:01<00:05, 93.49it/s] 23%|       | 138/599 [00:01<00:04, 99.86it/s] 25%|       | 150/599 [00:01<00:04, 104.70it/s] 27%|       | 162/599 [00:01<00:04, 108.34it/s] 29%|       | 174/599 [00:02<00:03, 110.60it/s] 31%|       | 186/599 [00:02<00:03, 112.64it/s] 33%|      | 198/599 [00:02<00:03, 112.84it/s] 35%|      | 210/599 [00:02<00:03, 113.84it/s] 37%|      | 222/599 [00:02<00:03, 114.71it/s] 39%|      | 234/599 [00:02<00:03, 115.62it/s] 41%|      | 246/599 [00:02<00:03, 116.18it/s] 43%|     | 258/599 [00:02<00:02, 116.73it/s] 45%|     | 270/599 [00:02<00:03, 109.61it/s] 47%|     | 282/599 [00:02<00:02, 112.02it/s] 49%|     | 294/599 [00:03<00:02, 113.85it/s] 51%|     | 306/599 [00:03<00:02, 114.91it/s] 53%|    | 318/599 [00:03<00:02, 115.52it/s] 55%|    | 330/599 [00:03<00:02, 115.89it/s] 57%|    | 342/599 [00:03<00:02, 116.23it/s] 59%|    | 354/599 [00:03<00:02, 115.98it/s] 61%|    | 366/599 [00:03<00:02, 116.35it/s] 63%|   | 378/599 [00:03<00:01, 116.97it/s] 65%|   | 390/599 [00:03<00:01, 106.24it/s] 67%|   | 402/599 [00:04<00:01, 109.67it/s] 69%|   | 414/599 [00:04<00:01, 112.25it/s] 71%|   | 426/599 [00:04<00:01, 114.24it/s] 73%|  | 438/599 [00:04<00:01, 115.56it/s] 75%|  | 450/599 [00:04<00:01, 116.37it/s] 77%|  | 462/599 [00:04<00:01, 117.25it/s] 79%|  | 474/599 [00:04<00:01, 117.65it/s] 81%|  | 486/599 [00:04<00:00, 118.16it/s] 83%| | 498/599 [00:04<00:00, 118.46it/s] 85%| | 510/599 [00:04<00:00, 118.09it/s] 87%| | 522/599 [00:05<00:00, 118.19it/s] 89%| | 534/599 [00:05<00:00, 117.92it/s] 91%| | 546/599 [00:05<00:00, 118.32it/s] 93%|| 559/599 [00:05<00:00, 118.87it/s] 95%|| 572/599 [00:05<00:00, 119.30it/s] 98%|| 585/599 [00:05<00:00, 119.94it/s]100%|| 598/599 [00:05<00:00, 120.57it/s]100%|| 599/599 [00:05<00:00, 104.26it/s]
tensor([0.4753, 0.4951, 0.4773, 0.4917, 0.4827], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 14 of 101
train loss is 0.622979462146759
val loss is 0.6362029181586372
test loss is 0.6498664773764316
validation accuracy is 80.03472222222223
test accuracy is 93.05986667435634
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:46,  5.81s/it]  5%|         | 2/40 [00:06<01:37,  2.56s/it]  8%|         | 3/40 [00:06<00:56,  1.52s/it] 10%|         | 4/40 [00:06<00:37,  1.04s/it] 12%|        | 5/40 [00:06<00:26,  1.31it/s] 15%|        | 6/40 [00:07<00:20,  1.66it/s] 18%|        | 7/40 [00:07<00:16,  2.00it/s] 20%|        | 8/40 [00:07<00:13,  2.31it/s] 22%|       | 9/40 [00:08<00:11,  2.59it/s] 25%|       | 10/40 [00:08<00:10,  2.81it/s] 28%|       | 11/40 [00:08<00:09,  2.99it/s] 30%|       | 12/40 [00:08<00:08,  3.12it/s] 32%|      | 13/40 [00:09<00:08,  3.23it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.49it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.48it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.34it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.44s/it] 22%|       | 2/9 [00:02<00:09,  1.37s/it] 44%|     | 4/9 [00:02<00:02,  1.80it/s] 78%|  | 7/9 [00:03<00:00,  3.78it/s]100%|| 9/9 [00:03<00:00,  2.80it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:58,  3.36it/s]  0%|          | 2/599 [00:00<01:51,  5.35it/s]  2%|         | 11/599 [00:00<00:21, 27.20it/s]  4%|         | 23/599 [00:00<00:11, 51.97it/s]  6%|         | 35/599 [00:00<00:07, 70.66it/s]  7%|         | 44/599 [00:00<00:08, 67.38it/s]  9%|         | 56/599 [00:01<00:06, 80.94it/s] 11%|        | 68/599 [00:01<00:05, 91.12it/s] 13%|        | 78/599 [00:01<00:06, 80.86it/s] 15%|        | 90/599 [00:01<00:05, 90.58it/s] 17%|        | 102/599 [00:01<00:05, 98.26it/s] 19%|        | 113/599 [00:01<00:05, 93.47it/s] 21%|        | 125/599 [00:01<00:04, 100.45it/s] 23%|       | 137/599 [00:01<00:04, 105.59it/s] 25%|       | 149/599 [00:01<00:04, 109.47it/s] 27%|       | 161/599 [00:02<00:03, 112.17it/s] 29%|       | 173/599 [00:02<00:03, 114.00it/s] 31%|       | 185/599 [00:02<00:03, 115.38it/s] 33%|      | 197/599 [00:02<00:03, 116.40it/s] 35%|      | 209/599 [00:02<00:03, 116.80it/s] 37%|      | 221/599 [00:02<00:03, 117.27it/s] 39%|      | 233/599 [00:02<00:03, 117.56it/s] 41%|      | 245/599 [00:02<00:03, 117.94it/s] 43%|     | 257/599 [00:02<00:02, 118.15it/s] 45%|     | 269/599 [00:02<00:02, 111.41it/s] 47%|     | 281/599 [00:03<00:02, 113.49it/s] 49%|     | 293/599 [00:03<00:02, 115.03it/s] 51%|     | 305/599 [00:03<00:02, 111.34it/s] 53%|    | 317/599 [00:03<00:02, 113.06it/s] 55%|    | 329/599 [00:03<00:02, 114.40it/s] 57%|    | 341/599 [00:03<00:02, 115.36it/s] 59%|    | 353/599 [00:03<00:02, 116.13it/s] 61%|    | 365/599 [00:03<00:02, 116.37it/s] 63%|   | 377/599 [00:03<00:01, 116.90it/s] 65%|   | 389/599 [00:04<00:01, 105.89it/s] 67%|   | 401/599 [00:04<00:01, 109.24it/s] 69%|   | 413/599 [00:04<00:01, 111.84it/s] 71%|   | 425/599 [00:04<00:01, 113.48it/s] 73%|  | 437/599 [00:04<00:01, 114.78it/s] 75%|  | 449/599 [00:04<00:01, 115.65it/s] 77%|  | 461/599 [00:04<00:01, 116.30it/s] 79%|  | 473/599 [00:04<00:01, 116.42it/s] 81%|  | 485/599 [00:04<00:00, 116.82it/s] 83%| | 497/599 [00:04<00:00, 117.10it/s] 85%| | 509/599 [00:05<00:00, 117.31it/s] 87%| | 521/599 [00:05<00:00, 116.69it/s] 89%| | 533/599 [00:05<00:00, 116.85it/s] 91%| | 545/599 [00:05<00:00, 117.38it/s] 93%|| 557/599 [00:05<00:00, 118.10it/s] 95%|| 570/599 [00:05<00:00, 118.89it/s] 97%|| 583/599 [00:05<00:00, 119.65it/s] 99%|| 596/599 [00:05<00:00, 120.21it/s]100%|| 599/599 [00:05<00:00, 102.00it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:228: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  ns_fpr, ns_tpr, _ = roc_curve(np.array(labels_list.cpu()), ns_probs)
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:229: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  lr_fpr, lr_tpr, _ = roc_curve(np.array(labels_list.cpu()), np.array(probs_list.detach().cpu()))
tensor([0.4697, 0.4924, 0.4719, 0.4883, 0.4785], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 15 of 101
train loss is 0.6141377687454224
val loss is 0.6261380513509115
test loss is 0.6412896460205167
validation accuracy is 80.64236111111111
test accuracy is 93.31028410031122
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:05<03:47,  5.84s/it]  5%|         | 2/40 [00:06<01:37,  2.57s/it]  8%|         | 3/40 [00:06<00:56,  1.53s/it] 10%|         | 4/40 [00:06<00:37,  1.04s/it] 12%|        | 5/40 [00:06<00:26,  1.30it/s] 15%|        | 6/40 [00:07<00:20,  1.66it/s] 18%|        | 7/40 [00:07<00:16,  2.00it/s] 20%|        | 8/40 [00:07<00:13,  2.31it/s] 22%|       | 9/40 [00:08<00:11,  2.58it/s] 25%|       | 10/40 [00:08<00:10,  2.81it/s] 28%|       | 11/40 [00:08<00:09,  2.99it/s] 30%|       | 12/40 [00:08<00:08,  3.12it/s] 32%|      | 13/40 [00:09<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:11<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:13<00:04,  3.48it/s] 68%|   | 27/40 [00:13<00:03,  3.48it/s] 70%|   | 28/40 [00:13<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:15<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.33it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:11,  1.48s/it] 22%|       | 2/9 [00:02<00:09,  1.35s/it] 44%|     | 4/9 [00:02<00:02,  1.82it/s] 78%|  | 7/9 [00:03<00:00,  3.83it/s]100%|| 9/9 [00:03<00:00,  2.83it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:44,  3.64it/s]  1%|          | 6/599 [00:00<00:32, 18.10it/s]  3%|         | 18/599 [00:00<00:11, 49.45it/s]  5%|         | 30/599 [00:00<00:08, 70.73it/s]  7%|         | 39/599 [00:00<00:08, 68.11it/s]  9%|         | 51/599 [00:00<00:06, 82.26it/s] 11%|         | 63/599 [00:00<00:05, 91.26it/s] 13%|        | 75/599 [00:01<00:05, 98.27it/s] 15%|        | 87/599 [00:01<00:04, 102.88it/s] 16%|        | 98/599 [00:01<00:04, 103.89it/s] 18%|        | 110/599 [00:01<00:04, 108.06it/s] 20%|        | 122/599 [00:01<00:05, 86.38it/s]  22%|       | 134/599 [00:01<00:04, 94.37it/s] 24%|       | 145/599 [00:01<00:04, 94.79it/s] 26%|       | 157/599 [00:01<00:04, 100.25it/s] 28%|       | 169/599 [00:01<00:04, 104.99it/s] 30%|       | 180/599 [00:02<00:04, 102.70it/s] 32%|      | 192/599 [00:02<00:03, 107.34it/s] 34%|      | 204/599 [00:02<00:03, 110.78it/s] 36%|      | 216/599 [00:02<00:03, 97.17it/s]  38%|      | 228/599 [00:02<00:03, 102.82it/s] 40%|      | 240/599 [00:02<00:03, 106.98it/s] 42%|     | 252/599 [00:02<00:03, 98.98it/s]  44%|     | 264/599 [00:02<00:03, 104.22it/s] 46%|     | 275/599 [00:03<00:03, 84.78it/s]  48%|     | 287/599 [00:03<00:03, 92.92it/s] 50%|     | 299/599 [00:03<00:03, 98.88it/s] 52%|    | 311/599 [00:03<00:02, 102.69it/s] 54%|    | 323/599 [00:03<00:02, 106.88it/s] 56%|    | 335/599 [00:03<00:02, 109.84it/s] 58%|    | 347/599 [00:03<00:02, 112.23it/s] 60%|    | 359/599 [00:03<00:02, 105.78it/s] 62%|   | 371/599 [00:03<00:02, 109.18it/s] 64%|   | 383/599 [00:04<00:01, 111.79it/s] 66%|   | 395/599 [00:04<00:02, 99.58it/s]  68%|   | 407/599 [00:04<00:01, 104.79it/s] 70%|   | 419/599 [00:04<00:01, 108.67it/s] 72%|  | 431/599 [00:04<00:01, 111.34it/s] 74%|  | 443/599 [00:04<00:01, 113.16it/s] 76%|  | 455/599 [00:04<00:01, 107.26it/s] 78%|  | 467/599 [00:04<00:01, 110.20it/s] 80%|  | 479/599 [00:04<00:01, 112.59it/s] 82%| | 491/599 [00:05<00:00, 114.28it/s] 84%| | 503/599 [00:05<00:00, 113.88it/s] 86%| | 515/599 [00:05<00:00, 115.02it/s] 88%| | 527/599 [00:05<00:00, 115.74it/s] 90%| | 539/599 [00:05<00:00, 116.34it/s] 92%|| 551/599 [00:05<00:00, 116.84it/s] 94%|| 564/599 [00:05<00:00, 118.12it/s] 96%|| 577/599 [00:05<00:00, 119.30it/s] 98%|| 589/599 [00:05<00:00, 108.57it/s]100%|| 599/599 [00:06<00:00, 98.82it/s] 
tensor([0.4636, 0.4890, 0.4658, 0.4841, 0.4736], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 16 of 101
train loss is 0.603449821472168
val loss is 0.6152576870388455
test loss is 0.631831628850386
validation accuracy is 81.42361111111111
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:42,  5.72s/it]  5%|         | 2/40 [00:06<01:35,  2.52s/it]  8%|         | 3/40 [00:06<00:55,  1.50s/it] 10%|         | 4/40 [00:06<00:36,  1.02s/it] 12%|        | 5/40 [00:06<00:26,  1.32it/s] 15%|        | 6/40 [00:07<00:20,  1.67it/s] 18%|        | 7/40 [00:07<00:16,  2.01it/s] 20%|        | 8/40 [00:07<00:13,  2.33it/s] 22%|       | 9/40 [00:08<00:11,  2.60it/s] 25%|       | 10/40 [00:08<00:10,  2.82it/s] 28%|       | 11/40 [00:08<00:09,  2.99it/s] 30%|       | 12/40 [00:08<00:08,  3.13it/s] 32%|      | 13/40 [00:09<00:08,  3.23it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:11<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.49it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.35it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.42s/it] 22%|       | 2/9 [00:02<00:09,  1.36s/it] 56%|    | 5/9 [00:02<00:01,  2.37it/s] 89%| | 8/9 [00:03<00:00,  4.31it/s]100%|| 9/9 [00:03<00:00,  2.86it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:33,  3.88it/s]  1%|          | 3/599 [00:00<01:14,  7.98it/s]  2%|         | 12/599 [00:00<00:18, 31.99it/s]  4%|         | 24/599 [00:00<00:10, 57.34it/s]  6%|         | 35/599 [00:00<00:09, 62.21it/s]  8%|         | 47/599 [00:00<00:07, 76.91it/s] 10%|         | 59/599 [00:00<00:06, 88.58it/s] 12%|        | 71/599 [00:01<00:05, 97.10it/s] 14%|        | 83/599 [00:01<00:05, 103.09it/s] 16%|        | 95/599 [00:01<00:04, 107.53it/s] 18%|        | 107/599 [00:01<00:04, 110.62it/s] 20%|        | 119/599 [00:01<00:04, 101.55it/s] 22%|       | 131/599 [00:01<00:04, 106.15it/s] 24%|       | 142/599 [00:01<00:04, 99.11it/s]  26%|       | 154/599 [00:01<00:04, 102.36it/s] 28%|       | 166/599 [00:01<00:04, 105.99it/s] 30%|       | 177/599 [00:02<00:03, 106.96it/s] 32%|      | 189/599 [00:02<00:03, 109.41it/s] 34%|      | 201/599 [00:02<00:03, 111.73it/s] 36%|      | 213/599 [00:02<00:03, 113.49it/s] 38%|      | 225/599 [00:02<00:03, 113.74it/s] 40%|      | 237/599 [00:02<00:03, 114.73it/s] 42%|     | 249/599 [00:02<00:03, 115.68it/s] 44%|     | 261/599 [00:02<00:02, 116.51it/s] 46%|     | 273/599 [00:02<00:02, 117.01it/s] 48%|     | 285/599 [00:02<00:02, 117.40it/s] 50%|     | 297/599 [00:03<00:02, 117.69it/s] 52%|    | 309/599 [00:03<00:02, 117.85it/s] 54%|    | 321/599 [00:03<00:02, 118.05it/s] 56%|    | 333/599 [00:03<00:02, 118.28it/s] 58%|    | 345/599 [00:03<00:02, 118.38it/s] 60%|    | 357/599 [00:03<00:02, 118.30it/s] 62%|   | 369/599 [00:03<00:01, 118.25it/s] 64%|   | 381/599 [00:03<00:01, 117.81it/s] 66%|   | 393/599 [00:03<00:02, 102.08it/s] 68%|   | 405/599 [00:04<00:01, 106.08it/s] 70%|   | 417/599 [00:04<00:01, 109.41it/s] 72%|  | 429/599 [00:04<00:01, 111.61it/s] 74%|  | 441/599 [00:04<00:01, 113.46it/s] 76%|  | 453/599 [00:04<00:01, 114.07it/s] 78%|  | 465/599 [00:04<00:01, 114.41it/s] 80%|  | 477/599 [00:04<00:01, 115.23it/s] 82%| | 489/599 [00:04<00:00, 115.63it/s] 84%| | 501/599 [00:04<00:00, 116.36it/s] 86%| | 513/599 [00:04<00:00, 116.96it/s] 88%| | 525/599 [00:05<00:00, 117.20it/s] 90%| | 537/599 [00:05<00:00, 117.45it/s] 92%|| 549/599 [00:05<00:00, 118.15it/s] 94%|| 562/599 [00:05<00:00, 118.83it/s] 96%|| 575/599 [00:05<00:00, 119.73it/s] 98%|| 587/599 [00:05<00:00, 112.37it/s]100%|| 599/599 [00:05<00:00, 103.12it/s]
tensor([0.4570, 0.4856, 0.4597, 0.4797, 0.4688], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 17 of 101
train loss is 0.5938799381256104
val loss is 0.6042461395263672
test loss is 0.6221694126352046
validation accuracy is 81.68402777777777
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:09,  4.86s/it]  5%|         | 2/40 [00:05<01:32,  2.43s/it]  8%|         | 3/40 [00:05<00:53,  1.45s/it] 10%|         | 4/40 [00:06<00:35,  1.01it/s] 12%|        | 5/40 [00:06<00:25,  1.35it/s] 15%|        | 6/40 [00:06<00:19,  1.71it/s] 18%|        | 7/40 [00:07<00:16,  2.05it/s] 20%|        | 8/40 [00:07<00:13,  2.36it/s] 22%|       | 9/40 [00:07<00:11,  2.62it/s] 25%|       | 10/40 [00:07<00:10,  2.84it/s] 28%|       | 11/40 [00:08<00:09,  3.01it/s] 30%|       | 12/40 [00:08<00:08,  3.14it/s] 32%|      | 13/40 [00:08<00:08,  3.23it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.47it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.48it/s] 80%|  | 32/40 [00:14<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.41it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.42s/it] 22%|       | 2/9 [00:02<00:09,  1.39s/it] 44%|     | 4/9 [00:02<00:02,  1.81it/s] 78%|  | 7/9 [00:03<00:00,  3.79it/s]100%|| 9/9 [00:03<00:00,  2.81it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:36,  2.76it/s]  1%|          | 4/599 [00:00<00:58, 10.23it/s]  2%|         | 12/599 [00:00<00:19, 29.65it/s]  4%|         | 24/599 [00:00<00:10, 55.34it/s]  6%|         | 36/599 [00:00<00:07, 74.00it/s]  8%|         | 46/599 [00:00<00:07, 78.86it/s] 10%|         | 59/599 [00:00<00:05, 91.38it/s] 12%|        | 72/599 [00:01<00:05, 100.14it/s] 14%|        | 83/599 [00:01<00:06, 85.05it/s]  16%|        | 96/599 [00:01<00:05, 94.42it/s] 18%|        | 107/599 [00:01<00:05, 96.13it/s] 20%|        | 119/599 [00:01<00:04, 102.22it/s] 22%|       | 131/599 [00:01<00:04, 105.93it/s] 24%|       | 143/599 [00:01<00:04, 108.45it/s] 26%|       | 155/599 [00:01<00:03, 111.10it/s] 28%|       | 167/599 [00:02<00:03, 112.94it/s] 30%|       | 179/599 [00:02<00:04, 98.86it/s]  32%|      | 191/599 [00:02<00:03, 103.81it/s] 34%|      | 203/599 [00:02<00:03, 107.37it/s] 36%|      | 215/599 [00:02<00:03, 109.46it/s] 38%|      | 227/599 [00:02<00:03, 111.57it/s] 40%|      | 239/599 [00:02<00:03, 90.67it/s]  42%|     | 251/599 [00:02<00:03, 97.53it/s] 44%|     | 262/599 [00:03<00:03, 85.44it/s] 46%|     | 274/599 [00:03<00:03, 93.45it/s] 48%|     | 286/599 [00:03<00:03, 99.77it/s] 50%|     | 298/599 [00:03<00:02, 104.55it/s] 52%|    | 310/599 [00:03<00:02, 108.18it/s] 54%|    | 322/599 [00:03<00:02, 110.86it/s] 56%|    | 334/599 [00:03<00:02, 112.93it/s] 58%|    | 346/599 [00:03<00:02, 114.12it/s] 60%|    | 358/599 [00:03<00:02, 113.04it/s] 62%|   | 370/599 [00:03<00:02, 114.15it/s] 64%|   | 382/599 [00:04<00:01, 113.99it/s] 66%|   | 394/599 [00:04<00:01, 113.67it/s] 68%|   | 406/599 [00:04<00:01, 114.04it/s] 70%|   | 418/599 [00:04<00:01, 115.24it/s] 72%|  | 430/599 [00:04<00:01, 116.12it/s] 74%|  | 442/599 [00:04<00:01, 116.63it/s] 76%|  | 454/599 [00:04<00:01, 117.02it/s] 78%|  | 466/599 [00:04<00:01, 115.79it/s] 80%|  | 478/599 [00:04<00:01, 116.39it/s] 82%| | 490/599 [00:04<00:00, 116.80it/s] 84%| | 502/599 [00:05<00:00, 116.78it/s] 86%| | 514/599 [00:05<00:00, 117.18it/s] 88%| | 526/599 [00:05<00:00, 116.82it/s] 90%| | 538/599 [00:05<00:00, 117.12it/s] 92%|| 550/599 [00:05<00:00, 117.63it/s] 94%|| 562/599 [00:05<00:00, 118.22it/s] 96%|| 575/599 [00:05<00:00, 119.24it/s] 98%|| 588/599 [00:05<00:00, 120.04it/s]100%|| 599/599 [00:05<00:00, 99.92it/s] 
tensor([0.4500, 0.4814, 0.4529, 0.4749, 0.4634], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 18 of 101
train loss is 0.584189772605896
val loss is 0.5928861829969618
test loss is 0.6119114883953024
validation accuracy is 82.37847222222223
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:47,  5.83s/it]  5%|         | 2/40 [00:06<01:37,  2.57s/it]  8%|         | 3/40 [00:06<00:56,  1.53s/it] 10%|         | 4/40 [00:06<00:37,  1.04s/it] 12%|        | 5/40 [00:06<00:26,  1.30it/s] 15%|        | 6/40 [00:07<00:20,  1.65it/s] 18%|        | 7/40 [00:07<00:16,  2.00it/s] 20%|        | 8/40 [00:07<00:13,  2.31it/s] 22%|       | 9/40 [00:08<00:12,  2.58it/s] 25%|       | 10/40 [00:08<00:10,  2.81it/s] 28%|       | 11/40 [00:08<00:09,  2.98it/s] 30%|       | 12/40 [00:08<00:08,  3.12it/s] 32%|      | 13/40 [00:09<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:11<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.46it/s] 65%|   | 26/40 [00:13<00:04,  3.47it/s] 68%|   | 27/40 [00:13<00:03,  3.46it/s] 70%|   | 28/40 [00:13<00:03,  3.47it/s] 72%|  | 29/40 [00:13<00:03,  3.48it/s] 75%|  | 30/40 [00:14<00:02,  3.48it/s] 78%|  | 31/40 [00:14<00:02,  3.48it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:15<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.33it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.43s/it] 22%|       | 2/9 [00:02<00:09,  1.35s/it] 56%|    | 5/9 [00:02<00:01,  2.39it/s] 89%| | 8/9 [00:03<00:00,  4.34it/s]100%|| 9/9 [00:03<00:00,  2.86it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:22,  2.28it/s]  0%|          | 2/599 [00:00<02:27,  4.04it/s]  2%|         | 14/599 [00:00<00:17, 33.30it/s]  4%|         | 25/599 [00:00<00:10, 52.80it/s]  6%|         | 37/599 [00:00<00:07, 70.83it/s]  8%|         | 49/599 [00:00<00:06, 84.41it/s] 10%|         | 61/599 [00:01<00:05, 94.20it/s] 12%|        | 73/599 [00:01<00:05, 101.35it/s] 14%|        | 85/599 [00:01<00:04, 106.52it/s] 16%|        | 97/599 [00:01<00:04, 110.08it/s] 18%|        | 109/599 [00:01<00:04, 112.56it/s] 20%|        | 121/599 [00:01<00:04, 114.20it/s] 22%|       | 133/599 [00:01<00:04, 115.59it/s] 24%|       | 145/599 [00:01<00:03, 116.53it/s] 26%|       | 157/599 [00:01<00:03, 117.20it/s] 28%|       | 169/599 [00:01<00:03, 117.51it/s] 30%|       | 181/599 [00:02<00:03, 117.83it/s] 32%|      | 193/599 [00:02<00:03, 118.01it/s] 34%|      | 205/599 [00:02<00:03, 118.13it/s] 36%|      | 217/599 [00:02<00:03, 118.28it/s] 38%|      | 229/599 [00:02<00:03, 112.70it/s] 40%|      | 241/599 [00:02<00:03, 114.37it/s] 42%|     | 253/599 [00:02<00:03, 115.25it/s] 44%|     | 265/599 [00:02<00:03, 87.36it/s]  46%|     | 277/599 [00:03<00:03, 94.91it/s] 48%|     | 289/599 [00:03<00:03, 100.34it/s] 50%|     | 301/599 [00:03<00:02, 105.08it/s] 52%|    | 313/599 [00:03<00:02, 108.56it/s] 54%|    | 325/599 [00:03<00:02, 103.60it/s] 56%|    | 337/599 [00:03<00:02, 107.70it/s] 58%|    | 349/599 [00:03<00:02, 110.59it/s] 60%|    | 361/599 [00:03<00:02, 100.92it/s] 62%|   | 373/599 [00:03<00:02, 105.61it/s] 64%|   | 385/599 [00:04<00:01, 109.09it/s] 66%|   | 397/599 [00:04<00:02, 90.45it/s]  68%|   | 409/599 [00:04<00:01, 96.44it/s] 70%|   | 420/599 [00:04<00:01, 99.27it/s] 72%|  | 432/599 [00:04<00:01, 104.37it/s] 74%|  | 444/599 [00:04<00:01, 108.33it/s] 76%|  | 456/599 [00:04<00:01, 106.61it/s] 78%|  | 468/599 [00:04<00:01, 109.94it/s] 80%|  | 480/599 [00:04<00:01, 112.37it/s] 82%| | 492/599 [00:05<00:00, 113.49it/s] 84%| | 504/599 [00:05<00:00, 114.94it/s] 86%| | 516/599 [00:05<00:00, 115.81it/s] 88%| | 528/599 [00:05<00:00, 116.45it/s] 90%| | 540/599 [00:05<00:00, 117.20it/s] 92%|| 552/599 [00:05<00:00, 114.25it/s] 94%|| 565/599 [00:05<00:00, 116.31it/s] 96%|| 578/599 [00:05<00:00, 102.42it/s] 99%|| 591/599 [00:05<00:00, 107.79it/s]100%|| 599/599 [00:06<00:00, 98.97it/s] 
tensor([0.4424, 0.4771, 0.4456, 0.4697, 0.4578], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 19 of 101
train loss is 0.5713018178939819
val loss is 0.5811746385362413
test loss is 0.6013446770645741
validation accuracy is 82.89930555555556
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:48,  5.86s/it]  5%|         | 2/40 [00:06<01:38,  2.58s/it]  8%|         | 3/40 [00:06<00:56,  1.53s/it] 10%|         | 4/40 [00:06<00:37,  1.04s/it] 12%|        | 5/40 [00:07<00:26,  1.30it/s] 15%|        | 6/40 [00:07<00:20,  1.65it/s] 18%|        | 7/40 [00:07<00:16,  1.99it/s] 20%|        | 8/40 [00:07<00:13,  2.31it/s] 22%|       | 9/40 [00:08<00:12,  2.58it/s] 25%|       | 10/40 [00:08<00:10,  2.80it/s] 28%|       | 11/40 [00:08<00:09,  2.98it/s] 30%|       | 12/40 [00:09<00:08,  3.12it/s] 32%|      | 13/40 [00:09<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:11<00:06,  3.46it/s] 50%|     | 20/40 [00:11<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.49it/s] 65%|   | 26/40 [00:13<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.48it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:15<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.33it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.41s/it] 22%|       | 2/9 [00:02<00:09,  1.37s/it] 44%|     | 4/9 [00:02<00:02,  1.81it/s] 78%|  | 7/9 [00:03<00:00,  3.80it/s]100%|| 9/9 [00:03<00:00,  2.82it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:47,  3.57it/s]  0%|          | 2/599 [00:00<02:13,  4.48it/s]  2%|         | 12/599 [00:00<00:19, 30.12it/s]  4%|         | 23/599 [00:00<00:11, 51.43it/s]  6%|         | 35/599 [00:00<00:08, 69.55it/s]  8%|         | 47/599 [00:00<00:06, 83.42it/s] 10%|         | 59/599 [00:00<00:05, 93.39it/s] 12%|        | 71/599 [00:01<00:05, 99.82it/s] 14%|        | 82/599 [00:01<00:05, 88.03it/s] 16%|        | 94/599 [00:01<00:05, 95.84it/s] 18%|        | 105/599 [00:01<00:05, 87.95it/s] 20%|        | 117/599 [00:01<00:05, 95.76it/s] 22%|       | 129/599 [00:01<00:04, 101.78it/s] 23%|       | 140/599 [00:01<00:04, 101.82it/s] 25%|       | 152/599 [00:01<00:04, 106.35it/s] 27%|       | 164/599 [00:02<00:03, 109.85it/s] 29%|       | 176/599 [00:02<00:03, 106.82it/s] 31%|      | 188/599 [00:02<00:03, 110.45it/s] 33%|      | 200/599 [00:02<00:03, 112.55it/s] 35%|      | 212/599 [00:02<00:03, 113.54it/s] 37%|      | 224/599 [00:02<00:03, 114.23it/s] 39%|      | 236/599 [00:02<00:03, 114.72it/s] 41%|     | 248/599 [00:02<00:03, 115.50it/s] 43%|     | 260/599 [00:02<00:02, 116.38it/s] 45%|     | 272/599 [00:02<00:03, 101.93it/s] 47%|     | 284/599 [00:03<00:02, 105.87it/s] 49%|     | 296/599 [00:03<00:02, 109.46it/s] 51%|    | 308/599 [00:03<00:02, 110.79it/s] 53%|    | 320/599 [00:03<00:02, 113.35it/s] 55%|    | 332/599 [00:03<00:02, 108.90it/s] 57%|    | 344/599 [00:03<00:02, 111.94it/s] 59%|    | 356/599 [00:03<00:02, 102.13it/s] 61%|   | 368/599 [00:03<00:02, 106.67it/s] 63%|   | 380/599 [00:03<00:01, 110.03it/s] 65%|   | 392/599 [00:04<00:02, 97.07it/s]  67%|   | 404/599 [00:04<00:01, 102.84it/s] 69%|   | 416/599 [00:04<00:01, 106.99it/s] 71%|  | 428/599 [00:04<00:01, 110.27it/s] 73%|  | 440/599 [00:04<00:01, 112.34it/s] 75%|  | 452/599 [00:04<00:01, 114.01it/s] 77%|  | 464/599 [00:04<00:01, 115.20it/s] 79%|  | 476/599 [00:04<00:01, 115.77it/s] 81%| | 488/599 [00:04<00:00, 116.46it/s] 83%| | 500/599 [00:05<00:00, 115.83it/s] 85%| | 512/599 [00:05<00:00, 116.37it/s] 87%| | 524/599 [00:05<00:00, 116.77it/s] 89%| | 536/599 [00:05<00:00, 117.07it/s] 91%|| 548/599 [00:05<00:00, 117.75it/s] 93%|| 560/599 [00:05<00:00, 118.39it/s] 96%|| 573/599 [00:05<00:00, 119.20it/s] 98%|| 586/599 [00:05<00:00, 119.86it/s]100%|| 599/599 [00:05<00:00, 120.37it/s]100%|| 599/599 [00:05<00:00, 100.57it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:228: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  ns_fpr, ns_tpr, _ = roc_curve(np.array(labels_list.cpu()), ns_probs)
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:229: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  lr_fpr, lr_tpr, _ = roc_curve(np.array(labels_list.cpu()), np.array(probs_list.detach().cpu()))
tensor([0.4338, 0.4712, 0.4373, 0.4631, 0.4512], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 20 of 101
train loss is 0.5595723390579224
val loss is 0.5681343078613281
test loss is 0.5892571234742867
validation accuracy is 85.50347222222223
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:05<03:45,  5.79s/it]  5%|         | 2/40 [00:06<01:37,  2.55s/it]  8%|         | 3/40 [00:06<00:56,  1.52s/it] 10%|         | 4/40 [00:06<00:37,  1.03s/it] 12%|        | 5/40 [00:06<00:26,  1.31it/s] 15%|        | 6/40 [00:07<00:20,  1.66it/s] 18%|        | 7/40 [00:07<00:16,  2.00it/s] 20%|        | 8/40 [00:07<00:13,  2.31it/s] 22%|       | 9/40 [00:08<00:11,  2.58it/s] 25%|       | 10/40 [00:08<00:10,  2.80it/s] 28%|       | 11/40 [00:08<00:09,  2.98it/s] 30%|       | 12/40 [00:08<00:08,  3.11it/s] 32%|      | 13/40 [00:09<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:13<00:03,  3.48it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.46it/s] 78%|  | 31/40 [00:14<00:02,  3.47it/s] 80%|  | 32/40 [00:14<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:15<00:01,  3.48it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.48it/s] 92%|| 37/40 [00:16<00:00,  3.48it/s] 95%|| 38/40 [00:16<00:00,  3.48it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:17<00:00,  2.33it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:11,  1.46s/it] 22%|       | 2/9 [00:02<00:09,  1.41s/it] 56%|    | 5/9 [00:02<00:01,  2.30it/s] 89%| | 8/9 [00:03<00:00,  4.19it/s]100%|| 9/9 [00:03<00:00,  2.78it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:06,  2.43it/s]  1%|          | 6/599 [00:00<00:42, 13.94it/s]  3%|         | 17/599 [00:00<00:15, 38.31it/s]  5%|         | 29/599 [00:00<00:09, 59.95it/s]  7%|         | 39/599 [00:00<00:07, 70.40it/s]  9%|         | 51/599 [00:00<00:06, 83.96it/s] 11%|         | 63/599 [00:01<00:05, 93.82it/s] 13%|        | 75/599 [00:01<00:05, 100.99it/s] 15%|        | 87/599 [00:01<00:04, 106.26it/s] 17%|        | 99/599 [00:01<00:04, 109.86it/s] 19%|        | 111/599 [00:01<00:04, 106.96it/s] 21%|        | 123/599 [00:01<00:04, 110.30it/s] 23%|       | 135/599 [00:01<00:04, 112.68it/s] 25%|       | 147/599 [00:01<00:04, 108.03it/s] 27%|       | 159/599 [00:01<00:03, 110.87it/s] 29%|       | 171/599 [00:02<00:03, 110.10it/s] 31%|       | 183/599 [00:02<00:03, 112.29it/s] 33%|      | 195/599 [00:02<00:03, 113.63it/s] 35%|      | 207/599 [00:02<00:03, 114.92it/s] 37%|      | 219/599 [00:02<00:03, 115.65it/s] 39%|      | 231/599 [00:02<00:03, 103.84it/s] 41%|      | 243/599 [00:02<00:03, 107.70it/s] 43%|     | 255/599 [00:02<00:03, 110.59it/s] 45%|     | 267/599 [00:02<00:02, 111.41it/s] 47%|     | 279/599 [00:02<00:02, 113.06it/s] 49%|     | 291/599 [00:03<00:02, 114.45it/s] 51%|     | 303/599 [00:03<00:02, 115.68it/s] 53%|    | 315/599 [00:03<00:02, 116.54it/s] 55%|    | 327/599 [00:03<00:02, 98.08it/s]  57%|    | 339/599 [00:03<00:02, 103.38it/s] 59%|    | 351/599 [00:03<00:02, 107.54it/s] 61%|    | 363/599 [00:03<00:02, 102.36it/s] 63%|   | 375/599 [00:03<00:02, 106.74it/s] 64%|   | 386/599 [00:04<00:02, 93.10it/s]  66%|   | 398/599 [00:04<00:02, 99.39it/s] 68%|   | 410/599 [00:04<00:01, 104.59it/s] 70%|   | 422/599 [00:04<00:01, 108.20it/s] 72%|  | 434/599 [00:04<00:01, 110.85it/s] 74%|  | 446/599 [00:04<00:01, 113.01it/s] 76%|  | 458/599 [00:04<00:01, 114.24it/s] 78%|  | 470/599 [00:04<00:01, 115.09it/s] 80%|  | 482/599 [00:04<00:01, 115.40it/s] 82%| | 494/599 [00:04<00:00, 116.00it/s] 84%| | 506/599 [00:05<00:00, 116.88it/s] 86%| | 518/599 [00:05<00:00, 117.28it/s] 88%| | 530/599 [00:05<00:00, 117.24it/s] 90%| | 542/599 [00:05<00:00, 117.40it/s] 92%|| 554/599 [00:05<00:00, 117.88it/s] 94%|| 566/599 [00:05<00:00, 118.35it/s] 96%|| 578/599 [00:05<00:00, 112.57it/s] 99%|| 591/599 [00:05<00:00, 115.27it/s]100%|| 599/599 [00:05<00:00, 101.00it/s]
tensor([0.4250, 0.4648, 0.4285, 0.4563, 0.4443], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 21 of 101
train loss is 0.5494937896728516
val loss is 0.5552075703938802
test loss is 0.577074519779925
validation accuracy is 88.54166666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:12,  4.93s/it]  5%|         | 2/40 [00:05<01:24,  2.22s/it]  8%|         | 3/40 [00:05<00:49,  1.34s/it] 10%|         | 4/40 [00:05<00:33,  1.08it/s] 12%|        | 5/40 [00:06<00:24,  1.44it/s] 15%|        | 6/40 [00:06<00:18,  1.80it/s] 18%|        | 7/40 [00:06<00:15,  2.14it/s] 20%|        | 8/40 [00:06<00:13,  2.44it/s] 22%|       | 9/40 [00:07<00:11,  2.69it/s] 25%|       | 10/40 [00:07<00:10,  2.88it/s] 28%|       | 11/40 [00:07<00:09,  3.04it/s] 30%|       | 12/40 [00:08<00:08,  3.16it/s] 32%|      | 13/40 [00:08<00:08,  3.25it/s] 35%|      | 14/40 [00:08<00:07,  3.32it/s] 38%|      | 15/40 [00:08<00:07,  3.37it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.43it/s] 45%|     | 18/40 [00:09<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.46it/s] 57%|    | 23/40 [00:11<00:04,  3.45it/s] 60%|    | 24/40 [00:11<00:04,  3.47it/s] 62%|   | 25/40 [00:11<00:04,  3.47it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:12<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.48it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.49it/s] 80%|  | 32/40 [00:13<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:14<00:01,  3.48it/s] 88%| | 35/40 [00:14<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.48it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:15<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.46it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.43s/it] 22%|       | 2/9 [00:02<00:09,  1.37s/it] 56%|    | 5/9 [00:02<00:01,  2.36it/s] 89%| | 8/9 [00:03<00:00,  4.28it/s]100%|| 9/9 [00:03<00:00,  2.83it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:51,  3.48it/s]  1%|          | 6/599 [00:00<00:31, 18.84it/s]  3%|         | 15/599 [00:00<00:14, 41.02it/s]  5%|         | 27/599 [00:00<00:08, 65.22it/s]  6%|         | 38/599 [00:00<00:07, 75.12it/s]  8%|         | 49/599 [00:00<00:06, 84.62it/s] 10%|         | 61/599 [00:00<00:05, 95.00it/s] 12%|        | 72/599 [00:01<00:07, 70.90it/s] 14%|        | 84/599 [00:01<00:06, 82.16it/s] 16%|        | 96/599 [00:01<00:05, 91.40it/s] 18%|        | 107/599 [00:01<00:05, 90.52it/s] 20%|        | 119/599 [00:01<00:04, 98.00it/s] 22%|       | 131/599 [00:01<00:04, 103.65it/s] 24%|       | 143/599 [00:01<00:04, 107.95it/s] 26%|       | 155/599 [00:01<00:03, 111.24it/s] 28%|       | 167/599 [00:01<00:03, 112.35it/s] 30%|       | 179/599 [00:02<00:03, 113.76it/s] 32%|      | 191/599 [00:02<00:03, 114.99it/s] 34%|      | 203/599 [00:02<00:03, 115.91it/s] 36%|      | 215/599 [00:02<00:03, 116.62it/s] 38%|      | 227/599 [00:02<00:03, 102.80it/s] 40%|      | 239/599 [00:02<00:03, 107.15it/s] 42%|     | 251/599 [00:02<00:03, 110.40it/s] 44%|     | 263/599 [00:02<00:02, 112.65it/s] 46%|     | 275/599 [00:02<00:02, 114.21it/s] 48%|     | 287/599 [00:03<00:02, 115.53it/s] 50%|     | 299/599 [00:03<00:02, 115.91it/s] 52%|    | 311/599 [00:03<00:02, 116.19it/s] 54%|    | 323/599 [00:03<00:02, 115.39it/s] 56%|    | 335/599 [00:03<00:02, 116.33it/s] 58%|    | 347/599 [00:03<00:02, 116.96it/s] 60%|    | 359/599 [00:03<00:02, 110.13it/s] 62%|   | 371/599 [00:03<00:02, 112.29it/s] 64%|   | 383/599 [00:03<00:01, 113.90it/s] 66%|   | 395/599 [00:04<00:02, 98.30it/s]  68%|   | 407/599 [00:04<00:01, 103.36it/s] 70%|   | 419/599 [00:04<00:01, 107.16it/s] 72%|  | 431/599 [00:04<00:01, 110.17it/s] 74%|  | 443/599 [00:04<00:01, 112.61it/s] 76%|  | 455/599 [00:04<00:01, 113.74it/s] 78%|  | 467/599 [00:04<00:01, 115.05it/s] 80%|  | 479/599 [00:04<00:01, 115.37it/s] 82%| | 491/599 [00:04<00:00, 115.77it/s] 84%| | 503/599 [00:04<00:00, 116.30it/s] 86%| | 515/599 [00:05<00:00, 116.47it/s] 88%| | 527/599 [00:05<00:00, 116.70it/s] 90%| | 539/599 [00:05<00:00, 115.89it/s] 92%|| 551/599 [00:05<00:00, 116.83it/s] 94%|| 564/599 [00:05<00:00, 117.79it/s] 96%|| 577/599 [00:05<00:00, 118.54it/s] 98%|| 590/599 [00:05<00:00, 119.37it/s]100%|| 599/599 [00:05<00:00, 102.24it/s]
tensor([0.4155, 0.4578, 0.4192, 0.4487, 0.4370], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 22 of 101
train loss is 0.5434194803237915
val loss is 0.5417548285590278
test loss is 0.56424412454707
validation accuracy is 90.79861111111111
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:31,  5.41s/it]  5%|         | 2/40 [00:05<01:31,  2.40s/it]  8%|         | 3/40 [00:05<00:53,  1.43s/it] 10%|         | 4/40 [00:06<00:35,  1.02it/s] 12%|        | 5/40 [00:06<00:25,  1.37it/s] 15%|        | 6/40 [00:06<00:19,  1.72it/s] 18%|        | 7/40 [00:07<00:16,  2.06it/s] 20%|        | 8/40 [00:07<00:13,  2.37it/s] 22%|       | 9/40 [00:07<00:11,  2.63it/s] 25%|       | 10/40 [00:07<00:10,  2.85it/s] 28%|       | 11/40 [00:08<00:09,  3.01it/s] 30%|       | 12/40 [00:08<00:08,  3.14it/s] 32%|      | 13/40 [00:08<00:08,  3.24it/s] 35%|      | 14/40 [00:09<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.39it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.40s/it] 22%|       | 2/9 [00:02<00:09,  1.35s/it] 56%|    | 5/9 [00:02<00:01,  2.39it/s] 89%| | 8/9 [00:03<00:00,  4.33it/s]100%|| 9/9 [00:03<00:00,  2.88it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:10,  2.39it/s]  1%|          | 5/599 [00:00<00:50, 11.83it/s]  3%|         | 17/599 [00:00<00:14, 40.14it/s]  5%|         | 29/599 [00:00<00:09, 61.60it/s]  7%|         | 41/599 [00:00<00:07, 77.31it/s]  9%|         | 53/599 [00:00<00:06, 88.83it/s] 11%|         | 65/599 [00:01<00:05, 97.17it/s] 13%|        | 77/599 [00:01<00:05, 103.07it/s] 15%|        | 89/599 [00:01<00:04, 107.39it/s] 17%|        | 101/599 [00:01<00:04, 110.47it/s] 19%|        | 113/599 [00:01<00:04, 109.77it/s] 21%|        | 125/599 [00:01<00:04, 112.05it/s] 23%|       | 137/599 [00:01<00:04, 113.55it/s] 25%|       | 149/599 [00:01<00:03, 114.77it/s] 27%|       | 161/599 [00:01<00:03, 115.27it/s] 29%|       | 173/599 [00:01<00:03, 111.85it/s] 31%|       | 185/599 [00:02<00:03, 112.76it/s] 33%|      | 197/599 [00:02<00:03, 114.21it/s] 35%|      | 209/599 [00:02<00:03, 104.40it/s] 37%|      | 221/599 [00:02<00:03, 108.02it/s] 39%|      | 232/599 [00:02<00:03, 104.92it/s] 41%|      | 243/599 [00:02<00:03, 102.25it/s] 43%|     | 255/599 [00:02<00:03, 106.84it/s] 45%|     | 267/599 [00:02<00:03, 110.13it/s] 47%|     | 279/599 [00:02<00:02, 112.43it/s] 49%|     | 291/599 [00:03<00:02, 114.09it/s] 51%|     | 303/599 [00:03<00:02, 115.26it/s] 53%|    | 315/599 [00:03<00:02, 115.52it/s] 55%|    | 327/599 [00:03<00:02, 116.09it/s] 57%|    | 339/599 [00:03<00:02, 116.43it/s] 59%|    | 351/599 [00:03<00:02, 116.40it/s] 61%|    | 363/599 [00:03<00:02, 116.58it/s] 63%|   | 375/599 [00:03<00:01, 116.67it/s] 65%|   | 387/599 [00:03<00:01, 116.62it/s] 67%|   | 399/599 [00:03<00:01, 116.90it/s] 69%|   | 411/599 [00:04<00:01, 116.73it/s] 71%|   | 423/599 [00:04<00:01, 116.91it/s] 73%|  | 435/599 [00:04<00:01, 117.15it/s] 75%|  | 447/599 [00:04<00:01, 117.11it/s] 77%|  | 459/599 [00:04<00:01, 117.06it/s] 79%|  | 471/599 [00:04<00:01, 116.12it/s] 81%|  | 483/599 [00:04<00:00, 116.48it/s] 83%| | 495/599 [00:04<00:00, 116.52it/s] 85%| | 507/599 [00:04<00:00, 116.68it/s] 87%| | 519/599 [00:05<00:00, 117.06it/s] 89%| | 531/599 [00:05<00:00, 117.48it/s] 91%| | 543/599 [00:05<00:00, 117.88it/s] 93%|| 555/599 [00:05<00:00, 118.42it/s] 95%|| 568/599 [00:05<00:00, 119.12it/s] 97%|| 581/599 [00:05<00:00, 119.98it/s] 99%|| 594/599 [00:05<00:00, 120.64it/s]100%|| 599/599 [00:05<00:00, 104.17it/s]
tensor([0.4065, 0.4512, 0.4102, 0.4414, 0.4302], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 23 of 101
train loss is 0.5321909785270691
val loss is 0.5294183095296224
test loss is 0.5522746264636019
validation accuracy is 92.10069444444444
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:13,  4.96s/it]  5%|         | 2/40 [00:05<01:36,  2.54s/it]  8%|         | 3/40 [00:06<00:56,  1.51s/it] 10%|         | 4/40 [00:06<00:37,  1.03s/it] 12%|        | 5/40 [00:06<00:26,  1.31it/s] 15%|        | 6/40 [00:06<00:20,  1.66it/s] 18%|        | 7/40 [00:07<00:16,  2.01it/s] 20%|        | 8/40 [00:07<00:13,  2.32it/s] 22%|       | 9/40 [00:07<00:12,  2.58it/s] 25%|       | 10/40 [00:08<00:10,  2.81it/s] 28%|       | 11/40 [00:08<00:09,  2.98it/s] 30%|       | 12/40 [00:08<00:08,  3.12it/s] 32%|      | 13/40 [00:08<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:09<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.43it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.46it/s] 75%|  | 30/40 [00:13<00:02,  3.47it/s] 78%|  | 31/40 [00:14<00:02,  3.46it/s] 80%|  | 32/40 [00:14<00:02,  3.47it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:15<00:01,  3.48it/s] 88%| | 35/40 [00:15<00:01,  3.48it/s] 90%| | 36/40 [00:15<00:01,  3.48it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.37it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.42s/it] 22%|       | 2/9 [00:02<00:09,  1.42s/it] 56%|    | 5/9 [00:02<00:01,  2.28it/s] 89%| | 8/9 [00:03<00:00,  4.15it/s]100%|| 9/9 [00:03<00:00,  2.77it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:42,  2.69it/s]  1%|          | 6/599 [00:00<00:43, 13.64it/s]  3%|         | 16/599 [00:00<00:16, 35.18it/s]  5%|         | 28/599 [00:00<00:09, 57.38it/s]  7%|         | 40/599 [00:00<00:07, 74.04it/s]  9%|         | 52/599 [00:00<00:06, 86.44it/s] 11%|         | 64/599 [00:01<00:05, 95.63it/s] 13%|        | 76/599 [00:01<00:05, 102.28it/s] 15%|        | 88/599 [00:01<00:04, 106.98it/s] 17%|        | 100/599 [00:01<00:04, 110.09it/s] 19%|        | 112/599 [00:01<00:04, 112.33it/s] 21%|        | 124/599 [00:01<00:04, 113.98it/s] 23%|       | 136/599 [00:01<00:04, 115.30it/s] 25%|       | 148/599 [00:01<00:03, 116.17it/s] 27%|       | 160/599 [00:01<00:04, 108.20it/s] 29%|       | 172/599 [00:01<00:03, 111.11it/s] 31%|       | 184/599 [00:02<00:03, 113.29it/s] 33%|      | 196/599 [00:02<00:03, 107.95it/s] 35%|      | 208/599 [00:02<00:03, 109.60it/s] 37%|      | 220/599 [00:02<00:03, 112.18it/s] 39%|      | 232/599 [00:02<00:03, 95.86it/s]  41%|      | 244/599 [00:02<00:03, 101.65it/s] 43%|     | 256/599 [00:02<00:03, 106.20it/s] 45%|     | 268/599 [00:02<00:03, 109.70it/s] 47%|     | 280/599 [00:02<00:02, 111.01it/s] 49%|     | 292/599 [00:03<00:02, 112.98it/s] 51%|     | 304/599 [00:03<00:02, 114.59it/s] 53%|    | 316/599 [00:03<00:02, 115.58it/s] 55%|    | 328/599 [00:03<00:02, 116.41it/s] 57%|    | 340/599 [00:03<00:02, 117.08it/s] 59%|    | 352/599 [00:03<00:02, 117.37it/s] 61%|    | 364/599 [00:03<00:01, 117.82it/s] 63%|   | 376/599 [00:03<00:01, 118.03it/s] 65%|   | 388/599 [00:03<00:01, 117.86it/s] 67%|   | 400/599 [00:04<00:01, 118.08it/s] 69%|   | 412/599 [00:04<00:01, 118.26it/s] 71%|   | 424/599 [00:04<00:01, 118.19it/s] 73%|  | 436/599 [00:04<00:01, 118.32it/s] 75%|  | 448/599 [00:04<00:01, 118.22it/s] 77%|  | 460/599 [00:04<00:01, 118.18it/s] 79%|  | 472/599 [00:04<00:01, 117.85it/s] 81%|  | 484/599 [00:04<00:00, 117.93it/s] 83%| | 496/599 [00:04<00:00, 117.86it/s] 85%| | 508/599 [00:04<00:00, 117.77it/s] 87%| | 520/599 [00:05<00:00, 116.35it/s] 89%| | 532/599 [00:05<00:00, 116.51it/s] 91%| | 544/599 [00:05<00:00, 116.85it/s] 93%|| 556/599 [00:05<00:00, 117.32it/s] 95%|| 568/599 [00:05<00:00, 118.02it/s] 97%|| 581/599 [00:05<00:00, 118.98it/s] 99%|| 594/599 [00:05<00:00, 119.69it/s]100%|| 599/599 [00:05<00:00, 103.78it/s]
tensor([0.3972, 0.4441, 0.4011, 0.4338, 0.4231], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 24 of 101
train loss is 0.5233833193778992
val loss is 0.5169879065619575
test loss is 0.5402484412782379
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:09,  4.87s/it]  5%|         | 2/40 [00:05<01:22,  2.17s/it]  8%|         | 3/40 [00:05<00:48,  1.31s/it] 10%|         | 4/40 [00:05<00:32,  1.10it/s] 12%|        | 5/40 [00:06<00:23,  1.46it/s] 15%|        | 6/40 [00:06<00:18,  1.82it/s] 18%|        | 7/40 [00:06<00:15,  2.16it/s] 20%|        | 8/40 [00:06<00:13,  2.46it/s] 22%|       | 9/40 [00:07<00:11,  2.70it/s] 25%|       | 10/40 [00:07<00:10,  2.90it/s] 28%|       | 11/40 [00:07<00:09,  3.06it/s] 30%|       | 12/40 [00:08<00:08,  3.18it/s] 32%|      | 13/40 [00:08<00:08,  3.26it/s] 35%|      | 14/40 [00:08<00:07,  3.33it/s] 38%|      | 15/40 [00:08<00:07,  3.37it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.43it/s] 45%|     | 18/40 [00:09<00:06,  3.45it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:10<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:11<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:12<00:03,  3.48it/s] 72%|  | 29/40 [00:12<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.49it/s] 80%|  | 32/40 [00:13<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.49it/s] 90%| | 36/40 [00:14<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.48it/s] 95%|| 38/40 [00:15<00:00,  3.47it/s] 98%|| 39/40 [00:15<00:00,  3.46it/s]100%|| 40/40 [00:16<00:00,  3.47it/s]100%|| 40/40 [00:16<00:00,  2.47it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.43s/it] 22%|       | 2/9 [00:02<00:09,  1.34s/it] 44%|     | 4/9 [00:02<00:02,  1.88it/s] 78%|  | 7/9 [00:02<00:00,  3.92it/s]100%|| 9/9 [00:03<00:00,  2.87it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:38,  3.78it/s]  0%|          | 2/599 [00:00<02:15,  4.42it/s]  2%|         | 14/599 [00:00<00:16, 35.48it/s]  4%|         | 26/599 [00:00<00:09, 58.80it/s]  6%|         | 38/599 [00:00<00:07, 75.76it/s]  8%|         | 50/599 [00:00<00:06, 87.96it/s] 10%|         | 62/599 [00:00<00:05, 96.62it/s] 12%|        | 74/599 [00:01<00:05, 102.80it/s] 14%|        | 86/599 [00:01<00:04, 107.19it/s] 16%|        | 98/599 [00:01<00:04, 110.29it/s] 18%|        | 110/599 [00:01<00:04, 112.44it/s] 20%|        | 122/599 [00:01<00:04, 113.21it/s] 22%|       | 134/599 [00:01<00:04, 114.62it/s] 24%|       | 146/599 [00:01<00:04, 107.97it/s] 26%|       | 158/599 [00:01<00:03, 110.73it/s] 28%|       | 170/599 [00:01<00:03, 112.93it/s] 30%|       | 182/599 [00:02<00:03, 112.47it/s] 32%|      | 194/599 [00:02<00:03, 113.27it/s] 34%|      | 206/599 [00:02<00:03, 114.57it/s] 36%|      | 218/599 [00:02<00:03, 115.48it/s] 38%|      | 230/599 [00:02<00:03, 97.23it/s]  40%|      | 242/599 [00:02<00:03, 102.71it/s] 42%|     | 254/599 [00:02<00:03, 106.96it/s] 44%|     | 266/599 [00:02<00:03, 109.96it/s] 46%|     | 278/599 [00:02<00:02, 112.13it/s] 48%|     | 290/599 [00:03<00:02, 113.75it/s] 50%|     | 302/599 [00:03<00:02, 114.93it/s] 52%|    | 314/599 [00:03<00:02, 115.87it/s] 54%|    | 326/599 [00:03<00:03, 89.39it/s]  56%|    | 338/599 [00:03<00:02, 96.45it/s] 58%|    | 350/599 [00:03<00:02, 102.25it/s] 60%|    | 361/599 [00:03<00:02, 100.60it/s] 62%|   | 373/599 [00:03<00:02, 105.50it/s] 64%|   | 385/599 [00:03<00:01, 109.13it/s] 66%|   | 397/599 [00:04<00:02, 96.10it/s]  68%|   | 409/599 [00:04<00:01, 101.96it/s] 70%|   | 421/599 [00:04<00:01, 106.41it/s] 72%|  | 433/599 [00:04<00:01, 109.82it/s] 74%|  | 445/599 [00:04<00:01, 112.36it/s] 76%|  | 457/599 [00:04<00:01, 114.05it/s] 78%|  | 469/599 [00:04<00:01, 115.27it/s] 80%|  | 481/599 [00:04<00:01, 115.95it/s] 82%| | 493/599 [00:04<00:00, 116.44it/s] 84%| | 505/599 [00:05<00:00, 116.62it/s] 86%| | 517/599 [00:05<00:00, 116.83it/s] 88%| | 529/599 [00:05<00:00, 117.01it/s] 90%| | 541/599 [00:05<00:00, 117.31it/s] 92%|| 553/599 [00:05<00:00, 117.83it/s] 94%|| 565/599 [00:05<00:00, 118.45it/s] 96%|| 578/599 [00:05<00:00, 119.25it/s] 99%|| 591/599 [00:05<00:00, 119.86it/s]100%|| 599/599 [00:05<00:00, 101.99it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:228: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  ns_fpr, ns_tpr, _ = roc_curve(np.array(labels_list.cpu()), ns_probs)
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:229: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  lr_fpr, lr_tpr, _ = roc_curve(np.array(labels_list.cpu()), np.array(probs_list.detach().cpu()))
tensor([0.3875, 0.4363, 0.3914, 0.4255, 0.4155], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 25 of 101
train loss is 0.5151179432868958
val loss is 0.5041128794352213
test loss is 0.5277309510763579
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:05<03:35,  5.52s/it]  5%|         | 2/40 [00:05<01:32,  2.44s/it]  8%|         | 3/40 [00:06<00:53,  1.46s/it] 10%|         | 4/40 [00:06<00:35,  1.00it/s] 12%|        | 5/40 [00:06<00:25,  1.35it/s] 15%|        | 6/40 [00:06<00:19,  1.71it/s] 18%|        | 7/40 [00:07<00:16,  2.05it/s] 20%|        | 8/40 [00:07<00:13,  2.36it/s] 22%|       | 9/40 [00:07<00:11,  2.62it/s] 25%|       | 10/40 [00:08<00:10,  2.83it/s] 28%|       | 11/40 [00:08<00:09,  3.00it/s] 30%|       | 12/40 [00:08<00:08,  3.13it/s] 32%|      | 13/40 [00:08<00:08,  3.23it/s] 35%|      | 14/40 [00:09<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.41it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.48it/s] 75%|  | 30/40 [00:13<00:02,  3.48it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.48it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.38it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:11,  1.39s/it] 22%|       | 2/9 [00:02<00:09,  1.34s/it] 44%|     | 4/9 [00:02<00:02,  1.86it/s] 78%|  | 7/9 [00:02<00:00,  3.90it/s]100%|| 9/9 [00:03<00:00,  2.88it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:40,  2.71it/s]  1%|          | 4/599 [00:00<00:58, 10.19it/s]  2%|         | 12/599 [00:00<00:19, 29.54it/s]  4%|         | 24/599 [00:00<00:10, 54.51it/s]  6%|         | 36/599 [00:00<00:07, 72.83it/s]  8%|         | 48/599 [00:00<00:06, 85.92it/s] 10%|         | 60/599 [00:00<00:05, 95.48it/s] 12%|        | 72/599 [00:01<00:05, 102.17it/s] 14%|        | 84/599 [00:01<00:04, 106.32it/s] 16%|        | 96/599 [00:01<00:04, 109.04it/s] 18%|        | 108/599 [00:01<00:04, 106.16it/s] 20%|        | 120/599 [00:01<00:04, 109.58it/s] 22%|       | 132/599 [00:01<00:04, 112.08it/s] 24%|       | 144/599 [00:01<00:04, 113.54it/s] 26%|       | 156/599 [00:01<00:03, 114.45it/s] 28%|       | 168/599 [00:01<00:03, 115.34it/s] 30%|       | 180/599 [00:02<00:03, 115.76it/s] 32%|      | 192/599 [00:02<00:03, 112.96it/s] 34%|      | 204/599 [00:02<00:03, 114.16it/s] 36%|      | 216/599 [00:02<00:03, 115.15it/s] 38%|      | 228/599 [00:02<00:03, 114.82it/s] 40%|      | 240/599 [00:02<00:03, 115.61it/s] 42%|     | 252/599 [00:02<00:02, 115.84it/s] 44%|     | 264/599 [00:02<00:02, 116.43it/s] 46%|     | 276/599 [00:02<00:02, 116.73it/s] 48%|     | 288/599 [00:02<00:02, 117.08it/s] 50%|     | 300/599 [00:03<00:02, 117.11it/s] 52%|    | 312/599 [00:03<00:02, 116.65it/s] 54%|    | 324/599 [00:03<00:02, 95.90it/s]  56%|    | 336/599 [00:03<00:02, 101.52it/s] 58%|    | 348/599 [00:03<00:02, 106.07it/s] 60%|    | 360/599 [00:03<00:02, 99.24it/s]  62%|   | 372/599 [00:03<00:02, 104.16it/s] 64%|   | 384/599 [00:03<00:01, 107.98it/s] 66%|   | 396/599 [00:04<00:02, 94.88it/s]  68%|   | 408/599 [00:04<00:01, 100.74it/s] 70%|   | 420/599 [00:04<00:01, 105.29it/s] 72%|  | 432/599 [00:04<00:01, 108.78it/s] 74%|  | 444/599 [00:04<00:01, 111.40it/s] 76%|  | 456/599 [00:04<00:01, 113.30it/s] 78%|  | 468/599 [00:04<00:01, 114.80it/s] 80%|  | 480/599 [00:04<00:01, 115.80it/s] 82%| | 492/599 [00:04<00:00, 116.55it/s] 84%| | 504/599 [00:04<00:00, 116.96it/s] 86%| | 516/599 [00:05<00:00, 117.23it/s] 88%| | 528/599 [00:05<00:00, 117.53it/s] 90%| | 540/599 [00:05<00:00, 117.82it/s] 92%|| 552/599 [00:05<00:00, 118.35it/s] 94%|| 564/599 [00:05<00:00, 118.70it/s] 96%|| 577/599 [00:05<00:00, 119.70it/s] 98%|| 589/599 [00:05<00:00, 108.91it/s]100%|| 599/599 [00:05<00:00, 101.97it/s]
tensor([0.3774, 0.4285, 0.3816, 0.4167, 0.4077], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 26 of 101
train loss is 0.5033866763114929
val loss is 0.49175665113661027
test loss is 0.5154003361131194
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:09,  4.85s/it]  5%|         | 2/40 [00:05<01:22,  2.17s/it]  8%|         | 3/40 [00:05<00:48,  1.31s/it] 10%|         | 4/40 [00:05<00:32,  1.10it/s] 12%|        | 5/40 [00:06<00:23,  1.46it/s] 15%|        | 6/40 [00:06<00:18,  1.82it/s] 18%|        | 7/40 [00:06<00:15,  2.16it/s] 20%|        | 8/40 [00:06<00:13,  2.46it/s] 22%|       | 9/40 [00:07<00:11,  2.71it/s] 25%|       | 10/40 [00:07<00:10,  2.90it/s] 28%|       | 11/40 [00:07<00:09,  3.06it/s] 30%|       | 12/40 [00:08<00:08,  3.17it/s] 32%|      | 13/40 [00:08<00:08,  3.26it/s] 35%|      | 14/40 [00:08<00:07,  3.32it/s] 38%|      | 15/40 [00:08<00:07,  3.37it/s] 40%|      | 16/40 [00:09<00:07,  3.41it/s] 42%|     | 17/40 [00:09<00:06,  3.43it/s] 45%|     | 18/40 [00:09<00:06,  3.45it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:10<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:11<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:12<00:03,  3.49it/s] 72%|  | 29/40 [00:12<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.49it/s] 80%|  | 32/40 [00:13<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.48it/s] 90%| | 36/40 [00:14<00:01,  3.48it/s] 92%|| 37/40 [00:15<00:00,  3.47it/s] 95%|| 38/40 [00:15<00:00,  3.48it/s] 98%|| 39/40 [00:15<00:00,  3.48it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.47it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.47s/it] 22%|       | 2/9 [00:02<00:09,  1.40s/it] 56%|    | 5/9 [00:02<00:01,  2.32it/s] 89%| | 8/9 [00:03<00:00,  4.21it/s]100%|| 9/9 [00:03<00:00,  2.78it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:13,  3.10it/s]  1%|          | 6/599 [00:00<00:42, 13.90it/s]  2%|         | 14/599 [00:00<00:19, 30.57it/s]  4%|         | 26/599 [00:00<00:10, 54.18it/s]  6%|         | 38/599 [00:00<00:07, 70.66it/s]  8%|         | 50/599 [00:00<00:06, 83.91it/s] 10%|         | 62/599 [00:01<00:05, 93.61it/s] 12%|        | 74/599 [00:01<00:05, 100.62it/s] 14%|        | 86/599 [00:01<00:04, 105.63it/s] 16%|        | 98/599 [00:01<00:04, 109.21it/s] 18%|        | 110/599 [00:01<00:04, 111.68it/s] 20%|        | 122/599 [00:01<00:04, 113.51it/s] 22%|       | 134/599 [00:01<00:04, 114.24it/s] 24%|       | 146/599 [00:01<00:04, 105.27it/s] 26%|       | 158/599 [00:01<00:04, 108.08it/s] 28%|       | 170/599 [00:01<00:03, 110.81it/s] 30%|       | 182/599 [00:02<00:03, 110.06it/s] 32%|      | 194/599 [00:02<00:03, 112.03it/s] 34%|      | 206/599 [00:02<00:03, 113.51it/s] 36%|      | 218/599 [00:02<00:03, 114.74it/s] 38%|      | 230/599 [00:02<00:03, 114.61it/s] 40%|      | 242/599 [00:02<00:03, 115.27it/s] 42%|     | 254/599 [00:02<00:02, 115.86it/s] 44%|     | 266/599 [00:02<00:02, 116.32it/s] 46%|     | 278/599 [00:02<00:02, 116.69it/s] 48%|     | 290/599 [00:03<00:02, 116.77it/s] 50%|     | 302/599 [00:03<00:02, 117.02it/s] 52%|    | 314/599 [00:03<00:02, 116.71it/s] 54%|    | 326/599 [00:03<00:02, 102.31it/s] 56%|    | 338/599 [00:03<00:02, 106.29it/s] 58%|    | 350/599 [00:03<00:02, 109.43it/s] 60%|    | 362/599 [00:03<00:02, 99.90it/s]  62%|   | 374/599 [00:03<00:02, 104.48it/s] 64%|   | 386/599 [00:03<00:02, 93.39it/s]  66%|   | 398/599 [00:04<00:02, 98.50it/s] 68%|   | 410/599 [00:04<00:01, 103.14it/s] 70%|   | 422/599 [00:04<00:01, 106.83it/s] 72%|  | 434/599 [00:04<00:01, 109.65it/s] 74%|  | 446/599 [00:04<00:01, 111.79it/s] 76%|  | 458/599 [00:04<00:01, 113.24it/s] 78%|  | 470/599 [00:04<00:01, 114.72it/s] 80%|  | 482/599 [00:04<00:01, 115.76it/s] 82%| | 494/599 [00:04<00:00, 116.10it/s] 84%| | 506/599 [00:05<00:00, 116.65it/s] 86%| | 518/599 [00:05<00:00, 116.74it/s] 88%| | 530/599 [00:05<00:00, 116.87it/s] 90%| | 542/599 [00:05<00:00, 117.27it/s] 92%|| 554/599 [00:05<00:00, 117.58it/s] 94%|| 566/599 [00:05<00:00, 118.24it/s] 96%|| 578/599 [00:05<00:00, 101.98it/s] 99%|| 591/599 [00:05<00:00, 107.51it/s]100%|| 599/599 [00:05<00:00, 101.09it/s]
tensor([0.3682, 0.4211, 0.3718, 0.4089, 0.4001], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 27 of 101
train loss is 0.49905794858932495
val loss is 0.480876710679796
test loss is 0.5038261890212363
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:13,  4.97s/it]  5%|         | 2/40 [00:05<01:37,  2.57s/it]  8%|         | 3/40 [00:06<00:56,  1.53s/it] 10%|         | 4/40 [00:06<00:37,  1.04s/it] 12%|        | 5/40 [00:06<00:26,  1.31it/s] 15%|        | 6/40 [00:06<00:20,  1.66it/s] 18%|        | 7/40 [00:07<00:16,  2.00it/s] 20%|        | 8/40 [00:07<00:13,  2.31it/s] 22%|       | 9/40 [00:07<00:12,  2.58it/s] 25%|       | 10/40 [00:08<00:10,  2.80it/s] 28%|       | 11/40 [00:08<00:09,  2.98it/s] 30%|       | 12/40 [00:08<00:08,  3.11it/s] 32%|      | 13/40 [00:09<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:09<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.47it/s] 75%|  | 30/40 [00:13<00:02,  3.46it/s] 78%|  | 31/40 [00:14<00:02,  3.47it/s] 80%|  | 32/40 [00:14<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:15<00:01,  3.48it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.37it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.44s/it] 22%|       | 2/9 [00:02<00:09,  1.39s/it] 56%|    | 5/9 [00:02<00:01,  2.33it/s] 89%| | 8/9 [00:03<00:00,  4.23it/s]100%|| 9/9 [00:03<00:00,  2.81it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:06,  2.42it/s]  1%|         | 8/599 [00:00<00:30, 19.38it/s]  3%|         | 20/599 [00:00<00:12, 45.84it/s]  5%|         | 32/599 [00:00<00:08, 65.53it/s]  7%|         | 42/599 [00:00<00:07, 75.13it/s]  9%|         | 54/599 [00:00<00:06, 87.47it/s] 11%|         | 66/599 [00:01<00:05, 96.25it/s] 13%|        | 78/599 [00:01<00:05, 102.53it/s] 15%|        | 90/599 [00:01<00:04, 107.27it/s] 17%|        | 102/599 [00:01<00:04, 109.82it/s] 19%|        | 114/599 [00:01<00:04, 108.17it/s] 21%|        | 126/599 [00:01<00:04, 111.01it/s] 23%|       | 138/599 [00:01<00:04, 112.03it/s] 25%|       | 150/599 [00:01<00:04, 105.91it/s] 27%|       | 162/599 [00:01<00:04, 108.26it/s] 29%|       | 174/599 [00:01<00:03, 110.73it/s] 31%|       | 186/599 [00:02<00:03, 109.59it/s] 33%|      | 198/599 [00:02<00:03, 111.95it/s] 35%|      | 210/599 [00:02<00:03, 111.64it/s] 37%|      | 222/599 [00:02<00:03, 112.26it/s] 39%|      | 234/599 [00:02<00:03, 96.24it/s]  41%|      | 246/599 [00:02<00:03, 102.03it/s] 43%|     | 258/599 [00:02<00:03, 106.34it/s] 45%|     | 269/599 [00:02<00:03, 85.44it/s]  47%|     | 281/599 [00:03<00:03, 93.68it/s] 49%|     | 293/599 [00:03<00:03, 100.12it/s] 51%|     | 305/599 [00:03<00:02, 105.00it/s] 53%|    | 317/599 [00:03<00:02, 108.67it/s] 55%|    | 329/599 [00:03<00:02, 111.38it/s] 57%|    | 341/599 [00:03<00:02, 113.44it/s] 59%|    | 353/599 [00:03<00:02, 114.88it/s] 61%|    | 365/599 [00:03<00:02, 115.53it/s] 63%|   | 377/599 [00:03<00:01, 114.93it/s] 65%|   | 389/599 [00:04<00:02, 101.43it/s] 67%|   | 401/599 [00:04<00:01, 106.06it/s] 69%|   | 413/599 [00:04<00:01, 109.55it/s] 71%|   | 425/599 [00:04<00:01, 110.24it/s] 73%|  | 437/599 [00:04<00:01, 111.89it/s] 75%|  | 449/599 [00:04<00:01, 113.75it/s] 77%|  | 461/599 [00:04<00:01, 112.22it/s] 79%|  | 473/599 [00:04<00:01, 113.97it/s] 81%|  | 485/599 [00:04<00:00, 115.21it/s] 83%| | 497/599 [00:04<00:00, 116.23it/s] 85%| | 509/599 [00:05<00:00, 117.00it/s] 87%| | 521/599 [00:05<00:00, 117.65it/s] 89%| | 533/599 [00:05<00:00, 118.07it/s] 91%| | 545/599 [00:05<00:00, 118.47it/s] 93%|| 557/599 [00:05<00:00, 118.32it/s] 95%|| 570/599 [00:05<00:00, 119.20it/s] 97%|| 582/599 [00:05<00:00, 102.03it/s] 99%|| 595/599 [00:05<00:00, 107.36it/s]100%|| 599/599 [00:05<00:00, 100.30it/s]
tensor([0.3584, 0.4133, 0.3621, 0.4004, 0.3926], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 28 of 101
train loss is 0.48748427629470825
val loss is 0.46961233350965714
test loss is 0.49223134349502984
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:33,  5.47s/it]  5%|         | 2/40 [00:05<01:31,  2.42s/it]  8%|         | 3/40 [00:06<00:53,  1.45s/it] 10%|         | 4/40 [00:06<00:35,  1.01it/s] 12%|        | 5/40 [00:06<00:25,  1.36it/s] 15%|        | 6/40 [00:06<00:19,  1.71it/s] 18%|        | 7/40 [00:07<00:16,  2.06it/s] 20%|        | 8/40 [00:07<00:13,  2.36it/s] 22%|       | 9/40 [00:07<00:11,  2.63it/s] 25%|       | 10/40 [00:08<00:10,  2.84it/s] 28%|       | 11/40 [00:08<00:09,  3.01it/s] 30%|       | 12/40 [00:08<00:08,  3.14it/s] 32%|      | 13/40 [00:08<00:08,  3.24it/s] 35%|      | 14/40 [00:09<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.47it/s] 70%|   | 28/40 [00:13<00:03,  3.46it/s] 72%|  | 29/40 [00:13<00:03,  3.48it/s] 75%|  | 30/40 [00:13<00:02,  3.48it/s] 78%|  | 31/40 [00:14<00:02,  3.48it/s] 80%|  | 32/40 [00:14<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.38it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.44s/it] 22%|       | 2/9 [00:02<00:09,  1.35s/it] 44%|     | 4/9 [00:02<00:02,  1.81it/s] 78%|  | 7/9 [00:03<00:00,  3.81it/s]100%|| 9/9 [00:03<00:00,  2.82it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:44,  3.63it/s]  2%|         | 9/599 [00:00<00:20, 29.41it/s]  3%|         | 19/599 [00:00<00:11, 52.12it/s]  5%|         | 31/599 [00:00<00:07, 73.10it/s]  7%|         | 43/599 [00:00<00:06, 85.14it/s]  9%|         | 53/599 [00:00<00:06, 87.53it/s] 11%|         | 65/599 [00:00<00:05, 96.35it/s] 13%|        | 76/599 [00:01<00:05, 96.22it/s] 15%|        | 87/599 [00:01<00:05, 91.35it/s] 17%|        | 99/599 [00:01<00:05, 98.76it/s] 18%|        | 110/599 [00:01<00:06, 79.84it/s] 20%|        | 119/599 [00:01<00:05, 80.06it/s] 22%|       | 131/599 [00:01<00:05, 89.73it/s] 24%|       | 141/599 [00:01<00:05, 84.96it/s] 26%|       | 153/599 [00:01<00:04, 92.22it/s] 27%|       | 164/599 [00:02<00:04, 94.82it/s] 29%|       | 174/599 [00:02<00:04, 88.60it/s] 31%|       | 184/599 [00:02<00:05, 70.02it/s] 33%|      | 196/599 [00:02<00:04, 80.82it/s] 35%|      | 208/599 [00:02<00:04, 89.84it/s] 37%|      | 220/599 [00:02<00:03, 97.29it/s] 39%|      | 232/599 [00:02<00:03, 103.14it/s] 41%|      | 244/599 [00:02<00:03, 107.45it/s] 43%|     | 256/599 [00:02<00:03, 110.80it/s] 45%|     | 268/599 [00:03<00:02, 112.94it/s] 47%|     | 280/599 [00:03<00:02, 114.72it/s] 49%|     | 292/599 [00:03<00:02, 115.98it/s] 51%|     | 304/599 [00:03<00:02, 116.59it/s] 53%|    | 316/599 [00:03<00:02, 117.20it/s] 55%|    | 328/599 [00:03<00:02, 94.76it/s]  57%|    | 340/599 [00:03<00:02, 100.87it/s] 59%|    | 352/599 [00:03<00:02, 105.68it/s] 61%|    | 364/599 [00:03<00:02, 107.27it/s] 63%|   | 376/599 [00:04<00:02, 110.34it/s] 65%|   | 388/599 [00:04<00:02, 100.51it/s] 67%|   | 400/599 [00:04<00:01, 105.39it/s] 69%|   | 412/599 [00:04<00:01, 109.07it/s] 71%|   | 424/599 [00:04<00:01, 111.83it/s] 73%|  | 436/599 [00:04<00:01, 113.78it/s] 75%|  | 448/599 [00:04<00:01, 115.14it/s] 77%|  | 460/599 [00:04<00:01, 116.18it/s] 79%|  | 472/599 [00:04<00:01, 117.15it/s] 81%|  | 484/599 [00:05<00:00, 117.59it/s] 83%| | 496/599 [00:05<00:00, 117.92it/s] 85%| | 508/599 [00:05<00:00, 118.19it/s] 87%| | 520/599 [00:05<00:00, 118.16it/s] 89%| | 532/599 [00:05<00:00, 118.31it/s] 91%| | 544/599 [00:05<00:00, 118.63it/s] 93%|| 556/599 [00:05<00:00, 119.03it/s] 95%|| 568/599 [00:05<00:00, 119.17it/s] 97%|| 581/599 [00:05<00:00, 119.98it/s] 99%|| 594/599 [00:05<00:00, 120.63it/s]100%|| 599/599 [00:06<00:00, 98.77it/s] 
tensor([0.3494, 0.4062, 0.3530, 0.3926, 0.3855], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 29 of 101
train loss is 0.4827142655849457
val loss is 0.4600147671169705
test loss is 0.4817097737315501
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:23,  5.23s/it]  5%|         | 2/40 [00:05<01:30,  2.39s/it]  8%|         | 3/40 [00:06<00:55,  1.49s/it] 10%|         | 4/40 [00:06<00:36,  1.03s/it] 12%|        | 5/40 [00:06<00:26,  1.31it/s] 15%|        | 6/40 [00:06<00:20,  1.67it/s] 18%|        | 7/40 [00:07<00:16,  2.01it/s] 20%|        | 8/40 [00:07<00:13,  2.32it/s] 22%|       | 9/40 [00:07<00:11,  2.59it/s] 25%|       | 10/40 [00:08<00:10,  2.81it/s] 28%|       | 11/40 [00:08<00:09,  2.99it/s] 30%|       | 12/40 [00:08<00:08,  3.12it/s] 32%|      | 13/40 [00:08<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.29it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:09<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.38it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.46s/it] 22%|       | 2/9 [00:02<00:09,  1.39s/it] 56%|    | 5/9 [00:02<00:01,  2.33it/s] 89%| | 8/9 [00:03<00:00,  4.24it/s]100%|| 9/9 [00:03<00:00,  2.80it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:57,  3.38it/s]  0%|          | 2/599 [00:00<02:00,  4.96it/s]  2%|         | 14/599 [00:00<00:15, 38.62it/s]  4%|         | 26/599 [00:00<00:09, 61.77it/s]  6%|         | 38/599 [00:00<00:07, 78.34it/s]  8%|         | 50/599 [00:00<00:06, 90.03it/s] 10%|         | 62/599 [00:00<00:05, 98.16it/s] 12%|        | 74/599 [00:01<00:05, 104.08it/s] 14%|        | 86/599 [00:01<00:04, 108.33it/s] 16%|        | 98/599 [00:01<00:04, 111.35it/s] 18%|        | 110/599 [00:01<00:04, 104.01it/s] 20%|        | 122/599 [00:01<00:04, 108.08it/s] 22%|       | 134/599 [00:01<00:04, 111.31it/s] 24%|       | 146/599 [00:01<00:04, 108.86it/s] 26%|       | 158/599 [00:01<00:03, 111.84it/s] 28%|       | 170/599 [00:01<00:03, 112.67it/s] 30%|       | 182/599 [00:02<00:04, 102.98it/s] 32%|      | 194/599 [00:02<00:03, 106.14it/s] 34%|      | 206/599 [00:02<00:03, 109.35it/s] 36%|      | 218/599 [00:02<00:03, 111.65it/s] 38%|      | 230/599 [00:02<00:03, 103.64it/s] 40%|      | 242/599 [00:02<00:03, 107.91it/s] 42%|     | 254/599 [00:02<00:03, 110.91it/s] 44%|     | 266/599 [00:02<00:02, 112.32it/s] 46%|     | 278/599 [00:02<00:02, 108.40it/s] 48%|     | 290/599 [00:03<00:02, 111.28it/s] 50%|     | 302/599 [00:03<00:02, 113.60it/s] 52%|    | 314/599 [00:03<00:02, 115.24it/s] 54%|    | 326/599 [00:03<00:02, 116.49it/s] 56%|    | 338/599 [00:03<00:02, 116.98it/s] 58%|    | 350/599 [00:03<00:02, 117.63it/s] 60%|    | 362/599 [00:03<00:02, 118.07it/s] 62%|   | 374/599 [00:03<00:02, 102.08it/s] 64%|   | 386/599 [00:03<00:01, 106.55it/s] 66%|   | 398/599 [00:03<00:01, 110.03it/s] 68%|   | 410/599 [00:04<00:01, 112.63it/s] 70%|   | 422/599 [00:04<00:01, 114.29it/s] 72%|  | 434/599 [00:04<00:01, 115.74it/s] 74%|  | 446/599 [00:04<00:01, 116.83it/s] 76%|  | 458/599 [00:04<00:01, 117.27it/s] 78%|  | 470/599 [00:04<00:01, 113.27it/s] 80%|  | 482/599 [00:04<00:01, 114.79it/s] 82%| | 494/599 [00:04<00:00, 116.03it/s] 84%| | 506/599 [00:04<00:00, 116.88it/s] 86%| | 518/599 [00:04<00:00, 117.06it/s] 88%| | 530/599 [00:05<00:00, 117.47it/s] 90%| | 542/599 [00:05<00:00, 117.68it/s] 93%|| 555/599 [00:05<00:00, 118.58it/s] 95%|| 568/599 [00:05<00:00, 119.28it/s] 97%|| 581/599 [00:05<00:00, 120.07it/s] 99%|| 594/599 [00:05<00:00, 120.38it/s]100%|| 599/599 [00:05<00:00, 104.16it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:228: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  ns_fpr, ns_tpr, _ = roc_curve(np.array(labels_list.cpu()), ns_probs)
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:229: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  lr_fpr, lr_tpr, _ = roc_curve(np.array(labels_list.cpu()), np.array(probs_list.detach().cpu()))
tensor([0.3403, 0.3987, 0.3435, 0.3840, 0.3779], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 30 of 101
train loss is 0.47798123955726624
val loss is 0.45004452599419487
test loss is 0.4709839474080202
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:05<03:52,  5.96s/it]  5%|         | 2/40 [00:06<01:39,  2.62s/it]  8%|         | 3/40 [00:06<00:57,  1.56s/it] 10%|         | 4/40 [00:06<00:37,  1.06s/it] 12%|        | 5/40 [00:07<00:27,  1.28it/s] 15%|        | 6/40 [00:07<00:20,  1.63it/s] 18%|        | 7/40 [00:07<00:16,  1.98it/s] 20%|        | 8/40 [00:07<00:13,  2.29it/s] 22%|       | 9/40 [00:08<00:12,  2.57it/s] 25%|       | 10/40 [00:08<00:10,  2.79it/s] 28%|       | 11/40 [00:08<00:09,  2.97it/s] 30%|       | 12/40 [00:09<00:09,  3.10it/s] 32%|      | 13/40 [00:09<00:08,  3.20it/s] 35%|      | 14/40 [00:09<00:07,  3.28it/s] 38%|      | 15/40 [00:09<00:07,  3.34it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:11<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:13<00:04,  3.48it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:14<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:15<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:16<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.31it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:11,  1.40s/it] 22%|       | 2/9 [00:02<00:10,  1.44s/it] 56%|    | 5/9 [00:03<00:01,  2.25it/s] 89%| | 8/9 [00:03<00:00,  4.11it/s]100%|| 9/9 [00:03<00:00,  2.75it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:53,  2.04it/s]  2%|         | 11/599 [00:00<00:24, 23.68it/s]  4%|         | 23/599 [00:00<00:12, 46.51it/s]  6%|         | 35/599 [00:00<00:08, 64.85it/s]  8%|         | 47/599 [00:00<00:07, 78.59it/s] 10%|         | 59/599 [00:01<00:06, 89.43it/s] 12%|        | 70/599 [00:01<00:05, 94.67it/s] 14%|        | 82/599 [00:01<00:05, 101.44it/s] 16%|        | 94/599 [00:01<00:04, 106.22it/s] 18%|        | 106/599 [00:01<00:04, 109.56it/s] 20%|        | 118/599 [00:01<00:04, 111.99it/s] 22%|       | 130/599 [00:01<00:04, 113.68it/s] 24%|       | 142/599 [00:01<00:03, 114.60it/s] 26%|       | 154/599 [00:01<00:03, 111.99it/s] 28%|       | 166/599 [00:01<00:03, 111.31it/s] 30%|       | 178/599 [00:02<00:04, 103.44it/s] 32%|      | 189/599 [00:02<00:03, 105.13it/s] 34%|      | 201/599 [00:02<00:03, 108.16it/s] 36%|      | 213/599 [00:02<00:03, 111.15it/s] 38%|      | 225/599 [00:02<00:03, 112.47it/s] 40%|      | 237/599 [00:02<00:03, 103.46it/s] 42%|     | 249/599 [00:02<00:03, 107.72it/s] 44%|     | 261/599 [00:02<00:03, 110.87it/s] 46%|     | 273/599 [00:02<00:03, 100.99it/s] 48%|     | 285/599 [00:03<00:02, 105.82it/s] 50%|     | 297/599 [00:03<00:03, 99.90it/s]  52%|    | 309/599 [00:03<00:02, 104.40it/s] 54%|    | 321/599 [00:03<00:02, 108.17it/s] 56%|    | 333/599 [00:03<00:02, 91.77it/s]  57%|    | 344/599 [00:03<00:02, 95.79it/s] 59%|    | 355/599 [00:03<00:02, 95.18it/s] 61%|   | 367/599 [00:03<00:02, 101.23it/s] 63%|   | 379/599 [00:04<00:02, 105.69it/s] 65%|   | 390/599 [00:04<00:02, 87.99it/s]  67%|   | 402/599 [00:04<00:02, 94.33it/s] 69%|   | 414/599 [00:04<00:01, 100.72it/s] 71%|   | 426/599 [00:04<00:01, 105.26it/s] 73%|  | 438/599 [00:04<00:01, 108.48it/s] 75%|  | 450/599 [00:04<00:01, 108.80it/s] 77%|  | 462/599 [00:04<00:01, 111.36it/s] 79%|  | 474/599 [00:04<00:01, 113.11it/s] 81%|  | 486/599 [00:05<00:00, 113.82it/s] 83%| | 498/599 [00:05<00:00, 114.73it/s] 85%| | 510/599 [00:05<00:00, 115.54it/s] 87%| | 522/599 [00:05<00:00, 114.02it/s] 89%| | 534/599 [00:05<00:00, 115.19it/s] 91%| | 546/599 [00:05<00:00, 109.66it/s] 93%|| 559/599 [00:05<00:00, 112.81it/s] 95%|| 572/599 [00:05<00:00, 115.38it/s] 97%|| 584/599 [00:05<00:00, 101.69it/s]100%|| 597/599 [00:06<00:00, 107.29it/s]100%|| 599/599 [00:06<00:00, 97.64it/s] 
tensor([0.3318, 0.3918, 0.3350, 0.3762, 0.3713], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 31 of 101
train loss is 0.47167786955833435
val loss is 0.44139109717475045
test loss is 0.46151076244790484
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:09,  4.86s/it]  5%|         | 2/40 [00:05<01:22,  2.17s/it]  8%|         | 3/40 [00:05<00:50,  1.38s/it] 10%|         | 4/40 [00:05<00:34,  1.05it/s] 12%|        | 5/40 [00:06<00:24,  1.41it/s] 15%|        | 6/40 [00:06<00:19,  1.77it/s] 18%|        | 7/40 [00:06<00:15,  2.10it/s] 20%|        | 8/40 [00:07<00:13,  2.41it/s] 22%|       | 9/40 [00:07<00:11,  2.66it/s] 25%|       | 10/40 [00:07<00:10,  2.87it/s] 28%|       | 11/40 [00:07<00:09,  3.03it/s] 30%|       | 12/40 [00:08<00:08,  3.16it/s] 32%|      | 13/40 [00:08<00:08,  3.25it/s] 35%|      | 14/40 [00:08<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.43it/s] 45%|     | 18/40 [00:09<00:06,  3.45it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.47it/s] 62%|   | 25/40 [00:11<00:04,  3.47it/s] 65%|   | 26/40 [00:12<00:04,  3.46it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:12<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.48it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.49it/s] 80%|  | 32/40 [00:13<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.48it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:15<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.45it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.39s/it] 22%|       | 2/9 [00:02<00:09,  1.36s/it] 44%|     | 4/9 [00:02<00:02,  1.84it/s] 78%|  | 7/9 [00:02<00:00,  3.86it/s]100%|| 9/9 [00:03<00:00,  2.84it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:33,  3.89it/s]  1%|          | 3/599 [00:00<01:04,  9.26it/s]  1%|          | 5/599 [00:00<00:47, 12.42it/s]  2%|         | 11/599 [00:00<00:21, 26.85it/s]  4%|         | 23/599 [00:00<00:10, 55.09it/s]  6%|         | 35/599 [00:00<00:07, 74.39it/s]  8%|         | 46/599 [00:00<00:06, 83.80it/s] 10%|         | 58/599 [00:00<00:05, 94.21it/s] 12%|        | 69/599 [00:01<00:05, 98.41it/s] 14%|        | 81/599 [00:01<00:04, 104.58it/s] 16%|        | 93/599 [00:01<00:04, 108.99it/s] 18%|        | 105/599 [00:01<00:04, 112.04it/s] 20%|        | 117/599 [00:01<00:04, 101.15it/s] 22%|       | 129/599 [00:01<00:04, 105.79it/s] 24%|       | 141/599 [00:01<00:04, 108.89it/s] 26%|       | 153/599 [00:01<00:04, 103.42it/s] 28%|       | 165/599 [00:01<00:04, 106.45it/s] 30%|       | 177/599 [00:02<00:03, 107.19it/s] 32%|      | 189/599 [00:02<00:03, 110.06it/s] 34%|      | 201/599 [00:02<00:03, 107.79it/s] 36%|      | 213/599 [00:02<00:03, 110.62it/s] 38%|      | 225/599 [00:02<00:03, 112.75it/s] 40%|      | 237/599 [00:02<00:03, 90.83it/s]  42%|     | 249/599 [00:02<00:03, 97.71it/s] 44%|     | 261/599 [00:02<00:03, 88.13it/s] 46%|     | 273/599 [00:03<00:03, 95.41it/s] 48%|     | 285/599 [00:03<00:03, 101.37it/s] 50%|     | 297/599 [00:03<00:02, 105.83it/s] 52%|    | 309/599 [00:03<00:02, 109.06it/s] 54%|    | 321/599 [00:03<00:02, 111.14it/s] 56%|    | 333/599 [00:03<00:02, 113.13it/s] 58%|    | 345/599 [00:03<00:02, 114.40it/s] 60%|    | 357/599 [00:03<00:02, 113.55it/s] 62%|   | 369/599 [00:03<00:02, 113.69it/s] 64%|   | 381/599 [00:04<00:01, 114.21it/s] 66%|   | 393/599 [00:04<00:01, 111.07it/s] 68%|   | 405/599 [00:04<00:01, 113.26it/s] 70%|   | 417/599 [00:04<00:01, 114.57it/s] 72%|  | 429/599 [00:04<00:01, 115.95it/s] 74%|  | 441/599 [00:04<00:01, 115.93it/s] 76%|  | 453/599 [00:04<00:01, 116.60it/s] 78%|  | 465/599 [00:04<00:01, 117.36it/s] 80%|  | 477/599 [00:04<00:01, 117.80it/s] 82%| | 489/599 [00:04<00:00, 118.07it/s] 84%| | 501/599 [00:05<00:00, 118.45it/s] 86%| | 513/599 [00:05<00:00, 118.03it/s] 88%| | 525/599 [00:05<00:00, 118.41it/s] 90%| | 537/599 [00:05<00:00, 118.03it/s] 92%|| 549/599 [00:05<00:00, 118.44it/s] 94%|| 562/599 [00:05<00:00, 119.33it/s] 96%|| 575/599 [00:05<00:00, 120.16it/s] 98%|| 588/599 [00:05<00:00, 106.32it/s]100%|| 599/599 [00:05<00:00, 100.26it/s]
tensor([0.3240, 0.3855, 0.3269, 0.3689, 0.3650], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 32 of 101
train loss is 0.4704750180244446
val loss is 0.4332593282063802
test loss is 0.4525863829757614
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:16,  5.03s/it]  5%|         | 2/40 [00:05<01:25,  2.24s/it]  8%|         | 3/40 [00:05<00:51,  1.39s/it] 10%|         | 4/40 [00:05<00:34,  1.05it/s] 12%|        | 5/40 [00:06<00:25,  1.40it/s] 15%|        | 6/40 [00:06<00:19,  1.76it/s] 18%|        | 7/40 [00:06<00:15,  2.10it/s] 20%|        | 8/40 [00:07<00:13,  2.40it/s] 22%|       | 9/40 [00:07<00:11,  2.66it/s] 25%|       | 10/40 [00:07<00:10,  2.87it/s] 28%|       | 11/40 [00:07<00:09,  3.03it/s] 30%|       | 12/40 [00:08<00:08,  3.15it/s] 32%|      | 13/40 [00:08<00:08,  3.25it/s] 35%|      | 14/40 [00:08<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.39it/s] 42%|     | 17/40 [00:09<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.47it/s] 65%|   | 26/40 [00:12<00:04,  3.47it/s] 68%|   | 27/40 [00:12<00:03,  3.47it/s] 70%|   | 28/40 [00:12<00:03,  3.47it/s] 72%|  | 29/40 [00:13<00:03,  3.47it/s] 75%|  | 30/40 [00:13<00:02,  3.48it/s] 78%|  | 31/40 [00:13<00:02,  3.48it/s] 80%|  | 32/40 [00:14<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.43it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.47s/it] 22%|       | 2/9 [00:02<00:09,  1.38s/it] 56%|    | 5/9 [00:02<00:01,  2.35it/s] 89%| | 8/9 [00:03<00:00,  4.27it/s]100%|| 9/9 [00:03<00:00,  2.83it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:41,  2.70it/s]  2%|         | 10/599 [00:00<00:22, 26.50it/s]  4%|         | 22/599 [00:00<00:11, 52.44it/s]  6%|         | 33/599 [00:00<00:08, 64.22it/s]  8%|         | 45/599 [00:00<00:06, 79.38it/s] 10%|         | 57/599 [00:00<00:05, 90.62it/s] 11%|        | 68/599 [00:01<00:06, 83.35it/s] 13%|        | 78/599 [00:01<00:07, 69.49it/s] 15%|        | 91/599 [00:01<00:06, 81.93it/s] 17%|        | 103/599 [00:01<00:05, 91.15it/s] 19%|        | 114/599 [00:01<00:06, 80.80it/s] 21%|        | 126/599 [00:01<00:05, 89.90it/s] 23%|       | 138/599 [00:01<00:04, 96.05it/s] 25%|       | 149/599 [00:02<00:05, 76.03it/s] 27%|       | 161/599 [00:02<00:05, 85.06it/s] 29%|       | 171/599 [00:02<00:05, 80.44it/s] 31%|       | 183/599 [00:02<00:04, 88.92it/s] 33%|      | 195/599 [00:02<00:04, 96.54it/s] 35%|      | 207/599 [00:02<00:03, 102.33it/s] 37%|      | 219/599 [00:02<00:03, 106.76it/s] 39%|      | 231/599 [00:02<00:03, 110.29it/s] 41%|      | 243/599 [00:02<00:03, 94.74it/s]  43%|     | 255/599 [00:03<00:03, 100.77it/s] 44%|     | 266/599 [00:03<00:03, 92.69it/s]  46%|     | 278/599 [00:03<00:03, 99.17it/s] 48%|     | 290/599 [00:03<00:02, 104.49it/s] 50%|     | 302/599 [00:03<00:02, 108.45it/s] 52%|    | 314/599 [00:03<00:02, 111.50it/s] 54%|    | 326/599 [00:03<00:02, 113.33it/s] 56%|    | 338/599 [00:03<00:02, 114.39it/s] 58%|    | 350/599 [00:03<00:02, 115.28it/s] 60%|    | 362/599 [00:04<00:02, 116.15it/s] 62%|   | 374/599 [00:04<00:01, 116.80it/s] 64%|   | 386/599 [00:04<00:01, 107.77it/s] 66%|   | 398/599 [00:04<00:01, 110.58it/s] 68%|   | 410/599 [00:04<00:01, 112.43it/s] 70%|   | 422/599 [00:04<00:01, 114.35it/s] 72%|  | 434/599 [00:04<00:01, 115.79it/s] 74%|  | 446/599 [00:04<00:01, 116.83it/s] 76%|  | 458/599 [00:04<00:01, 117.37it/s] 78%|  | 470/599 [00:04<00:01, 117.69it/s] 80%|  | 482/599 [00:05<00:00, 117.79it/s] 82%| | 494/599 [00:05<00:00, 117.79it/s] 84%| | 506/599 [00:05<00:00, 117.54it/s] 86%| | 518/599 [00:05<00:00, 117.43it/s] 88%| | 530/599 [00:05<00:00, 117.76it/s] 90%| | 542/599 [00:05<00:00, 118.30it/s] 92%|| 554/599 [00:05<00:00, 118.69it/s] 94%|| 566/599 [00:05<00:00, 119.07it/s] 97%|| 579/599 [00:05<00:00, 119.75it/s] 99%|| 592/599 [00:06<00:00, 120.28it/s]100%|| 599/599 [00:06<00:00, 97.49it/s] 
tensor([0.3159, 0.3784, 0.3186, 0.3613, 0.3582], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 33 of 101
train loss is 0.4615328907966614
val loss is 0.4247264862060547
test loss is 0.44353443075699084
validation accuracy is 92.44791666666667
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:36,  5.55s/it]  5%|         | 2/40 [00:05<01:34,  2.48s/it]  8%|         | 3/40 [00:06<00:54,  1.48s/it] 10%|         | 4/40 [00:06<00:36,  1.01s/it] 12%|        | 5/40 [00:06<00:26,  1.34it/s] 15%|        | 6/40 [00:07<00:20,  1.69it/s] 18%|        | 7/40 [00:07<00:16,  2.03it/s] 20%|        | 8/40 [00:07<00:13,  2.34it/s] 22%|       | 9/40 [00:07<00:11,  2.61it/s] 25%|       | 10/40 [00:08<00:10,  2.83it/s] 28%|       | 11/40 [00:08<00:09,  3.00it/s] 30%|       | 12/40 [00:08<00:08,  3.13it/s] 32%|      | 13/40 [00:09<00:08,  3.23it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:11<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.49it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.37it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.42s/it] 22%|       | 2/9 [00:02<00:09,  1.37s/it] 56%|    | 5/9 [00:02<00:01,  2.37it/s] 89%| | 8/9 [00:03<00:00,  4.30it/s]100%|| 9/9 [00:03<00:00,  2.86it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:26,  2.89it/s]  1%|          | 7/599 [00:00<00:30, 19.50it/s]  3%|         | 15/599 [00:00<00:15, 36.90it/s]  5%|         | 27/599 [00:00<00:09, 60.87it/s]  7%|         | 39/599 [00:00<00:07, 77.95it/s]  9%|         | 51/599 [00:00<00:06, 89.94it/s] 11%|         | 63/599 [00:00<00:05, 98.33it/s] 13%|        | 75/599 [00:01<00:05, 104.35it/s] 15%|        | 87/599 [00:01<00:05, 89.24it/s]  17%|        | 99/599 [00:01<00:05, 96.78it/s] 19%|        | 111/599 [00:01<00:04, 102.76it/s] 21%|        | 123/599 [00:01<00:04, 107.18it/s] 23%|       | 135/599 [00:01<00:04, 110.24it/s] 25%|       | 147/599 [00:01<00:04, 112.08it/s] 27%|       | 159/599 [00:01<00:03, 113.11it/s] 29%|       | 171/599 [00:01<00:03, 114.78it/s] 31%|       | 183/599 [00:02<00:03, 104.99it/s] 33%|      | 195/599 [00:02<00:03, 108.28it/s] 35%|      | 207/599 [00:02<00:04, 94.64it/s]  37%|      | 219/599 [00:02<00:03, 100.42it/s] 39%|      | 231/599 [00:02<00:03, 105.24it/s] 40%|      | 242/599 [00:02<00:03, 97.94it/s]  42%|     | 254/599 [00:02<00:03, 103.36it/s] 44%|     | 266/599 [00:02<00:03, 107.59it/s] 46%|     | 278/599 [00:02<00:02, 110.81it/s] 48%|     | 290/599 [00:03<00:02, 113.29it/s] 50%|     | 302/599 [00:03<00:02, 115.17it/s] 52%|    | 314/599 [00:03<00:02, 116.48it/s] 54%|    | 326/599 [00:03<00:02, 117.34it/s] 56%|    | 338/599 [00:03<00:02, 117.84it/s] 58%|    | 350/599 [00:03<00:02, 118.21it/s] 60%|    | 362/599 [00:03<00:02, 118.47it/s] 62%|   | 374/599 [00:03<00:01, 118.00it/s] 64%|   | 386/599 [00:03<00:01, 118.04it/s] 66%|   | 398/599 [00:03<00:01, 118.29it/s] 68%|   | 410/599 [00:04<00:01, 118.47it/s] 70%|   | 422/599 [00:04<00:01, 118.74it/s] 72%|  | 434/599 [00:04<00:01, 118.84it/s] 74%|  | 446/599 [00:04<00:01, 118.92it/s] 76%|  | 458/599 [00:04<00:01, 118.84it/s] 78%|  | 470/599 [00:04<00:01, 118.83it/s] 80%|  | 482/599 [00:04<00:00, 118.85it/s] 82%| | 494/599 [00:04<00:00, 118.89it/s] 84%| | 506/599 [00:04<00:00, 118.71it/s] 86%| | 518/599 [00:05<00:00, 118.69it/s] 88%| | 530/599 [00:05<00:00, 118.50it/s] 90%| | 542/599 [00:05<00:00, 118.53it/s] 92%|| 554/599 [00:05<00:00, 118.56it/s] 94%|| 566/599 [00:05<00:00, 118.63it/s] 97%|| 579/599 [00:05<00:00, 119.48it/s] 99%|| 592/599 [00:05<00:00, 120.32it/s]100%|| 599/599 [00:05<00:00, 104.06it/s]
tensor([0.3083, 0.3723, 0.3108, 0.3542, 0.3518], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 34 of 101
train loss is 0.4542114734649658
val loss is 0.41731399959988064
test loss is 0.43546925945353626
validation accuracy is 92.70833333333333
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:06<03:58,  6.12s/it]  5%|         | 2/40 [00:06<01:42,  2.69s/it]  8%|         | 3/40 [00:06<00:58,  1.59s/it] 10%|         | 4/40 [00:06<00:38,  1.08s/it] 12%|        | 5/40 [00:07<00:27,  1.26it/s] 15%|        | 6/40 [00:07<00:21,  1.61it/s] 18%|        | 7/40 [00:07<00:16,  1.95it/s] 20%|        | 8/40 [00:08<00:14,  2.27it/s] 22%|       | 9/40 [00:08<00:12,  2.55it/s] 25%|       | 10/40 [00:08<00:10,  2.78it/s] 28%|       | 11/40 [00:08<00:09,  2.96it/s] 30%|       | 12/40 [00:09<00:09,  3.11it/s] 32%|      | 13/40 [00:09<00:08,  3.21it/s] 35%|      | 14/40 [00:09<00:07,  3.29it/s] 38%|      | 15/40 [00:10<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:11<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:12<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:13<00:04,  3.48it/s] 65%|   | 26/40 [00:13<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:14<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:15<00:02,  3.49it/s] 82%| | 33/40 [00:15<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:16<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.29it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.44s/it] 22%|       | 2/9 [00:02<00:09,  1.39s/it] 56%|    | 5/9 [00:02<00:01,  2.34it/s] 89%| | 8/9 [00:03<00:00,  4.25it/s]100%|| 9/9 [00:03<00:00,  2.82it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:48,  2.62it/s]  1%|          | 5/599 [00:00<00:47, 12.55it/s]  3%|         | 16/599 [00:00<00:14, 39.03it/s]  5%|         | 28/599 [00:00<00:09, 61.72it/s]  6%|         | 38/599 [00:00<00:07, 70.75it/s]  8%|         | 50/599 [00:00<00:06, 84.45it/s] 10%|         | 62/599 [00:01<00:05, 94.46it/s] 12%|        | 74/599 [00:01<00:05, 101.51it/s] 14%|        | 86/599 [00:01<00:04, 105.60it/s] 16%|        | 98/599 [00:01<00:04, 109.20it/s] 18%|        | 110/599 [00:01<00:05, 90.45it/s] 20%|        | 122/599 [00:01<00:04, 97.75it/s] 22%|       | 134/599 [00:01<00:04, 103.46it/s] 24%|       | 146/599 [00:01<00:04, 107.69it/s] 26%|       | 158/599 [00:01<00:03, 110.42it/s] 28%|       | 170/599 [00:02<00:03, 112.53it/s] 30%|       | 182/599 [00:02<00:03, 109.92it/s] 32%|      | 194/599 [00:02<00:03, 112.08it/s] 34%|      | 206/599 [00:02<00:03, 113.53it/s] 36%|      | 218/599 [00:02<00:03, 112.85it/s] 38%|      | 230/599 [00:02<00:03, 111.73it/s] 40%|      | 242/599 [00:02<00:03, 112.05it/s] 42%|     | 254/599 [00:02<00:03, 113.01it/s] 44%|     | 266/599 [00:02<00:03, 101.55it/s] 46%|     | 278/599 [00:02<00:03, 105.76it/s] 48%|     | 290/599 [00:03<00:02, 108.99it/s] 50%|     | 302/599 [00:03<00:02, 110.92it/s] 52%|    | 314/599 [00:03<00:02, 112.13it/s] 54%|    | 326/599 [00:03<00:02, 113.59it/s] 56%|    | 338/599 [00:03<00:02, 113.85it/s] 58%|    | 350/599 [00:03<00:02, 114.94it/s] 60%|    | 362/599 [00:03<00:02, 115.70it/s] 62%|   | 374/599 [00:03<00:01, 116.41it/s] 64%|   | 386/599 [00:03<00:01, 116.69it/s] 66%|   | 398/599 [00:04<00:01, 116.92it/s] 68%|   | 410/599 [00:04<00:01, 117.10it/s] 70%|   | 422/599 [00:04<00:01, 117.24it/s] 72%|  | 434/599 [00:04<00:01, 117.35it/s] 74%|  | 446/599 [00:04<00:01, 116.30it/s] 76%|  | 458/599 [00:04<00:01, 116.56it/s] 78%|  | 470/599 [00:04<00:01, 116.55it/s] 80%|  | 482/599 [00:04<00:01, 116.79it/s] 82%| | 494/599 [00:04<00:00, 117.08it/s] 84%| | 506/599 [00:04<00:00, 117.35it/s] 86%| | 518/599 [00:05<00:00, 117.71it/s] 88%| | 530/599 [00:05<00:00, 117.72it/s] 90%| | 542/599 [00:05<00:00, 118.02it/s] 92%|| 554/599 [00:05<00:00, 118.37it/s] 95%|| 567/599 [00:05<00:00, 119.02it/s] 97%|| 580/599 [00:05<00:00, 119.73it/s] 99%|| 593/599 [00:05<00:00, 120.13it/s]100%|| 599/599 [00:05<00:00, 103.08it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:228: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  ns_fpr, ns_tpr, _ = roc_curve(np.array(labels_list.cpu()), ns_probs)
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:229: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  lr_fpr, lr_tpr, _ = roc_curve(np.array(labels_list.cpu()), np.array(probs_list.detach().cpu()))
tensor([0.3008, 0.3660, 0.3030, 0.3467, 0.3455], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 35 of 101
train loss is 0.44219771027565
val loss is 0.4099196328057183
test loss is 0.42720748909526757
validation accuracy is 92.79513888888889
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:06<03:59,  6.15s/it]  5%|         | 2/40 [00:06<01:42,  2.70s/it]  8%|         | 3/40 [00:06<00:59,  1.60s/it] 10%|         | 4/40 [00:07<00:38,  1.08s/it] 12%|        | 5/40 [00:07<00:27,  1.26it/s] 15%|        | 6/40 [00:07<00:21,  1.60it/s] 18%|        | 7/40 [00:07<00:16,  1.95it/s] 20%|        | 8/40 [00:08<00:14,  2.27it/s] 22%|       | 9/40 [00:08<00:12,  2.54it/s] 25%|       | 10/40 [00:08<00:10,  2.77it/s] 28%|       | 11/40 [00:09<00:09,  2.94it/s] 30%|       | 12/40 [00:09<00:09,  3.08it/s] 32%|      | 13/40 [00:09<00:08,  3.20it/s] 35%|      | 14/40 [00:09<00:07,  3.28it/s] 38%|      | 15/40 [00:10<00:07,  3.34it/s] 40%|      | 16/40 [00:10<00:07,  3.38it/s] 42%|     | 17/40 [00:10<00:06,  3.41it/s] 45%|     | 18/40 [00:11<00:06,  3.44it/s] 48%|     | 19/40 [00:11<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:12<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:13<00:04,  3.48it/s] 65%|   | 26/40 [00:13<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:14<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:15<00:02,  3.49it/s] 82%| | 33/40 [00:15<00:02,  3.48it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:16<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.29it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:11,  1.46s/it] 22%|       | 2/9 [00:02<00:09,  1.38s/it] 56%|    | 5/9 [00:02<00:01,  2.35it/s] 89%| | 8/9 [00:03<00:00,  4.27it/s]100%|| 9/9 [00:03<00:00,  2.84it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:06,  2.43it/s]  0%|          | 2/599 [00:00<02:21,  4.22it/s]  2%|         | 14/599 [00:00<00:17, 33.83it/s]  4%|         | 26/599 [00:00<00:10, 56.77it/s]  6%|         | 38/599 [00:00<00:07, 73.69it/s]  8%|         | 50/599 [00:00<00:06, 86.34it/s] 10%|         | 62/599 [00:01<00:05, 95.60it/s] 12%|        | 74/599 [00:01<00:05, 102.25it/s] 14%|        | 86/599 [00:01<00:04, 106.59it/s] 16%|        | 98/599 [00:01<00:04, 109.92it/s] 18%|        | 110/599 [00:01<00:04, 112.15it/s] 20%|        | 122/599 [00:01<00:04, 112.45it/s] 22%|       | 134/599 [00:01<00:04, 113.90it/s] 24%|       | 146/599 [00:01<00:03, 114.32it/s] 26%|       | 158/599 [00:01<00:03, 115.32it/s] 28%|       | 170/599 [00:01<00:03, 116.17it/s] 30%|       | 182/599 [00:02<00:03, 112.13it/s] 32%|      | 194/599 [00:02<00:03, 113.53it/s] 34%|      | 206/599 [00:02<00:03, 115.07it/s] 36%|      | 218/599 [00:02<00:03, 116.09it/s] 38%|      | 230/599 [00:02<00:03, 113.39it/s] 40%|      | 242/599 [00:02<00:03, 112.18it/s] 42%|     | 254/599 [00:02<00:03, 114.21it/s] 44%|     | 266/599 [00:02<00:03, 104.71it/s] 46%|     | 278/599 [00:02<00:02, 108.70it/s] 48%|     | 290/599 [00:03<00:02, 111.60it/s] 50%|     | 302/599 [00:03<00:02, 113.69it/s] 52%|    | 314/599 [00:03<00:02, 114.99it/s] 54%|    | 326/599 [00:03<00:02, 93.06it/s]  56%|    | 338/599 [00:03<00:02, 99.74it/s] 58%|    | 350/599 [00:03<00:02, 104.79it/s] 60%|    | 361/599 [00:03<00:02, 98.83it/s]  62%|   | 373/599 [00:03<00:02, 104.19it/s] 64%|   | 385/599 [00:03<00:01, 108.34it/s] 66%|   | 397/599 [00:04<00:02, 97.65it/s]  68%|   | 409/599 [00:04<00:01, 103.10it/s] 70%|   | 421/599 [00:04<00:01, 107.57it/s] 72%|  | 433/599 [00:04<00:01, 110.57it/s] 74%|  | 445/599 [00:04<00:01, 112.73it/s] 76%|  | 457/599 [00:04<00:01, 114.36it/s] 78%|  | 469/599 [00:04<00:01, 115.35it/s] 80%|  | 481/599 [00:04<00:01, 116.27it/s] 82%| | 493/599 [00:04<00:00, 116.89it/s] 84%| | 505/599 [00:05<00:00, 117.06it/s] 86%| | 517/599 [00:05<00:00, 117.42it/s] 88%| | 529/599 [00:05<00:00, 117.50it/s] 90%| | 541/599 [00:05<00:00, 117.77it/s] 92%|| 553/599 [00:05<00:00, 118.40it/s] 94%|| 566/599 [00:05<00:00, 119.00it/s] 97%|| 579/599 [00:05<00:00, 119.71it/s] 99%|| 592/599 [00:05<00:00, 120.25it/s]100%|| 599/599 [00:05<00:00, 101.69it/s]
tensor([0.2942, 0.3599, 0.2959, 0.3401, 0.3398], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 36 of 101
train loss is 0.4476046562194824
val loss is 0.4029563268025716
test loss is 0.41993023064578316
validation accuracy is 92.79513888888889
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:18,  5.09s/it]  5%|         | 2/40 [00:05<01:26,  2.26s/it]  8%|         | 3/40 [00:05<00:50,  1.36s/it] 10%|         | 4/40 [00:05<00:33,  1.07it/s] 12%|        | 5/40 [00:06<00:24,  1.42it/s] 15%|        | 6/40 [00:06<00:19,  1.78it/s] 18%|        | 7/40 [00:06<00:15,  2.12it/s] 20%|        | 8/40 [00:07<00:13,  2.42it/s] 22%|       | 9/40 [00:07<00:11,  2.68it/s] 25%|       | 10/40 [00:07<00:10,  2.88it/s] 28%|       | 11/40 [00:07<00:09,  3.04it/s] 30%|       | 12/40 [00:08<00:08,  3.16it/s] 32%|      | 13/40 [00:08<00:08,  3.25it/s] 35%|      | 14/40 [00:08<00:07,  3.32it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.43it/s] 45%|     | 18/40 [00:09<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:11<00:04,  3.47it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:12<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.48it/s] 80%|  | 32/40 [00:13<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.48it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:15<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.43it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.40s/it] 22%|       | 2/9 [00:02<00:09,  1.36s/it] 44%|     | 4/9 [00:02<00:02,  1.84it/s] 78%|  | 7/9 [00:02<00:00,  3.86it/s]100%|| 9/9 [00:03<00:00,  2.85it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:46,  3.60it/s]  0%|          | 2/599 [00:00<02:38,  3.76it/s]  2%|         | 14/599 [00:00<00:18, 31.48it/s]  4%|         | 26/599 [00:00<00:10, 53.87it/s]  6%|         | 38/599 [00:00<00:07, 71.28it/s]  8%|         | 50/599 [00:00<00:06, 84.53it/s] 10%|         | 62/599 [00:01<00:05, 94.33it/s] 12%|        | 74/599 [00:01<00:05, 101.56it/s] 15%|        | 87/599 [00:01<00:04, 107.27it/s] 17%|        | 99/599 [00:01<00:04, 110.80it/s] 19%|        | 111/599 [00:01<00:04, 113.38it/s] 21%|        | 123/599 [00:01<00:04, 115.26it/s] 23%|       | 136/599 [00:01<00:03, 116.69it/s] 25%|       | 148/599 [00:01<00:03, 116.47it/s] 27%|       | 160/599 [00:01<00:03, 115.93it/s] 29%|       | 172/599 [00:01<00:03, 116.19it/s] 31%|       | 184/599 [00:02<00:03, 113.01it/s] 33%|      | 196/599 [00:02<00:03, 112.99it/s] 35%|      | 208/599 [00:02<00:04, 94.53it/s]  37%|      | 220/599 [00:02<00:03, 100.80it/s] 39%|      | 232/599 [00:02<00:03, 105.44it/s] 41%|      | 243/599 [00:02<00:03, 96.86it/s]  43%|     | 255/599 [00:02<00:03, 102.62it/s] 44%|     | 266/599 [00:02<00:03, 91.21it/s]  46%|     | 278/599 [00:03<00:03, 98.48it/s] 48%|     | 290/599 [00:03<00:02, 104.06it/s] 50%|     | 302/599 [00:03<00:02, 108.37it/s] 52%|    | 314/599 [00:03<00:02, 111.38it/s] 54%|    | 326/599 [00:03<00:02, 99.32it/s]  56%|    | 338/599 [00:03<00:02, 104.37it/s] 58%|    | 350/599 [00:03<00:02, 108.25it/s] 60%|    | 362/599 [00:03<00:02, 98.76it/s]  62%|   | 374/599 [00:03<00:02, 104.16it/s] 64%|   | 386/599 [00:04<00:02, 87.42it/s]  67%|   | 399/599 [00:04<00:02, 95.68it/s] 69%|   | 411/599 [00:04<00:01, 101.50it/s] 70%|   | 422/599 [00:04<00:01, 97.17it/s]  72%|  | 434/599 [00:04<00:01, 102.72it/s] 74%|  | 446/599 [00:04<00:01, 107.18it/s] 76%|  | 458/599 [00:04<00:01, 109.16it/s] 78%|  | 470/599 [00:04<00:01, 111.98it/s] 80%|  | 482/599 [00:05<00:01, 106.52it/s] 82%| | 494/599 [00:05<00:00, 109.96it/s] 84%| | 506/599 [00:05<00:00, 112.65it/s] 86%| | 518/599 [00:05<00:00, 109.53it/s] 88%| | 530/599 [00:05<00:00, 112.07it/s] 91%| | 543/599 [00:05<00:00, 114.49it/s] 93%|| 556/599 [00:05<00:00, 116.36it/s] 95%|| 569/599 [00:05<00:00, 117.90it/s] 97%|| 581/599 [00:05<00:00, 101.97it/s] 99%|| 594/599 [00:06<00:00, 107.35it/s]100%|| 599/599 [00:06<00:00, 97.36it/s] 
tensor([0.2878, 0.3542, 0.2891, 0.3337, 0.3345], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 37 of 101
train loss is 0.4397713243961334
val loss is 0.3966073989868164
test loss is 0.4132213126339379
validation accuracy is 92.79513888888889
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:32,  5.45s/it]  5%|         | 2/40 [00:05<01:31,  2.41s/it]  8%|         | 3/40 [00:06<00:53,  1.44s/it] 10%|         | 4/40 [00:06<00:35,  1.01it/s] 12%|        | 5/40 [00:06<00:25,  1.36it/s] 15%|        | 6/40 [00:06<00:19,  1.71it/s] 18%|        | 7/40 [00:07<00:16,  2.05it/s] 20%|        | 8/40 [00:07<00:13,  2.36it/s] 22%|       | 9/40 [00:07<00:11,  2.62it/s] 25%|       | 10/40 [00:08<00:10,  2.84it/s] 28%|       | 11/40 [00:08<00:09,  3.01it/s] 30%|       | 12/40 [00:08<00:08,  3.14it/s] 32%|      | 13/40 [00:08<00:08,  3.24it/s] 35%|      | 14/40 [00:09<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.37it/s] 42%|     | 17/40 [00:10<00:06,  3.40it/s] 45%|     | 18/40 [00:10<00:06,  3.42it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.47it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.48it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.38it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.46s/it] 22%|       | 2/9 [00:02<00:09,  1.36s/it] 44%|     | 4/9 [00:02<00:02,  1.79it/s] 78%|  | 7/9 [00:03<00:00,  3.76it/s]100%|| 9/9 [00:03<00:00,  2.78it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:48,  3.54it/s]  0%|          | 2/599 [00:00<01:53,  5.25it/s]  2%|         | 12/599 [00:00<00:17, 34.21it/s]  3%|         | 20/599 [00:00<00:12, 47.99it/s]  5%|         | 31/599 [00:00<00:08, 65.41it/s]  7%|         | 39/599 [00:00<00:09, 57.38it/s]  8%|         | 50/599 [00:00<00:07, 70.57it/s] 10%|         | 61/599 [00:01<00:06, 80.27it/s] 12%|        | 70/599 [00:01<00:06, 76.48it/s] 14%|        | 82/599 [00:01<00:05, 86.57it/s] 16%|        | 94/599 [00:01<00:05, 95.08it/s] 18%|        | 106/599 [00:01<00:04, 101.51it/s] 20%|        | 118/599 [00:01<00:04, 106.06it/s] 22%|       | 130/599 [00:01<00:04, 109.16it/s] 24%|       | 142/599 [00:01<00:05, 81.03it/s]  26%|       | 153/599 [00:02<00:05, 87.57it/s] 27%|       | 163/599 [00:02<00:05, 79.01it/s] 29%|       | 174/599 [00:02<00:05, 84.72it/s] 31%|       | 185/599 [00:02<00:04, 90.06it/s] 33%|      | 196/599 [00:02<00:04, 93.49it/s] 34%|      | 206/599 [00:02<00:04, 88.13it/s] 36%|      | 218/599 [00:02<00:03, 95.74it/s] 38%|      | 228/599 [00:03<00:05, 72.88it/s] 40%|      | 239/599 [00:03<00:04, 80.55it/s] 42%|     | 251/599 [00:03<00:03, 89.31it/s] 44%|     | 261/599 [00:03<00:04, 75.11it/s] 45%|     | 272/599 [00:03<00:03, 82.41it/s] 47%|     | 284/599 [00:03<00:03, 90.50it/s] 49%|     | 294/599 [00:03<00:03, 90.56it/s] 51%|     | 305/599 [00:03<00:03, 93.71it/s] 53%|    | 317/599 [00:03<00:02, 100.14it/s] 55%|    | 329/599 [00:04<00:02, 104.67it/s] 57%|    | 340/599 [00:04<00:02, 105.34it/s] 59%|    | 351/599 [00:04<00:02, 105.28it/s] 61%|    | 363/599 [00:04<00:02, 106.76it/s] 63%|   | 375/599 [00:04<00:02, 109.94it/s] 65%|   | 387/599 [00:04<00:02, 101.29it/s] 67%|   | 399/599 [00:04<00:01, 105.91it/s] 69%|   | 411/599 [00:04<00:01, 109.43it/s] 71%|   | 423/599 [00:04<00:01, 96.23it/s]  73%|  | 435/599 [00:05<00:01, 101.89it/s] 75%|  | 447/599 [00:05<00:01, 106.33it/s] 77%|  | 459/599 [00:05<00:01, 109.61it/s] 79%|  | 471/599 [00:05<00:01, 111.73it/s] 81%|  | 483/599 [00:05<00:01, 113.78it/s] 83%| | 495/599 [00:05<00:00, 115.16it/s] 85%| | 507/599 [00:05<00:00, 115.91it/s] 87%| | 519/599 [00:05<00:00, 116.57it/s] 89%| | 531/599 [00:05<00:00, 117.16it/s] 91%| | 543/599 [00:05<00:00, 117.44it/s] 93%|| 555/599 [00:06<00:00, 117.28it/s] 95%|| 568/599 [00:06<00:00, 118.49it/s] 97%|| 581/599 [00:06<00:00, 119.55it/s] 99%|| 594/599 [00:06<00:00, 120.27it/s]100%|| 599/599 [00:06<00:00, 91.81it/s] 
tensor([0.2815, 0.3491, 0.2825, 0.3276, 0.3291], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 38 of 101
train loss is 0.4306505620479584
val loss is 0.3908635245429145
test loss is 0.4066678573671287
validation accuracy is 92.79513888888889
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:06<04:11,  6.44s/it]  5%|         | 2/40 [00:06<01:47,  2.82s/it]  8%|         | 3/40 [00:07<01:01,  1.66s/it] 10%|         | 4/40 [00:07<00:40,  1.12s/it] 12%|        | 5/40 [00:07<00:28,  1.22it/s] 15%|        | 6/40 [00:07<00:21,  1.56it/s] 18%|        | 7/40 [00:08<00:17,  1.91it/s] 20%|        | 8/40 [00:08<00:14,  2.23it/s] 22%|       | 9/40 [00:08<00:12,  2.51it/s] 25%|       | 10/40 [00:09<00:10,  2.75it/s] 28%|       | 11/40 [00:09<00:09,  2.94it/s] 30%|       | 12/40 [00:09<00:09,  3.08it/s] 32%|      | 13/40 [00:09<00:08,  3.19it/s] 35%|      | 14/40 [00:10<00:07,  3.28it/s] 38%|      | 15/40 [00:10<00:07,  3.34it/s] 40%|      | 16/40 [00:10<00:07,  3.38it/s] 42%|     | 17/40 [00:11<00:06,  3.41it/s] 45%|     | 18/40 [00:11<00:06,  3.44it/s] 48%|     | 19/40 [00:11<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:12<00:05,  3.47it/s] 55%|    | 22/40 [00:12<00:05,  3.47it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:13<00:04,  3.48it/s] 62%|   | 25/40 [00:13<00:04,  3.48it/s] 65%|   | 26/40 [00:13<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:14<00:03,  3.48it/s] 72%|  | 29/40 [00:14<00:03,  3.47it/s] 75%|  | 30/40 [00:14<00:02,  3.46it/s] 78%|  | 31/40 [00:15<00:02,  3.48it/s] 80%|  | 32/40 [00:15<00:02,  3.48it/s] 82%| | 33/40 [00:15<00:02,  3.48it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:16<00:01,  3.49it/s] 90%| | 36/40 [00:16<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:17<00:00,  3.49it/s] 98%|| 39/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.25it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.50s/it] 22%|       | 2/9 [00:02<00:09,  1.41s/it] 56%|    | 5/9 [00:02<00:01,  2.31it/s] 89%| | 8/9 [00:03<00:00,  4.19it/s]100%|| 9/9 [00:03<00:00,  2.78it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<04:17,  2.32it/s]  1%|         | 8/599 [00:00<00:31, 18.81it/s]  3%|         | 19/599 [00:00<00:13, 42.36it/s]  5%|         | 31/599 [00:00<00:09, 62.99it/s]  7%|         | 43/599 [00:00<00:07, 78.48it/s]  9%|         | 55/599 [00:00<00:06, 89.92it/s] 11%|         | 67/599 [00:01<00:05, 98.29it/s] 13%|        | 79/599 [00:01<00:05, 89.02it/s] 15%|        | 91/599 [00:01<00:05, 96.91it/s] 17%|        | 103/599 [00:01<00:04, 102.89it/s] 19%|        | 114/599 [00:01<00:05, 96.05it/s]  21%|        | 126/599 [00:01<00:04, 102.17it/s] 23%|       | 138/599 [00:01<00:04, 105.56it/s] 25%|       | 150/599 [00:01<00:04, 108.20it/s] 27%|       | 162/599 [00:01<00:03, 110.26it/s] 29%|       | 174/599 [00:02<00:04, 105.23it/s] 31%|       | 186/599 [00:02<00:03, 108.68it/s] 33%|      | 198/599 [00:02<00:03, 111.10it/s] 35%|      | 210/599 [00:02<00:03, 112.99it/s] 37%|      | 222/599 [00:02<00:03, 114.39it/s] 39%|      | 234/599 [00:02<00:03, 108.80it/s] 41%|      | 246/599 [00:02<00:03, 111.44it/s] 43%|     | 258/599 [00:02<00:03, 113.45it/s] 45%|     | 270/599 [00:02<00:03, 103.23it/s] 47%|     | 282/599 [00:03<00:02, 107.10it/s] 49%|     | 294/599 [00:03<00:02, 109.81it/s] 51%|     | 306/599 [00:03<00:02, 107.87it/s] 53%|    | 318/599 [00:03<00:02, 111.05it/s] 55%|    | 330/599 [00:03<00:02, 107.50it/s] 57%|    | 342/599 [00:03<00:02, 110.66it/s] 59%|    | 354/599 [00:03<00:02, 112.54it/s] 61%|    | 366/599 [00:03<00:02, 114.26it/s] 63%|   | 378/599 [00:03<00:01, 115.53it/s] 65%|   | 390/599 [00:04<00:01, 108.26it/s] 67%|   | 402/599 [00:04<00:01, 111.34it/s] 69%|   | 414/599 [00:04<00:01, 112.74it/s] 71%|   | 426/599 [00:04<00:01, 114.41it/s] 73%|  | 438/599 [00:04<00:01, 115.04it/s] 75%|  | 450/599 [00:04<00:01, 115.28it/s] 77%|  | 462/599 [00:04<00:01, 115.77it/s] 79%|  | 474/599 [00:04<00:01, 116.22it/s] 81%|  | 486/599 [00:04<00:00, 115.69it/s] 83%| | 498/599 [00:04<00:00, 116.29it/s] 85%| | 510/599 [00:05<00:00, 116.85it/s] 87%| | 522/599 [00:05<00:00, 117.55it/s] 89%| | 534/599 [00:05<00:00, 117.84it/s] 91%| | 546/599 [00:05<00:00, 113.42it/s] 93%|| 559/599 [00:05<00:00, 115.51it/s] 95%|| 572/599 [00:05<00:00, 117.28it/s] 97%|| 584/599 [00:05<00:00, 100.89it/s]100%|| 597/599 [00:05<00:00, 106.60it/s]100%|| 599/599 [00:05<00:00, 100.62it/s]
tensor([0.2761, 0.3447, 0.2769, 0.3223, 0.3245], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 39 of 101
train loss is 0.4374615550041199
val loss is 0.38603538937038845
test loss is 0.40104158946588164
validation accuracy is 92.79513888888889
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:06<04:02,  6.21s/it]  5%|         | 2/40 [00:06<01:43,  2.73s/it]  8%|         | 3/40 [00:06<00:59,  1.61s/it] 10%|         | 4/40 [00:07<00:39,  1.09s/it] 12%|        | 5/40 [00:07<00:27,  1.25it/s] 15%|        | 6/40 [00:07<00:21,  1.60it/s] 18%|        | 7/40 [00:07<00:16,  1.94it/s] 20%|        | 8/40 [00:08<00:14,  2.26it/s] 22%|       | 9/40 [00:08<00:12,  2.54it/s] 25%|       | 10/40 [00:08<00:10,  2.77it/s] 28%|       | 11/40 [00:09<00:09,  2.96it/s] 30%|       | 12/40 [00:09<00:09,  3.10it/s] 32%|      | 13/40 [00:09<00:08,  3.21it/s] 35%|      | 14/40 [00:09<00:07,  3.28it/s] 38%|      | 15/40 [00:10<00:07,  3.34it/s] 40%|      | 16/40 [00:10<00:07,  3.38it/s] 42%|     | 17/40 [00:10<00:06,  3.41it/s] 45%|     | 18/40 [00:11<00:06,  3.44it/s] 48%|     | 19/40 [00:11<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.46it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:12<00:05,  3.47it/s] 57%|    | 23/40 [00:12<00:04,  3.47it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:13<00:04,  3.48it/s] 65%|   | 26/40 [00:13<00:04,  3.48it/s] 68%|   | 27/40 [00:13<00:03,  3.48it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:14<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.48it/s] 80%|  | 32/40 [00:15<00:02,  3.47it/s] 82%| | 33/40 [00:15<00:02,  3.48it/s] 85%| | 34/40 [00:15<00:01,  3.48it/s] 88%| | 35/40 [00:15<00:01,  3.48it/s] 90%| | 36/40 [00:16<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.28it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.42s/it] 22%|       | 2/9 [00:02<00:09,  1.40s/it] 56%|    | 5/9 [00:02<00:01,  2.31it/s] 89%| | 8/9 [00:03<00:00,  4.21it/s]100%|| 9/9 [00:03<00:00,  2.80it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:57,  2.52it/s]  1%|          | 6/599 [00:00<00:39, 15.00it/s]  3%|         | 18/599 [00:00<00:13, 43.46it/s]  5%|         | 29/599 [00:00<00:09, 61.63it/s]  7%|         | 41/599 [00:00<00:07, 77.09it/s]  9%|         | 53/599 [00:00<00:06, 88.48it/s] 11%|         | 65/599 [00:01<00:05, 96.72it/s] 13%|        | 77/599 [00:01<00:05, 103.04it/s] 15%|        | 89/599 [00:01<00:04, 107.22it/s] 17%|        | 101/599 [00:01<00:04, 110.65it/s] 19%|        | 113/599 [00:01<00:04, 112.87it/s] 21%|        | 125/599 [00:01<00:04, 114.40it/s] 23%|       | 137/599 [00:01<00:04, 112.20it/s] 25%|       | 149/599 [00:01<00:03, 113.98it/s] 27%|       | 161/599 [00:01<00:03, 115.35it/s] 29%|       | 173/599 [00:01<00:03, 115.98it/s] 31%|       | 185/599 [00:02<00:03, 111.13it/s] 33%|      | 197/599 [00:02<00:03, 113.13it/s] 35%|      | 209/599 [00:02<00:03, 113.72it/s] 37%|      | 221/599 [00:02<00:03, 115.11it/s] 39%|      | 233/599 [00:02<00:03, 116.09it/s] 41%|      | 245/599 [00:02<00:03, 95.49it/s]  43%|     | 257/599 [00:02<00:03, 101.51it/s] 45%|     | 269/599 [00:02<00:03, 105.68it/s] 47%|     | 281/599 [00:02<00:02, 109.27it/s] 49%|     | 293/599 [00:03<00:02, 111.72it/s] 51%|     | 305/599 [00:03<00:02, 113.82it/s] 53%|    | 317/599 [00:03<00:02, 115.22it/s] 55%|    | 329/599 [00:03<00:02, 116.39it/s] 57%|    | 341/599 [00:03<00:02, 117.13it/s] 59%|    | 353/599 [00:03<00:02, 117.56it/s] 61%|    | 365/599 [00:03<00:01, 118.07it/s] 63%|   | 377/599 [00:03<00:01, 118.30it/s] 65%|   | 389/599 [00:03<00:01, 116.66it/s] 67%|   | 401/599 [00:03<00:01, 117.22it/s] 69%|   | 413/599 [00:04<00:01, 117.30it/s] 71%|   | 425/599 [00:04<00:01, 117.85it/s] 73%|  | 437/599 [00:04<00:01, 118.15it/s] 75%|  | 449/599 [00:04<00:01, 118.06it/s] 77%|  | 461/599 [00:04<00:01, 118.12it/s] 79%|  | 473/599 [00:04<00:01, 118.25it/s] 81%|  | 485/599 [00:04<00:00, 118.25it/s] 83%| | 497/599 [00:04<00:00, 118.45it/s] 85%| | 509/599 [00:04<00:00, 118.50it/s] 87%| | 521/599 [00:04<00:00, 118.50it/s] 89%| | 533/599 [00:05<00:00, 118.78it/s] 91%| | 545/599 [00:05<00:00, 117.82it/s] 93%|| 557/599 [00:05<00:00, 118.33it/s] 95%|| 570/599 [00:05<00:00, 119.08it/s] 97%|| 582/599 [00:05<00:00, 111.04it/s] 99%|| 595/599 [00:05<00:00, 113.78it/s]100%|| 599/599 [00:05<00:00, 104.39it/s]
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:228: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  ns_fpr, ns_tpr, _ = roc_curve(np.array(labels_list.cpu()), ns_probs)
/share/home/conradb/git/ifg-ssl/hephaestus/training/MAE_finetune.py:229: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  lr_fpr, lr_tpr, _ = roc_curve(np.array(labels_list.cpu()), np.array(probs_list.detach().cpu()))
tensor([0.2703, 0.3398, 0.2708, 0.3162, 0.3193], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 40 of 101
train loss is 0.4257168769836426
val loss is 0.3811137941148546
test loss is 0.39510031962434516
validation accuracy is 92.79513888888889
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:58: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|         | 1/40 [00:04<02:56,  4.52s/it]  5%|         | 2/40 [00:05<01:29,  2.36s/it]  8%|         | 3/40 [00:05<00:52,  1.41s/it] 10%|         | 4/40 [00:05<00:34,  1.03it/s] 12%|        | 5/40 [00:06<00:25,  1.38it/s] 15%|        | 6/40 [00:06<00:19,  1.74it/s] 18%|        | 7/40 [00:06<00:15,  2.08it/s] 20%|        | 8/40 [00:07<00:13,  2.39it/s] 22%|       | 9/40 [00:07<00:11,  2.65it/s] 25%|       | 10/40 [00:07<00:10,  2.86it/s] 28%|       | 11/40 [00:07<00:09,  3.02it/s] 30%|       | 12/40 [00:08<00:08,  3.15it/s] 32%|      | 13/40 [00:08<00:08,  3.24it/s] 35%|      | 14/40 [00:08<00:07,  3.31it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:09<00:06,  3.43it/s] 45%|     | 18/40 [00:09<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:10<00:05,  3.46it/s] 52%|    | 21/40 [00:10<00:05,  3.46it/s] 55%|    | 22/40 [00:11<00:05,  3.47it/s] 57%|    | 23/40 [00:11<00:04,  3.47it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:11<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.48it/s] 68%|   | 27/40 [00:12<00:03,  3.48it/s] 70%|   | 28/40 [00:12<00:03,  3.48it/s] 72%|  | 29/40 [00:13<00:03,  3.48it/s] 75%|  | 30/40 [00:13<00:02,  3.48it/s] 78%|  | 31/40 [00:13<00:02,  3.48it/s] 80%|  | 32/40 [00:13<00:02,  3.48it/s] 82%| | 33/40 [00:14<00:02,  3.48it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:15<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.48it/s]100%|| 40/40 [00:16<00:00,  2.44it/s]
  0%|          | 0/9 [00:00<?, ?it/s]/home/conradb/git/ifg-ssl/MAE/engine_finetune.py:135: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/conradb/.conda/envs/torch/lib/python3.11/site-packages/torch/nn/modules/module.py:1736: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
 11%|         | 1/9 [00:01<00:11,  1.40s/it] 22%|       | 2/9 [00:02<00:09,  1.36s/it] 56%|    | 5/9 [00:02<00:01,  2.38it/s] 89%| | 8/9 [00:03<00:00,  4.31it/s]100%|| 9/9 [00:03<00:00,  2.86it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:59,  3.34it/s]  2%|         | 9/599 [00:00<00:21, 27.67it/s]  3%|         | 18/599 [00:00<00:12, 46.96it/s]  5%|         | 30/599 [00:00<00:08, 69.00it/s]  7%|         | 42/599 [00:00<00:06, 84.19it/s]  9%|         | 52/599 [00:00<00:06, 83.76it/s] 11%|         | 65/599 [00:00<00:05, 94.85it/s] 13%|        | 77/599 [00:01<00:05, 99.87it/s] 15%|        | 89/599 [00:01<00:04, 105.42it/s] 17%|        | 101/599 [00:01<00:04, 108.63it/s] 19%|        | 113/599 [00:01<00:04, 105.23it/s] 21%|        | 125/599 [00:01<00:04, 109.29it/s] 23%|       | 137/599 [00:01<00:04, 111.72it/s] 25%|       | 149/599 [00:01<00:03, 113.97it/s] 27%|       | 161/599 [00:01<00:03, 115.70it/s] 29%|       | 173/599 [00:01<00:03, 116.74it/s] 31%|       | 185/599 [00:01<00:03, 117.46it/s] 33%|      | 197/599 [00:02<00:03, 117.90it/s] 35%|      | 209/599 [00:02<00:03, 118.05it/s] 37%|      | 221/599 [00:02<00:03, 118.37it/s] 39%|      | 233/599 [00:02<00:03, 99.72it/s]  41%|      | 245/599 [00:02<00:03, 104.65it/s] 43%|     | 257/599 [00:02<00:03, 108.36it/s] 45%|     | 269/599 [00:02<00:03, 90.20it/s]  47%|     | 281/599 [00:02<00:03, 97.32it/s] 49%|     | 293/599 [00:03<00:02, 102.89it/s] 51%|     | 305/599 [00:03<00:02, 106.94it/s] 53%|    | 317/599 [00:03<00:02, 109.87it/s] 55%|    | 329/599 [00:03<00:02, 112.30it/s] 57%|    | 341/599 [00:03<00:02, 114.09it/s] 59%|    | 353/599 [00:03<00:02, 115.12it/s] 61%|    | 365/599 [00:03<00:02, 116.16it/s] 63%|   | 377/599 [00:03<00:01, 116.82it/s] 65%|   | 389/599 [00:03<00:01, 117.29it/s] 67%|   | 401/599 [00:03<00:01, 117.52it/s] 69%|   | 413/599 [00:04<00:01, 117.38it/s] 71%|   | 425/599 [00:04<00:01, 117.63it/s] 73%|  | 437/599 [00:04<00:01, 117.89it/s] 75%|  | 449/599 [00:04<00:01, 118.23it/s] 77%|  | 461/599 [00:04<00:01, 118.22it/s] 79%|  | 473/599 [00:04<00:01, 118.36it/s] 81%|  | 485/599 [00:04<00:00, 118.28it/s] 83%| | 497/599 [00:04<00:00, 118.27it/s] 85%| | 509/599 [00:04<00:00, 118.15it/s] 87%| | 521/599 [00:04<00:00, 117.63it/s] 89%| | 533/599 [00:05<00:00, 117.72it/s] 91%| | 545/599 [00:05<00:00, 117.48it/s] 93%|| 557/599 [00:05<00:00, 118.14it/s] 95%|| 570/599 [00:05<00:00, 118.81it/s] 97%|| 583/599 [00:05<00:00, 119.47it/s] 99%|| 596/599 [00:05<00:00, 119.76it/s]100%|| 599/599 [00:05<00:00, 105.20it/s]
tensor([0.2649, 0.3354, 0.2649, 0.3108, 0.3147], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 41 of 101
train loss is 0.41735607385635376
val loss is 0.376789304945204
test loss is 0.3895582459705302
validation accuracy is 92.79513888888889
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:31,  5.43s/it]  5%|         | 2/40 [00:05<01:35,  2.51s/it]  8%|         | 3/40 [00:06<00:55,  1.49s/it] 10%|         | 4/40 [00:06<00:36,  1.02s/it] 12%|        | 5/40 [00:06<00:26,  1.32it/s] 15%|        | 6/40 [00:07<00:20,  1.68it/s] 18%|        | 7/40 [00:07<00:16,  2.02it/s] 20%|        | 8/40 [00:07<00:13,  2.33it/s] 22%|       | 9/40 [00:07<00:11,  2.60it/s] 25%|       | 10/40 [00:08<00:10,  2.82it/s] 28%|       | 11/40 [00:08<00:09,  3.00it/s] 30%|       | 12/40 [00:08<00:08,  3.13it/s] 32%|      | 13/40 [00:09<00:08,  3.23it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:09<00:07,  3.40it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.45it/s] 50%|     | 20/40 [00:11<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:11<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.48it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:13<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:15<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.37it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:12,  1.55s/it] 22%|       | 2/9 [00:02<00:10,  1.43s/it] 44%|     | 4/9 [00:03<00:02,  1.76it/s] 78%|  | 7/9 [00:03<00:00,  3.71it/s]100%|| 9/9 [00:03<00:00,  2.71it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:55,  3.41it/s]  0%|          | 2/599 [00:00<01:52,  5.32it/s]  2%|         | 12/599 [00:00<00:18, 31.03it/s]  4%|         | 24/599 [00:00<00:10, 55.99it/s]  6%|         | 36/599 [00:00<00:07, 74.21it/s]  8%|         | 48/599 [00:00<00:06, 86.84it/s] 10%|         | 60/599 [00:00<00:05, 96.23it/s] 12%|        | 72/599 [00:01<00:05, 103.05it/s] 14%|        | 84/599 [00:01<00:04, 107.87it/s] 16%|        | 96/599 [00:01<00:04, 111.02it/s] 18%|        | 108/599 [00:01<00:04, 106.42it/s] 20%|        | 120/599 [00:01<00:04, 110.11it/s] 22%|       | 132/599 [00:01<00:04, 112.86it/s] 24%|       | 144/599 [00:01<00:03, 114.92it/s] 26%|       | 156/599 [00:01<00:03, 116.39it/s] 28%|       | 168/599 [00:01<00:03, 115.75it/s] 30%|       | 180/599 [00:01<00:03, 115.56it/s] 32%|      | 192/599 [00:02<00:03, 116.53it/s] 34%|      | 204/599 [00:02<00:03, 117.17it/s] 36%|      | 216/599 [00:02<00:03, 109.81it/s] 38%|      | 228/599 [00:02<00:03, 103.30it/s] 40%|      | 239/599 [00:02<00:03, 102.68it/s] 42%|     | 251/599 [00:02<00:03, 107.11it/s] 44%|     | 263/599 [00:02<00:03, 110.38it/s] 46%|     | 275/599 [00:02<00:02, 112.73it/s] 48%|     | 287/599 [00:02<00:02, 114.66it/s] 50%|     | 299/599 [00:03<00:02, 115.98it/s] 52%|    | 311/599 [00:03<00:02, 116.91it/s] 54%|    | 323/599 [00:03<00:02, 99.94it/s]  56%|    | 335/599 [00:03<00:02, 104.96it/s] 58%|    | 347/599 [00:03<00:02, 108.92it/s] 60%|    | 359/599 [00:03<00:02, 108.45it/s] 62%|   | 371/599 [00:03<00:02, 111.34it/s] 64%|   | 383/599 [00:03<00:01, 113.31it/s] 66%|   | 395/599 [00:03<00:02, 100.72it/s] 68%|   | 407/599 [00:04<00:01, 105.40it/s] 70%|   | 419/599 [00:04<00:01, 108.99it/s] 72%|  | 431/599 [00:04<00:01, 111.78it/s] 74%|  | 443/599 [00:04<00:01, 113.78it/s] 76%|  | 455/599 [00:04<00:01, 115.26it/s] 78%|  | 467/599 [00:04<00:01, 116.28it/s] 80%|  | 479/599 [00:04<00:01, 117.11it/s] 82%| | 491/599 [00:04<00:00, 117.63it/s] 84%| | 503/599 [00:04<00:00, 118.05it/s] 86%| | 515/599 [00:04<00:00, 118.16it/s] 88%| | 527/599 [00:05<00:00, 118.49it/s] 90%| | 539/599 [00:05<00:00, 118.83it/s] 92%|| 552/599 [00:05<00:00, 119.34it/s] 94%|| 565/599 [00:05<00:00, 120.06it/s] 96%|| 578/599 [00:05<00:00, 120.62it/s] 99%|| 591/599 [00:05<00:00, 121.17it/s]100%|| 599/599 [00:05<00:00, 103.78it/s]
tensor([0.2600, 0.3315, 0.2595, 0.3057, 0.3105], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 42 of 101
train loss is 0.4203472137451172
val loss is 0.37278609805636936
test loss is 0.3847200350092727
validation accuracy is 92.79513888888889
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:52,  5.96s/it]  5%|         | 2/40 [00:06<01:39,  2.62s/it]  8%|         | 3/40 [00:06<00:57,  1.55s/it] 10%|         | 4/40 [00:06<00:37,  1.05s/it] 12%|        | 5/40 [00:07<00:27,  1.29it/s] 15%|        | 6/40 [00:07<00:20,  1.64it/s] 18%|        | 7/40 [00:07<00:16,  1.98it/s] 20%|        | 8/40 [00:07<00:13,  2.30it/s] 22%|       | 9/40 [00:08<00:12,  2.57it/s] 25%|       | 10/40 [00:08<00:10,  2.80it/s] 28%|       | 11/40 [00:08<00:09,  2.98it/s] 30%|       | 12/40 [00:09<00:08,  3.11it/s] 32%|      | 13/40 [00:09<00:08,  3.22it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.35it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:11<00:06,  3.46it/s] 50%|     | 20/40 [00:11<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.49it/s] 65%|   | 26/40 [00:13<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:15<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  3.49it/s]100%|| 40/40 [00:17<00:00,  2.32it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.41s/it] 22%|       | 2/9 [00:02<00:09,  1.37s/it] 56%|    | 5/9 [00:02<00:01,  2.36it/s] 89%| | 8/9 [00:03<00:00,  4.29it/s]100%|| 9/9 [00:03<00:00,  2.86it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<03:22,  2.96it/s]  1%|          | 6/599 [00:00<00:37, 15.93it/s]  3%|         | 18/599 [00:00<00:12, 45.00it/s]  5%|         | 30/599 [00:00<00:08, 65.61it/s]  7%|         | 42/599 [00:00<00:06, 80.13it/s]  9%|         | 54/599 [00:00<00:05, 91.38it/s] 11%|         | 66/599 [00:00<00:05, 99.28it/s] 13%|        | 78/599 [00:01<00:04, 104.96it/s] 15%|        | 90/599 [00:01<00:04, 109.16it/s] 17%|        | 102/599 [00:01<00:04, 112.00it/s] 19%|        | 114/599 [00:01<00:04, 114.01it/s] 21%|        | 126/599 [00:01<00:04, 115.29it/s] 23%|       | 138/599 [00:01<00:03, 116.11it/s] 25%|       | 150/599 [00:01<00:03, 116.69it/s] 27%|       | 162/599 [00:01<00:03, 117.21it/s] 29%|       | 174/599 [00:01<00:03, 116.09it/s] 31%|       | 186/599 [00:01<00:03, 116.76it/s] 33%|      | 198/599 [00:02<00:03, 117.21it/s] 35%|      | 210/599 [00:02<00:03, 116.47it/s] 37%|      | 222/599 [00:02<00:03, 116.94it/s] 39%|      | 234/599 [00:02<00:03, 110.23it/s] 41%|      | 246/599 [00:02<00:03, 112.57it/s] 43%|     | 258/599 [00:02<00:02, 114.15it/s] 45%|     | 270/599 [00:02<00:03, 100.27it/s] 47%|     | 282/599 [00:02<00:03, 104.92it/s] 49%|     | 294/599 [00:02<00:02, 108.17it/s] 51%|     | 306/599 [00:03<00:02, 111.00it/s] 53%|    | 318/599 [00:03<00:02, 113.25it/s] 55%|    | 330/599 [00:03<00:02, 114.98it/s] 57%|    | 342/599 [00:03<00:02, 116.26it/s] 59%|    | 354/599 [00:03<00:02, 115.39it/s] 61%|    | 366/599 [00:03<00:02, 95.74it/s]  63%|   | 378/599 [00:03<00:02, 101.69it/s] 65%|   | 390/599 [00:03<00:01, 106.23it/s] 67%|   | 402/599 [00:03<00:01, 109.52it/s] 69%|   | 414/599 [00:04<00:01, 112.15it/s] 71%|   | 426/599 [00:04<00:01, 113.89it/s] 73%|  | 438/599 [00:04<00:01, 104.71it/s] 75%|  | 450/599 [00:04<00:01, 108.47it/s] 77%|  | 462/599 [00:04<00:01, 102.18it/s] 79%|  | 474/599 [00:04<00:01, 106.58it/s] 81%|  | 486/599 [00:04<00:01, 109.89it/s] 83%| | 498/599 [00:04<00:00, 112.37it/s] 85%| | 510/599 [00:04<00:00, 114.17it/s] 87%| | 522/599 [00:05<00:00, 115.40it/s] 89%| | 534/599 [00:05<00:00, 115.83it/s] 91%| | 546/599 [00:05<00:00, 116.75it/s] 93%|| 559/599 [00:05<00:00, 117.82it/s] 95%|| 572/599 [00:05<00:00, 118.86it/s] 98%|| 585/599 [00:05<00:00, 119.61it/s]100%|| 598/599 [00:05<00:00, 120.18it/s]100%|| 599/599 [00:05<00:00, 103.66it/s]
tensor([0.2551, 0.3274, 0.2546, 0.3008, 0.3062], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 43 of 101
train loss is 0.4176541268825531
val loss is 0.36866399976942277
test loss is 0.3799940241199105
validation accuracy is 92.88194444444444
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:05<03:42,  5.70s/it]  5%|         | 2/40 [00:05<01:35,  2.52s/it]  8%|         | 3/40 [00:06<00:55,  1.50s/it] 10%|         | 4/40 [00:06<00:36,  1.02s/it] 12%|        | 5/40 [00:06<00:26,  1.32it/s] 15%|        | 6/40 [00:07<00:20,  1.68it/s] 18%|        | 7/40 [00:07<00:16,  2.02it/s] 20%|        | 8/40 [00:07<00:13,  2.33it/s] 22%|       | 9/40 [00:07<00:11,  2.60it/s] 25%|       | 10/40 [00:08<00:10,  2.82it/s] 28%|       | 11/40 [00:08<00:09,  3.00it/s] 30%|       | 12/40 [00:08<00:08,  3.13it/s] 32%|      | 13/40 [00:09<00:08,  3.23it/s] 35%|      | 14/40 [00:09<00:07,  3.30it/s] 38%|      | 15/40 [00:09<00:07,  3.36it/s] 40%|      | 16/40 [00:10<00:07,  3.39it/s] 42%|     | 17/40 [00:10<00:06,  3.42it/s] 45%|     | 18/40 [00:10<00:06,  3.44it/s] 48%|     | 19/40 [00:10<00:06,  3.46it/s] 50%|     | 20/40 [00:11<00:05,  3.47it/s] 52%|    | 21/40 [00:11<00:05,  3.47it/s] 55%|    | 22/40 [00:11<00:05,  3.48it/s] 57%|    | 23/40 [00:12<00:04,  3.48it/s] 60%|    | 24/40 [00:12<00:04,  3.48it/s] 62%|   | 25/40 [00:12<00:04,  3.49it/s] 65%|   | 26/40 [00:12<00:04,  3.49it/s] 68%|   | 27/40 [00:13<00:03,  3.49it/s] 70%|   | 28/40 [00:13<00:03,  3.49it/s] 72%|  | 29/40 [00:13<00:03,  3.49it/s] 75%|  | 30/40 [00:14<00:02,  3.49it/s] 78%|  | 31/40 [00:14<00:02,  3.49it/s] 80%|  | 32/40 [00:14<00:02,  3.49it/s] 82%| | 33/40 [00:14<00:02,  3.49it/s] 85%| | 34/40 [00:15<00:01,  3.49it/s] 88%| | 35/40 [00:15<00:01,  3.49it/s] 90%| | 36/40 [00:15<00:01,  3.49it/s] 92%|| 37/40 [00:16<00:00,  3.49it/s] 95%|| 38/40 [00:16<00:00,  3.49it/s] 98%|| 39/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  3.49it/s]100%|| 40/40 [00:16<00:00,  2.35it/s]
  0%|          | 0/9 [00:00<?, ?it/s] 11%|         | 1/9 [00:01<00:11,  1.48s/it] 22%|       | 2/9 [00:02<00:09,  1.32s/it] 56%|    | 5/9 [00:02<00:01,  2.42it/s] 89%| | 8/9 [00:02<00:00,  4.39it/s]100%|| 9/9 [00:03<00:00,  2.90it/s]
  0%|          | 0/599 [00:00<?, ?it/s]  0%|          | 1/599 [00:00<02:50,  3.51it/s]  1%|          | 7/599 [00:00<00:27, 21.81it/s]  2%|         | 13/599 [00:00<00:18, 31.37it/s]  4%|         | 25/599 [00:00<00:09, 57.41it/s]  6%|         | 37/599 [00:00<00:07, 75.57it/s]  8%|         | 49/599 [00:00<00:06, 87.96it/s] 10%|         | 61/599 [00:00<00:05, 97.05it/s] 12%|        | 72/599 [00:01<00:05, 95.37it/s] 14%|        | 83/599 [00:01<00:05, 93.93it/s] 16%|        | 95/599 [00:01<00:04, 100.91it/s] 18%|        | 107/599 [00:01<00:04, 106.25it/s] 20%|        | 118/599 [00:01<00:05, 85.50it/s]  22%|       | 131/599 [00:01<00:04, 94.56it/s] 24%|       | 143/599 [00:01<00:04, 101.04it/s] 26%|       | 155/599 [00:01<00:04, 106.10it/s] 28%|       | 167/599 [00:01<00:03, 109.61it/s] 30%|       | 179/599 [00:02<00:03, 106.72it/s] 32%|      | 191/599 [00:02<00:03, 110.26it/s] 34%|      | 203/599 [00:02<00:03, 112.16it/s] 36%|      | 215/599 [00:02<00:03, 114.00it/s] 38%|      | 227/599 [00:02<00:03, 115.17it/s] 40%|      | 239/599 [00:02<00:03, 116.07it/s] 42%|     | 251/599 [00:02<00:02, 116.90it/s] 44%|     | 263/599 [00:02<00:03, 108.88it/s] 46%|     | 275/599 [00:02<00:03, 100.35it/s] 48%|     | 287/599 [00:03<00:02, 105.49it/s] 50%|     | 299/599 [00:03<00:02, 109.28it/s] 52%|    | 311/599 [00:03<00:02, 112.08it/s] 54%|    | 323/599 [00:03<00:02, 114.08it/s] 56%|    | 335/599 [00:03<00:02, 115.43it/s] 58%|    | 347/599 [00:03<00:02, 116.40it/s] 60%|    | 359/599 [00:03<00:02, 117.30it/s] 62%|   | 371/599 [00:03<00:02, 107.49it/s] 64%|   | 383/599 [00:03<00:01, 110.69it/s] 66%|   | 395/599 [00:04<00:01, 113.11it/s] 68%|   | 407/599 [00:04<00:01, 114.86it/s] 70%|   | 419/599 [00:04<00:01, 115.99it/s] 72%|  | 431/599 [00:04<00:01, 116.76it/s] 74%|  | 443/599 [00:04<00:01, 117.27it/s] 76%|  | 455/599 [00:04<00:01, 117.73it/s] 78%|  | 467/599 [00:04<00:01, 117.95it/s] 80%|  | 479/599 [00:04<00:01, 118.06it/s] 82%| | 491/599 [00:04<00:00, 118.40it/s] 84%| | 503/599 [00:04<00:00, 118.68it/s] 86%| | 515/599 [00:05<00:00, 118.73it/s] 88%| | 527/599 [00:05<00:00, 118.56it/s] 90%| | 539/599 [00:05<00:00, 118.57it/s] 92%|| 552/599 [00:05<00:00, 119.07it/s] 94%|| 565/599 [00:05<00:00, 119.48it/s] 96%|| 578/599 [00:05<00:00, 119.98it/s] 99%|| 591/599 [00:05<00:00, 120.40it/s]100%|| 599/599 [00:05<00:00, 103.52it/s]
tensor([0.2510, 0.3242, 0.2500, 0.2961, 0.3027], device='cuda:0',
       dtype=torch.float16)
tensor([0, 0, 0, 0, 0], device='cuda:0')
torch.Size([8386])
torch.Size([8386])
Epoch 44 of 101
train loss is 0.4140830636024475
val loss is 0.3651149537828233
test loss is 0.37584885915054106
validation accuracy is 92.88194444444444
test accuracy is 93.32220874206848
  0%|          | 0/40 [00:00<?, ?it/s]  2%|         | 1/40 [00:04<03:01,  4.66s/it]  5%|         | 2/40 [00:04<01:19,  2.09s/it]  8%|         | 3/40 [00:05<00:46,  1.27s/it] 10%|         | 4/40 [00:05<00:31,  1.14it/s] 12%|        | 5/40 [00:05<00:23,  1.50it/s] 15%|        | 6/40 [00:06<00:18,  1.86it/s] 18%|        | 7/40 [00:06<00:15,  2.20it/s] 20%|        | 8/40 [00:06<00:12,  2.49it/s] 22%|       | 9/40 [00:06<00:11,  2.73it/s] 25%|       | 10/40 [00:07<00:10,  2.93it/s] 28%|       | 11/40 [00:07<00:09,  3.08it/s] 30%|       | 12/40 [00:07<00:08,  3.19it/s] 32%|      | 13/40 [00:08<00:08,  3.27it/s] 35%|      | 14/40 [00:08<00:07,  3.33it/s] 38%|      | 15/40 [00:08<00:07,  3.38it/s] 40%|      | 16/40 [00:08<00:07,  3.41it/s] 42%|     | 17/40 [00:09<00:06,  3.43it/s] 45%|     | 18/40 [00:09<00:06,  3.45it/s] 48%|     | 19/40 [00:09<00:06,  3.46it/s] 50%|     | 20/40 [00:10<00:05,  3.47it/s] 52%|    | 21/40 [00:10<00:05,  3.47it/s] 55%|    | 22/40 [00:10<00:05,  3.48it/s] 57%|    | 23/40 [00:10<00:04,  3.48it/s] 60%|    | 24/40 [00:11<00:04,  3.48it/s] 62%|   | 25/40 [00:11<00:04,  3.49it/s] 65%|   | 26/40 [00:11<00:04,  3.49it/s] 68%|   | 27/40 [00:12<00:03,  3.49it/s] 70%|   | 28/40 [00:12<00:03,  3.49it/s] 72%|  | 29/40 [00:12<00:03,  3.49it/s] 75%|  | 30/40 [00:12<00:02,  3.49it/s] 78%|  | 31/40 [00:13<00:02,  3.49it/s] 80%|  | 32/40 [00:13<00:02,  3.49it/s] 82%| | 33/40 [00:13<00:02,  3.49it/s] 85%| | 34/40 [00:14<00:01,  3.49it/s] 88%| | 35/40 [00:14<00:01,  3.49it/s] 90%| | 36/40 [00:14<00:01,  3.49it/s] 92%|| 37/40 [00:14<00:00,  3.49it/s] 95%|| 38/40 [00:15<00:00,  3.49it/s] 98%|| 39/40 [00:15<00:00,  3.49it/s]100%|| 40/40 [00:15<00:00,  3.49it/s]